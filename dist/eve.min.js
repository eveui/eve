!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;(t=(t=(t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).d3||(t.d3={})).layout||(t.layout={})).cloud=e()}}(function(){return function e(t,n,a){function l(o,r){if(!n[o]){if(!t[o]){var s="function"==typeof require&&require;if(!r&&s)return s(o,!0);if(i)return i(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var d=n[o]={exports:{}};t[o][0].call(d.exports,function(e){var n=t[o][1][e];return l(n||e)},d,d.exports,e,t,n,a)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<a.length;o++)l(a[o]);return l}({1:[function(e,t,n){var a=e("d3-dispatch").dispatch,l=Math.PI/180,i=64,o=2048;function r(e){return e.text}function s(){return"serif"}function u(){return"normal"}function d(e){return Math.sqrt(e.value)}function c(){return 30*(~~(6*Math.random())-3)}function p(){return 1}function f(e,t,n,a){if(!t.sprite){var r=e.context,s=e.ratio;r.clearRect(0,0,(i<<5)/s,o/s);var u=0,d=0,c=0,p=n.length;for(--a;++a<p;){t=n[a],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font;var f=r.measureText(t.text+"m").width*s,m=t.size<<1;if(t.rotate){var g=Math.sin(t.rotate*l),h=Math.cos(t.rotate*l),y=f*h,x=f*g,b=m*h,v=m*g;f=Math.max(Math.abs(y+v),Math.abs(y-v))+31>>5<<5,m=~~Math.max(Math.abs(x+b),Math.abs(x-b))}else f=f+31>>5<<5;if(m>c&&(c=m),u+f>=i<<5&&(u=0,d+=c,c=0),d+m>=o)break;r.translate((u+(f>>1))/s,(d+(m>>1))/s),t.rotate&&r.rotate(t.rotate*l),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=f,t.height=m,t.xoff=u,t.yoff=d,t.x1=f>>1,t.y1=m>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,u+=f}for(var F=r.getImageData(0,0,(i<<5)/s,o/s).data,w=[];--a>=0;)if((t=n[a]).hasText){for(var A=(f=t.width)>>5,k=(m=t.y1-t.y0,0);k<m*A;k++)w[k]=0;if(null==(u=t.xoff))return;d=t.yoff;for(var S=0,C=-1,z=0;z<m;z++){for(k=0;k<f;k++){var T=A*z+(k>>5),M=F[(d+z)*(i<<5)+(u+k)<<2]?1<<31-k%32:0;w[T]|=M,S|=M}S?C=z:(t.y0++,m--,z--,d++)}t.y1=t.y0+C,t.sprite=w.slice(0,(t.y1-t.y0)*A)}}}function m(e,t,n){n>>=5;for(var a,l=e.sprite,i=e.width>>5,o=e.x-(i<<4),r=127&o,s=32-r,u=e.y1-e.y0,d=(e.y+e.y0)*n+(o>>5),c=0;c<u;c++){a=0;for(var p=0;p<=i;p++)if((a<<s|(p<i?(a=l[c*i+p])>>>r:0))&t[d+p])return!0;d+=n}return!1}function g(e,t){var n=e[0],a=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>a.x&&(a.x=t.x+t.x1),t.y+t.y1>a.y&&(a.y=t.y+t.y1)}function h(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function y(){return document.createElement("canvas")}function x(e){return"function"==typeof e?e:function(){return e}}t.exports=function(){var e=[256,256],t=r,n=s,l=d,v=u,F=u,w=c,A=p,k=h,S=[],C=1/0,z=a("word","end"),T=null,M=Math.random,_={},E=y;function V(t,n,a){e[0],e[1];for(var l,i,o,r,s,u=n.x,d=n.y,c=Math.sqrt(e[0]*e[0]+e[1]*e[1]),p=k(e),f=M()<.5?1:-1,g=-f;(l=p(g+=f))&&(i=~~l[0],o=~~l[1],!(Math.min(Math.abs(i),Math.abs(o))>=c));)if(n.x=u+i,n.y=d+o,!(n.x+n.x0<0||n.y+n.y0<0||n.x+n.x1>e[0]||n.y+n.y1>e[1]||a&&m(n,t,e[0])||a&&(s=a,!((r=n).x+r.x1>s[0].x&&r.x+r.x0<s[1].x&&r.y+r.y1>s[0].y&&r.y+r.y0<s[1].y)))){for(var h,y=n.sprite,x=n.width>>5,b=e[0]>>5,v=n.x-(x<<4),F=127&v,w=32-F,A=n.y1-n.y0,S=(n.y+n.y0)*b+(v>>5),C=0;C<A;C++){h=0;for(var z=0;z<=x;z++)t[S+z]|=h<<w|(z<x?(h=y[C*x+z])>>>F:0);S+=b}return delete n.sprite,!0}return!1}return _.canvas=function(e){return arguments.length?(E=x(e),_):E},_.start=function(){var a=function(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=(i<<5)/t,e.height=o/t;var n=e.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:t}}(E()),r=function(e){var t=[],n=-1;for(;++n<e;)t[n]=0;return t}((e[0]>>5)*e[1]),s=null,u=S.length,d=-1,c=[],p=S.map(function(e,a){return e.text=t.call(this,e,a),e.font=n.call(this,e,a),e.style=v.call(this,e,a),e.weight=F.call(this,e,a),e.rotate=w.call(this,e,a),e.size=~~l.call(this,e,a),e.padding=A.call(this,e,a),e}).sort(function(e,t){return t.size-e.size});return T&&clearInterval(T),T=setInterval(m,0),m(),_;function m(){for(var t=Date.now();Date.now()-t<C&&++d<u&&T;){var n=p[d];n.x=e[0]*(M()+.5)>>1,n.y=e[1]*(M()+.5)>>1,f(a,n,p,d),n.hasText&&V(r,n,s)&&(c.push(n),z.word(n),s?g(s,n):s=[{x:n.x+n.x0,y:n.y+n.y0},{x:n.x+n.x1,y:n.y+n.y1}],n.x-=e[0]>>1,n.y-=e[1]>>1)}d>=u&&(_.stop(),z.end(c,s))}},_.stop=function(){return T&&(clearInterval(T),T=null),_},_.timeInterval=function(e){return arguments.length?(C=null==e?1/0:e,_):C},_.words=function(e){return arguments.length?(S=e,_):S},_.size=function(t){return arguments.length?(e=[+t[0],+t[1]],_):e},_.font=function(e){return arguments.length?(n=x(e),_):n},_.fontStyle=function(e){return arguments.length?(v=x(e),_):v},_.fontWeight=function(e){return arguments.length?(F=x(e),_):F},_.rotate=function(e){return arguments.length?(w=x(e),_):w},_.text=function(e){return arguments.length?(t=x(e),_):t},_.spiral=function(e){return arguments.length?(k=b[e]||e,_):k},_.fontSize=function(e){return arguments.length?(l=x(e),_):l},_.padding=function(e){return arguments.length?(A=x(e),_):A},_.random=function(e){return arguments.length?(M=e,_):M},_.on=function(){var e=z.on.apply(z,arguments);return e===z?_:e},_};var b={archimedean:h,rectangular:function(e){var t=4*e[0]/e[1],n=0,a=0;return function(e){var l=e<0?-1:1;switch(Math.sqrt(1+4*l*e)-l&3){case 0:n+=t;break;case 1:a+=4;break;case 2:n-=t;break;default:a-=4;break}return[n,a]}}}},{"d3-dispatch":2}],2:[function(e,t,n){(function(e){"use strict";function t(e){var t,n=-1,a=e.length,l={},i={},o=this;for(o.on=function(e,t){if(e=function(e){var t=(e+="").indexOf("."),n=e;t>=0?e=e.slice(0,t):n+=".";if(e&&!l.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}(e),arguments.length<2)return(t=i[e.name])&&t.value;if(e.type){var n=l[e.type],a=i[e.name];a&&(a.value=null,s=n.indexOf(a),l[e.type]=n=n.slice(0,s).concat(n.slice(s+1)),delete i[e.name]),t&&(t={value:t},i[e.name]=t,n.push(t))}else if(null==t)for(var r in l)if(t=i[r+e.name]){t.value=null;var s=(n=l[r]).indexOf(t);l[r]=n.slice(0,s).concat(n.slice(s+1)),delete i[t.name]}return o};++n<a;){if(!(t=e[n]+"")||t in o)throw new Error("illegal or duplicate type: "+t);l[t]=[],o[t]=r(t)}function r(e){return function(){for(var t,n=l[e],a=-1,i=n.length;++a<i;)(t=n[a].value)&&t.apply(this,arguments);return o}}}function n(){return new t(arguments)}n.prototype=t.prototype,e.dispatch=n})("object"==typeof n&&void 0!==t?n:this.dispatch={})},{}]},{},[1])(1)}),d3.sankey=function(){function e(){for(var e,t=s,n=0;t.length;)e=[],t.forEach(function(t){t.x=n,t.dx=i,t.sourceLinks.forEach(function(t){e.indexOf(t.target)<0&&e.push(t.target)})}),t=e,++n;(function(e){s.forEach(function(t){t.sourceLinks.length||(t.x=e-1)})})(n),function(e){s.forEach(function(t){t.x*=e})}((r[0]-i)/(n-1))}function t(){function e(e,t){return e.source.y-t.source.y}function t(e,t){return e.target.y-t.target.y}s.forEach(function(n){n.sourceLinks.sort(t),n.targetLinks.sort(e)}),s.forEach(function(e){var t=0,n=0;e.sourceLinks.forEach(function(e){e.sy=t,t+=e.dy}),e.targetLinks.forEach(function(e){e.ty=n,n+=e.dy})})}function n(e){return e.y+e.dy/2}function a(e){return e.value}var l={},i=24,o=8,r=[1,1],s=[],u=[];return l.nodeWidth=function(e){return arguments.length?(i=+e,l):i},l.nodePadding=function(e){return arguments.length?(o=+e,l):o},l.nodes=function(e){return arguments.length?(s=e,l):s},l.links=function(e){return arguments.length?(u=e,l):u},l.size=function(e){return arguments.length?(r=e,l):r},l.layout=function(i){return s.forEach(function(e){e.sourceLinks=[],e.targetLinks=[]}),u.forEach(function(e){var t=e.source,n=e.target;"number"==typeof t&&(t=e.source=s[e.source]),"number"==typeof n&&(n=e.target=s[e.target]),t.sourceLinks.push(e),n.targetLinks.push(e)}),s.forEach(function(e){e.value=Math.max(d3.sum(e.sourceLinks,a),d3.sum(e.targetLinks,a))}),e(),function(e){function t(e){function t(e){return n(e.source)*e.value}c.forEach(function(l,i){l.forEach(function(l){if(l.targetLinks.length){var i=d3.sum(l.targetLinks,t)/d3.sum(l.targetLinks,a);l.y+=(i-n(l))*e}})})}function l(e){function t(e){return n(e.target)*e.value}c.slice().reverse().forEach(function(l){l.forEach(function(l){if(l.sourceLinks.length){var i=d3.sum(l.sourceLinks,t)/d3.sum(l.sourceLinks,a);l.y+=(i-n(l))*e}})})}function i(){c.forEach(function(e){var t,n,a,l=0,i=e.length;for(e.sort(d),a=0;i>a;++a)(n=l-(t=e[a]).y)>0&&(t.y+=n),l=t.y+t.dy+o;if((n=l-o-r[1])>0)for(l=t.y-=n,a=i-2;a>=0;--a)(n=(t=e[a]).y+t.dy+o-l)>0&&(t.y-=n),l=t.y})}function d(e,t){return e.y-t.y}var c=d3.nest().key(function(e){return e.x}).sortKeys(d3.ascending).entries(s).map(function(e){return e.values});(function(){var e=d3.min(c,function(e){return(r[1]-(e.length-1)*o)/d3.sum(e,a)});c.forEach(function(t){t.forEach(function(t,n){t.y=n,t.dy=t.value*e})}),u.forEach(function(t){t.dy=t.value*e})})(),i();for(var p=1;e>0;--e)l(p*=.99),i(),t(p),i()}(i),t(),l},l.relayout=function(){return t(),l},l.link=function(){function e(e){var n=e.source.x+e.source.dx,a=e.target.x,l=d3.interpolateNumber(n,a),i=l(t),o=l(1-t),r=e.source.y+e.sy+e.dy/2,s=e.target.y+e.ty+e.dy/2;return"M"+n+","+r+"C"+i+","+r+" "+o+","+s+" "+a+","+s}var t=.5;return e.curvature=function(n){return arguments.length?(t=+n,e):t},e},l};"use strict";!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.ResizeSensor=t()}("undefined"!=typeof window?window:this,function(){if("undefined"==typeof window)return null;var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,20)};function t(e,t){var n=Object.prototype.toString.call(e),a="[object Array]"===n||"[object NodeList]"===n||"[object HTMLCollection]"===n||"[object Object]"===n||"undefined"!=typeof jQuery&&e instanceof jQuery||"undefined"!=typeof Elements&&e instanceof Elements,l=0,i=e.length;if(a)for(;l<i;l++)t(e[l]);else t(e)}function n(e){if(!e.getBoundingClientRect)return{width:e.offsetWidth,height:e.offsetHeight};var t=e.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}var a=function(l,i){t(l,function(t){!function(t,a){if(t)if(t.resizedAttached)t.resizedAttached.add(a);else{t.resizedAttached=new function(){var e,t,n=[];this.add=function(e){n.push(e)},this.call=function(){for(e=0,t=n.length;e<t;e++)n[e].call()},this.remove=function(a){var l=[];for(e=0,t=n.length;e<t;e++)n[e]!==a&&l.push(n[e]);n=l},this.length=function(){return n.length}},t.resizedAttached.add(a),t.resizeSensor=document.createElement("div"),t.resizeSensor.dir="ltr",t.resizeSensor.className="resize-sensor";var l="position: absolute; left: -10px; top: -10px; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;",i="position: absolute; left: 0; top: 0; transition: 0s;";t.resizeSensor.style.cssText=l,t.resizeSensor.innerHTML='<div class="resize-sensor-expand" style="'+l+'"><div style="'+i+'"></div></div><div class="resize-sensor-shrink" style="'+l+'"><div style="'+i+' width: 200%; height: 200%"></div></div>',t.appendChild(t.resizeSensor);var o=window.getComputedStyle(t).getPropertyPriority("position");"absolute"!==o&&"relative"!==o&&"fixed"!==o&&(t.style.position="relative");var r,s,u=t.resizeSensor.childNodes[0],d=u.childNodes[0],c=t.resizeSensor.childNodes[1],p=n(t),f=p.width,m=p.height,g=function(){var e=0===t.offsetWidth&&0===t.offsetHeight;if(e){var n=t.style.display;t.style.display="block"}d.style.width="100000px",d.style.height="100000px",u.scrollLeft=1e5,u.scrollTop=1e5,c.scrollLeft=1e5,c.scrollTop=1e5,e&&(t.style.display=n)};t.resizeSensor.resetSensor=g;var h=function(){s=0,r&&(f=void 0,m=void 0,t.resizedAttached&&t.resizedAttached.call())},y=function(){var a=n(t),l=a.width,i=a.height;(r=l!=f||i!=m)&&!s&&(s=e(h)),g()},x=function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n)};x(u,"scroll",y),x(c,"scroll",y),e(g)}}(t,i)}),this.detach=function(e){a.detach(l,e)},this.reset=function(){l.resizeSensor.resetSensor()}};return a.reset=function(e,n){t(e,function(e){e.resizeSensor.resetSensor()})},a.detach=function(e,n){t(e,function(e){e&&(e.resizedAttached&&"function"==typeof n&&(e.resizedAttached.remove(n),e.resizedAttached.length())||e.resizeSensor&&(e.contains(e.resizeSensor)&&e.removeChild(e.resizeSensor),delete e.resizeSensor,delete e.resizedAttached))})},a}),function(){String.prototype.replaceAll=function(e,t){return this.split(e).join(t)},Date.prototype.diff=function(e){return(this.getTime()-e.getTime())/864e5},Date.prototype.addHours=function(e){return this.setHours(this.getHours()+e)},Date.prototype.addDays=function(e){return this.setDate(this.getDate()+e)},String.prototype.toSymbol=function(){let e=d3.symbolSquare;switch(this){case"circle":e=d3.symbolCircle;break;case"cross":e=d3.symbolCross;break;case"diamond":e=d3.symbolDiamond;break;case"star":e=d3.symbolStar;break;case"triangle":e=d3.symbolTriangle;break;case"wye":e=d3.symbolWye;break}return e},String.prototype.toTileType=function(){let e=d3.treemapSquarify;switch(this.toString().toLowerCase()){case"binary":e=d3.treemapBinary;break;case"dice":e=d3.treemapDice;break;case"slice":e=d3.treemapSlice;break;case"slicedice":e=d3.treemapSliceDice;break;case"resquarify":e=d3.treemapResquarify;break}return e},String.prototype.toEasing=function(){return d3["ease"+this.toString()[0].toUpperCase()+this.toString().slice(1)]||d3.easeLinearIn},String.prototype.toValueKey=function(){return this.toString().trim().toLowerCase().replace(/[^a-zA-Z0-9 ]/g,"")},String.prototype.toClassSelector=function(){return this.toString().toLowerCase().replace(/[^\w\s]/gi,"").replaceAll(" ","_")},Array.prototype.remove=function(){let e,t,n=arguments,a=n.length;for(;a&&this.length;)for(e=n[--a];-1!==(t=this.indexOf(e));)this.splice(t,1);return this},Array.prototype.getLongestText=function(){let e="";for(let t=0;t<this.length;t++){let n=this[t].toString();n.length>0&&(e=n)}return e},Number.prototype.between=function(e,t){return e>=this&&this<=t};let eve={configs:{},colors:["rgb(131, 170, 48)","rgb(20, 153, 211)","rgb(77, 102, 132)","rgb(61, 61, 61)","rgb(185, 52, 11)","rgb(206, 164, 92)","rgb(197, 190, 139)","rgb(73, 131, 121)","rgb(63, 38, 28)","rgb(231, 71, 0)","rgb(241, 230, 143)","rgb(255, 151, 111)","rgb(255, 100, 100)","rgb(85, 73, 57)","rgb(112, 108, 77)","rgb(156, 101, 30)","rgb(80, 107, 11)","rgb(26, 107, 77)","rgb(13, 128, 116)","rgb(32, 130, 145)","rgb(15, 146, 166)"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysMin:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsMin:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],mapDirectory:"/libraries/eve/",vectorSource:"https://maps.tilehosting.com/data/v3/",vectorKey:"TiNL5etp1GifX4gsKGzS",vectorTileStyle:"<style type='text/css'>path{stroke-linejoin:round;stroke-linecap:round;}.outerBorder{fill:none;stroke:#fff;stroke-width:1px;}.innerBorder{fill:none;stroke:#fff;stroke-width:0.5px;}.notVisible{fill:none;stroke:#dddddd;}.buildingAndHouseNo{fill:none;stroke:#987284;stroke-width:0.15px;}.noneStyle{fill:none;stroke:none;}.water{fill:#fff;stroke:#fff;}.waterway{fill:none;stroke:#fff;stroke-width:1.5px;}.roads{fill:none;stroke:#dddddd;}.roads-motorway{fill:none;stroke:#FA4A48;stroke-width:1.5px;}.roads-major_road{fill:none;stroke:#fb7b7a;stroke-width:1px;}.roads-minor_road{fill:none;stroke:#999;stroke-width:0.5px;}.roads-rail{fill:none;stroke:#503D3F;stroke-width:0.5px;}</style>",visualizations:[]};eve.configs.animation={duration:250,delay:5,enabled:!1,easing:"linear",effect:"default",field:{},order:"",autoPlay:!0,loop:!1,label:"",locked:!0},eve.configs.axis={alpha:1,color:"#999999",gridLineColor:"#aaaaaa",gridLineThickness:.5,gridLineAlpha:.5,labelAngle:0,labelFontColor:"#999999",labelFontFamily:"Tahoma",labelFontSize:10,labelFontStyle:"normal",labelFormat:"",startsFromZero:!1,locked:!1,min:null,max:null,values:[],colorMin:null,colorMax:null,tickCount:"auto",title:"",titleFontColor:"#666666",titleFontFamily:"Tahoma",titleFontSize:11,titleFontStyle:"bold",enabled:!0,skipEmpty:!1,stacked:!1,position:"left",stackType:"normal",orderField:"",orderDirection:"asc",orderValues:[]},eve.configs.legend={enabled:!0,type:"default",secondaryType:"",fontColor:"#333333",fontFamily:"Tahoma",fontSize:12,fontStyle:"normal",position:"right",circleCount:3,legendColors:[],rangeList:[],gradientStopCount:"auto",gradientColors:["",""],numberFormat:"",lockedItems:null,smartLabels:!0},eve.configs.multiples={enabled:!1,multipleField:{},startFromZeroX:!1,startFromZeroY:!1,lockAxisX:!1,lockAxisY:!1},eve.configs.serie={alpha:.8,axisPosition:"left",axisTitle:"",backColor:"#efefef",borderColor:"#cdcdcd",bullet:"none",bulletSize:8,colField:"",color:"",colorField:"",dateField:"",direction:"linear",enableDrillDown:!1,endField:"",excludeStopWords:!1,expression:"none",filterStates:!1,groupField:"",handleColor:"#999999",hideEmptyShapes:!1,labelAngle:0,labelField:"",labelFontColor:"#333333",labelFontFamily:"Tahoma",labelFontSize:"auto",labelFontStyle:"normal",labelFormat:"",labelPosition:"auto",labelVisibility:"always",latField:"",lineBehavior:"linear",lineMeasures:!1,linkShapes:!1,longField:"",majorTicks:5,mapLayers:["boundaries","landuse","roads","water"],markerColor:"#000000",markerField:"",markerFormat:"{{title}}: {{marker}}",markerWidth:5,maxBulletSize:30,maxFontSize:50,maxRadius:30,maxRange:null,measureField:"",minorTicks:5,minBulletSize:5,minFontSize:12,minRadius:5,minRange:null,neckHeight:25,negativeColor:"#E21020",numberFormat:"",orderMode:"name",orientation:"vertical",parentField:"",precision:2,radius:20,rangeColor:"#cccccc",rangeField:"",rowField:"",segmentLineAlpha:1,segmentLineColor:"#cccccc",segmentLineThickness:1,sliceStrokeAlpha:.1,sliceStrokeColor:"",sliceStrokeThickness:0,shadowsEnabled:!1,showBullets:!0,sizeField:"",sourceField:"",spriteAngle:"none",startField:"",tileIcon:"circle",tileType:"squarify",title:"",titleColor:"#666666",titleField:"",type:"column",updateReZoom:!1,valueField:"",xField:"",yField:""},eve.configs.title={content:"",fontColor:"#333333",fontFamily:"Tahoma",fontSize:13,fontStyle:"normal",position:"topCenter"},eve.configs.tooltip={backColor:"#ffffff",enabled:!0,fontColor:"#333333",fontFamily:"Tahoma",fontSize:12,fontStyle:"normal",format:"",borderColor:"#61c9f6",borderRadius:3,borderSize:1,borderStyle:"solid",opacity:.9,padding:10},eve.configs.vis={animation:eve.configs.animation,backColor:"#ffffff",border:{color:"transparent",size:0,style:"solid"},margin:{left:5,top:5,right:5,bottom:5},colors:[],container:"",currTransform:null,data:null,height:"auto",legend:eve.configs.legend,multiples:eve.configs.multiples,series:[],title:eve.configs.title,tooltip:eve.configs.tooltip,trends:[],type:"",xAxis:eve.configs.axis,xField:"",yAxis:eve.configs.axis,width:"auto"},eve.isMobile=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},eve.getType=function(e,t){let n=typeof e,a="null";if(null===e)return"null";if(void 0===e)return"undefined";switch(n){case"string":{let t=d3.utcParse("%Y-%m-%dT%H:%M:%S.%LZ"),n=d3.utcParse("%Y-%m-%dT%H:%M:%S"),a=d3.utcParse("%Y-%m-%d");if(t(e)||n(e)||a(e))return"date";{let t=new Date(e);JSON.stringify(t);return"string"}}break;case"number":case"boolean":case"function":a=n;break;default:if(void 0===e.getMonth)if("[object Array]"===Object.prototype.toString.call(e))a="array";else if("[object Function]"===Object.prototype.toString.call(e))a="function";else if("[object NodeList]"===Object.prototype.toString.call(e))a="nodeList";else if("[object Object]"===Object.prototype.toString.call(e))a="object";else{a=("object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName)?"htmlElement":"wtf"}else a="date";break}return a},eve.getBrowserName=function(){for(var e=["MSIE","Firefox","Safari","Chrome","Opera"],t=navigator.userAgent,n=e.length-1;n>-1&&-1===t.indexOf(e[n]);n--);return e[n]},eve.setColors=function(){if(0===arguments.length)return;let e=arguments[0],t=eve.getType(e);"string"===t?e.indexOf(";")>-1?eve.colors=e.split(";"):e.indexOf(",")>-1&&(eve.colors=e.split(",")):"array"===t&&(eve.colors=e)},eve.getBestDimension=function(e,t,n,a){a||(a=1);let l={area:0,cols:0,rows:0,width:0,height:0};for(let i=n;i>0;i+=-1){const o=Math.ceil(n/i);let r,s;e/(i*a)<=t/o?s=(r=e/i)/a:r=(s=t/o)*a;const u=r*s;u>l.area&&(l={area:u,width:r,height:s,rows:o,cols:i})}return l},eve.closestPower=function(e,t){if(0===arguments.length)return 2;1===arguments.length&&(t=2);let n=0;for(let a=e;a>0;--a)if(a%t==0){n=a;break}return n},eve.toHex=function(e){let t=e.toString(16);return 1===t.length?"0"+t:t},eve.rgbToHex=function(){if(1===arguments.length){if(arguments.toString().indexOf("#")>-1)return arguments[0];{let e=arguments[0].toString().replace("rgb(","").replace(")","").split(",");return"#"+eve.toHex(parseInt(e[0]))+eve.toHex(parseInt(e[1]))+eve.toHex(parseInt(e[2]))}}return 3===arguments.length?"#"+eve.toHex(parseInt(arguments[0]))+eve.toHex(parseInt(arguments[1]))+eve.toHex(parseInt(arguments[2])):"#0066CC"},eve.hexToRgb=function(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},eve.hexToRgbString=function(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?"rgb("+parseInt(t[1],16)+","+parseInt(t[2],16)+","+parseInt(t[3],16)+")":null},eve.removeDuplicates=function(e){return _.uniq(e)},eve.getNumberBase=function(e){let t=e.toString().length,n="1";for(let e=0;e<t-1;e++)n+="0";return parseFloat(n)},eve.calculateTicks=function(e){return e%2==0?e:e%5==0?e:e%10==0?e:e+1},eve.customSort=function(e,t,n){let a,l,i,o,r,s,u=[],d=[];if(e[0].hasOwnProperty("group")&&e[0].hasOwnProperty("values"))for(r=0;r<e.length;r++){for(a=eve.clone(e[r]),l=[],o=0;o<n.length;o++)if(null!=n[o])for(s=0;s<a.values.length;s++)null!=a.values[s][t]?a.values[s][t].toString().toLowerCase()===n[o].toString().toLowerCase()&&(i=eve.clone(a.values[s]),l.push(i)):d.push(eve.clone(a.values[s]));l.concat(d),a.values=l,u.push(a)}else{for(o=0;o<n.length;o++)if(null!=n[o])for(s=0;s<e.length;s++)null!=e[s][t]?e[s][t].toString().toLowerCase()===n[o].toString().toLowerCase()&&(i=eve.clone(e[s]),u.push(i)):d.push(eve.clone(e[s]));u.concat(d)}return u},eve.gradient=function(e,t){let n=d3.range(0,100,100/(e.length-1));return n.push(100),d3.scaleLinear().domain(n).range(e)(t)},eve.gridGradient=function(e,t,n){var a={},l=eve.hexToRgb(e),i=eve.hexToRgb(t);function o(e,t){return e+Math.round(n/100*(t-e))}function r(e){e=Math.min(e,255);var t=(e=Math.max(e,0)).toString(16);return t.length<2&&(t="0"+t),t}return a.r=o(l.r,i.r),a.g=o(l.g,i.g),a.b=o(l.b,i.b),a.cssColor="#"+r(a.r)+r(a.g)+r(a.b),"#"+r(a.r)+r(a.g)+r(a.b)},eve.invertColor=function(e){e.indexOf("rgb")>-1&&(e=eve.rgbToHex(e));let t=e;return t=t.substring(1),t=parseInt(t,16),t="#"+(t=("000000"+(t=(t^=16777215).toString(16))).slice(-6))},eve.randInt=function(){let e=0,t=1;if(2===arguments.length&&(e=arguments[0],t=arguments[1]),e>=t)throw Error("Max argument should be greater than min argument!");return Math.floor(Math.random()*(t-e+1))+e},eve.randDecimal=function(e,t,n){return 1*(Math.random()*(t-e)+e).toFixed(n)},eve.randColor=function(){let e="0123456789ABCDEF".split(""),t="#";for(let n=0;n<6;n++)t+=e[Math.floor(16*Math.random())];return eve.hexToRgbString(t)},eve.autoColor=function(t){let n=d3.color(t);return n?(n=255===n.r&&255===n.g&&255===n.b?d3.rgb(0,0,0):0===n.r&&0===n.g&&0===n.b?d3.rgb(255,255,255):1-(.299*n.r+.587*n.g+.114*n.b)/255<.5?d3.rgb(d3.hsl(d3.color(t)).darker()).darker(2):d3.rgb(d3.hsl(d3.color(t)).brighter()).brighter(2)).toString():e.randColor()},eve.getDaysInMonth=function(e,t){let n=new Date(e,t,1),a=(new Date(e,t+1,1)-n)/864e5;return Math.ceil(a)},eve.clone=function(e){if(!e||"object"!=typeof e)return e;if(e instanceof Date)return copy=new Date,copy.setTime(e.getTime()),copy;if(e instanceof Array){let t=[];for(let n=0,a=e.length;n<a;n++)t[n]=eve.clone(e[n]);return t}if(e instanceof Object){let t={};for(let n in e)t[n]=eve.clone(e[n]);return t}throw new Error("Unable to copy obj! Its type isn't supported.")},eve.isPrime=function(e){if(isNaN(e)||!isFinite(e)||e%1||e<2)return!1;if(e%2==0)return 2==e;let t=Math.sqrt(e);for(let n=3;n<=t;n+=2)if(e%n==0)return!1;return!0},eve.getPrimeFactors=function(e){if(isNaN(e)||!isFinite(e))return[];let t=Math.sqrt(e),n=arguments[1]||[],a=2;if(e%a)for(a=3;e%a&&(a+=2)<t;);return a=a<=t?a:e,n.push(a),a===e?n:eve.getPrimeFactors(e/a,n)},eve.extend=function(sub,base){function extended(){}if(extended.prototype=base.prototype,"function"===eve.getType(sub)&&"function"===eve.getType(base)){for(let key1 in base)eval("sub."+key1+" = base."+key1);return sub}if("object"===eve.getType(sub)&&"object"===eve.getType(base)){for(let e in base){let t=eve.getType(base[e]);"object"===t?sub[e]?eve.extend(sub[e],base[e]):sub[e]=base[e]:void 0===sub[e]&&(sub[e]=base[e])}return sub}},eve.simplify=function(){},eve.queryString=function(e){if(0===arguments.length)return"";e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");let t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},eve.isIdentical=function(e){for(let t=0;t<e.length-1;t++)if(e[t]!==e[t+1])return!1;return!0},eve.offset=function(e){let t={width:0,height:0,left:0,top:0};if(!e)return t;if("htmlElement"!==eve.getType(e))return t;let n=getComputedStyle(e,null),a=parseInt(n.getPropertyValue("border-left-width")),l=parseInt(n.getPropertyValue("border-right-width")),i=parseInt(n.getPropertyValue("border-top-width")),o=parseInt(n.getPropertyValue("border-bottom-width")),r=parseInt(n.getPropertyValue("padding-left")),s=parseInt(n.getPropertyValue("padding-right")),u=parseInt(n.getPropertyValue("padding-top")),d=parseInt(n.getPropertyValue("padding-bottom"));if(e.getBoundingClientRect){let n=e.getBoundingClientRect();t.width=n.width-a-l-r-s,t.height=n.height-i-o-u-d,t.left=n.left,t.top=n.top}else t.width=e.offsetWidth?0:parseFloat(e.offsetWidth)-a-l-r-s,t.height=e.offsetHeight?0:parseFloat(e.offsetHeight)-i-o-u-d,t.left=e.offsetLeft?0:parseFloat(e.offsetLeft),t.top=e.offsetTop?0:parseFloat(e.offsetTop);return t},eve.filterNumeric=function(e,t,n){return e.filter(function(e){return!(!e[t]||!n)&&e[t]==n})},eve.filter=function(e,t,n){return e.filter(function(e){return!(!e[t]||!n)&&e[t].toString().toUpperCase()==n.toString().toUpperCase()})},eve.filterSensitive=function(e,t,n){return e.filter(function(e){return!(!e[t]||!n)&&e[t]==n})},eve.filterSingle=function(e,t){let n,a,l=t,i=function(e){return e.toLowerCase().replaceAll("\xe4","a").replaceAll("\xe0","a").replaceAll("\xe2","a").replaceAll("\xe5","a").replaceAll("\xe1","a").replaceAll("\u0105","a").replaceAll("\xe3","a").replaceAll("\u0103","a").replaceAll("\xe7","c").replaceAll("\u010d","c").replaceAll("\u0107","c").replaceAll("\u010f","d").replaceAll("\xe9","e").replaceAll("\xe8","e").replaceAll("\xea","e").replaceAll("\xeb","e").replaceAll("\u011b","e").replaceAll("\u0119","e").replaceAll("\u011f","g").replaceAll("\xef","i").replaceAll("\xee","i").replaceAll("\u0131","i").replaceAll("\xed","i").replaceAll("\u0130","I").replaceAll("\u0148","n").replaceAll("\u0144","n").replaceAll("\xf1","n").replaceAll("\xf6","o").replaceAll("\xf4","o").replaceAll("\xf3","o").replaceAll("\u0151","o").replaceAll("\xf0","o").replaceAll("\xf5","o").replaceAll("\u0159","r").replaceAll("\u015f","s").replaceAll("\u0161","s").replaceAll("\u015b","s").replaceAll("\u0219","s").replaceAll("\u0165","t").replaceAll("\u0163","t").replaceAll("\u021b","t").replaceAll("\xfc","u").replaceAll("\u0171","u").replaceAll("\xf9","u").replaceAll("\xfb","u").replaceAll("\xfa","u").replaceAll("\u016f","u").replaceAll("\u0175","w").replaceAll("\xff","y").replaceAll("\xfd","y").replaceAll("\u0177","y").replaceAll("\u017e","z").replaceAll("\u017a","z").replaceAll("\u017c","z")};if("array"===eve.getType(l)){for(n=0;n<l.length;n++)if(l[n].replaceChar)if("array"===eve.getType(l[n].values))for(a=0;a<l[n].values.length;a++)l[n].values[a]=i(l[n].values[a]);else l[n].values=i(l[n].values)}else if(l.replaceChar)if("array"===eve.getType(l.values))for(a=0;a<l.values.length;a++)l.values[a]=i(l.values[a]);else l.values=i(l.values);for(n=0;n<e.length;n++){let t=e[n];if("array"===eve.getType(l)){if(l.every(function(e){if(t[e.key]){if(e.replaceChar&&(t[e.key]=i(t[e.key])),"array"===eve.getType(e.values))return e.values.some(function(n){return e.isNumeric?t[e.key]==n:t[e.key].toString().toUpperCase()==n.toString().toUpperCase()});if(e.values)return e.isNumeric?t[e.key]==e.values:t[e.key].toString().toUpperCase()==e.values.toString().toUpperCase()}}))return t}else if(t[l.key])if(l.replaceChar&&(t[l.key]=i(t[l.key])),"array"===eve.getType(l.values)){if(l.values.some(function(e){return l.isNumeric?t[l.key]==e:t[l.key].toString().toUpperCase()==e.toString().toUpperCase()}))return t}else if(l.isNumeric){if(t[l.key]==l.values)return t}else if(t[l.key].toString().toUpperCase()==l.values.toString().toUpperCase())return t}return null},eve.matchRange=function(e,t,n){for(let a=0;a<t.length;a++){let l=t[a];if(e>=l.minValue&&e<=l.maxValue)return{color:l[n],index:a}}},eve.findRange=function(e,t,n){for(let a=0;a<t.length;a++){let l=t[a];if(e>=l.minValue&&e<=l.maxValue)return l[n]}},eve.matchGroup=function(e,t,n){for(let a=0;a<t.length;a++){let l=t[a];if(e==l.value)return l[n]}},eve.getUniqueValues=function(e,t){return null==t?_.uniq(e):_.uniq(_.map(e,function(e){return e[t]}))},eve.detectMS=function(){let e=window.navigator.userAgent;return e.indexOf("MSIE ")>0||(e.indexOf("Trident/")>0||e.indexOf("Edge/")>0)},eve.detectIE=function(){let e=window.navigator.userAgent;return e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0},eve.isFloat=function(e){return Number(e)===e&&e%1!=0},eve.formatNumber=function(e,t){if(0===arguments.length)return"";1===arguments.length&&(t=""),t||(t="");let n="",a="",l=t.substr(0,1),i=t.substr(t.length-1,1),o="("===l&&")"===i,r="0"===l,s="0"===i,u=[],d=0,c="f",p=t.indexOf("[")>-1&&t.indexOf("]")>-1,f=t.indexOf("[")<2?"start":"end",m=/\[(.*)\]/i,g="",h="",y="",x=t.indexOf("#,##")>-1;if(""===t)return eve.isFloat(e)?parseFloat(e).toFixed(2):e?e.toString():0===e?e.toString():"";if("0"===t)return d3.format(".0f")(e);o&&(t=t.replaceAll("(","").replaceAll(")","")),p&&(g=t.match(m)[1],t=t.replaceAll("["+g+"]",""),h="start"===f?g:"",y="end"===f?g:""),l=(t=x?t.replaceAll("#,##",""):t).substr(0,1),s="0"===(i=t.substr(t.length-1,1)),(r="0"===l)||(t=t.replaceAll(l,"")),s||(t=t.replaceAll(i,"")),d=2===(u=t.split(".")).length?u[1].length:0,c="0"===i?"f":i,n=(x?",":"")+"."+d+c;try{a=h+d3.format(n)(e)+y,"s"===c&&(a=a.replaceAll("G","B"))}catch(t){return d3.format("")(e)}return o&&e<0&&(a="("+a+")"),a},eve.formatDate=function(e,t){if(0===arguments.length)return"";t||(t="%x");let n="",a=t.indexOf("AM/PM");return"string"==typeof e&&(e=new Date(e)),(t=t.replaceAll("AM/PM","%p")).indexOf("yyyy")>-1&&(t=t.replaceAll("yyyy","%Y")),t.indexOf("yy")>-1&&(t=t.replaceAll("yy","%y")),t.indexOf("mmmm")>-1&&(t=t.replaceAll("mmmm","%B")),t.indexOf("mmm")>-1&&(t=t.replaceAll("mmm","%b")),t.indexOf("mm")>-1&&(t=t.replaceAll("mm","%m")),t.indexOf("dddd")>-1&&(t=t.replaceAll("dddd","%A")),t.indexOf("ddd")>-1&&(t=t.replaceAll("ddd","%a")),t.indexOf("d")>-1&&(t=t.replaceAll("d","%e")),t.indexOf("hh")>-1&&(t=a?t.replaceAll("hh","%I"):t.replaceAll("hh","%H")),t.indexOf("h")>-1&&(t=a?t.replaceAll("h","%I"):t.replaceAll("h","%H")),(t=t.replaceAll("%N","%M")).indexOf("ss")>-1&&(t=t.replaceAll("ss","%S")),(n=d3.timeFormat(t)(e)).trim()},eve.getVisDataType=function(e){if(null==e)return null;let t=eve.getType(e);if("array"===t){let t=e[0];eve.getType(t);if(!t)return"array";if(t.hasOwnProperty("group")&&t.hasOwnProperty("values")){if("object"===eve.getType(t.values)){if(t.values.dataArray){if(t.values.dataArray.hasOwnProperty("links")&&t.values.dataArray.hasOwnProperty("nodes"))return"multiplesSankey";if("array"===eve.getType(t.values.dataArray))return"multiplesArray"}else if(t.values.hasOwnProperty("links")&&t.values.hasOwnProperty("nodes"))return"multiplesSankey";return"multiplesTree"}return"multiplesArray"}return"classical"}return"object"===t?e.hasOwnProperty("links")&&e.hasOwnProperty("nodes")?"sankey":"tree":t;return null},eve.parseColor=function(e){return"string"===eve.getType(e)&&-1!==e.indexOf("#")?eve.hexToRgbString(e):e},eve.renderVectorError=function(e){d3.select(e).append("text").style("font-size","11px").style("fill","red").style("font-family","Tahoma, Arial, Helvetica, Ubuntu").style("font-style","normal").style("font-weight","bold").style("text-anchor","middle").text("Tile fetch failed. Please check your MapTiler information.").attr("transform","translate(128,128)").each(function(){let e,t=d3.select(this),n=t.text().split(/\s+/).reverse(),a=[],l=0,i=t.attr("y"),o=t.attr("dy")?parseFloat(t.attr("dy")):0,r=t.text(null).append("tspan").attr("x",0).attr("y",i).attr("dy",o+"em");if(n.length>1)for(;e=n.pop();)a.push(e),r.text(a.join(" ")),l>0&&r.node().getComputedTextLength()>256&&(a.pop(),r.text(a.join(" ")),a=[e],r=t.append("tspan").attr("x",0).attr("y",i).attr("dy",1.1+o+"em").text(e)),l++;else r=t.append("tspan").attr("x",0).attr("y",i).attr("dy",o+"em").text(n[0])})},eve.exportToCSV=function(e,t){if(null==t&&(t="Visualization"),!(null==e||e.length<=0)){var n={};for(var a in e[0])n[a]=a;!function(e){n&&e.unshift(n);var a=function(e){for(var t="object"!=typeof e?JSON.parse(e):e,n="",a=0;a<t.length;a++){var l="",i=!1;for(var o in t[a]){(""!=l||i)&&(l+=","),i=!1;var r=t[a][o];null!=r?l+=r:i=!0}n+=l+"\r\n"}return n}(JSON.stringify(e)),l=t+".csv"||"export.csv",i=new Blob([a],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(i,l);else{var o=document.createElement("a");if(void 0!==o.download){var r=URL.createObjectURL(i);o.setAttribute("href",r),o.setAttribute("download",l),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)}}}(e)}};let tmpXY=[{x:2001,col1:15,col2:25,col3:10},{x:2002,col1:5,col2:10,col3:2},{x:2003,col1:7,col2:40,col3:61},{x:2004,col1:11,col2:12,col3:13},{x:2005,col1:17,col2:5,col3:9}],tmpSliced=[{group:"Vysda",size:25},{group:"SpreadsheetWEB",size:15},{group:"Visart",size:14}],tmpMap=[{label:"AL",value:eve.randInt(1,50)},{label:"AK",value:eve.randInt(1,50)},{label:"AZ",value:eve.randInt(1,50)},{label:"AR",value:eve.randInt(1,50)},{label:"CA",value:eve.randInt(1,50)},{label:"CO",value:eve.randInt(1,50)},{label:"CT",value:eve.randInt(1,50)},{label:"DE",value:eve.randInt(1,50)},{label:"FL",value:eve.randInt(1,50)},{label:"GA",value:eve.randInt(1,50)},{label:"HI",value:eve.randInt(1,50)},{label:"ID",value:eve.randInt(1,50)},{label:"IL",value:eve.randInt(1,50)},{label:"IN",value:eve.randInt(1,50)},{label:"IA",value:eve.randInt(1,50)},{label:"KS",value:eve.randInt(1,50)},{label:"KY",value:eve.randInt(1,50)},{label:"LA",value:eve.randInt(1,50)},{label:"ME",value:eve.randInt(1,50)},{label:"MD",value:eve.randInt(1,50)},{label:"MA",value:eve.randInt(1,50)},{label:"MI",value:eve.randInt(1,50)},{label:"MN",value:eve.randInt(1,50)},{label:"MS",value:eve.randInt(1,50)},{label:"MO",value:eve.randInt(1,50)},{label:"MT",value:eve.randInt(1,50)},{label:"NE",value:eve.randInt(1,50)},{label:"NV",value:eve.randInt(1,50)},{label:"NH",value:eve.randInt(1,50)},{label:"NJ",value:eve.randInt(1,50)},{label:"NM",value:eve.randInt(1,50)},{label:"NY",value:eve.randInt(1,50)},{label:"NC",value:eve.randInt(1,50)},{label:"ND",value:eve.randInt(1,50)},{label:"OH",value:eve.randInt(1,50)},{label:"OK",value:eve.randInt(1,50)},{label:"OR",value:eve.randInt(1,50)},{label:"PA",value:eve.randInt(1,50)},{label:"RI",value:eve.randInt(1,50)},{label:"SC",value:eve.randInt(1,50)},{label:"SD",value:eve.randInt(1,50)},{label:"TN",value:eve.randInt(1,50)},{label:"TX",value:eve.randInt(1,50)},{label:"UT",value:eve.randInt(1,50)},{label:"VT",value:eve.randInt(1,50)},{label:"VA",value:eve.randInt(1,50)},{label:"WA",value:eve.randInt(1,50)},{label:"WV",value:eve.randInt(1,50)},{label:"WV",value:eve.randInt(1,50)},{label:"WI",value:eve.randInt(1,50)},{label:"WY",value:eve.randInt(1,50)}],tmpLatLng=[{latitude:-7.5,longitude:164.9,group:"Group 1",isotime:"2012-12-26T12:00:00.000Z"},{latitude:-8.1,longitude:164.2,group:"Group 1",isotime:"2012-12-26T18:00:00.000Z"},{latitude:-14,longitude:114.3,group:"Group 2",isotime:"2012-12-27T00:00:00.000Z"},{latitude:-9,longitude:164,group:"Group 1",isotime:"2012-12-27T00:00:00.000Z"},{latitude:-9.6,longitude:163.3,group:"Group 1",isotime:"2012-12-27T06:00:00.000Z"},{latitude:-10.1,longitude:162.5,group:"Group 1",isotime:"2012-12-27T12:00:00.000Z"},{latitude:-14,longitude:112,group:"Group 2",isotime:"2012-12-27T16:00:00.000Z"},{latitude:-10.4,longitude:161.9,group:"Group 1",isotime:"2012-12-27T18:00:00.000Z"},{latitude:-14.7,longitude:111.7,group:"Group 2",isotime:"2012-12-28T00:00:00.000Z"},{latitude:-10.7,longitude:161.4,group:"Group 1",isotime:"2012-12-28T00:00:00.000Z"},{latitude:-15.1,longitude:111.7,group:"Group 2",isotime:"2012-12-28T03:00:00.000Z"},{latitude:-15.1,longitude:111.7,group:"Group 2",isotime:"2012-12-28T06:00:00.000Z"},{latitude:-11,longitude:160.9,group:"Group 1",isotime:"2012-12-28T06:00:00.000Z"},{latitude:-15.2,longitude:111.7,group:"Group 2",isotime:"2012-12-28T10:00:00.000Z"},{latitude:-15.44,longitude:111.46,group:"Group 2",isotime:"2012-12-28T12:00:00.000Z"},{latitude:-11.3,longitude:160.5,group:"Group 1",isotime:"2012-12-28T12:00:00.000Z"},{latitude:-15.5,longitude:111.4,group:"Group 2",isotime:"2012-12-28T12:30:00.000Z"},{latitude:-15.85,longitude:111.33,group:"Group 2",isotime:"2012-12-28T15:00:00.000Z"},{latitude:-16.27,longitude:111.23,group:"Group 2",isotime:"2012-12-28T18:00:00.000Z"},{latitude:-11.8,longitude:160.2,group:"Group 1",isotime:"2012-12-28T18:00:00.000Z"},{latitude:-16.65,longitude:111.05,group:"Group 2",isotime:"2012-12-28T19:39:00.000Z"},{latitude:-16.81,longitude:110.96,group:"Group 2",isotime:"2012-12-28T21:00:00.000Z"},{latitude:-17,longitude:110.85,group:"Group 2",isotime:"2012-12-28T22:34:00.000Z"},{latitude:-17.3,longitude:110.7,group:"Group 2",isotime:"2012-12-29T00:00:00.000Z"},{latitude:-12.3,longitude:159.9,group:"Group 1",isotime:"2012-12-29T00:00:00.000Z"},{latitude:-17.5,longitude:110.6,group:"Group 2",isotime:"2012-12-29T03:00:00.000Z"},{latitude:-17.9,longitude:110.3,group:"Group 2",isotime:"2012-12-29T06:00:00.000Z"},{latitude:-12.6,longitude:159.9,group:"Group 1",isotime:"2012-12-29T06:00:00.000Z"},{latitude:-18.1,longitude:110.15,group:"Group 2",isotime:"2012-12-29T07:30:00.000Z"},{latitude:-18.3,longitude:110,group:"Group 2",isotime:"2012-12-29T09:00:00.000Z"},{latitude:-19,longitude:110,group:"Group 2",isotime:"2012-12-29T12:00:00.000Z"},{latitude:-12.9,longitude:160.2,group:"Group 1",isotime:"2012-12-29T12:00:00.000Z"},{latitude:-19.4,longitude:110.1,group:"Group 2",isotime:"2012-12-29T15:00:00.000Z"},{latitude:-19.6,longitude:110.1,group:"Group 2",isotime:"2012-12-29T16:26:00.000Z"},{latitude:-19.9,longitude:110.2,group:"Group 2",isotime:"2012-12-29T18:00:00.000Z"},{latitude:-20.5,longitude:110.2,group:"Group 2",isotime:"2012-12-29T21:00:00.000Z"},{latitude:-21.1,longitude:110.2,group:"Group 2",isotime:"2012-12-30T00:00:00.000Z"},{latitude:-22.7,longitude:110.1,group:"Group 2",isotime:"2012-12-30T06:00:00.000Z"},{latitude:-23.89,longitude:109.62,group:"Group 2",isotime:"2012-12-30T12:00:00.000Z"},{latitude:-24.2,longitude:109.5,group:"Group 2",isotime:"2012-12-30T13:38:00.000Z"},{latitude:-25.4,longitude:109.2,group:"Group 2",isotime:"2012-12-30T17:14:00.000Z"},{latitude:-25.61,longitude:109.04,group:"Group 2",isotime:"2012-12-30T18:00:00.000Z"},{latitude:-25.8,longitude:108.9,group:"Group 2",isotime:"2012-12-30T18:43:00.000Z"},{latitude:-27.1,longitude:108.2,group:"Group 2",isotime:"2012-12-31T00:00:00.000Z"},{latitude:-27.3,longitude:108.1,group:"Group 2",isotime:"2012-12-31T01:30:00.000Z"},{latitude:-28.8,longitude:108.3,group:"Group 2",isotime:"2012-12-31T07:30:00.000Z"},{latitude:-29.3,longitude:108.5,group:"Group 2",isotime:"2012-12-31T10:30:00.000Z"},{latitude:-29.9,longitude:108.65,group:"Group 2",isotime:"2012-12-31T12:00:00.000Z"},{latitude:-30.5,longitude:108.8,group:"Group 2",isotime:"2012-12-31T13:30:00.000Z"},{latitude:-30.8,longitude:108.8,group:"Group 2",isotime:"2012-12-31T16:30:00.000Z"},{latitude:-31.5,longitude:109.92,group:"Group 2",isotime:"2012-12-31T19:30:00.000Z"},{latitude:-31.8,longitude:110.5,group:"Group 2",isotime:"2012-12-31T21:30:00.000Z"},{latitude:-10,longitude:125.8,group:"Group 2",isotime:"2013-01-05T00:00:00.000Z"},{latitude:-10,longitude:126.3,group:"Group 2",isotime:"2013-01-05T06:00:00.000Z"},{latitude:-10.1,longitude:126.4,group:"Group 2",isotime:"2013-01-05T12:00:00.000Z"},{latitude:-10.2,longitude:126.3,group:"Group 2",isotime:"2013-01-05T18:00:00.000Z"},{latitude:-10.2,longitude:125.8,group:"Group 2",isotime:"2013-01-06T00:00:00.000Z"},{latitude:-10.8,longitude:125,group:"Group 2",isotime:"2013-01-06T06:00:00.000Z"},{latitude:-11,longitude:124,group:"Group 2",isotime:"2013-01-06T12:00:00.000Z"},{latitude:-11.1,longitude:122.5,group:"Group 2",isotime:"2013-01-06T18:00:00.000Z"},{latitude:-11.2,longitude:122,group:"Group 2",isotime:"2013-01-06T21:00:00.000Z"},{latitude:-11.2,longitude:121.7,group:"Group 2",isotime:"2013-01-07T00:00:00.000Z"},{latitude:-11.2,longitude:121.3,group:"Group 2",isotime:"2013-01-07T03:00:00.000Z"},{latitude:-11.3,longitude:121,group:"Group 2",isotime:"2013-01-07T06:00:00.000Z"},{latitude:-11.3,longitude:120.8,group:"Group 2",isotime:"2013-01-07T09:00:00.000Z"},{latitude:-11.4,longitude:120.5,group:"Group 2",isotime:"2013-01-07T12:00:00.000Z"},{latitude:-11.6,longitude:120.2,group:"Group 2",isotime:"2013-01-07T15:00:00.000Z"},{latitude:-11.8,longitude:120,group:"Group 2",isotime:"2013-01-07T18:00:00.000Z"},{latitude:-11.9,longitude:119.8,group:"Group 2",isotime:"2013-01-07T21:00:00.000Z"},{latitude:-12,longitude:119.3,group:"Group 2",isotime:"2013-01-08T00:00:00.000Z"},{latitude:-11.9,longitude:119,group:"Group 2",isotime:"2013-01-08T03:00:00.000Z"},{latitude:-11.9,longitude:118.4,group:"Group 2",isotime:"2013-01-08T06:00:00.000Z"},{latitude:-12.1,longitude:118.1,group:"Group 2",isotime:"2013-01-08T09:00:00.000Z"},{latitude:-12.3,longitude:117.8,group:"Group 2",isotime:"2013-01-08T12:00:00.000Z"},{latitude:-12.4,longitude:117.4,group:"Group 2",isotime:"2013-01-08T15:00:00.000Z"},{latitude:-12.5,longitude:117.1,group:"Group 2",isotime:"2013-01-08T18:00:00.000Z"},{latitude:-12.6,longitude:116.8,group:"Group 2",isotime:"2013-01-08T21:00:00.000Z"},{latitude:-12.7,longitude:116.6,group:"Group 2",isotime:"2013-01-09T00:00:00.000Z"},{latitude:-12.84,longitude:116.48,group:"Group 2",isotime:"2013-01-09T03:00:00.000Z"},{latitude:-12.98,longitude:116.35,group:"Group 2",isotime:"2013-01-09T06:00:00.000Z"},{latitude:-13.1,longitude:116.21,group:"Group 2",isotime:"2013-01-09T09:00:00.000Z"},{latitude:-13.27,longitude:116.07,group:"Group 2",isotime:"2013-01-09T12:00:00.000Z"},{latitude:-13.4,longitude:116,group:"Group 2",isotime:"2013-01-09T15:00:00.000Z"},{latitude:-13.58,longitude:115.95,group:"Group 2",isotime:"2013-01-09T18:00:00.000Z"},{latitude:-13.76,longitude:115.91,group:"Group 2",isotime:"2013-01-09T21:00:00.000Z"},{latitude:-14,longitude:115.8,group:"Group 2",isotime:"2013-01-10T00:00:00.000Z"},{latitude:-14.7,longitude:115.7,group:"Group 2",isotime:"2013-01-10T03:00:00.000Z"},{latitude:-15.4,longitude:115.4,group:"Group 2",isotime:"2013-01-10T06:00:00.000Z"},{latitude:-15.9,longitude:115.1,group:"Group 2",isotime:"2013-01-10T09:00:00.000Z"},{latitude:-16.3,longitude:114.9,group:"Group 2",isotime:"2013-01-10T12:00:00.000Z"},{latitude:-16.6,longitude:114.7,group:"Group 2",isotime:"2013-01-10T15:00:00.000Z"},{latitude:-16.8,longitude:114.3,group:"Group 2",isotime:"2013-01-10T18:00:00.000Z"},{latitude:-17,longitude:114,group:"Group 2",isotime:"2013-01-10T21:00:00.000Z"},{latitude:-17.2,longitude:113.8,group:"Group 2",isotime:"2013-01-11T00:00:00.000Z"},{latitude:-17.6,longitude:113.1,group:"Group 2",isotime:"2013-01-11T06:00:00.000Z"},{latitude:-17.84,longitude:112.82,group:"Group 2",isotime:"2013-01-11T09:00:00.000Z"},{latitude:-18.09,longitude:112.54,group:"Group 2",isotime:"2013-01-11T12:00:00.000Z"},{latitude:-18.25,longitude:112.4,group:"Group 2",isotime:"2013-01-11T15:00:00.000Z"},{latitude:-18.43,longitude:112.1,group:"Group 2",isotime:"2013-01-11T18:00:00.000Z"},{latitude:-18.52,longitude:112,group:"Group 2",isotime:"2013-01-11T21:00:00.000Z"},{latitude:-18.7,longitude:112,group:"Group 2",isotime:"2013-01-12T00:00:00.000Z"},{latitude:-18.9,longitude:111.9,group:"Group 2",isotime:"2013-01-12T03:00:00.000Z"},{latitude:-19.2,longitude:111.8,group:"Group 2",isotime:"2013-01-12T06:00:00.000Z"},{latitude:-19.5,longitude:111.6,group:"Group 2",isotime:"2013-01-12T09:00:00.000Z"},{latitude:-19.8,longitude:111.5,group:"Group 2",isotime:"2013-01-12T12:00:00.000Z"},{latitude:-20.22,longitude:111.35,group:"Group 2",isotime:"2013-01-12T15:00:00.000Z"},{latitude:-20.52,longitude:111.2,group:"Group 2",isotime:"2013-01-12T18:00:00.000Z"},{latitude:-20.83,longitude:111.1,group:"Group 2",isotime:"2013-01-12T21:00:00.000Z"},{latitude:-21.3,longitude:111,group:"Group 2",isotime:"2013-01-13T00:00:00.000Z"},{latitude:-21.8,longitude:110.7,group:"Group 2",isotime:"2013-01-13T03:00:00.000Z"},{latitude:-22.3,longitude:110.4,group:"Group 2",isotime:"2013-01-13T06:00:00.000Z"},{latitude:-22.8,longitude:110.2,group:"Group 2",isotime:"2013-01-13T09:00:00.000Z"},{latitude:-23.3,longitude:110,group:"Group 2",isotime:"2013-01-13T12:00:00.000Z"},{latitude:-23.7,longitude:109.85,group:"Group 2",isotime:"2013-01-13T15:00:00.000Z"},{latitude:-24.2,longitude:109.7,group:"Group 2",isotime:"2013-01-13T18:00:00.000Z"},{latitude:-24.7,longitude:109.65,group:"Group 2",isotime:"2013-01-13T21:00:00.000Z"},{latitude:-25.2,longitude:109.6,group:"Group 2",isotime:"2013-01-14T00:00:00.000Z"},{latitude:-26.3,longitude:109.7,group:"Group 2",isotime:"2013-01-14T06:00:00.000Z"},{latitude:-27.6,longitude:109.4,group:"Group 2",isotime:"2013-01-14T12:00:00.000Z"},{latitude:-28.18,longitude:109.3,group:"Group 2",isotime:"2013-01-14T15:00:00.000Z"},{latitude:-29.28,longitude:109.1,group:"Group 2",isotime:"2013-01-14T18:00:00.000Z"},{latitude:-29.9,longitude:109.1,group:"Group 2",isotime:"2013-01-15T00:00:00.000Z"},{latitude:-31,longitude:109.4,group:"Group 2",isotime:"2013-01-15T06:00:00.000Z"},{latitude:-14,longitude:138,group:"Group 1",isotime:"2013-01-17T12:00:00.000Z"},{latitude:-15.5,longitude:138.5,group:"Group 1",isotime:"2013-01-17T18:00:00.000Z"},{latitude:-16.4,longitude:138.5,group:"Group 1",isotime:"2013-01-18T00:00:00.000Z"},{latitude:-16.8,longitude:138.5,group:"Group 1",isotime:"2013-01-18T06:00:00.000Z"},{latitude:-16.7,longitude:137.9,group:"Group 1",isotime:"2013-01-18T12:00:00.000Z"},{latitude:-16.59,longitude:136.75,group:"Group 1",isotime:"2013-01-18T18:00:00.000Z"},{latitude:-17.3,longitude:135.4,group:"Group 1",isotime:"2013-01-19T00:00:00.000Z"},{latitude:-17.3,longitude:135,group:"Group 1",isotime:"2013-01-19T03:00:00.000Z"},{latitude:-17.2,longitude:134.7,group:"Group 2",isotime:"2013-01-19T06:00:00.000Z"},{latitude:-16.9,longitude:134.6,group:"Group 2",isotime:"2013-01-19T12:00:00.000Z"},{latitude:-16.5,longitude:134.7,group:"Group 2",isotime:"2013-01-19T18:00:00.000Z"},{latitude:-16.4,longitude:135.8,group:"Group 1",isotime:"2013-01-20T00:00:00.000Z"},{latitude:-16.32,longitude:136.41,group:"Group 1",isotime:"2013-01-20T03:00:00.000Z"},{latitude:-16.69,longitude:123.45,group:"Group 2",isotime:"2013-01-20T06:00:00.000Z"},{latitude:-15.8,longitude:136.4,group:"Group 1",isotime:"2013-01-20T06:00:00.000Z"},{latitude:-16.89,longitude:123.19,group:"Group 2",isotime:"2013-01-20T09:00:00.000Z"},{latitude:-16.2,longitude:137,group:"Group 1",isotime:"2013-01-20T10:00:00.000Z"},{latitude:-17.04,longitude:123.02,group:"Group 2",isotime:"2013-01-20T12:00:00.000Z"},{latitude:-16.3,longitude:137.6,group:"Group 1",isotime:"2013-01-20T12:00:00.000Z"},{latitude:-17.25,longitude:122.9,group:"Group 2",isotime:"2013-01-20T15:00:00.000Z"},{latitude:-17.55,longitude:122.74,group:"Group 2",isotime:"2013-01-20T18:00:00.000Z"},{latitude:-15.7,longitude:139,group:"Group 1",isotime:"2013-01-20T18:00:00.000Z"},{latitude:-15.7,longitude:139.8,group:"Group 1",isotime:"2013-01-20T21:00:00.000Z"},{latitude:-18,longitude:122.5,group:"Group 2",isotime:"2013-01-21T00:00:00.000Z"},{latitude:-15.84,longitude:140.16,group:"Group 1",isotime:"2013-01-21T00:00:00.000Z"},{latitude:-15.9,longitude:140.4,group:"Group 1",isotime:"2013-01-21T02:00:00.000Z"},{latitude:-18.2,longitude:122.3,group:"Group 2",isotime:"2013-01-21T03:00:00.000Z"},{latitude:-15.78,longitude:140.6,group:"Group 1",isotime:"2013-01-21T03:00:00.000Z"},{latitude:-18.4,longitude:122,group:"Group 2",isotime:"2013-01-21T06:00:00.000Z"},{latitude:-15.8,longitude:141,group:"Group 1",isotime:"2013-01-21T06:00:00.000Z"},{latitude:-15.8,longitude:141.1,group:"Group 1",isotime:"2013-01-21T08:30:00.000Z"},{latitude:-18.6,longitude:121.7,group:"Group 2",isotime:"2013-01-21T09:00:00.000Z"},{latitude:-15.8,longitude:141.1,group:"Group 1",isotime:"2013-01-21T09:00:00.000Z"},{latitude:-18.8,longitude:121.4,group:"Group 2",isotime:"2013-01-21T12:00:00.000Z"},{latitude:-15.4,longitude:141.4,group:"Group 1",isotime:"2013-01-21T12:00:00.000Z"},{latitude:-19.19,longitude:121.15,group:"Group 2",isotime:"2013-01-21T15:00:00.000Z"},{latitude:-15.3,longitude:141.6,group:"Group 1",isotime:"2013-01-21T15:00:00.000Z"},{latitude:-19.23,longitude:120.95,group:"Group 2",isotime:"2013-01-21T18:00:00.000Z"},{latitude:-15,longitude:141.7,group:"Group 1",isotime:"2013-01-21T18:00:00.000Z"},{latitude:-19.3,longitude:120.5,group:"Group 2",isotime:"2013-01-21T21:00:00.000Z"},{latitude:-14.65,longitude:141.84,group:"Group 1",isotime:"2013-01-21T21:00:00.000Z"},{latitude:-19.4,longitude:120.1,group:"Group 2",isotime:"2013-01-22T00:00:00.000Z"},{latitude:-14.29,longitude:142.1,group:"Group 1",isotime:"2013-01-22T00:00:00.000Z"},{latitude:-19.5,longitude:119.8,group:"Group 2",isotime:"2013-01-22T03:00:00.000Z"},{latitude:-14,longitude:142.6,group:"Group 1",isotime:"2013-01-22T03:00:00.000Z"},{latitude:-19.7,longitude:119.4,group:"Group 2",isotime:"2013-01-22T06:00:00.000Z"},{latitude:-14.14,longitude:143.27,group:"Group 1",isotime:"2013-01-22T06:00:00.000Z"},{latitude:-19.8,longitude:118.8,group:"Group 2",isotime:"2013-01-22T09:00:00.000Z"},{latitude:-19.9,longitude:118.55,group:"Group 2",isotime:"2013-01-22T12:00:00.000Z"},{latitude:-14.9,longitude:144.7,group:"Group 1",isotime:"2013-01-22T12:00:00.000Z"},{latitude:-19.9,longitude:118.35,group:"Group 2",isotime:"2013-01-22T13:00:00.000Z"},{latitude:-19.93,longitude:118.1,group:"Group 2",isotime:"2013-01-22T14:00:00.000Z"},{latitude:-19.9,longitude:117.9,group:"Group 2",isotime:"2013-01-22T15:00:00.000Z"},{latitude:-19.8,longitude:117.9,group:"Group 2",isotime:"2013-01-22T18:00:00.000Z"},{latitude:-15.3,longitude:144.9,group:"Group 1",isotime:"2013-01-22T18:00:00.000Z"},{latitude:-19.9,longitude:117.8,group:"Group 2",isotime:"2013-01-22T21:00:00.000Z"},{latitude:-15.7,longitude:144.7,group:"Group 1",isotime:"2013-01-22T21:00:00.000Z"},{latitude:-20.1,longitude:117.7,group:"Group 2",isotime:"2013-01-23T00:00:00.000Z"},{latitude:-15.9,longitude:144.6,group:"Group 1",isotime:"2013-01-23T00:00:00.000Z"},{latitude:-20.3,longitude:117.5,group:"Group 2",isotime:"2013-01-23T03:00:00.000Z"},{latitude:-16.2,longitude:144.5,group:"Group 1",isotime:"2013-01-23T03:00:00.000Z"},{latitude:-20.6,longitude:117.3,group:"Group 2",isotime:"2013-01-23T06:00:00.000Z"},{latitude:-16.6,longitude:144.6,group:"Group 1",isotime:"2013-01-23T06:00:00.000Z"},{latitude:-21,longitude:117.1,group:"Group 2",isotime:"2013-01-23T09:00:00.000Z"},{latitude:-16.8,longitude:144.8,group:"Group 1",isotime:"2013-01-23T09:00:00.000Z"},{latitude:-17,longitude:145.02,group:"Group 1",isotime:"2013-01-23T12:00:00.000Z"},{latitude:-17.3,longitude:145.3,group:"Group 1",isotime:"2013-01-23T15:00:00.000Z"},{latitude:-17.8,longitude:145.3,group:"Group 1",isotime:"2013-01-23T18:00:00.000Z"},{latitude:-18.4,longitude:145.6,group:"Group 1",isotime:"2013-01-23T21:00:00.000Z"},{latitude:-18.8,longitude:146.2,group:"Group 1",isotime:"2013-01-24T00:00:00.000Z"},{latitude:-19.4,longitude:146.6,group:"Group 1",isotime:"2013-01-24T03:00:00.000Z"},{latitude:-19.9,longitude:146.9,group:"Group 1",isotime:"2013-01-24T06:00:00.000Z"},{latitude:-20.71,longitude:147.8,group:"Group 1",isotime:"2013-01-24T12:00:00.000Z"},{latitude:-21.1,longitude:147.9,group:"Group 1",isotime:"2013-01-24T15:00:00.000Z"},{latitude:-21.3,longitude:148,group:"Group 1",isotime:"2013-01-24T18:00:00.000Z"},{latitude:-22,longitude:148.5,group:"Group 1",isotime:"2013-01-25T00:00:00.000Z"},{latitude:-22.8,longitude:149,group:"Group 1",isotime:"2013-01-25T04:00:00.000Z"},{latitude:-23,longitude:149,group:"Group 1",isotime:"2013-01-25T06:00:00.000Z"},{latitude:-23,longitude:149,group:"Group 1",isotime:"2013-01-25T12:00:00.000Z"},{latitude:-23,longitude:148.6,group:"Group 1",isotime:"2013-01-26T00:00:00.000Z"},{latitude:-23.1,longitude:148.7,group:"Group 1",isotime:"2013-01-26T03:00:00.000Z"},{latitude:-23.4,longitude:148.9,group:"Group 1",isotime:"2013-01-26T06:00:00.000Z"},{latitude:-23.7,longitude:149.1,group:"Group 1",isotime:"2013-01-26T09:00:00.000Z"},{latitude:-23.7,longitude:149.3,group:"Group 1",isotime:"2013-01-26T12:00:00.000Z"},{latitude:-23.9,longitude:149.6,group:"Group 1",isotime:"2013-01-26T15:00:00.000Z"},{latitude:-24.2,longitude:150,group:"Group 1",isotime:"2013-01-26T18:00:00.000Z"},{latitude:-24.7,longitude:150,group:"Group 1",isotime:"2013-01-26T21:00:00.000Z"},{latitude:-25.2,longitude:150,group:"Group 1",isotime:"2013-01-26T23:00:00.000Z"},{latitude:-25.7,longitude:150,group:"Group 1",isotime:"2013-01-27T00:00:00.000Z"},{latitude:-26,longitude:150,group:"Group 1",isotime:"2013-01-27T01:00:00.000Z"},{latitude:-26.3,longitude:150,group:"Group 1",isotime:"2013-01-27T02:00:00.000Z"},{latitude:-26.6,longitude:150.3,group:"Group 1",isotime:"2013-01-27T05:00:00.000Z"},{latitude:-26.8,longitude:150.6,group:"Group 1",isotime:"2013-01-27T09:00:00.000Z"},{latitude:-26.9,longitude:150.9,group:"Group 1",isotime:"2013-01-27T12:00:00.000Z"},{latitude:-27,longitude:150.9,group:"Group 1",isotime:"2013-01-27T15:00:00.000Z"},{latitude:-26.9,longitude:151.1,group:"Group 1",isotime:"2013-01-27T18:00:00.000Z"},{latitude:-27.1,longitude:150.8,group:"Group 1",isotime:"2013-01-27T21:00:00.000Z"},{latitude:-27.3,longitude:151.1,group:"Group 1",isotime:"2013-01-28T00:00:00.000Z"},{latitude:-27.9,longitude:151.1,group:"Group 1",isotime:"2013-01-28T03:00:00.000Z"},{latitude:-28.9,longitude:150.9,group:"Group 1",isotime:"2013-01-28T06:00:00.000Z"},{latitude:-30,longitude:151,group:"Group 1",isotime:"2013-01-28T09:00:00.000Z"},{latitude:-31.1,longitude:151.1,group:"Group 1",isotime:"2013-01-28T12:00:00.000Z"},{latitude:-13.3,longitude:122.5,group:"Group 2",isotime:"2013-02-22T00:00:00.000Z"},{latitude:-13.3,longitude:122.3,group:"Group 2",isotime:"2013-02-22T03:00:00.000Z"},{latitude:-13.5,longitude:121.5,group:"Group 2",isotime:"2013-02-22T06:00:00.000Z"},{latitude:-13.7,longitude:121.1,group:"Group 2",isotime:"2013-02-22T09:00:00.000Z"},{latitude:-14.26,longitude:120.3,group:"Group 2",isotime:"2013-02-22T12:00:00.000Z"},{latitude:-14.9,longitude:119.6,group:"Group 2",isotime:"2013-02-22T18:00:00.000Z"},{latitude:-15.5,longitude:118.8,group:"Group 2",isotime:"2013-02-23T00:00:00.000Z"},{latitude:-15.6,longitude:118.5,group:"Group 2",isotime:"2013-02-23T06:00:00.000Z"},{latitude:-15.8,longitude:118.45,group:"Group 2",isotime:"2013-02-23T12:00:00.000Z"},{latitude:-15.9,longitude:118.46,group:"Group 2",isotime:"2013-02-23T13:13:00.000Z"},{latitude:-16.3,longitude:118.4,group:"Group 2",isotime:"2013-02-23T16:25:00.000Z"},{latitude:-16.4,longitude:118.4,group:"Group 2",isotime:"2013-02-23T18:00:00.000Z"},{latitude:-16.7,longitude:118.3,group:"Group 2",isotime:"2013-02-24T00:00:00.000Z"},{latitude:-16.9,longitude:118.2,group:"Group 2",isotime:"2013-02-24T03:00:00.000Z"},{latitude:-17.1,longitude:118.2,group:"Group 2",isotime:"2013-02-24T06:00:00.000Z"},{latitude:-17.2,longitude:118.3,group:"Group 2",isotime:"2013-02-24T09:00:00.000Z"},{latitude:-17.3,longitude:118.45,group:"Group 2",isotime:"2013-02-24T12:00:00.000Z"},{latitude:-17.45,longitude:118.6,group:"Group 2",isotime:"2013-02-24T15:00:00.000Z"},{latitude:-17.5,longitude:118.7,group:"Group 2",isotime:"2013-02-24T18:00:00.000Z"},{latitude:-17.55,longitude:118.8,group:"Group 2",isotime:"2013-02-24T21:00:00.000Z"},{latitude:-17.6,longitude:118.85,group:"Group 2",isotime:"2013-02-25T00:00:00.000Z"},{latitude:-17.7,longitude:118.95,group:"Group 2",isotime:"2013-02-25T03:00:00.000Z"},{latitude:-17.8,longitude:119,group:"Group 2",isotime:"2013-02-25T06:00:00.000Z"},{latitude:-18.1,longitude:119.05,group:"Group 2",isotime:"2013-02-25T09:00:00.000Z"},{latitude:-18.3,longitude:119.1,group:"Group 2",isotime:"2013-02-25T12:00:00.000Z"},{latitude:-18.5,longitude:119.1,group:"Group 2",isotime:"2013-02-25T15:00:00.000Z"},{latitude:-18.7,longitude:119.2,group:"Group 2",isotime:"2013-02-25T18:00:00.000Z"},{latitude:-18.9,longitude:119.2,group:"Group 2",isotime:"2013-02-25T21:00:00.000Z"},{latitude:-18.9,longitude:119.2,group:"Group 2",isotime:"2013-02-26T00:00:00.000Z"},{latitude:-19.15,longitude:119.1,group:"Group 2",isotime:"2013-02-26T03:00:00.000Z"},{latitude:-19.2,longitude:119.1,group:"Group 2",isotime:"2013-02-26T06:00:00.000Z"},{latitude:-19.2,longitude:119.1,group:"Group 2",isotime:"2013-02-26T09:00:00.000Z"},{latitude:-19.2,longitude:119.1,group:"Group 2",isotime:"2013-02-26T12:00:00.000Z"},{latitude:-19.2,longitude:119.1,group:"Group 2",isotime:"2013-02-26T15:00:00.000Z"},{latitude:-19.25,longitude:119.15,group:"Group 2",isotime:"2013-02-26T18:00:00.000Z"},{latitude:-19.3,longitude:119.2,group:"Group 2",isotime:"2013-02-26T21:00:00.000Z"},{latitude:-19.3,longitude:119.3,group:"Group 2",isotime:"2013-02-27T00:00:00.000Z"},{latitude:-19.6,longitude:119.4,group:"Group 2",isotime:"2013-02-27T03:00:00.000Z"},{latitude:-19.8,longitude:119.5,group:"Group 2",isotime:"2013-02-27T06:00:00.000Z"},{latitude:-20,longitude:119.6,group:"Group 2",isotime:"2013-02-27T09:00:00.000Z"},{latitude:-20.2,longitude:119.8,group:"Group 2",isotime:"2013-02-27T12:00:00.000Z"},{latitude:-20.4,longitude:120,group:"Group 2",isotime:"2013-02-27T15:00:00.000Z"},{latitude:-20.6,longitude:120.1,group:"Group 2",isotime:"2013-02-27T18:00:00.000Z"},{latitude:-20.9,longitude:120.3,group:"Group 2",isotime:"2013-02-27T21:00:00.000Z"},{latitude:-21.1,longitude:120.35,group:"Group 2",isotime:"2013-02-28T00:00:00.000Z"},{latitude:-21.7,longitude:120.5,group:"Group 2",isotime:"2013-02-28T03:00:00.000Z"},{latitude:-22,longitude:120.55,group:"Group 2",isotime:"2013-02-28T06:00:00.000Z"},{latitude:-13,longitude:135,group:"Group 1",isotime:"2013-03-10T06:00:00.000Z"},{latitude:-12.8,longitude:135.3,group:"Group 1",isotime:"2013-03-10T09:00:00.000Z"},{latitude:-12.7,longitude:135.8,group:"Group 1",isotime:"2013-03-10T12:00:00.000Z"},{latitude:-12.5,longitude:136.3,group:"Group 1",isotime:"2013-03-10T15:00:00.000Z"},{latitude:-12.2,longitude:136.8,group:"Group 1",isotime:"2013-03-10T18:00:00.000Z"},{latitude:-12,longitude:137.3,group:"Group 1",isotime:"2013-03-10T21:00:00.000Z"},{latitude:-12,longitude:137.3,group:"Group 1",isotime:"2013-03-11T00:00:00.000Z"},{latitude:-12.1,longitude:136.9,group:"Group 1",isotime:"2013-03-11T03:00:00.000Z"},{latitude:-12.2,longitude:136.8,group:"Group 1",isotime:"2013-03-11T06:00:00.000Z"},{latitude:-12.3,longitude:136.9,group:"Group 1",isotime:"2013-03-11T09:00:00.000Z"},{latitude:-12.5,longitude:138,group:"Group 1",isotime:"2013-03-11T12:00:00.000Z"},{latitude:-12.5,longitude:138.4,group:"Group 1",isotime:"2013-03-11T15:00:00.000Z"},{latitude:-12.4,longitude:138.7,group:"Group 1",isotime:"2013-03-11T18:00:00.000Z"},{latitude:-12.3,longitude:138.8,group:"Group 1",isotime:"2013-03-11T21:00:00.000Z"},{latitude:-12,longitude:138.9,group:"Group 1",isotime:"2013-03-12T00:00:00.000Z"},{latitude:-11.5,longitude:139,group:"Group 1",isotime:"2013-03-12T03:00:00.000Z"},{latitude:-11.4,longitude:139.5,group:"Group 1",isotime:"2013-03-12T06:00:00.000Z"},{latitude:-11.3,longitude:139.8,group:"Group 1",isotime:"2013-03-12T09:00:00.000Z"},{latitude:-11,longitude:140.3,group:"Group 1",isotime:"2013-03-12T12:00:00.000Z"},{latitude:-11.3,longitude:141.2,group:"Group 1",isotime:"2013-03-12T15:00:00.000Z"},{latitude:-11.6,longitude:141.9,group:"Group 1",isotime:"2013-03-12T18:00:00.000Z"},{latitude:-11.6,longitude:142.5,group:"Group 1",isotime:"2013-03-12T21:00:00.000Z"},{latitude:-11.6,longitude:143.1,group:"Group 1",isotime:"2013-03-13T00:00:00.000Z"},{latitude:-11.9,longitude:143.6,group:"Group 1",isotime:"2013-03-13T03:00:00.000Z"},{latitude:-12.3,longitude:144.4,group:"Group 1",isotime:"2013-03-13T06:00:00.000Z"},{latitude:-12.33,longitude:145.25,group:"Group 1",isotime:"2013-03-13T09:00:00.000Z"},{latitude:-12.19,longitude:146.45,group:"Group 1",isotime:"2013-03-13T12:00:00.000Z"},{latitude:-12.75,longitude:147.14,group:"Group 1",isotime:"2013-03-13T15:00:00.000Z"},{latitude:-13.27,longitude:147.5,group:"Group 1",isotime:"2013-03-13T18:00:00.000Z"},{latitude:-13.72,longitude:148.18,group:"Group 1",isotime:"2013-03-13T21:00:00.000Z"},{latitude:-14.19,longitude:148.5,group:"Group 1",isotime:"2013-03-14T00:00:00.000Z"},{latitude:-14.68,longitude:149.27,group:"Group 1",isotime:"2013-03-14T03:00:00.000Z"},{latitude:-14.9,longitude:149.9,group:"Group 1",isotime:"2013-03-14T06:00:00.000Z"},{latitude:-15.2,longitude:150.5,group:"Group 1",isotime:"2013-03-14T09:00:00.000Z"},{latitude:-15.3,longitude:151.1,group:"Group 1",isotime:"2013-03-14T12:00:00.000Z"},{latitude:-15.4,longitude:151.7,group:"Group 1",isotime:"2013-03-14T15:00:00.000Z"},{latitude:-15.35,longitude:152.09,group:"Group 1",isotime:"2013-03-14T18:00:00.000Z"},{latitude:-15.46,longitude:152.86,group:"Group 1",isotime:"2013-03-14T21:00:00.000Z"},{latitude:-15.81,longitude:153.28,group:"Group 1",isotime:"2013-03-15T00:00:00.000Z"},{latitude:-15.9,longitude:153.6,group:"Group 1",isotime:"2013-03-15T03:00:00.000Z"},{latitude:-16.1,longitude:154,group:"Group 1",isotime:"2013-03-15T06:00:00.000Z"},{latitude:-16.2,longitude:154.1,group:"Group 1",isotime:"2013-03-15T09:00:00.000Z"},{latitude:-16.3,longitude:154.2,group:"Group 1",isotime:"2013-03-15T12:00:00.000Z"},{latitude:-16.5,longitude:154.3,group:"Group 1",isotime:"2013-03-15T18:00:00.000Z"},{latitude:-16.8,longitude:154.2,group:"Group 1",isotime:"2013-03-15T21:00:00.000Z"},{latitude:-16.9,longitude:154.1,group:"Group 1",isotime:"2013-03-16T00:00:00.000Z"},{latitude:-17.1,longitude:154,group:"Group 1",isotime:"2013-03-16T03:00:00.000Z"},{latitude:-17.1,longitude:153.9,group:"Group 1",isotime:"2013-03-16T06:00:00.000Z"},{latitude:-17.4,longitude:153.7,group:"Group 1",isotime:"2013-03-16T12:00:00.000Z"},{latitude:-17.7,longitude:153.5,group:"Group 1",isotime:"2013-03-16T18:00:00.000Z"},{latitude:-18.4,longitude:153.3,group:"Group 1",isotime:"2013-03-17T00:00:00.000Z"},{latitude:-18.7,longitude:153,group:"Group 1",isotime:"2013-03-17T06:00:00.000Z"},{latitude:-18.9,longitude:152.6,group:"Group 1",isotime:"2013-03-17T12:00:00.000Z"},{latitude:-19.1,longitude:152.3,group:"Group 1",isotime:"2013-03-17T18:00:00.000Z"},{latitude:-19.1,longitude:152.1,group:"Group 1",isotime:"2013-03-18T00:00:00.000Z"},{latitude:-19.3,longitude:152,group:"Group 1",isotime:"2013-03-18T06:00:00.000Z"},{latitude:-19.1,longitude:151.7,group:"Group 1",isotime:"2013-03-18T12:00:00.000Z"},{latitude:-19.1,longitude:151.4,group:"Group 1",isotime:"2013-03-18T18:00:00.000Z"},{latitude:-19,longitude:150.9,group:"Group 1",isotime:"2013-03-19T00:00:00.000Z"},{latitude:-19.6,longitude:150.5,group:"Group 1",isotime:"2013-03-19T06:00:00.000Z"},{latitude:-19.6,longitude:149.9,group:"Group 1",isotime:"2013-03-19T12:00:00.000Z"},{latitude:-19.3,longitude:149.3,group:"Group 1",isotime:"2013-03-19T18:00:00.000Z"},{latitude:-18.6,longitude:148.9,group:"Group 1",isotime:"2013-03-19T21:00:00.000Z"},{latitude:-18.3,longitude:148.6,group:"Group 1",isotime:"2013-03-20T00:00:00.000Z"},{latitude:-18.2,longitude:148.3,group:"Group 1",isotime:"2013-03-20T03:00:00.000Z"},{latitude:-18.1,longitude:148,group:"Group 1",isotime:"2013-03-20T06:00:00.000Z"},{latitude:-18,longitude:147.06,group:"Group 1",isotime:"2013-03-20T12:00:00.000Z"},{latitude:-17.6,longitude:146.1,group:"Group 1",isotime:"2013-03-20T18:00:00.000Z"},{latitude:-7,longitude:99,group:"Group 2",isotime:"2013-04-07T06:00:00.000Z"},{latitude:-9.34,longitude:101.32,group:"Group 2",isotime:"2013-04-08T02:11:00.000Z"},{latitude:-9.5,longitude:101.4,group:"Group 2",isotime:"2013-04-08T06:00:00.000Z"},{latitude:-9.76,longitude:101.92,group:"Group 2",isotime:"2013-04-08T12:00:00.000Z"},{latitude:-10.43,longitude:102.1,group:"Group 2",isotime:"2013-04-08T18:00:00.000Z"},{latitude:-11.5,longitude:102.4,group:"Group 2",isotime:"2013-04-09T00:00:00.000Z"},{latitude:-12.3,longitude:102.7,group:"Group 2",isotime:"2013-04-09T06:00:00.000Z"},{latitude:-13.2,longitude:103.2,group:"Group 2",isotime:"2013-04-09T12:00:00.000Z"},{latitude:-14.1,longitude:103.4,group:"Group 2",isotime:"2013-04-09T18:00:00.000Z"},{latitude:-14.9,longitude:103.4,group:"Group 2",isotime:"2013-04-10T00:00:00.000Z"},{latitude:-15.6,longitude:103.7,group:"Group 2",isotime:"2013-04-10T06:00:00.000Z"},{latitude:-16.2,longitude:104.1,group:"Group 2",isotime:"2013-04-10T12:00:00.000Z"},{latitude:-16.6,longitude:104.5,group:"Group 2",isotime:"2013-04-10T18:00:00.000Z"},{latitude:-17.5,longitude:104.6,group:"Group 2",isotime:"2013-04-11T00:00:00.000Z"},{latitude:-18.6,longitude:104.6,group:"Group 2",isotime:"2013-04-11T06:00:00.000Z"},{latitude:-19.83,longitude:105.06,group:"Group 2",isotime:"2013-04-11T12:00:00.000Z"},{latitude:-20.99,longitude:105.3,group:"Group 2",isotime:"2013-04-11T18:00:00.000Z"},{latitude:-8.84,longitude:152.86,group:"Group 1",isotime:"2013-04-25T12:00:00.000Z"},{latitude:-9.09,longitude:152.86,group:"Group 1",isotime:"2013-04-25T18:00:00.000Z"},{latitude:-9.78,longitude:153.59,group:"Group 1",isotime:"2013-04-26T00:00:00.000Z"},{latitude:-9.8,longitude:153.7,group:"Group 1",isotime:"2013-04-26T06:00:00.000Z"},{latitude:-10.02,longitude:153.97,group:"Group 1",isotime:"2013-04-26T12:00:00.000Z"},{latitude:-10.2,longitude:154.3,group:"Group 1",isotime:"2013-04-26T18:00:00.000Z"},{latitude:-10.7,longitude:154.1,group:"Group 1",isotime:"2013-04-27T00:00:00.000Z"},{latitude:-10.8,longitude:154.5,group:"Group 1",isotime:"2013-04-27T06:00:00.000Z"},{latitude:-11.1,longitude:154.5,group:"Group 1",isotime:"2013-04-27T12:00:00.000Z"},{latitude:-11.8,longitude:154.6,group:"Group 1",isotime:"2013-04-27T18:00:00.000Z"},{latitude:-12.2,longitude:154.2,group:"Group 1",isotime:"2013-04-28T00:00:00.000Z"},{latitude:-12.5,longitude:153.9,group:"Group 1",isotime:"2013-04-28T06:00:00.000Z"},{latitude:-12.7,longitude:153.7,group:"Group 1",isotime:"2013-04-28T12:00:00.000Z"},{latitude:-12.8,longitude:153.5,group:"Group 1",isotime:"2013-04-28T18:00:00.000Z"},{latitude:-12.8,longitude:153.3,group:"Group 1",isotime:"2013-04-29T00:00:00.000Z"},{latitude:-13.17,longitude:152.87,group:"Group 1",isotime:"2013-04-29T06:00:00.000Z"},{latitude:-13.52,longitude:152.05,group:"Group 1",isotime:"2013-04-29T12:00:00.000Z"},{latitude:-13.69,longitude:151.59,group:"Group 1",isotime:"2013-04-29T15:00:00.000Z"},{latitude:-13.73,longitude:151.12,group:"Group 1",isotime:"2013-04-29T18:00:00.000Z"},{latitude:-13.65,longitude:150.6,group:"Group 1",isotime:"2013-04-29T21:00:00.000Z"},{latitude:-13.8,longitude:150.2,group:"Group 1",isotime:"2013-04-30T00:00:00.000Z"},{latitude:-13.9,longitude:149.9,group:"Group 1",isotime:"2013-04-30T03:00:00.000Z"},{latitude:-14,longitude:149.5,group:"Group 1",isotime:"2013-04-30T06:00:00.000Z"},{latitude:-14.1,longitude:149.2,group:"Group 1",isotime:"2013-04-30T09:00:00.000Z"},{latitude:-14.1,longitude:148.8,group:"Group 1",isotime:"2013-04-30T12:00:00.000Z"},{latitude:-14.1,longitude:148.5,group:"Group 1",isotime:"2013-04-30T15:00:00.000Z"},{latitude:-14.1,longitude:148.2,group:"Group 1",isotime:"2013-04-30T18:00:00.000Z"},{latitude:-13.9,longitude:147.9,group:"Group 1",isotime:"2013-04-30T21:00:00.000Z"},{latitude:-13.8,longitude:147.5,group:"Group 1",isotime:"2013-05-01T00:00:00.000Z"},{latitude:-13.6,longitude:147.1,group:"Group 1",isotime:"2013-05-01T03:00:00.000Z"},{latitude:-13.5,longitude:146.5,group:"Group 1",isotime:"2013-05-01T06:00:00.000Z"},{latitude:-13.4,longitude:146,group:"Group 1",isotime:"2013-05-01T09:00:00.000Z"},{latitude:-13.2,longitude:145.5,group:"Group 1",isotime:"2013-05-01T12:00:00.000Z"},{latitude:-13.1,longitude:145.2,group:"Group 1",isotime:"2013-05-01T15:00:00.000Z"},{latitude:-12.9,longitude:144.8,group:"Group 1",isotime:"2013-05-01T17:00:00.000Z"}];eve.template=function(e,t,n,a){let l=eve.clone(eve.colors),i={isTemp:!0,animation:{duration:0,delay:0,enabled:!1,easing:"linear",effect:"default"},container:e,backColor:"transparent",xField:"",data:[],series:[],legend:{enabled:!1},xAxis:{color:"#cccccc",gridLineColor:"#cccccc",labelFontColor:"#cccccc",title:"X Axis",titleFontColor:"#cccccc"},yAxis:{color:"#cccccc",gridLineColor:"#cccccc",labelFontColor:"#cccccc",title:"Y Axis",titleFontColor:"#cccccc",stacked:!0},width:a||"auto",height:n||"auto"};switch(eve.colors=["#999999","#666666","#333333","#111111","#000000"],t){case"areaChart":case"barChart":case"bubbleChart":case"columnChart":case"lineChart":case"radarChart":case"scatterChart":i.data=tmpXY,i.xField="x",i.series=[],i.series.push({yField:"col1",showBullets:!1,sizeField:"bubbleChart"===t?"col3":""}),i.series.push({yField:"col2",showBullets:!1,sizeField:"bubbleChart"===t?"col3":""}),eve[t](i);break;case"pieChart":case"donutChart":case"funnelChart":case"pyramidChart":i.data=tmpSliced,i.xField="group",i.series=[],i.series.push({valueField:"size",titleField:"group"}),eve[t](i);break;case"standardMap":case"tileMap":case"ddCartogram":case"contCartogram":i.data=tmpMap,i.series=[],i.hideZoom=!0,i.series.push({map:"USA",labelField:"label",valueField:"value"}),i.legend={type:"gradient",enabled:!1,gradientColors:["#999999","#333333"]},eve[t](i);break;case"locationMap":i.data=tmpLatLng,i.data.forEach(function(e){e.measure=eve.randInt(1,50)}),i.series=[],i.hideZoom=!0,i.series.push({latField:"latitude",longField:"longitude",valueField:"measure"}),i.legend={type:"scaled",enabled:!1,legendColors:[{text:"",value:"all",color:"#666666"}]},eve[t](i);break;case"routeMap":i.data=tmpLatLng,i.data.forEach(function(e){e.measure=eve.randInt(1,50)}),i.series=[],i.hideZoom=!0,i.series.push({latField:"latitude",longField:"longitude",orderField:"isotime"}),i.legend={type:"default",enabled:!1,legendColors:[{text:"",value:"all",color:"#666666"}]},eve[t](i);break;case"densityMap":i.data=tmpLatLng,i.data.forEach(function(e){e.measure=eve.randInt(1,50)}),i.series=[],i.hideZoom=!0,i.series.push({latField:"latitude",longField:"longitude",valueField:"measure",expression:"sum"}),i.legend={type:"gradient",enabled:!1,gradientColors:["#eeeeee","#cccccc","#666666","#333333"]},eve[t](i);break}eve.colors=l},eve.mobile=eve.isMobile(),"undefined"!=typeof amd?define(function(){return eve}):"object"==typeof module&&module.exports?module.exports=eve:window.eve=eve}.call(this),function(e){function t(t,n){let a=t.length>5?5:t.length,l=null,i="string";for(let o=1;o<a;o++)l=t[o],d3.keys(l).map(function(t,a){i=e.getType(l[t]),n[t].type.push(i)});return function(t,n,a){let l=!0,i="string";return d3.keys(t).map(function(n){if(l=e.isIdentical(t[n].type))i=t[n].type[0];else for(let e=0;e<t[n].type.length;e++)if(t[n].type[e]&&"null"!==t[n].type[e]){i=t[n].type[e];break}t[n].type=i}),t}(n)}e.getDataProperties=function(){if(0===arguments.length)return null;let n=arguments[0];if("array"===e.getType(n)){let a=d3.keys(n[0]),l=function(t,n){let a={};return n.map(function(n){a[n]={type:[e.getType(t[0][n])],uniques:t.length<1e3?e.getUniqueValues(t,n):[]}}),a}(n,a);return{columns:l=t(n,l),rowCount:n.length,colCount:a.length}}return{columns:d3.keys(n)}}}(eve),function(e){function t(t){if(null==t)throw new Error("Visualization options could not be found!");if("object"!==e.getType(t))throw new Error("Visualization options should be a JSON object!");if(!t.container)throw new Error("Container could not be found!");let n=e.getVisDataType(t.data);if(!n)throw new Error("Visualization data does not have a valid type!");let a=t?e.extend(t,e.configs.vis):e.configs.vis,l=this,i=t.container,o=null;for(let t in l.isPSW=!1,a)switch(t){case"animation":l[t]=e.extend(a[t],e.configs.animation);break;case"legend":if(l[t]=e.extend(a[t],e.configs.legend),l[t].fontColor=e.parseColor(l[t].fontColor),l[t].iconColor=e.parseColor(l[t].iconColor),"string"===e.getType(l[t].gradientColors))l[t].gradientColors=[];else if(l[t].gradientColors.length>0)for(var r=0;r<l[t].gradientColors.length;r++)l[t].gradientColors[r]=e.parseColor(l[t].gradientColors[r]);if("string"===e.getType(l[t].legendColors))l[t].legendColors=[];else if(l[t].legendColors.length>0)for(r=0;r<l[t].legendColors.length;r++)l[t].legendColors[r].color=e.parseColor(l[t].legendColors[r].color);if("string"===e.getType(l[t].rangeList))l[t].rangeList=[];else if(l[t].rangeList.length>0)for(r=0;r<l[t].rangeList.length;r++)l[t].rangeList[r].color=e.parseColor(l[t].rangeList[r].color);break;case"multiples":l[t]=e.extend(a[t],e.configs.multiples);break;case"title":l[t]=e.extend(a[t],e.configs.title),l[t].fontColor=e.parseColor(l[t].fontColor);break;case"tooltip":l[t]=e.extend(a[t],e.configs.tooltip),l[t].backColor=e.parseColor(l[t].backColor),l[t].fontColor=e.parseColor(l[t].fontColor);break;case"xAxis":case"yAxis":l[t]=e.extend(a[t],e.configs.axis),l[t].labelFontColor=e.parseColor(l[t].labelFontColor),l[t].titleFontColor=e.parseColor(l[t].titleFontColor);break;case"series":l[t]=[],a[t].forEach(function(n){let a=e.extend(n,e.configs.serie);a.backColor=e.parseColor(a.backColor),a.borderColor=e.parseColor(a.borderColor),a.color=e.parseColor(a.color),a.handleColor=e.parseColor(a.handleColor),a.labelFontColor=e.parseColor(a.labelFontColor),a.markerColor=e.parseColor(a.markerColor),a.negativeColor=e.parseColor(a.negativeColor),a.rangeColor=e.parseColor(a.rangeColor),a.segmentLineColor=e.parseColor(a.segmentLineColor),a.titleColor=e.parseColor(a.titleColor),l[t].push(a)});break;case"colors":l[t]=[],a[t].forEach(function(n){l[t].push(e.parseColor(n))});default:l[t]=a[t],"backColor"===t&&(l[t]=e.parseColor(l[t]))}switch("string"===e.getType(i)&&(i=document.getElementById(i)),i.innerHTML="",l.innerContainer=l.container+"_inner",o=e.offset(i),l.ordering&&l.xAxis&&(l.xAxis.orderField=l.ordering.orderField,l.xAxis.orderDirection=l.ordering.orderDirection,l.xAxis.orderValues=l.ordering.orderValues),"auto"===l.width&&(l.width=o.width),"auto"===l.height&&(l.height=o.height),l.border&&l.border.size&&(l.width-=2*+l.border.size,l.height-=2*+l.border.size),l.margin={left:5,right:5,top:5,bottom:5},l.left=o.left,l.top=o.top,l.serieTypes=[],l.dataProperties=-1===n.indexOf("multiples")?e.getDataProperties(l.data):null,l.xDataType="numeric","streamGraph"!==l.type?"barChart"===l.type?(l.xAxis.axisCrossing&&(l.xAxis.position="min"===l.xAxis.axisCrossing?"left":"right"),l.yAxis.axisCrossing&&(l.yAxis.position="min"===l.yAxis.axisCrossing?"top":"bottom")):(l.xAxis.axisCrossing&&(l.xAxis.position="min"===l.xAxis.axisCrossing?"bottom":"top"),l.yAxis.axisCrossing&&(l.yAxis.position="min"===l.yAxis.axisCrossing?"left":"right")):l.yAxis.position="right",l.domains={minX:0,minY:0,maxX:0,maxY:0,minSize:0,maxSize:0,minColor:0,maxColor:0,minLat:0,maxLat:0,minLong:0,maxLong:0,xValues:[],yValues:[],isNegative:!1},l.plot={width:l.width,height:l.height,left:5,top:5,right:5,bottom:5,titleHeight:0},l.type){case"lineChart":case"combinationChart":case"bubbleChart":case"scatterChart":l.yAxis.stacked=!1;break}switch(l.masterType){case"map":l.yAxis.stacked=!1;break}null==l.columnNames&&(l.columnNames={});let s=null,u=null,d=null,c=null,p=!(!l.yAxis||!l.yAxis.stacked),f=0;l.__stackable||(p=!1);let m=function(e,t){l.onTitleClick&&l.onTitleClick("visTitle"),d3.event.stopPropagation()},g=function(e){return d3.min(e,function(e){return e[0]})},h=function(e){return d3.max(e,function(e){return e[1]})},y=function(){let e=[];return l.series.length?l.series.forEach(function(t){-1===e.indexOf(t.yField)&&e.push(t.yField)}):e=l.serieNames,e}();l.calculateDomain=function(t){t&&(l.data=t),x();switch(n){case"classical":!function(){let t=null,n=null,a=null;if(l.xField){if(l.xDataType=e.getType(l.data[0][l.xField],1),l.xDataTypeOriginal=e.getType(l.data[0][l.xField]),"barChart"===l.type||"columnChart"===l.type){if(l.xAxis.orderFieldName&&"custom"!==l.xAxis.orderDirection&&l.xAxis.orderFieldName!==l.xField){l.xDataType="string";let e="asc"===l.xAxis.orderDirection?d3.ascending:d3.descending;l.data.sort(function(t,n){return e(t[l.xAxis.orderFieldName],n[l.xAxis.orderFieldName])})}"custom"===l.xAxis.orderDirection&&(l.xDataType="string")}switch(l.xDataType){case"number":switch(n=l.xAxis&&l.xAxis.startsFromZero?0:d3.min(l.data,function(e){return e[l.xField]}),a=d3.max(l.data,function(e){return e[l.xField]}),t=Math.ceil((a-n)/10),l.domains.minX=l.xAxis.locked?l.xAxis.min:n,l.domains.maxX=l.xAxis.locked?l.xAxis.max:a,l.type){case"bubbleChart":l.domains.minX=l.xAxis.locked?l.xAxis.min:n-t,l.domains.maxX=l.xAxis.locked?l.xAxis.max:a+t;break;case"abacus":case"barChart":case"columnChart":case"combinationChart":l.domains.minX=l.xAxis.locked?l.xAxis.min:n-t,l.domains.maxX=l.xAxis.locked?l.xAxis.max:a+t,0!==n||l.xAxis.locked||(l.domains.minX=0),l.domains.xValues=e.getUniqueValues(l.data,l.xField);break}null!=l.xAxis.min&&(l.domains.minX=l.xAxis.min),null!=l.xAxis.max&&(l.domains.maxX=l.xAxis.max);break;case"date":switch(n=d3.min(l.data,function(e){return new Date(e[l.xField])}),a=d3.max(l.data,function(e){return new Date(e[l.xField])}),l.domains.minX=n,l.domains.maxX=a,l.xAxis.locked&&("date"===e.getType(l.xAxis.min)?l.domains.minX=l.xAxis.min:l.domains.minX=new Date(l.xAxis.min),"date"===e.getType(l.xAxis.max)?l.domains.maxX=l.xAxis.max:l.domains.maxX=new Date(l.xAxis.max)),l.type){case"abacus":case"barChart":case"columnChart":l.domains.xValues=e.getUniqueValues(l.data,l.xField);break}break;default:l.domains.xValues=l.xAxis.xValues&&l.xAxis.xValues.length?l.xAxis.xValues:e.getUniqueValues(l.data,l.xField),l.xAxis.orderValues&&l.xAxis.orderValues.length>1&&("barChart"!==l.type&&"columnChart"!==l.type||l.xAxis.orderValues&&l.xAxis.orderValues.length&&("string"==typeof l.xAxis.orderValues?l.domains.xValues=l.xAxis.orderValues.split(","):l.domains.xValues=l.xAxis.orderValues));break}}let i=Number.MAX_VALUE,o=Number.MIN_VALUE,r=Number.MAX_VALUE,s=Number.MIN_VALUE,u=Number.MAX_VALUE,d=Number.MIN_VALUE,c=Number.MAX_VALUE,m=Number.MIN_VALUE,x=Number.MAX_VALUE,b=Number.MIN_VALUE,v=[];for(let e=0;e<l.data.length;e++){let t=l.data[e],n=0,a=l.series[0].sizeField,p=l.series[0].colorField,f=l.series[0].latField,g=l.series[0].longField,h=a?+t[a]:0,y=+parseFloat(t[p]),F=+parseFloat(t[f]),w=+parseFloat(t[g]);l.serieNames.forEach(function(e){let a=parseFloat(t[e]);"areaChart"===l.type&&isNaN(a)&&(a=0),a&&a>0&&(n+=a),isNaN(a)||(a>o&&(o=a),a<i&&(i=a))}),a&&(isNaN(h)||(h>s&&(s=h),h<r&&(r=h))),p&&(isNaN(y)||(y>d&&(d=y),y<u&&(u=y))),(null===l.currTransform||l.series[0].updateReZoom)&&(f&&(isNaN(F)||(F>m&&(m=F),F<c&&(c=F))),g&&(isNaN(w)||(w>b&&(b=w),w<x&&(x=w)))),v.push(n)}if(l.domains.isNegative=i<0,p&&l.series.length>1){let e=d3.stack().keys(y).offset(d3.stackOffsetDiverging)(l.data);l.domains.minY=d3.min(e,g),l.domains.maxY=d3.max(e,h)}else l.domains.minY=p&&i>0?0:l.yAxis&&l.yAxis.startsFromZero?0:i,l.domains.maxY=p?d3.max(v):o;if(l.xField&&l.series[0].valueField&&(f=d3.sum(l.data,function(e){return+e[l.series[0].valueField]})),l.__baseChartType&&"xy"===l.__baseChartType&&"radarChart"!==l.type&&(l.domains.maxY*=1.05),"bubbleChart"===l.type&&(l.domains.maxY*=1.1),l.domains.minSize=r,l.domains.maxSize=s,l.domains.minColor=u,l.domains.maxColor=d,l.domains.minLat=c,l.domains.maxLat=m,l.domains.minLong=x,l.domains.maxLong=b,l.frozenYAxis&&"string"===l.frozenYAxis&&(l.domains.yValues=e.getUniqueValues(l.data,l.series[0].yField)),l.yAxis.locked){var F=parseFloat(l.yAxis.min),w=parseFloat(l.yAxis.max);isNaN(F)||isNaN(w)||(l.domains.minY=F,l.domains.maxY=w)}switch(l.yAxis.colorMin&&l.yAxis.colorMax&&(l.domains.minColor=l.yAxis.colorMin,l.domains.maxColor=l.yAxis.colorMax),l.yAxis.stacked&&"full"===l.yAxis.stackType&&(l.domains.minY=0,l.domains.maxY=100),l.type){case"wordCloud":l.domains.minY=d3.min(l.data,function(e){return+e.size}),l.domains.maxY=d3.max(l.data,function(e){return+e.size});break}l.fromMultiples&&(void 0!==l.xAxis.min&&null!==l.xAxis.min&&l.xAxis.min!==Number.MAX_VALUE&&(l.domains.minX=l.xAxis.min),void 0!==l.xAxis.max&&null!==l.xAxis.max&&l.xAxis.max!==Number.MIN_VALUE&&(l.domains.maxX=l.xAxis.max),void 0!==l.yAxis.min&&null!==l.yAxis.min&&l.yAxis.min!==Number.MAX_VALUE&&(l.domains.minY=l.yAxis.min),void 0!==l.yAxis.max&&null!==l.yAxis.max&&l.yAxis.max!==Number.MIN_VALUE&&(l.domains.maxY=l.yAxis.max),l.xAxis.values&&l.xAxis.values.length&&(l.domains.xValues=l.xAxis.values),l.yAxis.values&&l.yAxis.values.length&&(l.domains.yValues=l.yAxis.values)),null!=l.yAxis.min&&(l.domains.minY=parseFloat(l.yAxis.min)),null!=l.yAxis.max&&(l.domains.maxY=parseFloat(l.yAxis.max))}();break;case"tree":!function(){let t=function(){let t=[];if(function n(a){if(a)if(0===a.depth)a.children.forEach(function(e){n(e)});else if(a.children&&a.children.length){let n=e.getUniqueValues(a.children,"size");t=t.concat(n)}}(l.data),t.length>0)return t}();l.domains.minY=d3.min(t),l.domains.maxY=d3.max(t)}();break;case"sankey":l.domains.minY=d3.min(l.data.links,function(e){return+e.value}),l.domains.maxY=d3.max(l.data.links,function(e){return+e.value});break;default:!function(){let t=[],a=[],i=[],o=[],r=[],s=[],u=[],d=l.series[0];switch(n){case"multiplesTree":l.data.forEach(function(e){let n=e.values.dataArray||e.values,i=d3.pack().padding(2).size([l.plot.width,l.plot.height])(d3.hierarchy(n).sum(function(e){return e.size?+e.size:0}).sort(function(e,t){return t.value-e.value})).descendants(),o=d3.max(i,function(e){return e.depth}),r=d3.min(i,function(e){return e.size||e.value}),s=d3.max(i,function(e){if(e.depth===o)return e.size||e.value});t.push(r),a.push(s)});break;case"multiplesArray":{let n=function(){let e=null;return l.data.forEach(function(t){let n=t.values.dataArray||t.values;n.length>0&&(e=n[0])}),e}();l.data.forEach(function(c){let f=c.values.dataArray||c.values,m=d.measureField||d.valueField||d.yField,g=d.xField||d.sourceField||d.dateField,h=d.colorField;"slopeGraph"===d.type&&(g=d.rangeField);let y=g?n[g]:0,x=m?n[m]:0;switch(l.xDataType=typeof y,l.xDataType){case"number":case"numeric":i.push(d3.min(f,function(e){return+e[g]})),o.push(d3.max(f,function(e){return+e[g]}));break;case"date":i.push(d3.min(f,function(e){return new Date(e[g])})),o.push(d3.max(f,function(e){return new Date(e[g])}));break;default:e.getUniqueValues(f,g).forEach(function(e){-1===i.indexOf(e)&&i.push(e)});break}"networkMatrix"===d.type&&"string"==typeof x&&l.yAxis.locked&&(e.getUniqueValues(f,m).forEach(function(e){-1===u.indexOf(e)&&u.push(e)}),l.yAxis.yValues=u),p?f.forEach(function(e){let t=0;for(var n in e)n!==g&&(t+=+e[n]);a.push(t)}):(t.push(d3.min(f,function(e){return+e[m]})),a.push(d3.max(f,function(e){return+e[m]}))),h&&(r.push(d3.min(f,function(e){return+e[h]})),s.push(d3.max(f,function(e){return+e[h]})))})}break}"slopeGraph"===d.type?l.xAxis.locked&&l.yAxis.locked&&(l.domains.minX=l.xAxis.min,l.domains.maxX=l.xAxis.max,l.domains.minY=l.yAxis.min,l.domains.maxY=l.yAxis.max):("string"===l.xDataType?l.domains.xValues=e.getUniqueValues(i).sort(d3.ascending):(l.domains.minX=d3.min(i),l.domains.maxX=d3.max(o)),l.domains.minY=d3.min(t),l.domains.maxY=d3.max(a),l.domains.minColor=d3.min(r),l.domains.maxColor=d3.max(s),null!=l.yAxis.min&&l.yAxis.locked&&(l.domains.minY=l.yAxis.min),null!=l.yAxis.max&&l.yAxis.locked&&(l.domains.maxY=l.yAxis.max),null!=l.xAxis.min&&l.xAxis.locked&&(l.domains.minX=l.yAxis.min),null!=l.xAxis.max&&l.xAxis.locked&&(l.domains.maxX=l.yAxis.max))}();break}};let x=function(){l.serieNames=[],l.hasGroup?l.serieNames=d3.keys(l.data[0]).remove(l.xField).remove(l.series[0].sizeField).remove("_total").remove("_serieIndex"):l.series.forEach(function(e){l.serieTypes.push({type:e.type,name:e.yField?e.yField.toString():"",serie:e}),e.yField?l.serieNames.push(e.yField):e.valueField?l.serieNames.push(e.valueField):e.measureField&&l.serieNames.push(e.measureField)})};d3.select(i).style("background-color",l.backColor).style("border-color",l.border.color).style("border-width",l.border.size+"px").style("border-style",l.border.style).style("position","relative").append("div").on("click",function(){l.onBodyClick&&l.onBodyClick("body"),d3.event.stopPropagation()}).attr("id",l.innerContainer).style("background-color",l.backColor);let b=function(){return{legend:$("#"+l.container+"_legend"),title:$("#"+l.container+"_title"),inner:$("#"+l.container+"_inner"),master:$("#"+l.container)}};switch(l.type){case"locationMap":case"routeMap":case"densityMap":case"multiples":break;default:if(l.svg=d3.select("#"+l.innerContainer).append("svg").attr("id",l.container+"_svg").attr("class","vis_svg").attr("viewBox","0 0 "+l.width+" "+l.height).attr("preserveAspectRatio","xMidYMid meet").attr("width",l.width).attr("height",l.height).attr("fill",l.backColor).attr("stroke","none"),e.mobile&&$("#"+l.container+"_svg").css("height",l.height),l.isTemp){let e=document.getElementById(l.container);new ResizeSensor(e,function(){let e=l.width/l.height,t=b(),n=t.legend.width(),a=(t.legend.height(),t.title.width(),t.title.height(),t.master.width()),i=(t.master.height(),a-(n||0)),o=i/e;l.svg.attr("width",i),l.svg.attr("height",o)}),new ResizeSensor(e.parentElement,function(){let e=l.width/l.height,t=b(),n=t.legend.width(),a=(t.legend.height(),t.title.width(),t.title.height(),t.master.width()),i=(t.master.height(),a-(n||0)),o=i/e;l.svg.attr("width",i),l.svg.attr("height",o)})}break}l.series.forEach(function(t,n){t.color||(t.color=n<e.colors.length?e.colors[n]:e.randColor()),l.legend.legendColors.forEach(function(e){e.text!==t.yField&&e.value!==t.yField||(t.color=e.color)})}),l.updateTitle=function(){let e=arguments.length>0?arguments[0]:l.title.content;l.title.position||(l.title.position="topCenter");if(e)if(null===c){c=l.title.position.indexOf("bottom")>-1?d3.select(i).append("div").attr("id",l.container+"_title").attr("width",l.width+"px"):d3.select(i).insert("div",":first-child").attr("id",l.container+"_title").attr("width",l.width+"px");let t="number"==typeof l.title.fontSize?l.title.fontSize+"px":l.title.fontSize;d=c.append("div").style("font-size",t).style("background-color",l.backColor).style("color",l.title.fontColor).style("font-family",l.title.fontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==l.title.fontStyle?"normal":l.title.fontStyle).style("font-weight","bold"==l.title.fontStyle?"bold":"normal").style("padding-left","5px").style("padding-right","5px").style("padding-top","5px").style("padding-bottom","5px").style("text-align",function(){switch(l.title.position){case"topLeft":case"bottomLeft":return"left";case"topRight":case"bottomRight":return"right";case"topCenter":case"bottomCenter":return"center";default:return"center"}}()).on("click",m).html(e),titleOffset=d.node().getBoundingClientRect(),l.plot.height-=titleOffset.height,l.title.position.indexOf("bottom")>-1?l.plot.titleHeight=0:l.plot.titleHeight=titleOffset.height,l.svg&&l.svg.attr("viewBox","0 0 "+l.plot.width+" "+l.plot.height).attr("height",l.plot.height)}else d.html(e)},l.showTooltip=function(){u.show(Array.prototype.slice.call(arguments))},l.hideTooltip=function(){u.hide()},l.updateLegend=function(){s.update(l)},l.toCanvas=function(t){var n,a=document.getElementById(l.container),i=document.getElementById(l.innerContainer),o=document.getElementById(l.container+"_legend_svg"),r=i.querySelector("#"+l.container+"_svg"),s=document.getElementById(l.container+"_zoom_container"),u=!1,d=null;return n=document.createElement("canvas"),xml=(new XMLSerializer).serializeToString(r),e.detectMS()&&(xml=xml.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(n,xml,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){u=!0}}),i.appendChild(n),i.removeChild(r),s&&i.removeChild(s),o&&(d=document.createElement("canvas"),xml=(new XMLSerializer).serializeToString(o),e.detectMS()&&(xml=xml.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(d,xml,{ignoreMouse:!0,ignoreAnimation:!0}),o.parentNode.appendChild(d),o.parentNode.removeChild(o)),new Promise(function(e){var l=setInterval(function(){u&&(html2canvas(a).then(function(a){o&&(d.parentNode.appendChild(o),d.parentNode.removeChild(d)),i.appendChild(r),i.removeChild(n),s&&i.appendChild(s),a.id=t+"-canvas",e(a)}),clearInterval(l))},500)})},l.toImage=function(){var t,n=document.getElementById(l.container),a=document.getElementById(l.innerContainer),i=document.getElementById(l.container+"_legend_svg"),o=a.querySelector("#"+l.container+"_svg"),r=document.getElementById(l.container+"_zoom_container"),s=!1,u=null;return t=document.createElement("canvas"),xml=(new XMLSerializer).serializeToString(o),e.detectMS()&&(xml=xml.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(t,xml,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){s=!0}}),a.appendChild(t),a.removeChild(o),r&&a.removeChild(r),i&&(u=document.createElement("canvas"),xml=(new XMLSerializer).serializeToString(i),e.detectMS()&&(xml=xml.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(u,xml,{ignoreMouse:!0,ignoreAnimation:!0}),i.parentNode.appendChild(u),i.parentNode.removeChild(i)),new Promise(function(e){var l=setInterval(function(){s&&(html2canvas(n).then(function(n){i&&(u.parentNode.appendChild(i),u.parentNode.removeChild(u)),a.appendChild(o),a.removeChild(t),r&&a.appendChild(r),e(n.toDataURL("image/png"))}),clearInterval(l))},500)})},l.wrapText=function(e,t){e.each(function(){let e,n=d3.select(this),a=n.text().split(/\s+/).reverse(),l=[],i=0,o=n.attr("y"),r=n.attr("dy")?parseFloat(n.attr("dy")):0,s=n.text(null).append("tspan").attr("x",0).attr("y",o).attr("dy",r+"em");if(a.length>1)for(;e=a.pop();)l.push(e),s.text(l.join(" ")),i>0&&s.node().getComputedTextLength()>t&&(l.pop(),s.text(l.join(" ")),l=[e],s=n.append("tspan").attr("x",0).attr("y",o).attr("dy",1.1+r+"em").text(e)),i++;else s=n.append("tspan").attr("x",0).attr("y",o).attr("dy",r+"em").text(a[0])})},l.getAutoColor=function(t){let n=d3.color(t);return n?(n=255===n.r&&255===n.g&&255===n.b?d3.rgb(0,0,0):0===n.r&&0===n.g&&0===n.b?d3.rgb(255,255,255):1-(.299*n.r+.587*n.g+.114*n.b)/255<.5?d3.rgb(d3.hsl(d3.color(t)).darker()).darker(2):d3.rgb(d3.hsl(d3.color(t)).brighter()).brighter(2)).toString():e.randColor()},l.getSerieIndexByName=function(e){let t=-1;return l.series.forEach(function(n,a){n.yField.toString()&&n.yField.toString()===e?t=a:n.measureField&&n.measureField===e?t=a:n.valueField&&n.valueField===e&&(t=a)}),t};let v=function(e,t){switch(l.type){case"pieChart":case"donutChart":{let n=t?15:0,a=(e.startAngle+e.endAngle)/2;return"translate("+Math.sin(a)*n+","+-Math.cos(a)*n+")"}break}};l.interactSerie=function(){let e=0,t=!0,n=1,a=null;1===arguments.length?e=arguments[0]:2===arguments.length?(e=arguments[0],t=arguments[1]):3===arguments.length?(e=arguments[0],t=arguments[1],n=arguments[2]):4===arguments.length&&(e=arguments[0],t=arguments[1],n=arguments[2],a=arguments[3]);let i=l.svg?l.svg:l.tempSVG;if(i)switch(l.type){case"donutChart":case"pieChart":a=l.__slicedSet[e];l.__tempArc.centroid(a);t?i.select(".eve-vis-series-"+e).transition().duration(100).attr("transform",v(a,!0)):i.select(".eve-vis-series-"+e).transition().duration(100).attr("transform",v(a,!1));break;case"funnelChart":t?i.select(".eve-vis-series-"+e).transition().duration(100).attr("transform","translate(15,0)"):i.select(".eve-vis-series-"+e).transition().duration(100).attr("transform","translate(0,0)");break;case"pyramidChart":{let n=l.__funnelWidth/2,a=l.__funnelHeight/2;t?(n+=15,i.select(".eve-vis-series-"+e).transition().duration(100).attr("transform","rotate(180,"+n+","+a+")")):i.select(".eve-vis-series-"+e).transition().duration(100).attr("transform","rotate(180,"+n+","+a+")")}break;default:{let e=a.value.toString().toClassSelector();t?(i.selectAll(".eve-vis-series").style("opacity",.1),i.selectAll(".serie-"+e).style("opacity",n)):i.selectAll(".eve-vis-series").style("opacity",n)}break}};let F=function(e){var t="";if(l.columnNames&&null!=l.columnNames)for(var n in l.columnNames)l.columnNames[n]===e&&(t=n);return t};l.getContent=function(t,n,a,i,o){if(!a)return"";let r=a,s=t.data||t;n||(n=l.series[0]),s=t.data&&"object"==typeof t.data?t.data:t;let u=null!==r.match(/{(.*?)}/g)?r.match(/{(.*?)}/g).map(function(e){return e}):[],d=null!==r.match(/\[(.*?)\]/g)?r.match(/\[(.*?)\]/g).map(function(e){return e}):[],c=n.title||n.yField.toString()||n.measureField||n.valueField||n.sizeField,p=s[n.alphaField],m=s[n.closeField],g=s[n.columnField]||s[n.targetField]||s[l.xField],h=s[n.colorField],y=s[n.dateField],x=s[n.endField]||s[n.endDateField],b=s._groupValue||s[n.groupField]||s.group||s.clusterName,v=s.groupValue,w=s[n.highField],A=s[n.labelField],k=s[n.latField],S=s[n.longField],C=s[n.orderField],z=s[n.lowField],T=s[n.markerField],M=s.expressionedDataValue||t.expressionedDataValue||s._measureValue||s.measure||s[n.measureField]||s[n.yField.toString()]||s[n.valueField]||s.value||s.size||s.measureValue,_=s[n.openField],E=s[n.rangeField],V=s[n.rowField]||s[n.sourceField]||s[n.yField.toString()],N=s.sizeValue||s[n.sizeField]||s[n.valueField]||s[n.measureField]||s.size,L=i||s._sourceValue||s[l.xField]||s[n.sourceField]||s.sourceValue||s.source||s.name||s[n.groupField],B=o||s[n.targetField]||s.targetValue,G=s[n.startField]||s[n.startDateField],D=s.expressionedDataValue||t.expressionedDataValue||s.value||s[n.valueField]||s[n.measureField]||s[n.yField.toString()],I=s.value,Z=s.xValue||s[l.xField]||s[n.rangeField]||s.x,P=s.yValue||s[n.yField.toString()]||s[n.measureField]||s.y;return null!=s.xValue&&(Z=s.xValue),null!=s[l.xField]&&(Z=s[l.xField]),null!=s[n.rangeField]&&(Z=s[n.rangeField]),null!=s.x&&(Z=s.x),null!=s.yValue&&(P=s.yValue),null!=s[n.yField.toString()]&&(P=s[n.yField.toString()]),null!=s[n.measureField]&&(P=s[n.measureField]),null!=s.y&&(P=s.y),"barChart"===l.type&&(null!=s.xValue&&(P=s.xValue),null!=s[l.xField]&&(P=s[l.xField]),null!=s[n.rangeField]&&(P=s[n.rangeField]),null!=s.x&&(P=s.x),null!=s.yValue&&(Z=s.yValue),null!=s[n.yField.toString()]&&(Z=s[n.yField.toString()]),null!=s[n.measureField]&&(Z=s[n.measureField]),null!=s.y&&(Z=s.y)),s.size||s.children&&s.name&&!s._measureValue&&(M=0,s.children.forEach(function(e){e.size&&(M=+e.size)})),"cooccurenceMatrix"===l.type&&(M=s.measure),"parallelLines"===l.type&&(null!=b&&""!==b||(c="")),l.columnNames&&null!=l.columnNames&&(l.columnNames[c]&&(c=l.columnNames[c]),l.columnNames[b]&&(b=l.columnNames[b]),l.columnNames[v]&&(v=l.columnNames[v]),l.columnNames[A]&&(A=l.columnNames[A]),l.columnNames[L]&&(L=l.columnNames[L]),l.columnNames[B]&&(B=l.columnNames[B])),u.forEach(function(t){let a=t.replace("{","").replace("}","").split(":"),i=a[0],o=2===a.length?a[1]:"",u="",d="";switch(i){case"value":d=D;break;case"start":d=G;break;case"source":case"task":case"text":d=L;break;case"size":d=N;break;case"count":d=I;break;case"row":d=V;break;case"range":d=E;break;case"measure":d=M;break;case"open":d=_;break;case"marker":d=T;break;case"low":d=z;break;case"order":d=C;break;case"longitude":d=S;break;case"latitude":d=k;break;case"label":d=A;break;case"high":d=w;break;case"serie":d=c;break;case"group":d=b||c;break;case"relation":d=v;break;case"end":d=x;break;case"date":d=new Date(y);break;case"color":d=h;break;case"column":case"col":d=g;break;case"alpha":d=p;break;case"target":d=B;break;case"close":d=m;break;case"x":case"title":d=Z;break;case"y":d=P;break;case"percent":d=100*N/f;break;case"total":d=f;break;default:if(l.usedFields&&F){let e=F(i),t=e||i,n=l.usedFields.xField===t,a=l.usedFields.yField===t,o=l.usedFields.groupField===t,r=(l.usedFields.sizeField,l.usedFields.measureField===t),u=l.usedFields.latField===t,p=l.usedFields.lngField===t,f=l.usedFields.labelField===t,m=(l.usedFields.titleField,l.usedFields.sourceField===t),g=l.usedFields.targetField===t,w=l.usedFields.markerField===t,z=l.usedFields.dateField===t,_=l.usedFields.startDateField===t,V=l.usedFields.endDateField===t,N=l.usedFields.taskField===t,I=l.usedFields.relationField===t,O=l.usedFields.rangeField===t,Y=l.usedFields.valueField===t,R=l.usedFields.colorField===t,H=l.usedFields.orderField===t;null!=s[t]?d=s[t]:n?d=Z:a?d=P:o?d=b||c:m?d=L:g?d=B:r?d=M:w?d=T:z?d=y:_?d=G:V?d=x:N?d=L:I?d=v:O?d=E:f?d=A:Y?d=D:u?d=k:p?d=S:R?d=h:H&&(d=C)}else{if(!!l.columnNames&&Object.keys(l.columnNames).length>0){let e=F(i),t=e||i;s[t]&&(d=s[t])}else s[i]&&(d=s[i])}break}if("measures"===i){let a=[];n.measureField.split(",").forEach(function(t){let n=t.trim();l.columnNames&&null!=l.columnNames&&l.columnNames[t]&&(n=l.columnNames[t]),a.push(n+": "+e.formatNumber(+s[t],o))}),r=r.replaceAll(t,a.join(", "))}else{if(d){d.toString().indexOf(".000Z")>-1&&(d=new Date(d));let n=e.getType(d);if(isNaN(d)){if(["date","start","starts","end","ends"].indexOf(i)>-1){let e=new Date(d);"null"!=JSON.stringify(e)&&(n="date")}}u="number"===n?e.formatNumber(d,o):"date"===n?e.formatDate(new Date(d),o):isNaN(+d)?d:e.formatNumber(+d,o),r=r.replaceAll(t,u)}else r=r.replaceAll(t,0===d?"0":"");"percent"===i&&(r+="%")}}),d.forEach(function(t){let n=t.replaceAll("[","").replaceAll("]","").split(":"),a=F(n[0]),l=2===n.length?n[1]:"",i="",o=s[a];o?(o.toString().indexOf(".000Z")>-1&&(o=new Date(o)),i="number"===e.getType(o)?e.formatNumber(o,l):"date"===e.getType(o)?e.formatDate(new Date(o),l):isNaN(+o)?o:e.formatNumber(+o,l),r=r.replaceAll(t,i)):r=r.replaceAll(t,"")}),r};l.extractSerieNamesFromData=function(){let t=[],n=[],a=l.series[0];if("multiples"===l.type){let i=function(){let e="";switch(l.series[0].type){case"gantt":case"seatMap":case"timeline":case"pie":case"pyramid":case"donut":case"funnel":e="grouped";break;case"circlePacking":case"dendrogram":case"treemap":case"force":e="tree";break;case"networkMatrix":e="xy";break;case"bullet":e="sliced";break;case"calendarmap":case"wordCloud":e="standard";break;case"slopeGraph":e="sourced";break}return e}(),o=l.series[0].type;switch(i){case"grouped":l.data.forEach(function(i){if(i.values){let r=[],s=[],u=a.groupField;switch(i.values.dataArray&&i.values.dataArray.length?r=i.values.dataArray:i.values.length&&(r=i.values),o){case"pie":case"donut":case"pyramid":case"funnel":u=a.xField;break}(s=e.getUniqueValues(r,u)).forEach(function(i){if(-1===t.indexOf(i)){let o=e.clone(a);o.title=i;let r=e.filterSensitive(l.legend.legendColors,"value",i);r.length&&r.length>0&&(o.color=r[0].color),t.push(i),n.push({serieName:i,serie:o})}})}});break;default:l.data.forEach(function(e){if(e.values){let i=[],o=[a.xField,"_serieIndex"];l.xField&&o.push(l.xField),a.groupField&&o.push(a.groupField),e.values.dataArray&&e.values.dataArray.length?i=e.values.dataArray:e.values.length&&(i=e.values),i.forEach(function(e){Object.keys(e).forEach(function(e){if(-1===o.indexOf(e)&&-1===t.indexOf(e)){let a=l.series[l.getSerieIndexByName(e)];a&&(t.push(e),n.push({serieName:e,serie:a}))}})})}});break}}else{let i=l.series;for(let e=0;e<l.data.length;e++){let i=l.data[e];for(let e in i)e!==l.xField&&e!==a.sizeField&&e!==a.groupField&&e!==a.xField&&"_serieIndex"!==e&&-1===t.indexOf(e)&&(t.push(e),n.push({serieName:e,serie:l.series[l.getSerieIndexByName(e)]}))}l.isPSW?(n=[],i.forEach(function(e){n.push({serieName:e.yField,serie:e})})):l.series.length<n.length&&n.forEach(function(t,n){null==t.serie&&(t.serie=e.clone(a),t.serie.yField=t.serieName,t.serie.color=n<e.colors.length?e.colors[n]:e.randColor())})}return n},l.getColorFromLegend=function(e){let t="none";return l.legend.legendColors.forEach(function(n){n.text.toString()!==e.toString()&&n.value.toString()!==e.toString()||(t=n.color)}),t},l.getColorFromLegendByIndex=function(t){return l.legend.legendColors[t]?l.legend.legendColors[t].color:e.randColor()},l.calculateDomain(),l.updateTitle(),u=eve.createTooltip(l),s=eve.createLegend(l)}e.initVis=function(e){return new t(e)}}(eve),function(e){function t(t){if(null==t)throw Error("Invalid chart data!");this.xScale=null,this.yScale=null,this.xAxis=null,this.yAxis=null;let n=this,a=arguments[0],l="barChart"===t.type||"abacus"===t.type,i=l?a.yAxis:a.xAxis,o=l?a.xAxis:a.yAxis,r=null,s=null,u=null,d=null,c=null,p=null,f=0,m=null,g=null,h=function(){let e=!1;return"barChart"!==a.type&&"columnChart"!==a.type||(e=!0),e},y=function(){let e=null,t=null;if(l){switch(a.xDataType){case"number":case"numeric":t=d3.scaleLinear().domain([a.domains.minX,a.domains.maxX]),a.xAxis.orderFieldName&&"desc"===a.xAxis.orderDirection&&a.xAxis.orderFieldName===a.xField&&(t=d3.scaleLinear().domain([a.domains.maxX,a.domains.minX])),"barChart"===a.type?t.range([a.plot.height/a.data.length/2,a.plot.height-a.plot.height/a.data.length/2]):t.range([0,a.plot.height]);break;case"date":t=d3.scaleTime().range([0,a.plot.height]).domain([a.domains.minX,a.domains.maxX]),a.xAxis.orderFieldName&&"desc"===a.xAxis.orderDirection&&a.xAxis.orderFieldName===a.xField&&(t=d3.scaleTime().range([0,a.plot.height]).domain([a.domains.maxX,a.domains.minX]));break;default:h()||a.domains.xValues.sort(d3.ascending),t=d3.scaleBand().range([0,a.plot.height]).padding(.1).round(!0).domain(a.domains.xValues);break}e=d3.scaleLinear().range([0,a.plot.width]).domain([a.domains.minY,a.domains.maxY])}else{switch(a.xDataType){case"number":case"numeric":if(a.fromMultiples||a.animation.enabled)switch(a.type){case"networkMatrix":a.xAxis.values&&a.xAxis.values.length&&(a.domains.xValues=a.xAxis.values,a.domains.minX=d3.min(a.domains.xValues),a.domains.maxX=d3.max(a.domains.xValues));break}e=d3.scaleLinear().domain([a.domains.minX,a.domains.maxX]),a.xAxis.orderFieldName&&"desc"===a.xAxis.orderDirection&&a.xAxis.orderFieldName===a.xField&&(e=d3.scaleLinear().domain([a.domains.maxX,a.domains.minX])),"columnChart"===a.type?e.range([a.plot.width/a.data.length/2,a.plot.width-a.plot.width/a.data.length/2]):e.range([0,a.plot.width]);break;case"date":if(a.fromMultiples||a.animation.enabled)switch(a.type){case"networkMatrix":a.xAxis.values&&a.xAxis.values.length&&(a.domains.xValues=a.xAxis.values,a.domains.minX=d3.min(a.domains.xValues),a.domains.maxX=d3.max(a.domains.xValues));break}e=d3.scaleTime().range([0,a.plot.width]).domain([a.domains.minX,a.domains.maxX]),a.xAxis.orderFieldName&&"desc"===a.xAxis.orderDirection&&a.xAxis.orderFieldName===a.xField&&(e=d3.scaleTime().range([0,a.plot.width]).domain([a.domains.maxX,a.domains.minX]));break;default:h()||a.domains.xValues.sort(d3.ascending),e=d3.scaleBand().range([0,a.plot.width]).padding(.1).round(!0).domain(a.domains.xValues);break}if(a.frozenYAxis&&"string"===a.frozenYAxis){if(a.domains.yValues.sort(d3.ascending),a.yAxis.yValues&&a.yAxis.yValues.length&&a.yAxis.yValues.length>0&&(a.domains.yValues=a.yAxis.yValues),a.fromMultiples||a.animation.enabled)switch(a.type){case"networkMatrix":a.yAxis.values&&a.yAxis.values.length&&(a.domains.yValues=a.yAxis.values);break}t=d3.scaleBand().range([0,a.plot.height]).padding(.1).round(!0).domain(a.domains.yValues)}else t=d3.scaleLinear().range([a.plot.height,0]).domain([a.domains.minY,a.domains.maxY])}n.xScale=e,n.yScale=t},x=function(){let t=null,o=function(){let e=10,t=l?a.plot.height:a.plot.width;return"auto"===i.tickCount?((e=Math.ceil(t/(l?p.width:c.width))-1)>10&&(e=10*Math.round(e/10)),"date"===a.xDataType&&e>=5&&(e/=2)):e=parseInt(i.tickCount),e<=1&&(e=2),"auto"===i.tickCount&&e>10&&(e=10),e}();if(t="top"===i.position?d3.axisTop(n.xScale):d3.axisBottom(n.xScale),!l&&"string"===a.xDataType)return t.tickValues(a.domains.xValues);try{if(!l&&a.xField&&a.dataProperties){let e=a.dataProperties.columns[a.xField].uniques;e.length<o&&(o=e.length)}}catch(e){o=10}return o=e.calculateTicks(o),a.width<360&&(o=3),t.ticks(o)},b=function(){let t=null,i=function(){let e=10,t=l?a.plot.width:a.plot.height;return"auto"===o.tickCount?(e=Math.ceil(t/(l?c.height:p.height))-1)>10&&(e=10*Math.round(e/10)/2):e=parseInt(o.tickCount),e<=1&&(e=2),"auto"===o.tickCount&&e>10&&(e=10),e}();if(t="right"===o.position?d3.axisRight(n.yScale):d3.axisLeft(n.yScale),l&&"string"===a.xDataType)return t.tickValues(a.domains.xValues);if(l&&a.xField&&a.dataProperties){let e=a.dataProperties.columns[a.xField].uniques;e.length<i&&(i=e.length)}return i=e.calculateTicks(i),a.height<360&&(i=3),t.ticks(i)},v=function(e){e?(r.transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).attr("transform","translate(0,"+("top"===i.position?0:a.plot.height)+")").call(x().tickSize(-a.plot.height,0,0).tickFormat("")),s.transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).attr("transform","translate("+("right"===o.position?a.plot.width:0)+")").call(b().tickSize(-a.plot.width,0,0).tickFormat(""))):(r.attr("transform","translate(0,"+("top"===i.position?0:a.plot.height)+")").call(x().tickSize(-a.plot.height,0,0).tickFormat("")),s.attr("transform","translate("+("right"===o.position?a.plot.width:0)+")").call(b().tickSize(-a.plot.width,0,0).tickFormat(""))),r.selectAll(".domain").style("stroke","none").style("stroke-width","0px"),r.selectAll("line").style("stroke-opacity",i.gridLineAlpha).style("stroke-width",i.gridLineThickness+"px").style("stroke",i.gridLineColor),s.selectAll(".domain").style("stroke","none").style("stroke-width","0px"),s.selectAll("line").style("stroke-opacity",o.gridLineAlpha).style("stroke-width",o.gridLineThickness+"px").style("stroke",o.gridLineColor)},F=function(){let t=function(e,t){a.onAxisLabelClick&&a.onAxisLabelClick("xAxis",e),d3.event.stopPropagation()},n=function(e,t){a.onAxisLabelClick&&a.onAxisLabelClick("yAxis",e),d3.event.stopPropagation()},r=function(t,n){let a=e.getType(t);return 0===t?t:"array"===a&&t.length>0?t[0]:"number"===a?t?e.formatNumber(t,i.labelFormat):"":"date"===a?t?e.formatDate(t,i.labelFormat):"":t?t.replaceAll("&lt;","<").replaceAll("&gt;",">"):""},s=function(t,n){let a=e.getType(t);return 0===t?t:"number"===a?t?e.formatNumber(t,o.labelFormat):"":"date"===a?t?e.formatDate(t,o.labelFormat):"":t?t.replaceAll("&lt;","<").replaceAll("&gt;",">"):""};i.enabled&&(u.selectAll("path").style("stroke-opacity",i.alpha).style("stroke-width",i.thickness+"px").style("stroke",i.color),u.selectAll("line").style("fill","none").style("stroke-width",i.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",i.alpha).style("stroke",i.color),u.selectAll("text").style("fill",i.labelFontColor).style("font-size",i.labelFontSize+"px").style("font-family",i.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===i.labelFontStyle?"normal":i.labelFontStyle).style("font-weight","bold"===i.labelFontStyle?"bold":"normal").style("text-anchor","middle").attr("transform",function(e){return m=this.getBBox(),l?45===i.labelAngle?"rotate("+i.labelAngle+")translate("+2*m.height+")":-45===i.labelAngle?"rotate("+i.labelAngle+")translate(-"+2*m.height+")":90===i.labelAngle?"rotate("+i.labelAngle+")translate("+(2*m.height+6)+", -"+m.height+")":void 0:45===i.labelAngle?"rotate("+i.labelAngle+")translate("+m.width/2+")":-45===i.labelAngle?"rotate("+i.labelAngle+")translate(-"+m.width/2+")":90===i.labelAngle?"rotate("+i.labelAngle+")translate("+(m.width/2+6)+", -"+m.height+")":"rotate("+i.labelAngle+")"}).on("click",t).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).text(r)),o.enabled&&(d.selectAll("path").style("stroke-opacity",o.alpha).style("stroke-width",o.thickness+"px").style("stroke",o.color),d.selectAll("line").style("fill","none").style("stroke-width",o.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",o.alpha).style("stroke",o.color),d.selectAll("text").style("fill",o.labelFontColor).style("font-size",o.labelFontSize+"px").style("font-family",o.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===o.labelFontStyle?"normal":o.labelFontStyle).style("font-weight","bold"===o.labelFontStyle?"bold":"normal").style("text-anchor",function(e){return l?90===o.labelAngle?"start":"end":"right"===o.position?"start":"end"}).attr("transform",function(e){return m=this.getBBox(),l?90===o.labelAngle?"rotate("+o.labelAngle+")translate(0,"+m.width/2+")":"right"===o.position?"rotate("+o.labelAngle+")translate("+m.width+")":"rotate("+o.labelAngle+")":90===o.labelAngle?"rotate("+o.labelAngle+")translate("+m.width/2+","+m.height+")":"rotate("+o.labelAngle+")"}).on("click",n).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).text(s))};return function(){let e=null,t=null,n=function(){a.onAxisTitleClick&&a.onAxisTitleClick("xAxisTitle",i.title),d3.event.stopPropagation()},l=function(){a.onAxisTitleClick&&a.onAxisTitleClick("yAxisTitle",o.title),d3.event.stopPropagation()},r=function(){return m=this.getBBox(),f="top"===i.position?a.plot.top+m.height/2:a.plot.height-m.height/2},s=function(){return m=this.getBBox(),f="left"===o.position?o.titleFontSize+5:a.plot.width-o.titleFontSize-5};i.title&&(e=a.svg.append("g").append("text").text(i.title).style("fill",i.titleFontColor).style("font-family",i.titleFontFamily+", Arial, Helvetica, Ubuntu").style("font-size",i.titleFontSize+"px").style("font-style","bold"===i.titleFontStyle?"normal":i.titleFontStyle).style("font-weight","bold"===i.titleFontStyle?"bold":"normal").style("text-anchor","middle").on("click",n).attr("x",a.plot.width/2).attr("y",r),m=e.node().getBBox(),"top"===i.position?a.plot.top+=m.height:a.plot.bottom+=m.height),o.title&&(t=a.svg.append("g").append("text").text(o.title).style("fill",o.titleFontColor).style("font-family",o.titleFontFamily+", Arial, Helvetica, Ubuntu").style("font-size",o.titleFontSize+"px").style("font-style","bold"===o.titleFontStyle?"normal":o.titleFontStyle).style("font-weight","bold"===o.titleFontStyle?"bold":"normal").style("text-anchor","middle").on("click",l).attr("transform","rotate(-90)").attr("x",a.plot.height/2*-1).attr("y",s),m=t.node().getBBox(),"right"===o.position?a.plot.right+=m.height+5:a.plot.left+=m.height+5)}(),g=null,function(){let t=null,n=l?o.labelFormat:i.labelFormat,r=0,s=0,u=0,d="",f="";if(a.fromMultiples||a.animation.enabled)switch(a.type){case"networkMatrix":a.yAxis.values&&a.yAxis.values.length&&(a.domains.yValues=a.yAxis.values),a.xAxis.values&&a.xAxis.values.length&&(a.domains.xValues=a.xAxis.values,"number"!==a.xDataType&&"date"!==a.xDataType||(a.domains.minX=d3.min(a.domains.xValues),a.domains.maxX=d3.max(a.domains.xValues)));break}switch(a.xDataType){case"number":case"numeric":s=n?e.formatNumber(a.domains.maxX,n):null!=a.domains.maxX?a.domains.maxX.toFixed(1):"";break;case"date":s=n?e.formatDate(a.domains.maxX,n):e.formatDate(a.domains.maxX,"");break;default:{let e=a.allXValues&&a.allXValues.length>0?a.allXValues:a.domains.xValues;r=0;for(let t=0;t<e.length;t++){let n=e[t];n&&n.toString().length>r&&(r=n.length,s=n)}}break}if(a.domains.yValues&&a.domains.yValues.length&&a.domains.yValues.length>0){r=0;for(let e=0;e<a.domains.yValues.length;e++){let t=a.domains.yValues[e];t&&t.toString().length>r&&(r=t.toString().length,u=t)}}else u=(n=l?i.labelFormat:o.labelFormat)?e.formatNumber(a.domains.maxY,n):null!=a.domains.maxY?a.domains.maxY.toFixed(1):"";l?(d=u,f=s):(f=u,d=s),t=a.svg.append("text").style("font-size",i.labelFontSize+"px").style("color",i.labelFontColor).style("font-family",i.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==i.labelFontStyle?"normal":i.labelFontStyle).style("font-weight","bold"==i.labelFontStyle?"bold":"normal").attr("transform","rotate("+i.labelAngle+")").text(d),c=t.node().getBoundingClientRect(),t.remove(),t=a.svg.append("text").style("font-size",o.labelFontSize+"px").style("color",o.labelFontColor).style("font-family",o.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==o.labelFontStyle?"normal":o.labelFontStyle).style("font-weight","bold"==o.labelFontStyle?"bold":"normal").attr("transform","rotate("+o.labelAngle+")").text(f),p=t.node().getBoundingClientRect(),t.remove(),a.plot.top+=5,a.plot.bottom+=5,a.plot.left+=5,a.plot.right+=5,"right"===o.position?(a.plot.right+=o.enabled?p.width+6:6,a.plot.left+=o.enabled?p.width/2:0):(a.plot.left+=o.enabled?p.width+6:6,a.plot.right+=o.enabled?p.width/2:0),"top"===i.position?a.plot.top+=i.enabled?c.height+6:0:a.plot.bottom+=i.enabled?c.height+6:0,a.plot.width=Math.abs(a.plot.width-a.plot.left-a.plot.right),a.plot.height=Math.abs(a.plot.height-a.plot.top-a.plot.bottom)}(),y(),g=a.svg.append("g").attr("transform","translate("+a.plot.left+","+a.plot.top+")"),r=g.append("g").attr("class","eve-x-grid"),s=g.append("g").attr("class","eve-y-grid"),v(),n.xAxis=x(),n.yAxis=b(),i.enabled&&(u=g.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform",function(){return"zero"===i.axisCrossing?"translate(0,"+n.yScale(0)+")":"translate(0,"+("top"===i.position?0:a.plot.height+0)+")"}).attr("class","eve-x-axis").call(n.xAxis)),o.enabled&&(d=g.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform",function(){return"zero"===o.axisCrossing?"translate("+n.xScale(0)+")":"translate("+("right"===o.position?a.plot.width:0)+")"}).attr("class","eve-y-axis").call(n.yAxis)),F(),n.update=function(){a.calculateDomain(),y(),v(!0),i.enabled&&u.style("fill","none").style("shape-rendering","crispEdges").transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).call(x()),o.enabled&&d.style("fill","none").style("shape-rendering","crispEdges").transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).call(b()),F()},this}function n(){if(0===arguments.length)throw Error("Invalid chart data!");this.xScale=null,this.yScale=null,this.xAxis=null,this.yAxis=null;let t=this,n=arguments[0],a=n.xAxis,l=n.yAxis,i=null,o=null,r="",s=null,u={},d=null,c={},p={},f=null,m=null,g=null,h=[],y=function(){switch(n.xDataType){case"number":case"numeric":d=d3.scaleLinear().range([0,n.plot.width]).domain([n.domains.minX,n.domains.maxX]);break;case"date":d=d3.scaleTime().range([0,n.plot.width]).domain([n.domains.minX,n.domains.maxX]);break;default:d=d3.scaleBand().range([0,n.plot.width]).padding(.1).round(!0).domain(n.domains.xValues);break}n.series.forEach(function(e,t){let a=e.yField.toValueKey(),i=d3.min(n.data,function(t){return t[e.yField]}),o=1.02*d3.max(n.data,function(t){return t[e.yField]});"left"===e.axisPosition?(l.min&&(i=.9*l.min),l.max&&(o=1.2*l.max)):"right"===e.axisPosition&&(l.minRight&&(i=.9*(l.minRight||l.colorMin)),l.maxRight&&(o=1.2*(l.maxRight||l.colorMax))),l.startsFromZero&&(i=0),c[a]=d3.scaleLinear().range([n.plot.height,0]).domain([i,o]),p[a]={min:i,max:o}}),t.xScale=d,t.serieScales=c,t.serieDomains=p},x=function(){let l=null,i=function(){let t=10;return"auto"===a.tickCount?(t=Math.ceil(n.plot.width/s.width)-1)>10&&(t=10*Math.round(t/10)):t=parseInt(a.tickCount),e.closestPower(Math.ceil(t))}();if(l="top"===a.position?d3.axisTop(t.xScale):d3.axisBottom(t.xScale),"string"===n.xDataType)return l.tickValues(n.domains.xValues);Math.floor(n.plot.width/s.width);return i=e.calculateTicks(i),"auto"===a.tickCount&&i>15&&(i=15),n.width<360&&(i=3),l.ticks(i)},b=function(e){let t=n.series[e],a=t.yField.toValueKey();!function(e){let t=10,a=u[e];"auto"===l.tickCount?(t=Math.ceil(n.plot.height/a.height)-1)>10&&(t=10*Math.round(t/10)/2):t=parseInt(l.tickCount)}(a);return"right"===t.axisPosition?d3.axisRight(c[a]):d3.axisLeft(c[a])},v=function(e){e?(f.transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).attr("transform","translate(0,"+("top"===n.xAxis.position?0:n.plot.height)+")").call(x().tickSize(-n.plot.height,0,0).tickFormat("")),m.transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).attr("transform","translate("+("right"===n.yAxis.position?n.plot.width:0)+")").call(b(0).tickSize(-n.plot.width,0,0).tickFormat(""))):(f.attr("transform","translate(0,"+("top"===n.xAxis.position?0:n.plot.height)+")").call(x().tickSize(-n.plot.height,0,0).tickFormat("")),m.attr("transform","translate("+("right"===n.yAxis.position?n.plot.width:0)+")").call(b(0).tickSize(-n.plot.width,0,0).tickFormat(""))),f.selectAll(".domain").style("stroke","none").style("stroke-width","0px"),f.selectAll("line").style("stroke-opacity",n.xAxis.gridLineAlpha).style("stroke-width",n.xAxis.gridLineThickness+"px").style("stroke",n.xAxis.gridLineColor),m.selectAll(".domain").style("stroke","none").style("stroke-width","0px"),m.selectAll("line").style("stroke-opacity",n.yAxis.gridLineAlpha).style("stroke-width",n.yAxis.gridLineThickness+"px").style("stroke",n.yAxis.gridLineColor)},F=function(t,n){let l=e.getType(t);return 0===t?t:"array"===l&&t.length>0?t[0]:"number"===l?t?e.formatNumber(t,a.labelFormat):"":"date"===l?t?e.formatDate(t,a.labelFormat):"":t?t.replaceAll("&lt;","<").replaceAll("&gt;",">"):""},w=function(t,n){let a=e.getType(t);return 0===t?t:"number"===a?t?e.formatNumber(t,l.labelFormat):"":"date"===a?t?e.formatDate(t,l.labelFormat):"":t?t.replaceAll("&lt;","<").replaceAll("&gt;",">"):""},A=function(){n.xAxis.enabled&&(g.selectAll("path").style("stroke-opacity",n.xAxis.alpha).style("stroke-width",n.xAxis.thickness+"px").style("stroke",n.xAxis.color),g.selectAll("line").style("fill","none").style("stroke-width",n.xAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",n.xAxis.alpha).style("stroke",n.xAxis.color),g.selectAll("text").style("fill",n.xAxis.labelFontColor).style("font-size",n.xAxis.labelFontSize+"px").style("font-family",n.xAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.xAxis.labelFontStyle?"normal":n.xAxis.labelFontStyle).style("font-weight","bold"===n.xAxis.labelFontStyle?"bold":"normal").style("text-anchor",function(e,t){return n.xAxis.labelAngle>0?"start":n.xAxis.labelAngle<0?"end":"middle"}).attr("transform","rotate("+n.xAxis.labelAngle+")").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).text(F)),n.yAxis.enabled&&h.forEach(function(e,t){e.selectAll("path").style("stroke-opacity",n.yAxis.alpha).style("stroke-width",n.yAxis.thickness+"px").style("stroke",n.yAxis.color),e.selectAll("line").style("fill","none").style("stroke-width",n.yAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",n.yAxis.alpha).style("stroke",n.yAxis.color),e.selectAll("text").style("fill",n.yAxis.labelFontColor).style("font-size",n.yAxis.labelFontSize+"px").style("font-family",n.yAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.yAxis.labelFontStyle?"normal":n.yAxis.labelFontStyle).style("font-weight","bold"===n.yAxis.labelFontStyle?"bold":"normal").attr("transform","rotate("+n.yAxis.labelAngle+")").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).text(w)})};return function(){o=n.svg.append("g").append("text").text(a.title).style("fill",a.titleFontColor).style("font-family",a.titleFontFamily+", Arial, Helvetica, Ubuntu").style("font-size",a.titleFontSize+"px").style("font-style","bold"===a.titleFontStyle?"normal":a.titleFontStyle).style("font-weight","bold"===a.titleFontStyle?"bold":"normal").style("text-anchor","middle").attr("x",n.plot.width/2).attr("y",function(){return i=this.getBBox(),"top"===a.position?yPos=n.plot.top+i.height/2:yPos=n.plot.height-i.height/2,yPos}),i=o.node().getBBox(),"top"===a.position?n.plot.top+=i.height:n.plot.bottom+=i.height,function(){switch(n.xDataType){case"string":valueLength=0,n.domains.xValues.forEach(function(e){e&&e.toString().length>valueLength&&(valueLength=e.length,r=e)});break;case"number":r=e.formatNumber(n.domains.maxX,a.axisFormat);break;case"date":r=e.formatDate(n.domains.maxX,a.axisFormat);break}o=n.svg.append("text").style("font-size",n.xAxis.labelFontSize+"px").style("color",n.xAxis.labelFontColor).style("font-family",n.xAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==n.xAxis.labelFontStyle?"normal":n.xAxis.labelFontStyle).style("font-weight","bold"==n.xAxis.labelFontStyle?"bold":"normal").attr("transform","rotate("+n.xAxis.labelAngle+")").text(r),i=o.node().getBoundingClientRect(),s=o.node().getBoundingClientRect(),o.remove(),n.plot.top+=5,n.plot.bottom+=10,n.plot.left+=5,n.plot.right+=5,"top"===n.xAxis.position?n.plot.top+=n.xAxis.enabled?i.height:0:n.plot.bottom+=n.xAxis.enabled?i.height:0;let t=0,d=0,c=0,p=[],f=[];n.series.forEach(function(a){let r=d3.max(n.data,function(e){return+e[a.yField]}),s=a.yField.toValueKey();o=n.svg.append("text").style("font-size",l.labelFontSize+"px").style("color",l.labelFontColor).style("font-family",l.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==l.labelFontStyle?"normal":l.labelFontStyle).style("font-weight","bold"==l.labelFontStyle?"bold":"normal").attr("transform","rotate("+l.labelAngle+")").text(e.formatNumber(r,l.labelFormat)),i=o.node().getBoundingClientRect(),u[s]=i,o.remove(),c=l.enabled?i.width+6+2*l.titleFontSize:6,"left"===a.axisPosition&&(p.push(i.width+2*l.titleFontSize+6),t++),"right"===a.axisPosition&&(f.push(i.width+2*l.titleFontSize+6),d++)}),leftAxisWidth=d3.max(p),rightAxisWidth=d3.max(f),n.plot.left=leftAxisWidth*t,n.plot.right=rightAxisWidth*d,n.plot.width=Math.abs(n.plot.width-n.plot.left-n.plot.right)-10,n.plot.height=Math.abs(n.plot.height-n.plot.top-n.plot.bottom)}(),y(),axisG=n.svg.append("g").attr("transform","translate("+n.plot.left+","+n.plot.top+")"),f=axisG.append("g").attr("class","eve-x-grid"),m=axisG.append("g").attr("class","eve-y-grid"),v(),a.enabled&&(g=axisG.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform","translate(0,"+("top"===a.position?0:n.plot.height+0)+")").attr("class","eve-x-axis").call(x()));let t=[],d=[];n.series.forEach(function(n,a){n._actualSerieIndex=a,"left"===n.axisPosition?t.push(e.clone(n)):d.push(e.clone(n))}),l.enabled&&t.forEach(function(e,t){e.yField.toValueKey();let a=-1*(leftAxisWidth*(t+1)-l.titleFontSize),i=0===t?0:t*leftAxisWidth*-1,o=axisG.append("g");o.append("text").style("fill",l.titleFontColor).style("font-family",l.titleFontFamily+", Arial, Helvetica, Ubuntu").style("font-size",l.titleFontSize+"px").style("font-style","bold"===l.titleFontStyle?"normal":l.titleFontStyle).style("font-weight","bold"===l.titleFontStyle?"bold":"normal").style("text-anchor","middle").text(e.axisTitle?e.axisTitle:"").attr("transform","rotate(-90)"),o.attr("transform","translate("+a+","+n.plot.height/2+")"),yAxis=axisG.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform","translate("+i+")").attr("class","eve-y-axis").call(b(e._actualSerieIndex)),h.push(yAxis)}),l.enabled&&d.forEach(function(e,t){e.yField.toValueKey();let a=n.plot.width+(rightAxisWidth*(t+1)-l.titleFontSize),i=n.plot.width+t*rightAxisWidth,o=axisG.append("g");o.append("text").style("fill",l.titleFontColor).style("font-family",l.titleFontFamily+", Arial, Helvetica, Ubuntu").style("font-size",l.titleFontSize+"px").style("font-style","bold"===l.titleFontStyle?"normal":l.titleFontStyle).style("font-weight","bold"===l.titleFontStyle?"bold":"normal").style("text-anchor","middle").text(e.axisTitle?e.axisTitle:"").attr("transform","rotate(90)"),o.attr("transform","translate("+a+","+n.plot.height/2+")"),yAxis=axisG.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform","translate("+i+")").attr("class","eve-y-axis").call(b(e._actualSerieIndex)),h.push(yAxis)}),A()}(),t.update=function(){n.calculateDomain(),y(),v(!0),n.xAxis.enabled&&g.style("fill","none").style("shape-rendering","crispEdges").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).call(x()),n.yAxis.enabled&&h.forEach(function(e,t){e.style("fill","none").style("shape-rendering","crispEdges").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).call(b(t))}),A()},this}e.initClassicalAxis=function(e){return new t(e)},e.initRadarAxis=function(t){return new function(){if(0===arguments.length)throw Error("Invalid chart data!");let t=this,n=arguments[0],a=n.xAxis,l=n.yAxis,i=e.getUniqueValues(n.data,n.xField),o=(n.series[0],0),r=0,s=null,u=null,d=null,c=null,p=null,f=function(t,n){let a=e.getType(t);return 0===t?t:"array"===a&&t.length>0?t[0]:"number"===a?t?e.formatNumber(t,n):"":"date"===a?t?e.formatDate(t,n):"":t?t.replaceAll("&lt;","<").replaceAll("&gt;",">"):""};function m(e,t){e.each(function(){let e,n=d3.select(this),a=n.text().split(/\s+/).reverse(),l=[],i=0,o=n.attr("y"),r=n.attr("x"),s=parseFloat(n.attr("dy")),u=n.text(null).append("tspan").attr("x",r).attr("y",o).attr("dy",s+"em");for(;e=a.pop();)l.push(e),u.text(l.join(" ")),u.node().getComputedTextLength()>t&&(l.pop(),u.text(l.join(" ")),l=[e],u=n.append("tspan").attr("x",r).attr("y",o).attr("dy",1.4*++i+s+"em").text(e))})}let g=function(){o=Math.min(n.plot.width/2,n.plot.height/2),r=2*Math.PI/i.length,p=d3.range(1,6).reverse(),t.yScale=d3.scaleLinear().range([0,o]).domain([n.domains.minY,n.domains.maxY]),s=t.yScale.ticks(),t.sliceAngle=r},h=function(){u=n.svg.append("g").attr("transform","translate("+n.width/2+","+n.height/2+")"),(d=u.append("g")).selectAll(".eve-y-axis").data(p).enter().append("circle").attr("class","eve-y-axis").attr("r",function(e,t){return o/5*e}).style("fill","none").style("stroke",l.color),d.selectAll(".eve-yAxis-labels").data(p.reverse()).enter().append("text").attr("class","eve-yAxis-labels").attr("x",0).attr("y",function(e){return-e*o/5}).attr("dy","0.4em").style("pointer-events","none").style("fill",l.labelFontColor).style("font-family",l.labelFontFamily).style("font-style","bold"===l.labelFontStyle?"normal":l.labelFontStyle).style("font-weight","bold"===l.labelFontStyle?"bold":"normal").style("font-size",l.labelFontSize).text(function(e,t){let a=Math.round(n.domains.maxY*e/5);return f(a,l.labelFormat);return a}),(c=d.selectAll(".eve-x-axis").data(i).enter().append("g").attr("class","eve-x-axis")).append("line").attr("x1",0).attr("y1",0).attr("x2",function(e,a){return t.yScale(1*n.domains.maxY)*Math.cos(r*a-Math.PI/2)}).attr("y2",function(e,a){return t.yScale(1*n.domains.maxY)*Math.sin(r*a-Math.PI/2)}).attr("class","line").style("stroke",a.color).style("stroke-width",1),c.append("text").attr("text-anchor","middle").style("fill",a.labelFontColor).style("font-family",a.labelFontFamily).style("font-style","bold"===a.labelFontStyle?"normal":a.labelFontStyle).style("font-weight","bold"===a.labelFontStyle?"bold":"normal").style("font-size",a.labelFontSize).attr("dy","0.35em").attr("x",function(e,a){return t.yScale(1.1*n.domains.maxY)*Math.cos(r*a-Math.PI/2)}).attr("y",function(e,a){return t.yScale(1.1*n.domains.maxY)*Math.sin(r*a-Math.PI/2)}).text(function(e){return f(e,a.labelFormat)}).call(m,60)};return function(){let e=null,t=null,l=i.getLongestText();t=(e=n.svg.append("text").style("font-size",a.labelFontSize+"px").style("color",a.labelFontColor).style("font-family",a.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==a.labelFontStyle?"normal":a.labelFontStyle).style("font-weight","bold"==a.labelFontStyle?"bold":"normal").text(l)).node().getBoundingClientRect(),e.remove();let o=t.width+t.height+2*n.plot.titleHeight;n.plot.width-=o,n.plot.height-=o}(),g(),h(),t.update=function(){n.calculateDomain(),u.remove(),g(),h()},this}(t)},e.initCombinationAxis=function(e){return new n(e)}}(eve),function(e){function t(t){let n=null,a=null,l=null,o=0,r=0,s={width:0,height:0,left:t.margin.left,top:t.margin.top,right:t.margin.right,bottom:t.margin.bottom},u={maxWidth:t.plot.width/4,maxHeight:t.plot.height/4,minWidth:t.plot.width/15,minHeight:t.plot.height/15,containerWidth:0,containerHeight:0,svgWidth:0,svgHeight:0},d={width:0,height:0,blockWidth:0,blockHeight:0,dimension:20,svg:null},c={width:0,height:0,singleHeight:0,legendValues:[],icons:null,texts:null,svg:null},p={width:0,height:0,percentage:0,dimension:20,blockWidth:0,blockHeight:0,minMax:[],minLabel:null,maxLabel:null,gradient:null,svg:null},f={width:0,height:0,band:0,legendValues:[],rScale:null,icons:null,lines:null,texts:null,svg:null},m="",g=0,h=null,y=null,x=5,b=null,v=null,F=[],w=[],A=0,k=0,S=null,C=null,z=!1,T=0,M=0,_=0,E=0,V=function(){let n=[],a=t.series[0];t.data.forEach(function(t){"array"===e.getType(t.values)?t.values.length&&t.values.length>0&&n.push(e.clone(t)):t.values&&t.values.baseData&&t.values.baseData.length&&t.values.baseData.length>0&&n.push(e.clone(t))});let l=[],i=[];switch(a.type){case"circlePacking":case"circlepacking":case"dendrogram":case"force":case"sunburst":case"treemap":n.forEach(function(e){currentDataArray=e.values.dataArray||e.values;let n=t.getMinMaxValueForTree(a,currentDataArray);l.push(n.min),i.push(n.max)}),T=d3.min(l),M=d3.max(i);break;default:T=t.domains.minY,M=t.domains.maxY,_=t.domains.minX,E=t.domains.maxX;break}};function N(){if(c.svg){switch(t.legend.position){case"left":case"right":A=(u.svgWidth-(c.width+s.left+s.right))/2,k=Math.max((u.svgHeight-r)/2,0);break;case"bottom":case"top":A=Math.max((u.svgWidth-o)/2,0),k=(u.svgHeight-(c.height+s.top+s.bottom))/2;break}c.svg.transition().duration(t.animation.duration).ease(t.animation.easing.toEasing()).attr("transform","translate("+A+","+k+")")}if(p.svg){switch(t.legend.position){case"left":case"right":A=(u.svgWidth-(p.width+s.left+s.right))/2,k=0;break;case"bottom":case"top":A=0,k=(u.svgHeight-(p.height+s.top+s.bottom))/2;break}p.svg.attr("transform","translate("+A+","+k+")")}if(d.svg){switch(t.legend.position){case"left":case"right":A=(u.svgWidth-(d.width+s.left+s.right))/2,k=0;break;case"bottom":case"top":A=0,k=(u.svgHeight-(d.height+s.top+s.bottom))/2;break}d.svg.attr("transform","translate("+A+","+k+")")}if(f.svg){switch(t.legend.position){case"left":case"right":A=(u.svgWidth-f.width-s.left-s.right)/2,k=r-f.height-s.top+Math.max((u.svgHeight-r)/2,0)+f.height/2;break;case"bottom":case"top":A=o-f.width-s.left+Math.max((u.svgWidth-o)/2,0),k=(u.svgHeight-f.height-s.top-s.bottom)/2+f.height/2;break}f.svg.attr("transform","translate("+A+","+k+")")}}function L(n){switch(b=null,t.masterType){case"sliced":if("multiples"===t.type){let n=[];t.data.forEach(function(a){a.values&&a.values.length&&a.values.forEach(function(a){let l=a[t.series[0].xField];-1===n.indexOf(l)&&((b=e.filterSensitive(t.legend.legendColors,"value",a[t.series[0].xField])).length>0?c.legendValues.push({value:b[0].value?b[0].value:"",length:b[0].value?b[0].value.toString().length:0,color:b[0].color}):c.legendValues.push({value:a[t.xField]?a[t.xField].toString():"",length:a[t.xField]?a[t.xField].toString().length:0,color:i>e.colors.length?e.randColor():e.colors[i]}),n.push(l))})}),c.legendValues.sort(function(e,t){let n=typeof e.value;return"string"===n?e.value<t.value?-1:e.value>t.value?1:0:"number"===n?e.value-t.value:new Date(e.value)-new Date(t.value)})}else t.data.forEach(function(n,a){b=e.filterSensitive(t.legend.legendColors,"value",n[t.xField]),null!=n[t.series[0].valueField]&&(b.length>0?c.legendValues.push({value:b[0].value?b[0].value:"",length:b[0].value?b[0].value.toString().length:0,color:b[0].color}):c.legendValues.push({value:n[t.xField]?n[t.xField].toString():"",length:n[t.xField]?n[t.xField].toString().length:0,color:a>e.colors.length?e.randColor():e.colors[a]}))}),c.legendValues.sort(function(e,t){let n=typeof e.value;return"string"===n?e.value<t.value?-1:e.value>t.value?1:0:"number"===n?e.value-t.value:new Date(e.value)-new Date(t.value)});c.legendValues.forEach(function(n,a){0===(b=e.filterSensitive(t.legend.legendColors,"value",n.value)).length&&t.legend.legendColors.push(n)});break;case"grouped":(F=e.getUniqueValues(t.data,t.series[0].groupField)).forEach(function(n,a){(b=e.filterSensitive(t.legend.legendColors,"value",n)).length>0?c.legendValues.push({value:b[0].value?b[0].value:"",length:b[0].value?b[0].value.toString().length:0,color:b[0].color}):c.legendValues.push({value:n?n.toString():"",length:n?n.toString().length:0,color:a>e.colors.length?e.randColor():e.colors[a]})}),t.legend.legendColors&&t.legend.legendColors.length&&(c.legendValues=t.legend.legendColors),c.legendValues.sort(function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}),c.legendValues.forEach(function(n,a){0===(b=e.filterSensitive(t.legend.legendColors,"value",n.value)).length&&t.legend.legendColors.push(n)});break;case"sourced":(F=e.getUniqueValues(t.data,t.series[0].sourceField)).forEach(function(t,n){c.legendValues.push({value:t?t.toString():"",length:t?t.toString().length:0,color:n>e.colors.length?e.randColor():e.colors[n]})}),c.legendValues.sort(function(e,t){return e.value<t.value?-1:e.value>t.value?1:0});break;case"map":if(t.legend.animLegend)F=t.legend.animLegend;else switch(t.type){case"standardMap":case"tileMap":F=e.getUniqueValues(t.data,t.series[0].valueField);break;case"ddCartogram":if(""===t.series[0].colorField)return;F=e.getUniqueValues(t.data,t.series[0].colorField);break;default:if(""===t.series[0].groupField)return;F=e.getUniqueValues(t.data,t.series[0].groupField)}F.forEach(function(n,a){(b=e.filterSensitive(t.legend.legendColors,"value",n)).length>0?c.legendValues.push({value:b[0].value?b[0].value:"",length:b[0].value?b[0].value.toString().length:0,color:b[0].color}):c.legendValues.push({value:n?n.toString():"",length:n?n.toString().length:0,color:a>e.colors.length?e.randColor():e.colors[a]})}),c.legendValues.sort(function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}),c.legendValues.forEach(function(n,a){0===(b=e.filterSensitive(t.legend.legendColors,"value",n.value)).length&&t.legend.legendColors.push(n)});break;case"manual":t.manualLegendValues&&t.manualLegendValues.forEach(function(n,a){n&&((v=e.filterSensitive(t.legend.legendColors,"value",n)).length>0?c.legendValues.push({value:v[0].value?v[0].value:"",length:v[0].value?v[0].value.toString().length:0,color:v[0].color}):c.legendValues.push({value:n.toString(),length:n.toString().length,color:a>e.colors.length?e.randColor():e.colors[a]}))}),c.legendValues.sort(function(e,t){return e.value<t.value?-1:e.value>t.value?1:0});break;default:if("mirroredBars"===t.type){let e=0;t.legend.legendColors.forEach(function(t,n){if(e<2){let e=t.text||t.value;c.legendValues.push({value:e?e.toString():"",length:e?e.toString().length:0,color:t.color})}e++}),c.legendValues.sort(function(e,t){let n=typeof e.value;return"string"===n?e.value<t.value?-1:e.value>t.value?1:0:"number"===n?e.value-t.value:new Date(e.value)-new Date(t.value)})}else if("bubbleForce"===t.type){if(""===t.series[0].groupField)return;(F=e.getUniqueValues(t.data,t.series[0].groupField)).forEach(function(n,a){(b=e.filterSensitive(t.legend.legendColors,"value",n)).length>0?c.legendValues.push({value:b[0].value?b[0].value:"",length:b[0].value?b[0].value.toString().length:0,color:b[0].color}):c.legendValues.push({value:n?n.toString():"",length:n?n.toString().length:0,color:a>e.colors.length?e.randColor():e.colors[a]})}),c.legendValues.sort(function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}),c.legendValues.forEach(function(n,a){0===(b=e.filterSensitive(t.legend.legendColors,"value",n.value)).length&&t.legend.legendColors.push(n)})}else t.manualLegendValues?(t.manualLegendValues.forEach(function(n,a){n&&((v=e.filterSensitive(t.legend.legendColors,"value",n)).length>0?c.legendValues.push({value:v[0].value?v[0].value:"",length:v[0].value?v[0].value.toString().length:0,color:v[0].color}):c.legendValues.push({value:n.toString(),length:n.toString().length,color:a>e.colors.length?e.randColor():e.colors[a]}))}),c.legendValues.forEach(function(n,a){0===(b=e.filterSensitive(t.legend.legendColors,"value",n.value)).length&&t.legend.legendColors.push(n)})):(t.legend.legendColors&&t.legend.legendColors.length&&(c.legendValues=t.legend.legendColors),c.legendValues.sort(function(e,t){let n=typeof e.value;return"string"===n?e.value<t.value?-1:e.value>t.value?1:0:"number"===n?e.value-t.value:new Date(e.value)-new Date(t.value)}));if(c.legendValues.length<2&&t.series.length<2)return;break}if(0!==c.legendValues.length)switch(t.legendValues=c.legendValues,c.legendValues.sort(function(t,n){let a=e.getType(t.value);return isNaN(t.value)?"string"===a?t.value<n.value?-1:t.value>n.value?1:0:"date"===a?new Date(t.value)-new Date(n.value):t.value-n.value:parseFloat(t.value)-parseFloat(n.value)}),c.legendValues.forEach(function(e){e.width=Y(e.value).width+t.legend.fontSize+2*x,e.width>g&&(m=e.value,g=e.length)}),y=Y(m),c.singleHeight=y.height+x,c.svg=l.append("g"),c.icons=c.svg.selectAll(".eve-legend-icon").data(c.legendValues).enter().append("rect").attr("class","eve-legend-icon").attr("width",t.legend.fontSize).attr("height",t.legend.fontSize).style("cursor",n.onClickEnabled?"pointer":"auto").style("fill",function(e,t){return e.color}).on("click",function(e,a){e.clicked?(e.clicked=null,t.interactSerie(e.serieIndex?e.serieIndex:a,null,1,e)):(e.clicked=!0,t.interactSerie(e.serieIndex?e.serieIndex:a,!0,1,e)),t.legendClick&&n.onClickEnabled&&t.legendClick(e,e.serieIndex?e.serieIndex:a),t.onLegendClick&&t.onLegendClick("legend")}),c.texts=c.svg.selectAll(".eve-legend-text").data(c.legendValues).enter().append("text").attr("class","eve-legend-text").style("font-size",t.legend.fontSize+"px").style("fill",t.legend.fontColor).style("font-family",t.legend.fontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==t.legend.fontStyle?"normal":t.legend.fontStyle).style("font-weight","bold"==t.legend.fontStyle?"bold":"normal").style("cursor",n.onClickEnabled?"pointer":"auto").text(function(e,t){return e.value}).on("click",function(e,a){e.clicked?(e.clicked=null,t.interactSerie(e.serieIndex?e.serieIndex:a,null,1,e)):(e.clicked=!0,t.interactSerie(e.serieIndex?e.serieIndex:a,!0,1,e)),t.legendClick&&n.onClickEnabled&&t.legendClick(e,e.serieIndex?e.serieIndex:a),t.onLegendClick&&t.onLegendClick("legend")}),c.icons.attr("transform",function(e,n){switch(t.legend.position){case"left":case"right":A=0,k=n*c.singleHeight;break;default:k=0,A=d3.sum(c.legendValues,function(e,t){return t<n?e.width:0});break}return"translate("+A+", "+k+")"}),c.texts.attr("transform",function(e,n){switch(t.legend.position){case"left":case"right":A=t.legend.fontSize+x,k=n*c.singleHeight+c.singleHeight/2;break;default:k=c.singleHeight/2,A=d3.sum(c.legendValues,function(e,t){return t<n?e.width:0})+t.legend.fontSize+x;break}return"translate("+A+", "+k+")"}),C=c.svg.node().getBoundingClientRect(),c.height=C.height,c.width=C.width+15,t.legend.position){case"left":case"right":o=o<c.width?c.width:o,r+=c.height;break;default:o+=c.width,r=r<c.height?c.height:r;break}}function B(n){switch(w=[],b=null,t.masterType){case"sliced":t.data.forEach(function(n,a){b=e.filterSensitive(t.legend.legendColors,"value",n[t.xField]),null!=n[t.series[0].valueField]&&(b.length>0?w.push({value:b[0].value?b[0].value:"",length:b[0].value?b[0].value.toString().length:0,color:b[0].color}):w.push({value:n[t.xField]?n[t.xField].toString():"",length:n[t.xField]?n[t.xField].toString().length:0,color:a>e.colors.length?e.randColor():e.colors[a]}))});break;case"grouped":(F=e.getUniqueValues(t.data,t.series[0].groupField)).forEach(function(n,a){(b=e.filterSensitive(t.legend.legendColors,"value",n)).length>0?w.push({value:b[0].value?b[0].value:"",length:b[0].value?b[0].value.toString().length:0,color:b[0].color}):w.push({value:n?n.toString():"",length:n?n.toString().length:0,color:a>e.colors.length?e.randColor():e.colors[a]})}),w.sort(function(e,t){return e.value<t.value?-1:e.value>t.value?1:0});break;case"manual":t.manualLegendValues.forEach(function(n,a){n&&((v=e.filterSensitive(t.legend.legendColors,"value",n)).length>0?w.push({value:v[0].value?v[0].value:"",length:v[0].value?v[0].value.length:0,color:v[0].color}):w.push({value:n.toString(),length:n.toString().length,color:a>e.colors.length?e.randColor():e.colors[a]}))}),w.sort(function(e,t){return e.value<t.value?-1:e.value>t.value?1:0});break;case"map":if(t.legend.animLegend)F=t.legend.animLegend;else switch(t.type){case"standardMap":case"tileMap":case"contCartogram":F=e.getUniqueValues(t.data,t.series[0].valueField);break;case"ddCartogram":if(""===t.series[0].colorField)return;F=e.getUniqueValues(t.data,t.series[0].colorField);break;default:if(""===t.series[0].groupField)return;F=e.getUniqueValues(t.data,t.series[0].groupField)}F.forEach(function(n,a){(b=e.filterSensitive(t.legend.legendColors,"value",n)).length>0?w.push({value:b[0].value?b[0].value:"",length:b[0].value?b[0].value.toString().length:0,color:b[0].color}):w.push({value:n?n.toString():"",length:n?n.toString().length:0,color:a>e.colors.length?e.randColor():e.colors[a]})}),w.sort(function(e,t){return e.value<t.value?-1:e.value>t.value?1:0});break;default:if("bubbleForce"===t.type){if(""===t.series[0].groupField)return;(F=e.getUniqueValues(t.data,t.series[0].groupField)).forEach(function(n,a){(b=e.filterSensitive(t.legend.legendColors,"value",n)).length>0?w.push({value:b[0].value?b[0].value:"",length:b[0].value?b[0].value.toString().length:0,color:b[0].color}):w.push({value:n?n.toString():"",length:n?n.toString().length:0,color:a>e.colors.length?e.randColor():e.colors[a]})}),w.sort(function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}),w.forEach(function(n,a){0===(b=e.filterSensitive(t.legend.legendColors,"value",n.value)).length&&t.legend.legendColors.push(n)})}else{t.data.sort(function(e,n){return e[t.xField]<n[t.xField]?-1:e[t.xField]>n[t.xField]?1:0}),t.extractSerieNamesFromData().forEach(function(n){if(n.serie)if(n.serie.title&&""!==n.serie.title?b=n.serie.title:n.serie.yField&&""!==n.serie.yField?b=n.serie.yField:n.serie.valueField&&""!==n.serie.valueField?b=n.serie.valueField:n.serie.measureField&&""!==n.serie.measureField&&(b=n.serie.measureField),(v=e.filterSensitive(t.legend.legendColors,"value",b)).length>0){let e=v[0].text||v[0].value;w.push({value:e?e.toString():"",length:e?e.toString().length:0,color:n.serie.color})}else w.push({value:b?b.toString():"",length:b?b.toString().length:0,color:n.serie.color})})}break}t.legendValues=w,c.legendValues=w,m="",g=0,c.legendValues.sort(function(t,n){let a=e.getType(t.value);return isNaN(t.value)?"string"===a?t.value<n.value?-1:t.value>n.value?1:0:"date"===a?new Date(t.value)-new Date(n.value):t.value-n.value:parseFloat(t.value)-parseFloat(n.value)}),c.legendValues.forEach(function(e){e.width=Y(e.value).width+t.legend.fontSize+2*x,e.length>g&&(m=e.value,g=e.length)});let a=c.svg.selectAll(".eve-legend-icon").data(c.legendValues);a.attr("class","eve-legend-icon update"),a.exit().remove(),c.icons=a.enter().append("rect").attr("class","eve-legend-icon").attr("width",t.legend.fontSize).attr("height",t.legend.fontSize).style("cursor",n.onClickEnabled?"pointer":"auto").on("click",function(e,a){e.clicked?(e.clicked=null,t.interactSerie(a,null,1,e)):(e.clicked=!0,t.interactSerie(a,!0,1,e)),t.legendClick&&n.onClickEnabled&&t.legendClick(e,a),t.onLegendClick&&t.onLegendClick("legend")}).merge(a).style("fill",function(e,t){return e.color});let l=c.svg.selectAll(".eve-legend-text").data(c.legendValues);switch(l.attr("class","eve-legend-text update"),l.exit().remove(),c.texts=l.enter().append("text").attr("class","eve-legend-text").style("font-size",t.legend.fontSize+"px").style("fill",t.legend.fontColor).style("font-family",t.legend.fontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==t.legend.fontStyle?"normal":t.legend.fontStyle).style("font-weight","bold"==t.legend.fontStyle?"bold":"normal").style("cursor",n.onClickEnabled?"pointer":"auto").on("click",function(e,a){e.clicked?(e.clicked=null,t.interactSerie(a,null,1,e)):(e.clicked=!0,t.interactSerie(a,!0,1,e)),t.legendClick&&n.onClickEnabled&&t.legendClick(e,a),t.onLegendClick&&t.onLegendClick("legend")}).merge(l).text(function(e,t){return e.value}),c.icons.attr("transform",function(e,n){switch(t.legend.position){case"left":case"right":A=0,k=n*c.singleHeight;break;default:k=0,A=d3.sum(c.legendValues,function(e,t){return t<n?e.width:0});break}return"translate("+A+", "+k+")"}),c.texts.attr("transform",function(e,n){switch(t.legend.position){case"left":case"right":A=t.legend.fontSize+x,k=n*c.singleHeight+c.singleHeight/2;break;default:k=c.singleHeight/2,A=d3.sum(c.legendValues,function(e,t){return t<n?e.width:0})+t.legend.fontSize+x;break}return"translate("+A+", "+k+")"}),C=c.svg.node().getBoundingClientRect(),t.legend.position){case"left":case"right":o=o<C.width?C.width:o,r+=C.height;break;default:o+=C.width,r=r<C.height?C.height:r;break}c.height=C.height,c.width=C.width}function G(n){switch(t.masterType){case"map":switch(t.type){case"ddCartogram":if(""===t.series[0].colorField)return;break;default:break}break;default:break}if("multiples"===t.type)switch(t.series[0].type){case"ddCartogram":if(""===t.series[0].colorField)return;break}let a="";switch(g=0,t.legend.rangeList.forEach(function(n,l){n.text.length>g&&(m=n.text,g=n.text.length),(a=e.formatNumber(n.maxValue,t.legend.numberFormat).toString()).length>g&&(m=a,g=a.length)}),t.legend.position){case"left":case"right":y=Y(m),d.width=d.dimension+2*x+y.width,d.height=u.maxHeight-s.top-s.bottom-r-(n.legendSpace?x:0)-5,d.blockHeight=d.height/t.legend.rangeList.length,d.blockWidth=d.dimension;break;default:d.width=u.maxWidth-s.right-s.left-o-(n.legendSpace?x:0)-5,d.blockWidth=d.width/t.legend.rangeList.length,y=function(e,n){return h=l.append("text").style("font-size",t.legend.fontSize+"px").style("fill",t.legend.fontColor).style("font-family",t.legend.fontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==t.legend.fontStyle?"normal":t.legend.fontStyle).style("font-weight","bold"==t.legend.fontStyle?"bold":"normal").text(e),t.wrapText(h,n),S=h.node().getBoundingClientRect(),h.remove(),S}(m,d.blockWidth),d.height=d.dimension+y.height+2*x,d.blockHeight=d.dimension;break}d.svg=l.append("g"),d.svg.selectAll(".eve-legend-icon").data(t.legend.rangeList).enter().append("rect").attr("class",function(e,t){return"ranged-"+t}).attr("width",d.blockWidth).attr("height",d.blockHeight).style("cursor",n.onClickEnabled?"pointer":"auto").style("fill",function(t,n){return t.color&&""!==t.color?t.color:e.colors[n]}).attr("transform",function(e,n){switch(t.legend.position){case"left":case"right":A=0,k=n*d.blockHeight;break;default:A=n*d.blockWidth,k=0;break}return"translate("+A+","+k+")"}).on("click",function(e,n){t.onLegendClick&&t.onLegendClick("legend")}).on("mouseenter",function(e,a){t.onLegendHover&&n.onClickEnabled&&t.onLegendHover(e,a,!0)}).on("mouseleave",function(e,a){t.onLegendHover&&n.onClickEnabled&&t.onLegendHover(e,a,!1)});let i=d.svg.selectAll(".eve-legend-text").data(t.legend.rangeList).enter().append("text").style("font-size",t.legend.fontSize+"px").style("fill",t.legend.fontColor).style("font-family",t.legend.fontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==t.legend.fontStyle?"normal":t.legend.fontStyle).style("font-weight","bold"==t.legend.fontStyle?"bold":"normal").style("cursor",n.onClickEnabled?"pointer":"auto").style("text-anchor",function(){switch(t.legend.position){case"left":case"right":return"start";default:return"middle"}}).text(function(e){return e.text}).attr("transform",function(e,n){switch(t.legend.position){case"left":case"right":A=d.blockWidth+x,k=n*d.blockHeight+d.blockHeight/2;break;default:A=n*d.blockWidth+d.blockWidth/2,k=d.blockHeight+y.height;break}return"translate("+A+","+k+")"}).on("click",function(e,a){t.legendClick&&n.onClickEnabled&&t.legendClick(e,a),t.onLegendClick&&t.onLegendClick("legend")});switch(d.svg.selectAll(".eve-legend-line").data(t.legend.rangeList).enter().append("rect").attr("width",function(){switch(t.legend.position){case"left":case"right":return d.blockWidth+x;default:return 2}}).attr("height",function(){switch(t.legend.position){case"left":case"right":return 2;default:return d.blockHeight+x}}).style("fill","rgb(0,0,0)").attr("transform",function(e,n){switch(t.legend.position){case"left":case"right":A=0,k=n*d.blockHeight;break;default:A=n*d.blockWidth,k=0;break}return"translate("+A+","+k+")"}),d.svg.append("rect").attr("width",function(){switch(t.legend.position){case"left":case"right":return d.blockWidth+x;default:return 2}}).attr("height",function(){switch(t.legend.position){case"left":case"right":return 2;default:return d.blockHeight+x}}).style("fill","rgb(0,0,0)").attr("transform",function(){switch(t.legend.position){case"left":case"right":A=0,k=d.blockHeight*t.legend.rangeList.length-2;break;default:A=d.blockWidth*t.legend.rangeList.length-2,k=0;break}return"translate("+A+","+k+")"}),d.svg.selectAll(".eve-legend-icon").data(t.legend.rangeList).enter().append("text").attr("class","eve-legend-icon").style("font-size",t.legend.fontSize+"px").style("fill",t.legend.fontColor).style("font-family",t.legend.fontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==t.legend.fontStyle?"normal":t.legend.fontStyle).style("font-weight","bold"==t.legend.fontStyle?"bold":"normal").style("text-anchor",function(e,n){switch(t.legend.position){case"left":case"right":return"start";default:return 0===n?"start":"middle"}}).text(function(n){return e.formatNumber(n.minValue,t.legend.numberFormat)}).attr("transform",function(e,n){switch(t.legend.position){case"left":case"right":A=d.blockWidth+x+1,k=0===n?n*d.blockHeight+t.legend.fontSize:n*d.blockHeight+t.legend.fontSize/2;break;default:A=n*d.blockWidth,k=d.blockHeight+y.height+1;break}return"translate("+A+","+k+")"}),d.svg.append("text").attr("class","eve-legend-icon").style("font-size",t.legend.fontSize+"px").style("fill",t.legend.fontColor).style("font-family",t.legend.fontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==t.legend.fontStyle?"normal":t.legend.fontStyle).style("font-weight","bold"==t.legend.fontStyle?"bold":"normal").style("text-anchor",function(){switch(t.legend.position){case"left":case"right":return"start";default:return"end"}}).text(e.formatNumber(t.legend.rangeList[t.legend.rangeList.length-1].maxValue,t.legend.numberFormat)).attr("transform",function(){switch(t.legend.position){case"left":case"right":A=d.blockWidth+x+1,k=d.blockHeight*t.legend.rangeList.length+t.legend.fontSize-y.height;break;default:A=d.blockWidth*t.legend.rangeList.length+t.legend.fontSize-y.height,k=d.blockHeight+y.height+1;break}return"translate("+A+","+k+")"}),t.legend.position){case"top":case"bottom":{let e=[];d.svg.selectAll(".eve-legend-icon").each(function(t){e.push(this.getBoundingClientRect().width)}),i.each(function(n,a){let l=5;0===a?l+=Math.max(e[a],e[a+1]/2):a+2===e.length?l+=Math.max(e[a]/2,e[a+1]):l+=Math.max(e[a]/2,e[a+1]/2),l*=2,t.wrapText(d3.select(this),d.blockWidth-l)})}break}switch(C=d.svg.node().getBoundingClientRect(),t.legend.position){case"left":case"right":d.height=C.height+(n.legendSpace?x:0),d.width=C.width,o=o<d.width?d.width:o,r+=d.height;break;default:d.height=C.height,d.width=C.width+(n.legendSpace?x:0),o+=d.width,r=r<d.height?d.height:r;break}}function D(){switch(t.legend.position){case"left":case"right":o=o<d.width?d.width:o,r+=d.height;break;default:o+=d.width,r=r<d.height?d.height:r;break}}function I(n){let i=[t.legend.fontColor,t.legend.fontColor];switch(t.masterType){case"map":switch(t.type){case"ddCartogram":if(""===t.series[0].colorField)return;p.minMax=[t.domains.minColor,t.domains.maxColor];break;case"contCartogram":""===t.series[0].colorField?p.minMax=[t.domains.minY,t.domains.maxY]:p.minMax=[t.domains.minColor,t.domains.maxColor];break;case"densityMap":p.minMax=["",""];break;default:p.minMax=[t.domains.minY,t.domains.maxY],t.yAxis.min&&(p.minMax[0]=t.yAxis.min),t.yAxis.max&&(p.minMax[1]=t.yAxis.max);break}break;default:p.minMax=[t.domains.minY,t.domains.maxY],t.yAxis.min&&(p.minMax[0]=t.yAxis.min),t.yAxis.max&&(p.minMax[1]=t.yAxis.max);break}if("multiples"===t.type)switch(t.series[0].type){case"ddCartogram":if(""===t.series[0].colorField)return;p.minMax=[t.domains.minColor,t.domains.maxColor];break;case"contCartogram":""===t.series[0].colorField?p.minMax=[t.domains.minY,t.domains.maxY]:p.minMax=[t.domains.minColor,t.domains.maxColor];break;case"densityMap":p.minMax=["",""];break;default:null!=t.yAxis.min&&null!=t.yAxis.max&&(p.minMax=[t.yAxis.min,t.yAxis.max]);break}switch("multiples"===t.type&&(V(),p.minMax=[T,M]),m=e.formatNumber(p.minMax[1],t.legend.numberFormat),p.percentage=Math.ceil(100/(t.legend.gradientColors.length-1)),y=Y(m),p.svg=l.append("g"),t.legend.position){case"left":case"right":p.width=p.dimension+2*x+y.width,p.height=u.maxHeight-s.top-s.bottom-r-(n.legendSpace?x:0)-5,p.blockHeight=p.height,p.blockWidth=p.dimension,p.gradient=a.append("defs").append("linearGradient").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%").attr("id","gradient"+t.container);break;default:p.width=u.maxWidth-s.right-s.left-o-(n.legendSpace?x:0)-5,p.height=Math.max(p.dimension,y.height)+2*x,p.blockHeight=Math.max(p.dimension,y.height),p.blockWidth=p.width,p.gradient=a.append("defs").append("linearGradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").attr("id","gradient"+t.container),t.legend.smartLabels&&(i[0]=t.getAutoColor(t.legend.gradientColors[0]),i[1]=t.getAutoColor(t.legend.gradientColors[t.legend.gradientColors.length-1]));break}switch(p.gradient.selectAll("stop").data(t.legend.gradientColors).enter().append("stop").attr("offset",function(e,n){return n===t.legend.gradientColors.length-1?"100%":n*p.percentage+"%"}).attr("stop-color",function(e){return e}),p.svg.append("rect").attr("width",p.blockWidth).attr("height",p.blockHeight).on("click",function(){t.onLegendClick&&t.onLegendClick("legend")}).style("fill","url(#gradient"+t.container+")"),p.minLabel=p.svg.append("text").style("font-size",t.legend.fontSize+"px").style("fill",i[0]).style("font-family",t.legend.fontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==t.legend.fontStyle?"normal":t.legend.fontStyle).style("font-weight","bold"==t.legend.fontStyle?"bold":"normal").style("text-anchor","start").on("click",function(){t.onLegendClick&&t.onLegendClick("legend")}).text(e.formatNumber(p.minMax[0],t.legend.numberFormat)).attr("transform",function(e,n){switch(t.legend.position){case"left":case"right":A=p.blockWidth+x,k=y.height;break;default:A=3,k=p.blockHeight-3;break}return"translate("+A+","+k+")"}),p.maxLabel=p.svg.append("text").style("font-size",t.legend.fontSize+"px").style("fill",i[1]).style("font-family",t.legend.fontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==t.legend.fontStyle?"normal":t.legend.fontStyle).style("font-weight","bold"==t.legend.fontStyle?"bold":"normal").style("text-anchor",function(){switch(t.legend.position){case"left":case"right":return"start";default:return"end"}}).on("click",function(){t.onLegendClick&&t.onLegendClick("legend")}).text(e.formatNumber(p.minMax[1],t.legend.numberFormat)).attr("transform",function(e,n){switch(t.legend.position){case"left":case"right":A=p.blockWidth+x,k=p.blockHeight+t.legend.fontSize-y.height;break;default:A=p.blockWidth-3,k=p.blockHeight-3;break}return"translate("+A+","+k+")"}),C=p.svg.node().getBoundingClientRect(),t.legend.position){case"left":case"right":p.height=C.height+(n.legendSpace?x:0),p.width=C.width,o=o<p.width?p.width:o,r+=p.height;break;default:p.height=C.height,p.width=C.width+(n.legendSpace?x:0),o+=p.width,r=r<p.height?p.height:r;break}}function Z(){switch(t.masterType){case"map":switch(t.type){case"ddCartogram":if(""===t.series[0].colorField)return;p.minMax=[t.domains.minColor,t.domains.maxColor];break;case"contCartogram":""===t.series[0].colorField?p.minMax=[t.domains.minY,t.domains.maxY]:p.minMax=[t.domains.minColor,t.domains.maxColor];break;case"densityMap":p.minMax=["",""];break;default:p.minMax=[t.domains.minY,t.domains.maxY],t.yAxis.min&&(p.minMax[0]=t.yAxis.min),t.yAxis.max&&(p.minMax[1]=t.yAxis.max);break}break;default:p.minMax=[t.domains.minY,t.domains.maxY],t.yAxis.min&&(p.minMax[0]=t.yAxis.min),t.yAxis.max&&(p.minMax[1]=t.yAxis.max);break}if("multiples"===t.type)switch(t.series[0].type){case"ddCartogram":if(""===t.series[0].colorField)return;p.minMax=[t.domains.minColor,t.domains.maxColor];break;case"contCartogram":""===t.series[0].colorField?p.minMax=[t.domains.minY,t.domains.maxY]:p.minMax=[t.domains.minColor,t.domains.maxColor];break;case"densityMap":p.minMax=["",""];break;default:null!=t.yAxis.min&&null!=t.yAxis.max&&(p.minMax=[t.yAxis.min,t.yAxis.max]);break}switch(p.minLabel.text(e.formatNumber(p.minMax[0],t.legend.numberFormat)),p.maxLabel.text(e.formatNumber(p.minMax[1],t.legend.numberFormat)),t.legend.position){case"left":case"right":o=o<p.width?p.width:o,r+=p.height;break;default:o+=p.width,r=r<p.height?p.height:r;break}}function P(){let n=0;for(f.rScale=d3.scalePow().exponent(.5).domain([t.domains.minY,t.domains.maxY]).range([t.domains.minY===t.domains.maxY?t.series[0].maxBulletSize:t.series[0].minBulletSize,t.series[0].maxBulletSize]),f.band=(t.domains.maxY-t.domains.minY)/(t.legend.circleCount-1),n=f.rScale(t.domains.maxY),f.legendValues.push({value:e.formatNumber(t.domains.maxY,t.legend.numberFormat),radius:n}),i=1;i<t.legend.circleCount;i++)n-f.rScale(t.domains.maxY-f.band*i)>t.legend.fontSize/2?(n=f.rScale(t.domains.maxY-f.band*i),f.legendValues.push({value:e.formatNumber(t.domains.maxY-f.band*i,t.legend.numberFormat),radius:f.rScale(t.domains.maxY-f.band*i)})):f.legendValues.push({value:"",radius:0});switch(n===f.rScale(t.domains.maxY)&&(f.legendValues[0].value="",f.legendValues[0].radius=0),m="",g=0,f.legendValues.forEach(function(e){e.value.toString().length>g&&(m=e.value.toString(),g=e.value.toString().length)}),y=Y(m),f.width=y.width+2*t.series[0].maxBulletSize+2*x,f.height=2*t.series[0].maxBulletSize+t.legend.fontSize/2,t.legend.position){case"left":case"right":o=o<f.width?f.width:o,r+=f.height;break;default:o+=f.width,r=r<f.height?f.height:r;break}switch(f.svg=l.append("g"),t.series[0].tileIcon){case"circle":f.icons=f.svg.selectAll(".eve-legend-scaled-circle").data(f.legendValues).enter().append("circle").attr("class","eve-legend-scaled-circle").style("stroke","black").style("stroke-width",1).attr("r",function(e){return e.radius});break;case"square":f.icons=f.svg.selectAll(".eve-legend-scaled-circle").data(f.legendValues).enter().append("rect").attr("class","eve-legend-scaled-circle").style("stroke","black").style("stroke-width",1).attr("width",function(e){return 2*e.radius}).attr("height",function(e){return 2*e.radius});break;default:f.icons=f.svg.selectAll(".eve-legend-scaled-circle").data(f.legendValues).enter().append("circle").attr("class","eve-legend-scaled-circle").style("stroke","black").style("stroke-width",1).attr("r",function(e){return e.radius})}f.lines=f.svg.selectAll(".eve-legend-scaled-line").data(f.legendValues).enter().append("line").attr("class","eve-legend-scaled-line").style("stroke","black").style("stroke-width",1),f.texts=f.svg.selectAll(".eve-legend-scaled-text").data(f.legendValues).enter().append("text").attr("class","eve-legend-scaled-text").style("font-size",t.legend.fontSize+"px").style("fill",t.legend.fontColor).style("font-family",t.legend.fontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==t.legend.fontStyle?"normal":t.legend.fontStyle).style("font-weight","bold"==t.legend.fontStyle?"bold":"normal").style("cursor","pointer").text(function(e){return e.value}),f.icons.on("click",function(){t.onLegendClick&&t.onLegendClick("legend")}).attr("transform",function(e,n){return k="square"===t.series[0].tileIcon?t.series[0].maxBulletSize-2*e.radius:t.series[0].maxBulletSize-e.radius,"translate("+(A="square"===t.series[0].tileIcon?2*(t.series[0].maxBulletSize-e.radius):t.series[0].maxBulletSize)+", "+k+")"}),f.lines.attr("x1",function(e){return""===e.value?0:"square"===t.series[0].tileIcon?2*t.series[0].maxBulletSize:t.series[0].maxBulletSize}).attr("y1",function(e){return t.series[0].maxBulletSize-2*e.radius}).attr("x2",function(e){return""===e.value?0:2*t.series[0].maxBulletSize+x}).attr("y2",function(e){return t.series[0].maxBulletSize-2*e.radius}),f.texts.on("click",function(){t.onLegendClick&&t.onLegendClick("legend")}).attr("transform",function(e,n){return A=2*t.series[0].maxBulletSize+2*x,k=t.series[0].maxBulletSize-2*e.radius+t.legend.fontSize/2,"translate("+A+", "+k+")"})}function O(){let n=0;for(f.rScale=d3.scalePow().exponent(.5).domain([t.domains.minY,t.domains.maxY]).range([t.domains.minY===t.domains.maxY?t.series[0].maxBulletSize:t.series[0].minBulletSize,t.series[0].maxBulletSize]),f.band=(t.domains.maxY-t.domains.minY)/(t.legend.circleCount-1),n=f.rScale(t.domains.maxY),f.legendValues[0].value=e.formatNumber(t.domains.maxY,t.legend.numberFormat),f.legendValues[0].radius=n,i=1;i<t.legend.circleCount;i++)n-f.rScale(t.domains.maxY-f.band*i)>t.legend.fontSize/2?(n=f.rScale(t.domains.maxY-f.band*i),f.legendValues[i].value=e.formatNumber(t.domains.maxY-f.band*i,t.legend.numberFormat),f.legendValues[i].radius=f.rScale(t.domains.maxY-f.band*i)):(f.legendValues[i].value="",f.legendValues[i].radius=0);switch(n===f.rScale(t.domains.maxY)&&(f.legendValues[0].value="",f.legendValues[0].radius=0),m="",g=0,f.legendValues.forEach(function(e){e.value.toString().length>g&&(m=e.value.toString(),g=e.value.toString().length)}),y=Y(m),f.width=y.width+2*t.series[0].maxBulletSize+2*x,f.height=2*t.series[0].maxBulletSize+t.legend.fontSize/2,t.legend.position){case"left":case"right":o=o<f.width?f.width:o,r+=f.height;break;default:o+=f.width,r=r<f.height?f.height:r;break}switch(f.icons.on("click",function(){t.onLegendClick&&t.onLegendClick("legend")}).data(f.legendValues),t.series[0].tileIcon){case"circle":f.icons.transition().duration(t.animation.duration).ease(t.animation.easing.toEasing()).attr("r",function(e){return e.radius}).attr("transform",function(e,n){return k=t.series[0].maxBulletSize-e.radius,"translate("+(A=t.series[0].maxBulletSize)+", "+k+")"});break;case"square":f.icons.transition().duration(t.animation.duration).ease(t.animation.easing.toEasing()).attr("width",function(e){return 2*e.radius}).attr("height",function(e){return 2*e.radius}).attr("transform",function(e,n){return k=t.series[0].maxBulletSize-2*e.radius,"translate("+(A=2*(t.series[0].maxBulletSize-e.radius))+", "+k+")"});break;default:f.icons.transition().duration(t.animation.duration).ease(t.animation.easing.toEasing()).attr("r",function(e){return e.radius}).attr("transform",function(e,n){return k=t.series[0].maxBulletSize-e.radius,"translate("+(A=t.series[0].maxBulletSize)+", "+k+")"})}f.lines.data(f.legendValues),f.lines.transition().duration(t.animation.duration).ease(t.animation.easing.toEasing()).attr("x1",function(e){return""===e.value?0:"square"===t.series[0].tileIcon?2*t.series[0].maxBulletSize:t.series[0].maxBulletSize}).attr("y1",function(e){return t.series[0].maxBulletSize-2*e.radius}).attr("x2",function(e){return""===e.value?0:2*t.series[0].maxBulletSize+x}).attr("y2",function(e){return t.series[0].maxBulletSize-2*e.radius}),f.texts.on("click",function(){t.onLegendClick&&t.onLegendClick("legend")}).data(f.legendValues),f.texts.transition().duration(t.animation.duration).ease(t.animation.easing.toEasing()).text(function(e){return e.value}).attr("transform",function(e,n){return A=2*t.series[0].maxBulletSize+2*x,k=t.series[0].maxBulletSize-2*e.radius+t.legend.fontSize/2,"translate("+A+", "+k+")"})}function Y(e){return h=l.append("text").style("font-size",t.legend.fontSize+"px").style("fill",t.legend.fontColor).style("font-family",t.legend.fontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==t.legend.fontStyle?"normal":t.legend.fontStyle).style("font-weight","bold"==t.legend.fontStyle?"bold":"normal").text(e),S=h.node().getBoundingClientRect(),h.remove(),S}if(t.legend.enabled){switch(function(){switch(t.legend.position){case"left":n=d3.select("#"+t.container).insert("div","#"+t.innerContainer).attr("id",t.container+"_legend").style("float","left"),d3.select("#"+t.innerContainer).style("float","right"),u.maxHeight=t.plot.height;break;case"right":n=d3.select("#"+t.container).insert("div","#"+t.innerContainer).attr("id",t.container+"_legend").style("float","right"),d3.select("#"+t.innerContainer).style("float","left"),u.maxHeight=t.plot.height;break;case"bottom":n=d3.select("#"+t.container).append("div").attr("id",t.container+"_legend"),u.maxWidth=t.plot.width;break;case"top":n=d3.select("#"+t.container).insert("div","#"+t.innerContainer).attr("id",t.container+"_legend"),u.maxWidth=t.plot.width;break}a=n.append("svg").attr("class","legend_svg").attr("id",t.container+"_legend_svg").attr("fill",t.backColor).attr("stroke","none"),l=a.append("g").attr("transform","translate("+s.left+","+s.top+")")}(),t.legend.type.trim()){case"default":switch(L({onClickEnabled:!0}),t.legend.secondaryType){case"default":break;case"ranged":G({onClickEnabled:!0,legendSpace:!0});break;case"gradient":I({legendSpace:!0});break;case"scaled":P();break}break;case"ranged":switch(t.legend.secondaryType){case"default":L({onClickEnabled:!1}),z=!0;break;case"ranged":break;case"gradient":break;case"scaled":P(),z=!0;break}G({onClickEnabled:!0,legendSpace:z});break;case"gradient":switch(t.legend.secondaryType){case"default":L({onClickEnabled:!1}),z=!0;break;case"ranged":break;case"gradient":break;case"scaled":P(),z=!0;break}I({legendSpace:z});break;case"scaled":switch(P(),t.legend.secondaryType){case"default":L({onClickEnabled:!1});break;case"ranged":G({onClickEnabled:!0,legendSpace:!0});break;case"gradient":I({legendSpace:!0});break;case"scaled":break}}c.svg||d.svg||p.svg||f.svg?function(){switch(o+=s.left+s.right,r+=s.top+s.bottom,n.style("overflow","hidden"),t.legend.position){case"left":case"right":r>u.maxHeight?(u.containerHeight=u.maxHeight,u.svgHeight=r,n.style("overflow-y","auto"),u.containerWidth+=10):(u.containerHeight=u.maxHeight,u.svgHeight=u.maxHeight),o<u.minWidth?(u.containerWidth=u.minWidth,u.svgWidth=u.minWidth):o>u.maxWidth?(u.containerWidth=u.maxWidth,u.svgWidth=o,n.style("overflow-x","auto"),u.containerHeight+=10):(u.containerWidth=o,u.svgWidth=o),t.plot.width-=u.containerWidth;break;case"bottom":case"top":r<u.minHeight?(u.containerHeight=u.minHeight,u.svgHeight=u.minHeight):r>u.maxHeight+3?(u.containerHeight=u.maxHeight,u.svgHeight=r,n.style("overflow-y","auto"),u.containerWidth+=15):(u.containerHeight=r,u.svgHeight=r),o>u.maxWidth+3?(u.containerWidth=u.maxWidth,u.svgWidth=o,n.style("overflow-x","auto"),u.containerHeight+=15):(u.containerWidth=u.maxWidth,u.svgWidth=u.maxWidth),t.plot.height-=u.containerHeight;break}t.svg&&(t.svg.attr("viewBox","0 0 "+t.plot.width+" "+(t.plot.height-t.plot.top)).attr("width",t.plot.width).attr("height",t.plot.height-t.plot.top),e.mobile&&$("#"+t.container+"_svg").css("width",t.plot.width).css("height",t.plot.height-t.plot.top)),n.style("width",u.containerWidth+"px").style("height",u.containerHeight+"px"),a.attr("width",u.svgWidth).attr("height",u.svgHeight),N()}():(n.remove(),d3.select("#"+t.innerContainer).style("float",null))}this.update=function(){if(z=!1,o=0,r=0,t.legend.enabled){switch(t.legend.type){case"default":switch(c.svg&&B({onClickEnabled:!0}),t.legend.secondaryType){case"ranged":z=!0,d.svg&&D();break;case"gradient":z=!0,p.svg&&Z();break;case"scaled":f.svg&&O();break}break;case"ranged":switch(t.legend.secondaryType){case"default":L({onClickEnabled:!1}),z=!0;break;case"scaled":f.svg&&O();break}d.svg&&D();break;case"gradient":if("streamGraph"!==t.type){switch(t.legend.secondaryType){case"default":c.svg&&B({onClickEnabled:!1}),z=!0;break;case"scaled":f.svg&&O();break}p.svg&&Z()}break;case"scaled":switch(f.svg&&O(),t.legend.secondaryType){case"default":c.svg&&B({onClickEnabled:!1});break;case"ranged":d.svg&&D();break;case"gradient":p.svg&&Z();break}break}(c.svg||d.svg||p.svg||f.svg)&&(o+=s.left+s.right,r+=s.top+s.bottom,n.style("overflow","hidden"),r>u.containerHeight?(u.svgHeight=r,n.style("overflow-y","auto")):u.svgHeight=u.containerHeight,o>u.containerWidth?(u.svgWidth=o,n.style("overflow-x","auto")):u.svgWidth=u.containerWidth,a.attr("width",u.svgWidth).attr("height",u.svgHeight),N())}}}e.createLegend=function(e){return new t(e)}}(eve),function(e){function t(e){let t=d3.select("#eveTooltip");null===t.node()&&(t=d3.select("body").append("div").attr("id","eveTooltip").style("position","absolute").style("display","none").style("z-index",1e7).style("box-shadow","0 3px 6px rgba(0, 0, 0, .15)")),this.show=function(){let n=null,a=parseInt(d3.event.pageX+5),l=parseInt(d3.event.pageY+5);switch(arguments.length){case 0:return;case 1:n=arguments[0].toString().replaceAll("\n","<br>");break;case 2:n=arguments[0],a=arguments[1];break;case 3:n=arguments[0],a=arguments[1],l=arguments[2]}n=n.toString().replaceAll("\n","<br>"),e.tooltip.enabled&&""!==n&&null!==t&&(t.style("background-color",e.tooltip.backColor).style("border-style",e.tooltip.borderStyle).style("border-color",e.tooltip.borderColor).style("border-radius",e.tooltip.borderRadius+"px").style("border-width",e.tooltip.borderSize+"px").style("color",e.tooltip.fontColor).style("font-family",e.tooltip.fontFamily).style("font-size",e.tooltip.fontSize+"px").style("padding-left",e.tooltip.padding+"px").style("padding-top",e.tooltip.padding+"px").style("padding-right",e.tooltip.padding+"px").style("padding-bottom",e.tooltip.padding+"px"),"bold"==e.tooltip.fontStyle?t.style("font-weight","bold").style("font-style","normal"):t.style("font-weight","normal").style("font-style",e.tooltip.fontStyle),t.html(n).style("left",a+"px").style("top",l+"px").style("display","block"))},this.hide=function(){t.html("").style("display","none")}}eve.createTooltip=function(e){return new t(e)}}(),function(e){function t(t){t.__baseChartType="xy";let n=e.initVis(t),a=null,l=[],i=null,o=null,r=null,s=null,u=n.series[0],d=[],c=null,p=0,f=0,m=null,g=n.type,h="auto"===u.labelFontSize?11:u.labelFontSize,y=("barChart"===t.type||t.type,null);switch(n.type){case"radarChart":a=e.initRadarAxis(n);break;case"combinationChart":a=e.initCombinationAxis(n);break;default:a=e.initClassicalAxis(n);break}let x=function(){let e=[];return n.series.length?n.series.forEach(function(t){-1===e.indexOf(t.yField)&&e.push(t.yField)}):e=n.serieNames,e}(),b=function(t){for(let a=0;a<n.series.length;a++)if(n.series[a].yField===t)return e.clone(n.series[a]);return null},v=function(e){let t=0;for(let a=0;a<n.series.length;a++)n.series[a].yField===e&&(t=a);return t},F=function(){let e=!1;return"barChart"!==n.type&&"columnChart"!==n.type||(e=!0),e},w=function(){null!==n.xAxis.min&&(n.data=n.data.filter(function(e){return e[n.xField]>=n.xAxis.min})),null!==n.xAxis.max&&(n.data=n.data.filter(function(e){return e[n.xField]<=n.xAxis.max}));switch(n.type){case"abacus":l=[],n.extractSerieNamesFromData().forEach(function(t,a){let i=t.serieName,o=[];n.data.forEach(function(t,n){for(var l in t)t._serieIndex=a,l===i&&o.push(e.clone(t))}),o.index=a,o.name=i,l.push(o)});break;case"streamGraph":{let e=d3.stack().order(d3.stackOrderNone).offset(d3.stackOffsetWiggle);l=e.keys(x)(n.data);for(let e=0;e<l.length;e++)for(let t=0;t<l[e].length;t++)l[e][t].serie=b(l[e].key),l[e][t].serieIndex=v(l[e].key)}break;default:if(n.yAxis.stacked){!function(){if("full"===n.yAxis.stackType)for(let e=0;e<n.data.length;e++){let t=0,a=0;x.forEach(function(l){a=n.data[e][l]?+n.data[e][l]:0,t+=isNaN(a)?0:a}),x.forEach(function(l){a=n.data[e][l]?+n.data[e][l]:0,currentPercentValue=100*a/t,n.data[e][l]=currentPercentValue})}}();let e=d3.stack();switch(n.type){case"streamGraph":e.offset(d3.stackOffsetWiggle).order(d3.stackOrderInsideOut);break;case"barChart":case"columnChart":case"areaChart":e.offset(d3.stackOffsetDiverging);break}F()||n.data.sort(function(e,t){return"date"===n.xDataTypeOriginal?new Date(e[n.xField])-new Date(t[n.xField]):"string"===n.xDataTypeOriginal?e[n.xField]<t[n.xField]?-1:e[n.xField]>t[n.xField]?1:0:e[n.xField]-t[n.xField]}),l=e.keys(x)(n.data);for(let e=0;e<l.length;e++)for(let t=0;t<l[e].length;t++)l[e][t].serie=b(l[e].key),l[e][t].serieIndex=v(l[e].key)}else l=x.map(function(e,t){let a=b(e);if(a){let t=n.data.map(function(t){let l={x:t[n.xField],y:t[e],size:t[a.sizeField],serieIndex:v(e)};if("string"==typeof l.y){let e=parseFloat(l.y);isNaN(e)?l.y=null:l.y=e}return n.isPSW&&(l[n.xField]=l.x,l[e]=l.y,a.sizeField&&(l[a.sizeField]=l.size)),n.domains.isNegative&&n.yAxis.startsFromZero&&l.y<0&&(l.y=0),l});return F()||t.sort(function(e,t){return"date"===n.xDataTypeOriginal?new Date(e.x)-new Date(t.x):"string"===n.xDataTypeOriginal?e.x<t.x?-1:e.x>t.x?1:0:e.x-t.x}),{columnName:e,serie:a,values:t}}});break}},A=function(t){let a=e.randColor();return a=null!=t.serie?t.serie.color:t[0]&&t[0].serie?t[0].serie.color:null!=t.serieName?n.series[n.getSerieIndexByName(t.serieName)].color:null!=t.serieIndex?n.series[t.serieIndex].color:n.series[t.index].color},k=function(e,t){let a=null!=e.serieIndex?e.serieIndex:t,l="";e.serie&&e.columnName&&(a=n.getSerieIndexByName(e.columnName));let i="eve-vis-series";return null!=a&&(i+=" eve-vis-series-"+a),e.serie&&e.serie.yField?(l=e.serie.yField.toString(),n.columnNames[l]&&(l=n.columnNames[l].toString()),i+=" serie-"+l.toClassSelector()):e.key&&(l=e.key.toString(),n.columnNames[l]&&(l=n.columnNames[l].toString()),i+=" serie-"+l.toClassSelector()),i},S=function(e,t){let a="eve-vis-series",l="";return null!=e.serieIndex&&(a+=" eve-vis-series-"+e.serieIndex),e.serie&&e.serie.yField?(l=e.serie.yField.toString(),n.columnNames[l]&&(l=n.columnNames[l].toString()),a+=" serie-"+l.toClassSelector()):t&&t.yField?(l=t.yField.toString(),n.columnNames[l]&&(l=n.columnNames[l].toString()),a+=" serie-"+l.toClassSelector()):e.serieName&&(l=e.serieName.toString(),n.columnNames[l]&&(l=n.columnNames[l].toString()),a+=" serie-"+l.toClassSelector()),a},C=function(e,t){if(e){let t=!1;null!=e.y&&(t=!0),e.data&&e.serie&&null!=e.data[e.serie.yField]&&(t=!0);let a=null;if(t){switch(n.type){case"areaChart":case"lineChart":d3.select(this).attr("fill-opacity",1);break;case"combinationChart":e.serieKey&&(a=n.series.filter(function(t){return t.yField.toValueKey()===e.serieKey})).length>0&&("line"!==a[0].type&&"area"!==a[0].type||d3.select(this).attr("fill-opacity",1));break}let t=null;a&&a.length?t=a[0]:(null!=e.serie&&(t=e.serie),null!=e.serieIndex&&(t=n.series[e.serieIndex])),t||(t=u),n.showTooltip(n.getContent(e,t,n.tooltip.format))}}},z=function(e,t){if(e){let t=!1;if(null!=e.y&&(t=!0),e.data&&e.serie&&null!=e.data[e.serie.yField]&&(t=!0),t){switch(n.type){case"areaChart":case"lineChart":u.showBullets||d3.select(this).attr("fill-opacity",0);break;case"combinationChart":if(e.serieKey){let t=n.series.filter(function(t){return t.yField.toValueKey()===e.serieKey});t.length>0&&("line"!==t[0].type&&"area"!==t[0].type||d3.select(this).attr("fill-opacity",0))}break}n.hideTooltip()}}},T=function(e,t){let a=null!=e.serieIndex?e.serieIndex:t,l=e.columnName||e.serieKey;n.columnNames[l]&&(l=n.columnNames[l]);let i=l?l.toString().toClassSelector():"";e.serie&&e.columnName?a=n.getSerieIndexByName(e.columnName):e.serieKey&&(a=n.getSerieIndexByName(e.serieKey)),e.clicked?(e.clicked=null,n.svg.selectAll(".eve-vis-series").style("opacity",.85)):(e.clicked=!0,n.svg.selectAll(".eve-vis-series").style("opacity",.1),n.svg.selectAll(".serie-"+i).style("opacity",1))},M=function(e){if(""!==u.sizeField){let t=n.domains.maxSize-n.domains.minSize,a=u.maxBulletSize-u.minBulletSize,l=u.bulletSize;return t&&(l=e.size/t*a-n.domains.minSize/t*a+u.minBulletSize),l}return u.bulletSize},_=function(e,t,l){let i=0,o=0,r=e.data?e.data[n.xField]:e.x,s=e.data?e[1]:e.y,d=M(e),p=0;try{a.xScale.bandwidth?p=a.xScale.bandwidth():a.yScale.bandwidth&&(p=a.yScale.bandwidth())}catch(e){}if(-1===["radarChart","barChart"].indexOf(n.type)){switch(n.xDataType){case"string":i="columnChart"===n.type?a.xScale(r)+a.xScale.bandwidth()/2:a.xScale(r)+p;break;case"date":i=a.xScale(new Date(r));break;default:i=a.xScale(r);break}o=e.serieKey?t?n.domains.minY<0?a.serieScales[e.serieKey](0):n.plot.height:a.serieScales[e.serieKey](s):t?n.domains.minY<0?a.yScale(0):n.plot.height:a.yScale(s)}if(t)switch(o=e.serieKey?a.serieDomains[e.serieKey].min<0?a.serieScales[e.serieKey](0):n.plot.height:n.domains.minY<0?a.yScale(0):n.plot.height,g){case"combinationChart":case"columnChart":if(c)i=c(e.serieName)+c.bandwidth()/2;else switch(n.xDataType){case"string":i=a.xScale(r)+p;break;case"date":i=a.xScale(new Date(r));break;default:i=a.xScale(r);break}break;case"barChart":if(c)i=n.domains.minY<0?a.xScale(0):0,o=c(e.serieName)+c.bandwidth()/2+4;else{let t=e.data[n.xField];switch(n.xDataType){case"string":o=a.yScale(t)+e.bbox.height/2;break;case"date":o=a.yScale(new Date(t))+e.bbox.height/2;break;default:o=a.yScale(t)+e.bbox.height/2;break}i=n.domains.minY<0?a.xScale(0):a.xScale(n.domains.minY)}break;case"abacus":{let t=e[n.xField];switch(n.xDataType){case"string":o=a.yScale(t)+p-2*u.bulletSize;break;case"date":o=a.yScale(new Date(t))-2*u.bulletSize;break;default:o=a.yScale(t)-2*u.bulletSize;break}i=a.xScale(n.domains.minY)}break;case"radarChart":i=a.yScale(0)*Math.cos(a.sliceAngle*l-Math.PI/2),o=a.yScale(0)*Math.sin(a.sliceAngle*l-Math.PI/2);break}else{let t=e.serieKey?a.serieScales[e.serieKey]:a.yScale;switch(o=t(s),"barChart"!==g&&(null!==n.yAxis.min&&s<n.yAxis.min&&(o=t(n.yAxis.min)),null!==n.yAxis.max&&s>n.yAxis.max&&(o=t(n.yAxis.max))),g){case"combinationChart":case"columnChart":c?(i=c(e.serieName)+c.bandwidth()/2,e.serieKey?a.serieDomains[e.serieKey].min<0?s>0?o+=e.fontSize?e.fontSize+5:5:o=a.serieScales[e.serieKey](s)-5:o+=e.fontSize?e.fontSize+5:5:n.domains.minY<0?s>0?o+=e.fontSize?e.fontSize+5:5:o=a.yScale(s)-5:o+=e.fontSize?e.fontSize+5:5):o=e.serieKey?a.serieScales[e.serieKey](e[1])+e.fontSize+5:a.yScale(e[1])+e.fontSize;break;case"barChart":if(c)o=c(e.serieName)+c.bandwidth()/2+4,i=n.domains.minY<0&&e.y<0?a.xScale(0)-e.columnWidth+e.bbox.width/2+5:a.xScale(e.y)-e.bbox.width/2-5;else{let t=e.data[n.xField];switch(n.xDataType){case"string":o=a.yScale(t);break;case"date":o=a.yScale(new Date(t));break;default:o=a.yScale(t);break}o+=(f+e.bbox.height)/2,i=n.domains.minY<0?e.data[e.serie.yField]>0?a.xScale(e[1])-5:a.xScale(0)-Math.abs(a.xScale(e[0])-a.xScale(e[1]))+2*e.bbox.width+5:a.xScale(e[1])-5}break;case"abacus":{let t=e[n.xField];switch(n.xDataType){case"string":o=a.yScale(t)+p/2-2*u.bulletSize;break;case"date":o=a.yScale(new Date(t))-2*u.bulletSize;break;default:o=a.yScale(t)-2*u.bulletSize;break}i=a.xScale(e[n.series[e._serieIndex].yField])}break;case"radarChart":i=a.yScale(e.y)*Math.cos(a.sliceAngle*l-Math.PI/2),(o=a.yScale(e.y)*Math.sin(a.sliceAngle*l-Math.PI/2))<0?o-=u.bulletSize/2+h/2:o+=u.bulletSize+h/2;break;default:o-=d+(u.sizeField?5:0);break}}return isNaN(i)&&(i=0),isNaN(o)&&(o=0),"translate("+i+","+o+")"},E=function(e,t){let l=0,i=0,o=null;"abacus"===n.type?o=n.extractSerieNamesFromData()[e._serieIndex].serie:o=n.series[e._serieIndex];return i="string"===n.xDataType?a.yScale(e[n.xField])+a.yScale.bandwidth()/2:a.yScale(e[n.xField]),l=t?0:a.xScale(e[o.yField]),isNaN(l)&&(l=0),isNaN(i)&&(i=0),"translate("+l+","+i+")"},V=function(e,t){switch(n.type){case"combinationChart":case"columnChart":{let n=c?c.bandwidth()/2:p/2,a=e.getBBox();return t.bbox=a,"auto"===u.labelFontSize?t.fontSize=Math.min(2*n,(2*n-8)/Math.max(e.getComputedTextLength(),a.height)*8):t.fontSize=u.labelFontSize,t.fontSize<8&&(t.fontSize=8),t.fontSize+"px"}break;case"barChart":{let l=c?c.bandwidth():f,i=e.getBBox();return t.bbox=i,n.yAxis.stacked?n.domains.minY<0?t.columnWidth=Math.abs(a.xScale(t[0])-a.xScale(t[1])):t.columnWidth=Math.abs(a.xScale(t[0]-t[1]))-a.xScale(0):n.domains.minY<0?t.columnWidth=Math.abs(a.xScale(t.y)-a.xScale(0)):t.columnWidth=a.xScale(t.y),"auto"===u.labelFontSize?t.fontSize=Math.min(2*l,(2*l-8)/Math.max(e.getComputedTextLength(),i.height)*8):t.fontSize=u.labelFontSize,t.fontSize<8&&(t.fontSize=8),null!=y?t.fontSize=y:y=t.fontSize,t.fontSize+"px"}break}},N=function(e){let t=!0;switch(n.type){case"combinationChart":case"columnChart":t=e.columnHeight>e.fontSize+5;break;case"barChart":n.yAxis.stacked?t=e.columnWidth>e.bbox.width+e.fontSize:(t=e.columnWidth>e.bbox.width+e.fontSize,c.bandwidth()<e.fontSize&&(t=!1));break}return t},L=function(){r=d3.line().x(function(e){switch(n.xDataType){case"string":return a.xScale(e.x)+a.xScale.bandwidth()/2;break;case"date":return a.xScale(new Date(e.x));break;default:return a.xScale(e.x);break}}).y(n.plot.height),"spLine"===u.behavior?r.curve(d3.curveCardinal):"stepLine"===u.behavior&&r.curve(d3.curveStep),n.yAxis.skipEmpty&&r.defined(function(e){return null!=e.y});let e=null;l&&l.length&&(e=l[0].serie||null),i=m.selectAll(".eve-layout-line").data(l).enter().append("g").attr("class","eve-layout-line"),(o=i.append("path").attr("d",function(e){return r(e.values)}).attr("class",k).attr("fill","none").attr("stroke-opacity",1).attr("stroke",A).attr("stroke-width",2).on("click",T)).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("d",function(e){let t=e.values[0];return t.serieKey?r.y(function(e){return t.serieKey?a.serieScales[t.serieKey](e.y?e.y:a.serieDomains[t.serieKey].min):null!==n.yAxis.min&&e.y<n.yAxis.min?a.yScale(n.yAxis.min):null!==n.yAxis.max&&e.y>n.yAxis.max?a.yScale(n.yAxis.max):a.yScale(e.y?e.y:n.domains.minY)}):("spLine"===e.serie.behavior?r.curve(d3.curveCardinal):"stepLine"===e.serie.behavior&&r.curve(d3.curveStep),r.y(function(e){return e.serieKey?a.serieScales[e.serieKey](e.y?e.y:a.serieDomains[e.serieKey].min):null!==n.yAxis.min&&e.y<n.yAxis.min?a.yScale(n.yAxis.min):null!==n.yAxis.max&&e.y>n.yAxis.max?a.yScale(n.yAxis.max):a.yScale(null!=e.y?e.y:n.domains.minY)})),r(e.values)}),l.forEach(function(t,l){m.selectAll(".eve-line-bullet-"+l).data(t.values).enter().append("circle").attr("class","eve-line-bullet-"+l).attr("r",5).attr("cx",function(e){switch(n.xDataType){case"string":return a.xScale(e.x)+a.xScale.bandwidth()/2;break;case"date":return a.xScale(new Date(e.x));break;default:return a.xScale(e.x);break}}).attr("cy",n.plot.height).attr("fill-opacity",function(e){return null!=e.y&&u.showBullets?1:0}).attr("fill",A(t)).on("mousemove",C).on("mouseout",z).on("click",T).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("cy",function(e){let t=e.serieKey?a.serieScales[e.serieKey]:a.yScale,l=t(e.y);return null==e.y?0:e.serieKey?a.serieScales[e.serieKey](e.y?e.y:a.serieDomains[e.serieKey].min):null!==n.yAxis.min&&e.y<n.yAxis.min?t(n.yAxis.min):null!==n.yAxis.max&&e.y>n.yAxis.max?t(n.yAxis.max):isNaN(l)?0:l}),m.selectAll(".eve-line-label-"+l).data(t.values).enter().append("text").attr("class","eve-line-label eve-line-label-"+l).style("text-anchor","middle").style("pointer-events","none").style("fill-opacity",1).style("fill","auto"===u.labelFontColor?"#333333":u.labelFontColor).style("font-size",("auto"===u.labelFontSize?11:u.labelFontSize)+"px").style("font-family",u.labelFontFamily).style("font-style","bold"===u.labelFontStyle?"normal":u.labelFontStyle).style("font-weight","bold"===u.labelFontStyle?"bold":"normal").text(function(t){let a=e||n.series[t.serieIndex];return null!=t.y?n.getContent(t,a,u.labelFormat):""}).attr("transform",function(e){return _(e,!0)}).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("transform",function(e){return _(e,!1)})})},B=function(){l.forEach(function(e,t){let i=t;e.serie&&e.columnName&&(i=n.getSerieIndexByName(e.columnName));let o=null;l&&l.length&&(o=l[0].serie||null),m.selectAll(".eve-vis-series-"+i).data(e.values).enter().append("circle").attr("class",function(t){return S(t,e.serie)}).attr("r",5).attr("cx",function(e){switch(n.xDataType){case"string":return a.xScale(e.x)+a.xScale.bandwidth()/2;break;case"date":return a.xScale(new Date(e.x));break;default:return a.xScale(e.x);break}}).attr("cy",n.plot.height).attr("fill-opacity",function(e){return null!=e.y?1:0}).attr("fill",A(e)).on("mousemove",C).on("mouseout",z).on("click",T).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("cy",function(e){if(null==e.y)return 0;let t=e.serieKey?a.serieScales[e.serieKey](e.y):a.yScale(e.y);return isNaN(t)?0:t}),m.selectAll(".eve-vis-label-"+i).data(e.values).enter().append("text").attr("class","eve-vis-label eve-vis-label-"+i).style("text-anchor","middle").style("pointer-events","none").style("fill-opacity",1).style("fill","auto"===u.labelFontColor?"#333333":u.labelFontColor).style("font-size",("auto"===u.labelFontSize?11:u.labelFontSize)+"px").style("font-family",u.labelFontFamily).style("font-style","bold"===u.labelFontStyle?"normal":u.labelFontStyle).style("font-weight","bold"===u.labelFontStyle?"bold":"normal").text(function(e){let t=o||n.series[e.serieIndex];return null!=e.y?n.getContent(e,t,u.labelFormat):""}).attr("transform",function(e){return _(e,!0)}).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("transform",function(e){return _(e,!1)})})},G=function(e){let t=n.yAxis.stacked;r=d3.area().x(function(e){let l=t?e.data[n.xField]:e.x;switch(n.xDataType){case"string":return a.xScale(l)+a.xScale.bandwidth()/2;break;case"date":return a.xScale(new Date(l));break;default:return a.xScale(l);break}}).y0(function(){return"top"===n.xAxis.position?a.yScale(n.domains.maxY):n.plot.height}).y1(function(){return"top"===n.xAxis.position?a.yScale(n.domains.maxY):n.plot.height}),"spLine"===u.behavior?r.curve(d3.curveCardinal):"stepLine"===u.behavior&&r.curve(d3.curveStep);t?(i=m.selectAll(".eve-layout-area").data(l).enter().append("g").attr("class","eve-layout-area"),(o=i.append("path").attr("d",r).attr("class",k).attr("fill",A).attr("fill-opacity",1).on("click",T)).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",.85).attr("d",function(e){return r.y0(function(e){return isNaN(e[1])?a.yScale(n.domains.minY):"top"===n.xAxis.position?Math.abs(a.yScale(n.domains.minY)-a.yScale(e[0])):a.yScale(e[0]<n.domains.minY?n.domains.minY:e[0])}),r.y1(function(e){return isNaN(e[1])?a.yScale(n.domains.minY):null!==n.yAxis.min&&e[1]<n.yAxis.min?a.yScale(n.yAxis.min):null!==n.yAxis.max&&e[1]>n.yAxis.max?a.yScale(n.yAxis.max):a.yScale(e[1])}),r(e)}),l.forEach(function(e,t){m.selectAll(".eve-area-bullet-"+t).data(e).enter().append("circle").attr("class","eve-area-bullet-"+t).attr("r",5).attr("cx",function(e){let t=e.data[n.xField];switch(n.xDataType){case"string":return a.xScale(t)+a.xScale.bandwidth()/2;break;case"date":return a.xScale(new Date(t));break;default:return a.xScale(t);break}}).attr("cy",n.plot.height).attr("fill-opacity",function(e){return null!=e.data[e.serie.yField]&&u.showBullets?1:0}).attr("fill",A(e)).on("mousemove",C).on("mouseout",z).on("click",T).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("cy",function(e){let t=a.yScale(e[1]),l=e.data[e.serie.yField];return null!==n.yAxis.min&&e[1]<n.yAxis.min&&(t=a.yScale(n.yAxis.min)),null!==n.yAxis.max&&e[1]>n.yAxis.max&&(t=a.yScale(n.yAxis.max)),l?isNaN(t)?0:t:0}),m.selectAll(".eve-area-label-"+t).data(e).enter().append("text").attr("class","eve-area-label eve-area-label-"+t).style("text-anchor","middle").style("pointer-events","none").style("fill-opacity",1).style("fill","auto"===u.labelFontColor?"#333333":u.labelFontColor).style("font-size",("auto"===u.labelFontSize?11:u.labelFontSize)+"px").style("font-family",u.labelFontFamily).style("font-style","bold"===u.labelFontStyle?"normal":u.labelFontStyle).style("font-weight","bold"===u.labelFontStyle?"bold":"normal").text(function(e){return null!=e.data[e.serie.yField]?n.getContent(e,e.serie,u.labelFormat):""}).attr("transform",function(e){return _(e,!0)}).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("transform",function(e){return _(e,!1)})})):function(){"right"===n.yAxis.position&&r.y0(0);let e=null;l&&l.length&&(e=l[0].serie||null),i=m.selectAll(".eve-layout-area").data(l).enter().append("g").attr("class","eve-layout-area"),(o=i.append("path").attr("d",function(e){return r(e.values)}).attr("class",k).attr("fill",A).attr("fill-opacity",1).on("click",T)).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",.85).attr("d",function(e){return n.domains.minY<0&&r.y0(a.yScale(0)),r.y1(function(e){let t=0;return a.yScale?((t=null!=e.y?e.y:n.domains.minY)<n.domains.minY&&(t=n.domains.minY),a.yScale(e.y)):((t=null!=e.y?e.y:a.serieDomains[e.serieKey].min)<a.serieDomains[e.serieKey].min&&(t=a.serieDomains[e.serieKey].min),a.serieScales[e.serieKey](t))}),r(e.values)}),l.forEach(function(t,l){m.selectAll(".eve-area-bullet-"+l).data(t.values).enter().append("circle").attr("class","eve-area-bullet-"+l).attr("r",5).attr("cx",function(e){switch(n.xDataType){case"string":return a.xScale(e.x)+a.xScale.bandwidth()/2;break;case"date":return a.xScale(new Date(e.x));break;default:return a.xScale(e.x);break}}).attr("cy",n.plot.height).attr("fill-opacity",function(e){return null!=e.y&&u.showBullets?1:0}).attr("fill",A(t)).on("mousemove",C).on("mouseout",z).on("click",T).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("cy",function(e){let t=0;return t=a.yScale?a.yScale(e.y):a.serieScales[e.serieKey](e.y),null==e.y?-100:isNaN(t)?0:t}),m.selectAll(".eve-area-label-"+l).data(t.values).enter().append("text").attr("class","eve-area-label eve-area-label-"+l).style("text-anchor","middle").style("pointer-events","none").style("fill-opacity",1).style("fill","auto"===u.labelFontColor?"#333333":u.labelFontColor).style("font-size",("auto"===u.labelFontSize?11:u.labelFontSize)+"px").style("font-family",u.labelFontFamily).style("font-style","bold"===u.labelFontStyle?"normal":u.labelFontStyle).style("font-weight","bold"===u.labelFontStyle?"bold":"normal").text(function(t){let a=e||n.series[t.serieIndex];return null!=t.y?n.getContent(t,a,u.labelFormat):""}).attr("transform",function(e){return _(e,!0)}).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("transform",function(e){return _(e,!1)})})}()},D=function(){let e=n.yAxis.stacked,t=null,r=d3.scaleBand().range([0,n.plot.width]).padding(.1).round(!0).domain(n.domains.xValues);p=r.bandwidth()/2;let d=function(e){return x.map(function(t,a){let l={serieName:t,serieIndex:a,x:e[n.xField],y:+e[t],serieKey:"combinationChart"===n.type?t.toValueKey():null};return n.isPSW&&(l[n.xField]=l.x,l[t]=l.y),l})};e?function(){let e=function(e,l,i){let o=0,r=n.domains.minY<0?a.yScale(0):a.yScale(n.domains.minY);return t(e,l),"top"===n.xAxis.position?(o=i?a.yScale(n.domains.maxY):a.yScale(e[0]),n.domains.minY<0?(o=1===n.series.length&&e[1]<0?a.yScale(0):a.yScale(e[1]),i&&(o=a.yScale(0))):o=i?a.yScale(n.domains.maxY):a.yScale(n.domains.minY)-a.yScale(e[0])):n.domains.minY<0?(o=1===n.series.length&&e[1]<0?a.yScale(0):a.yScale(e[1]),i&&(o=a.yScale(0))):(o=i?r:a.yScale(e[1]),!i&&e[1]<0&&(o=a.yScale(e[1]))),null==o?0:o},t=function(e,t){let l=0,i=e.data[e.serie.yField];return null!=n.yAxis.min&&0===n.yAxis.min&&i<0&&(l=0),e.data[e.serie.yField]?(0===i&&(l=0),l=n.domains.minY<0?Math.abs(a.yScale(e[0])-a.yScale(e[1])):Math.abs(a.yScale(0===e[0]?n.domains.minY:e[0])-a.yScale(e[1]))):l=0,e.columnHeight=l,l};i=m.selectAll(".eve-layout-column").data(l).enter().append("g").attr("class","eve-layout-column").attr("fill",A).attr("fill-opacity",.85),o=i.selectAll("rect").data(function(e){return e}).enter().append("rect").attr("class",S).on("click",T).on("mousemove",C).on("mouseout",z).attr("x",function(e,t){let l=e.data[n.xField];switch(n.xDataType){case"string":return a.xScale(l)+p/2;break;case"date":return a.xScale(new Date(l))-p/2;break;default:return a.xScale(l)-p/2;break}}).attr("width",function(e,t){let a=e.data[n.xField];return null!=n.xAxis.min&&"string"!==n.xDataType&&a<n.domains.minX?0:p}).attr("y",function(t,n){return e(t,n,!0)}).attr("height",0).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("y",function(t,n){return e(t,n,!1)}).attr("height",t),u.labelFormat&&(s=i.selectAll("text").data(function(e){return e}).enter().append("text").style("text-anchor","middle").style("pointer-events","none").style("fill","auto"===u.labelFontColor?n.getAutoColor(u.color):u.labelFontColor).style("font-family",u.labelFontFamily).style("font-style","bold"===u.labelFontStyle?"normal":u.labelFontStyle).style("font-weight","bold"===u.labelFontStyle?"bold":"normal").text(function(e,t){return n.getContent(e,e.serie,u.labelFormat)}).style("font-size",function(e,t){return V(this,e)}).attr("transform",function(e){return _(e,!0)}).attr("opacity",function(e){return"add"===n.animation.effect?0:1}).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("transform",function(e){return _(e,!1)}))}():function(){"combinationChart"===n.type?(x=[],l=[],n.series.forEach(function(e){"column"===e.type&&x.push(e.yField)}),n.data.forEach(function(e){let t={};t[n.xField]=e[n.xField],x.forEach(function(n){t[n]=e[n]}),l.push(t)})):(l=n.data,null!=n.xAxis.min&&"string"!==n.xDataType&&(l=n.data.filter(function(e){if(e[n.xField]>=n.xAxis.min)return e}))),c=d3.scaleBand().domain(x).range([0,p]).round(!1).padding(.05),l&&l.length&&(t=l[0].serie||null);let e=function(e,t){let l=0;switch(n.xDataType){case"string":l=a.xScale(e.x)+p/2+t*c.bandwidth()+1;break;case"date":l=a.xScale(new Date(e.x))+p/2+t*c.bandwidth()+1;break;default:{let i=e.x;null!=n.xAxis.min&&e.x<n.xAxis.min&&(i=n.xAxis.min),null!=n.xAxis.max&&e.x>n.xAxis.max&&(i=n.xAxis.max),l=a.xScale(i)-p/2+t*c.bandwidth()+1}break}return l},i=function(e,t,l){let i=0,o=null,r=0,s=e.y;return e.serieKey?(o=a.serieScales[e.serieKey],currentDomain=a.serieDomains[e.serieKey],r=currentDomain.min):(o=a.yScale,currentDomain=n.domains,r=currentDomain.minY),null!=n.yAxis.min&&e.y<n.yAxis.min&&(s=n.yAxis.min),null!=n.yAxis.max&&e.y>n.yAxis.max&&(s=n.yAxis.max),i=o(l?r<0?0:r:r<0&&s<0?0:s)};o=m.append("g").selectAll("g").data(l).enter().append("g").selectAll("rect").data(d).enter().append("rect").attr("fill",A).attr("class",S).on("click",T).on("mousemove",C).on("mouseout",z).attr("x",e).attr("y",function(e,t){return i(e,0,!0)}).attr("width",c.bandwidth()).attr("height",0).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("y",function(e,t){return i(e)}).attr("height",function(e,t){let l=0,i=null,o=0,r=e.y;return e.serieKey?(i=a.serieScales[e.serieKey],currentDomain=a.serieDomains[e.serieKey],o=currentDomain.min):(i=a.yScale,currentDomain=n.domains,o=currentDomain.minY),null!=n.yAxis.min&&e.y<n.yAxis.min&&(r=n.yAxis.min),null!=n.yAxis.max&&e.y>n.yAxis.max&&(r=n.yAxis.max),l=r?Math.abs((o<0?i(0):n.plot.height)-Math.abs(i(r))):0}),s=m.append("g").selectAll("g").data(l).enter().append("g").selectAll("text").data(d).enter().append("text").style("text-anchor","middle").style("pointer-events","none").style("fill","auto"===u.labelFontColor?n.getAutoColor(u.color):u.labelFontColor).style("font-family",u.labelFontFamily).style("font-style","bold"===u.labelFontStyle?"normal":u.labelFontStyle).style("font-weight","bold"===u.labelFontStyle?"bold":"normal").text(function(e,a){let l=t||n.series[e.serieIndex];return n.getContent(e,l,u.labelFormat)}).style("font-size",function(e,t){return V(this,e)}).attr("transform",function(t,n){let a=e(t,n),l=i(t,0,!0);return"translate("+(a+=this.getBBox().width/2)+","+l+")"}).attr("opacity",function(e){return"add"===n.animation.effect?0:1}).transition().duration(l.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(l.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("transform",function(t,n){let a=e(t,n),l=i(t,0,!1);return l-=t.fontSize,"translate("+(a+=this.getBBox().width/2)+","+l+")"})}()},I=function(){let e=n.yAxis.stacked,t=d3.scaleBand().range([0,n.plot.height]).padding(.1).round(!0).domain(n.domains.xValues);f=t.bandwidth()/2;let r=function(e){return x.map(function(t,a){return{serieName:t,serieIndex:a,x:e[n.xField],y:+e[t]}})};e?function(){let e=function(e,t){let l=e.data[n.xField];switch(n.xDataType){case"string":return a.yScale(l)+f/2;break;case"date":return a.yScale(new Date(l))-f/2;break;default:return a.yScale(l)-f/2;break}},t=function(e,t,l){let i=0,o=n.domains.minY<0?a.xScale(0):a.xScale(n.domains.minY),s=r(e,t);return"right"===n.xAxis.position?i=1===n.series.length?e[1]<0?a.xScale(0)-s:n.domains.minY<0?l?a.xScale(0):a.xScale(e[0]):l?a.xScale(n.domains.maxY):a.xScale(n.domains.maxY)-a.xScale(e[1]):e[0]<0?a.xScale(e[1])-s:n.domains.minY<0?l?a.xScale(0):a.xScale(e[0]):l?a.xScale(n.domains.maxY):a.xScale(n.domains.maxY)-a.xScale(e[1]):(i=l?o:a.xScale(e[0]),e[1]<0&&!l&&(i=a.xScale(0)-r(e,t)),l||null==n.yAxis.min||(i=i<0?a.xScale(n.yAxis.min):a.xScale(e[0]))),null==i?0:i},r=function(e,t){let l=0,i=e.data[e.serie.yField];return null!=n.yAxis.min&&0===n.yAxis.min&&i<0&&(l=0),e.data[e.serie.yField]?(0===i&&(l=0),l=n.domains.minY<0?Math.abs(a.xScale(e[0])-a.xScale(e[1])):Math.abs(a.xScale(0===e[0]?n.domains.minY:e[0])-a.xScale(e[1]))):l=0,1===n.series.length&&(null!=n.yAxis.min&&e[1]<n.yAxis.min&&(l=0),null!=n.yAxis.max&&e[1]>n.yAxis.max&&(l=Math.abs(a.xScale(0===e[0]?n.domains.minY:e[0])-a.xScale(n.yAxis.max)))),e.columnWidth=l,l};i=m.selectAll(".eve-layout-bar").data(l).enter().append("g").attr("class","eve-layout-bar").attr("fill",A).attr("fill-opacity",.85),o=i.selectAll("rect").data(function(e){return e}).enter().append("rect").attr("class",S).on("click",T).on("mousemove",C).on("mouseout",z).attr("x",function(e,n){return t(e,n,!0)}).attr("width",0).attr("y",e).attr("height",function(e){let t=e.data[n.xField];return null!=n.xAxis.min&&"string"!==n.xDataType&&t<n.domains.minX?0:f}).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("x",function(e,n){return t(e,n,!1)}).attr("width",r),u.labelFormat&&(s=i.selectAll("text").data(function(e){return e}).enter().append("text").style("text-anchor","end").style("pointer-events","none").style("fill","auto"===u.labelFontColor?n.getAutoColor(u.color):u.labelFontColor).style("font-family",u.labelFontFamily).style("font-style","bold"===u.labelFontStyle?"normal":u.labelFontStyle).style("font-weight","bold"===u.labelFontStyle?"bold":"normal").text(function(e,t){return n.getContent(e,e.serie,u.labelFormat)}).style("font-size",function(e,t){return V(this,e)}).attr("transform",function(n,a){let l=t(n,a,!0),i=e(n),o=(n.fontSize-5)/2;return"translate("+l+","+(i+=f/2+o)+")"}).attr("opacity",function(e){return"add"===n.animation.effect?0:N(e)?1:0}).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",function(e){return N(e)?1:0}).attr("transform",function(n,a){let l=t(n,a,!1),i=e(n),o=r(n,a)-5,s=(n.fontSize-5)/2;return"translate("+(l+=o)+","+(i+=f/2+s)+")"}))}():function(){l=null!=n.xAxis.min&&"string"!==n.xDataType?n.data.filter(function(e){if(e[n.xField]>=n.xAxis.min)return e}):n.data,c=d3.scaleBand().domain(x).range([0,f]).round(!1).padding(.05);let e=function(e,t,l){let i=0,o=e.y;return d(e,t),null!=n.yAxis.min&&e.y<n.yAxis.min&&(o=n.yAxis.min),null!=n.yAxis.max&&e.y>n.yAxis.max&&(o=n.yAxis.max),i=l?a.xScale(0):(n.xAxis.position,e.y<0?a.xScale(o):a.xScale(0))},i=function(e,t){let l=0;switch(n.xDataType){case"string":l=c(e.serieName)+f/2;break;case"date":l=a.yScale(new Date(e.x))-c.bandwidth()/2+t*c.bandwidth()-f/2;break;default:{let i=e.x;null!=n.xAxis.min&&e.x<n.xAxis.min&&(i=n.xAxis.min),null!=n.xAxis.max&&e.x>n.xAxis.max&&(i=n.xAxis.max),l=a.yScale(i)-c.bandwidth()/2+t*c.bandwidth()-f/2}break}return l},d=function(e,t){let l=0,i=(n.domains.minY,e.y);return null!=n.yAxis.min&&e.y<n.yAxis.min&&(i=n.yAxis.min),null!=n.yAxis.max&&e.y>n.yAxis.max&&(i=n.yAxis.max),e.y&&(l=e.serieKey?Math.abs((a.serieDomains[e.serieKey].min<0?a.serieScales[e.serieKey](0):n.plot.width)-Math.abs(a.serieScales[e.serieKey](i))):e.y<0?Math.abs(a.xScale(e.y)-a.xScale(0)):Math.abs(a.xScale(i))),l};o=m.append("g").selectAll("g").data(l).enter().append("g").attr("transform",function(e){if("string"===n.xDataType)return"translate(0, "+t(e[n.xField])+")"}).selectAll("rect").data(r).enter().append("rect").attr("fill",A).attr("class",S).on("click",T).on("mousemove",C).on("mouseout",z).attr("x",function(t,n){return e(t,n,!0)}).attr("y",i).attr("width",0).attr("height",c.bandwidth()).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("x",function(t,n){return e(t,n)}).attr("width",d),u.labelFormat&&(s=m.append("g").selectAll("g").data(l).enter().append("g").attr("transform",function(e){if("string"===n.xDataType)return"translate(0, "+t(e[n.xField])+")"}).selectAll("text").data(r).enter().append("text").style("text-anchor","middle").style("pointer-events","none").style("fill","auto"===u.labelFontColor?n.getAutoColor(u.color):u.labelFontColor).style("font-family",u.labelFontFamily).style("font-style","bold"===u.labelFontStyle?"normal":u.labelFontStyle).style("font-weight","bold"===u.labelFontStyle?"bold":"normal").text(function(e,t){return n.getContent(e,n.series[e.serieIndex],u.labelFormat)}).style("font-size",function(e,t){return V(this,e)}).attr("transform",function(t,a){let l=e(t,a,!0),o=i(t,a),r=this.getBBox();return"string"===n.xDataType?o=o+c.bandwidth()/2+t.fontSize/2:o+=t.fontSize,"translate("+(l-=r.width)+","+o+")"}).attr("opacity",function(e){return"add"===n.animation.effect?0:N(e)?1:0}).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",function(e){return N(e)?1:0}).attr("transform",function(e,t){let a=d(e,t),l=i(e,t),o=this.getBBox();return"string"===n.xDataType?l=l+c.bandwidth()/2+e.fontSize/2:l+=e.fontSize,"translate("+(a-=o.width)+","+l+")"}))}()},Z=function(){d3.nest().key(function(e){return e.type}).entries(n.serieTypes).forEach(function(e,t){var a;switch(a=e.values,l=a.map(function(e,t){let a=n.data.map(function(t){return{x:t[n.xField],y:t[e.name],serieKey:e.name.toValueKey()}});return a.sort(function(e,t){return"date"===n.xDataType?new Date(e.x)-new Date(t.x):"string"===n.xDataType?e.value<t.value?-1:e.value>t.value?1:0:e.x-t.x}),{columnName:e.name,serie:e.serie,values:a}}),g=e.key+"Chart",e.key){case"area":G();break;case"column":D();break;case"line":L();break;case"scatter":B();break}})},P=function(){let e=u.bulletSize<16?16:u.bulletSize,t=0,i=0,o=0,r=0,s=0,c=0,p=a.xScale(n.domains.minY),f=a.xScale(n.domains.maxY),g=e/3,h=d3.symbol().type(function(e){return"none"===n.series[0].bullet?d3.symbolCircle:n.series[0].bullet.toSymbol()}).size(function(t){return Math.pow(e,2)}),y=n.extractSerieNamesFromData();y.forEach(function(x,b){u=x.serie,n.data.forEach(function(l,u){!function(e){d=[],d3.keys(e).map(function(t){if(t!==n.xField&&"_serieIndex"!==t&&"_serieColor"!==t&&"total"!==t&&"_total"!==t){let a=e[t];a&&d.push({name:t,value:a,serieColor:n.getColorFromLegend(t)})}}),d&&d.length>0&&d.sort(function(e,t){return e.value-t.value})}(l),t=a.yScale(l[n.xField])+("string"===n.xDataType?a.yScale.bandwidth()/2:0),m.selectAll(".eve-abacus-line-"+b+"-"+u).data(d).enter().append("line").attr("class","eve-abacus-lines eve-abacus-line-"+b+"-"+u).style("stroke",function(e,t){i=e;let a="none";return(o=d[t+1])?(a=parseFloat(i.value)<parseFloat(o.value)?n.getColorFromLegend(o.name):n.getColorFromLegend(i.name),e.color=a,a):"none"}).style("stroke-width",g).attr("y1",t).attr("y2",t).attr("x1",function(t,n){return i=t,(o=d[n+1])?(s=a.xScale(parseFloat(i.value)))>f?f:s<p?p:s+e/2:0}).style("stroke-dasharray",function(e,t){return i=e,(o=d[t+1])?(s=a.xScale(parseFloat(i.value)),c=a.xScale(parseFloat(o.value)),s<p||c>f?"5, 2":"0"):"0"}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).style("stroke-opacity",function(t,n){return i=t,(o=d[n+1])?(s=a.xScale(parseFloat(i.value)),c=a.xScale(parseFloat(o.value)),s<p&&c<p?0:(r=c-s)>e?1:0):0}).attr("x2",function(t,n){return i=t,(o=d[n+1])?(c=a.xScale(parseFloat(o.value)))>f?f:c-e/2:0})}),m.selectAll(".eve-abacus-bullet-"+b).data(l[b]).enter().append("path").attr("class","eve-abacus-bullets eve-abacus-bullet-"+b).attr("d",h).attr("stroke-width",u.bulletStrokeSize).attr("stroke-opacity","add"===n.animation.effect?0:1).attr("fill-opacity","add"===n.animation.effect?0:1).attr("fill",function(e,t){return u.color}).attr("transform",function(e){return E(e,!0)}).on("click",function(e){n.sliceClick&&n.sliceClick(e.data)}).on("mousemove",function(e,t){if((s=a.xScale(e[u.yField]))<p)return;if(s>f)return;let l=y[e._serieIndex].serie;d3.select(this).attr("fill-opacity",u.sliceHoverAlpha),n.showTooltip(n.getContent(e,l,n.tooltip.format))}).on("mouseout",function(e,t){n.hideTooltip()}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("stroke-opacity",u.bulletStrokeAlpha).attr("fill-opacity",function(e,t){return(s=a.xScale(e[u.yField]))<p?0:s>f?0:null!=e[u.yField]?1:0}).attr("transform",function(e){return E(e,!1)}),"auto"===u.labelFontSize&&(u.labelFontSize=11),"auto"===u.labelFontColor&&(u.labelFontColor="#333333"),""!==u.labelFormat&&m.selectAll(".eve-abacus-label-"+b).data(l[b]).enter().append("text").attr("class","eve-abacus-labels eve-abacus-label-"+b).style("text-anchor","middle").style("pointer-events","none").style("fill",u.labelFontColor).style("fill-opacity",function(e){return(s=a.xScale(e[u.yField]))<p?0:s>f?0:null!=e[u.yField]?1:0}).style("font-size",("auto"===u.labelFontSize?11:u.labelFontSize)+"px").style("font-family",u.labelFontFamily).style("font-style","bold"===u.labelFontStyle?"normal":u.labelFontStyle).style("font-weight","bold"===u.labelFontStyle?"bold":"normal").text(function(e){return(s=a.xScale(e[u.yField]))<p?"":s>f?"":n.getContent(e,u,u.labelFormat)}).attr("transform",function(e){return _(e,!0)}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("transform",function(e){return _(e,!1)})})},O=function(){switch(n.type){case"abacus":P();break;case"areaChart":G();break;case"barChart":I();break;case"columnChart":D();break;case"combinationChart":Z();break;case"bubbleChart":l.forEach(function(e,t){m.selectAll(".eve-vis-series-"+t).data(e.values).enter().append("circle").attr("class",function(t){return S(t,e.serie)}).attr("r",M).attr("cx",function(e){switch(n.xDataType){case"string":return a.xScale(e.x)+a.xScale.bandwidth()/2;break;case"date":return a.xScale(new Date(e.x));break;default:return a.xScale(e.x);break}}).attr("cy",n.plot.height).attr("fill-opacity",function(e){return null!=e.y?.85:0}).attr("fill",A(e)).on("mousemove",C).on("mouseout",z).on("click",T).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("cy",function(e){if(null==e.y)return 0;let t=a.yScale(e.y);return isNaN(t)?0:t}),m.selectAll(".eve-bubble-label-"+t).data(e.values).enter().append("text").attr("class","eve-bubble-label eve-bubble-label-"+t).style("text-anchor","middle").style("pointer-events","none").style("fill-opacity",1).style("fill","auto"===u.labelFontColor?"#333333":u.labelFontColor).style("font-size",("auto"===u.labelFontSize?11:u.labelFontSize)+"px").style("font-family",u.labelFontFamily).style("font-style","bold"===u.labelFontStyle?"normal":u.labelFontStyle).style("font-weight","bold"===u.labelFontStyle?"bold":"normal").text(function(e){return null!=e.y?n.getContent(e,n.series[e.serieIndex],u.labelFormat):""}).attr("transform",function(e){return _(e,!0)}).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("transform",function(e){return _(e,!1)})});break;case"lineChart":L();break;case"radarChart":r=d3.radialLine().curve(d3.curveLinearClosed).radius(function(e){return a.yScale(0)}).angle(function(e,t){return t*a.sliceAngle}),"spLine"===u.behavior&&r.curve(d3.curveCardinalClosed),m=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+n.width/2+","+n.height/2+")"),i=m.selectAll(".eve-layout-radar").data(l).enter().append("g").attr("class","eve-layout-radar"),(o=i.append("path").attr("d",function(e){return r(e.values)}).attr("class",k).attr("fill",A).attr("fill-opacity",u.alpha).attr("stroke-opacity",1).attr("stroke",A).attr("stroke-width",1).on("click",T)).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("d",function(e){r.radius(function(e){return null!=e.y?a.yScale(e.y):0});let t=e.values.filter(function(e){return null!=e.y});return t.length>0&&(t=e.values),r(t)}),i.selectAll("circle").data(function(e){e.values.forEach(function(t){t.serie=e.serie});let t=e.values.filter(function(e){return null!=e.y});return t.length>0?e.values:t}).enter().append("circle").attr("class",function(e){return k(e)}).attr("r",u.bulletSize/2).attr("cx",function(e,t){return a.yScale(0)*Math.cos(a.sliceAngle*t-Math.PI/2)}).attr("cy",function(e,t){return a.yScale(0)*Math.sin(a.sliceAngle*t-Math.PI/2)}).style("fill",A).style("pointer-events","all").on("mousemove",C).on("mouseout",z).on("click",T).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("cx",function(e,t){return a.yScale(e.y)*Math.cos(a.sliceAngle*t-Math.PI/2)}).attr("cy",function(e,t){return a.yScale(e.y)*Math.sin(a.sliceAngle*t-Math.PI/2)}),u.labelFormat&&i.selectAll("text").data(function(e){return e.values}).enter().append("text").attr("transform",function(e,t){return _(e,!0,t)}).style("fill",A).style("text-anchor","middle").style("pointer-events","none").style("fill-opacity",1).style("fill","auto"===u.labelFontColor?"#333333":u.labelFontColor).style("font-size",("auto"===u.labelFontSize?11:u.labelFontSize)+"px").style("font-family",u.labelFontFamily).style("font-style","bold"===u.labelFontStyle?"normal":u.labelFontStyle).style("font-weight","bold"===u.labelFontStyle?"bold":"normal").text(function(e){return n.getContent(e,u,u.labelFormat)}).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("transform",function(e,t){return _(e,!1,t)});break;case"scatterChart":B();break;case"streamGraph":!function(){let t=[];!function(){let a=100/n.series.length;t.length=0,n.series.forEach(function(l,i){switch(n.legend.type){case"gradient":t.push(e.gradient(n.legend.gradientColors,100-i*a));break;default:t.push(l.color);break}})}();let i=null;i="date"===n.xDataType?d3.scaleTime().domain(d3.extent(n.data,function(e){return e[n.xField]})).range([0,n.plot.width]):d3.scaleLinear().domain(d3.extent(n.data,function(e){return e[n.xField]})).range([0,n.plot.width]);let o=d3.scaleLinear().domain([0,d3.max(l,function(e){return d3.max(e,function(e){return e[0]+e[1]})})]).range([n.plot.height/2,0]);r=d3.area().x(function(e){return i(e.data[n.xField])}).y0(function(e){return o(e[0])}).y1(function(e){return o(e[0])}).curve(d3.curveBasis),m.selectAll(".eve-streamgraph-layer").data(l).enter().append("path").attr("class","eve-streamgraph-layer").attr("d",r).attr("fill",function(e,n){return t[n]}).attr("stroke",function(e,n){return t[n]}).attr("fill-opacity",function(e,t){if(null!=n.series[e.index])return n.series[e.index].alpha}).attr("stroke-opacity",function(e,t){if(n.series[e.index])return n.series[e.index].sliceStrokeAlpha}).attr("stroke-width",function(e,t){if(n.series[e.index])return n.series[e.index].sliceStrokeThickness}).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("opacity",1).attr("d",function(e){return r.y1(function(e){return o(e[1])}),r(e)}),m.selectAll(".eve-streamgraph-layer").on("mouseover",function(e,t){d3.select(this).attr("fill-opacity",n.series[t].sliceHoverAlpha)}).on("mousemove",function(e,t){mouseX=d3.mouse(this),mouseX=mouseX[0],invertedX=Math.ceil(a.xScale.invert(mouseX)),e.forEach(function(e){e.data[n.xField]===invertedX&&n.showTooltip(n.getContent(e.data,e.serie,n.tooltip.format))})}).on("mouseout",function(e,t){d3.select(this).attr("fill-opacity",n.series[t].alpha),n.hideTooltip()})}();break}};return"radarChart"!==n.type&&(m=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+n.plot.left+","+n.plot.top+")")),w(),O(),n.update=function(e){n.data=e,w(),n.calculateDomain(),n.updateLegend(),a.update(),n.animation.effect?"fade"===n.animation.effect?m.transition().duration(1e3).style("opacity",0).remove():"dim"===n.animation.effect?m.style("opacity",.15):"add"===n.animation.effect?m.style("opacity",1):m.remove():m.remove(),"radarChart"!==n.type&&(m=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+n.plot.left+","+n.plot.top+")")),O()},n.clear=function(){n.svg.selectAll(".eve-vis-g").remove()},n}eve.abacus=function(n){return n.yAxis&&(n.yAxis.stacked=!1),n.type="abacus",n.masterType="xy",e.visualizations.push(n),new t(n)},eve.areaChart=function(n){return n.type="areaChart",n.masterType="xy",n.__stackable=!0,e.visualizations.push(n),new t(n)},eve.barChart=function(n){return n.type="barChart",n.masterType="xy",n.__stackable=!0,1!==n.series.length||n.yAxis.stacked||(n.yAxis.stacked=!0),e.visualizations.push(n),new t(n)},eve.bubbleChart=function(n){return n.yAxis&&(n.yAxis.stacked=!1),n.type="bubbleChart",n.masterType="xy",e.visualizations.push(n),new t(n)},eve.columnChart=function(n){return n.type="columnChart",n.masterType="xy",n.__stackable=!0,1!==n.series.length||n.yAxis.stacked||(n.yAxis.stacked=!0),e.visualizations.push(n),new t(n)},eve.combinationChart=function(n){return n.yAxis&&(n.yAxis.stacked=!1),n.type="combinationChart",n.masterType="xy",e.visualizations.push(n),new t(n)},eve.lineChart=function(n){return n.yAxis&&(n.yAxis.stacked=!1),n.type="lineChart",n.masterType="xy",e.visualizations.push(n),new t(n)},eve.radarChart=function(n){return n.yAxis&&(n.yAxis.stacked=!1),n.type="radarChart",n.masterType="xy",e.visualizations.push(n),new t(n)},eve.scatterChart=function(n){return n.yAxis&&(n.yAxis.stacked=!1),n.type="scatterChart",n.masterType="xy",e.visualizations.push(n),new t(n)},eve.streamGraph=function(n){return n.yAxis&&(n.yAxis.position="right",n.yAxis.stacked=!0),n.legend&&(n.legend.enabled=!1),n.type="streamGraph",n.masterType="xy",e.visualizations.push(n),new t(n)},eve.streamgraph=function(n){return n.yAxis&&(n.yAxis.position="right",n.yAxis.stacked=!0),n.legend&&(n.legend.enabled=!1),n.type="streamGraph",n.masterType="xy",e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){t.__baseChartType="sliced";let n=eve.initVis(t),l=n.series[0],i=11,o=(n.xField,l.valueField||l.yField||l.sizeField),r=e.clone(n.data),s=e.clone(n.data),u=null,d=null,c=null,p=null,f=15,m=n.plot.width-n.plot.left-n.plot.right-f,g=n.plot.height-n.plot.bottom-n.plot.top-f,h=0,F=0,w=null,A=null,k=null,S=null,C=null,z=null,T=function(e,t){d3.select(e).attr("fill-opacity",l.sliceHoverAlpha),n.showTooltip(n.getContent(t,l,n.tooltip.format))},M=function(e,t){d3.select(e).attr("fill-opacity",l.alpha),n.hideTooltip()},_=function(e,t){switch(t.clicked?t.clicked=null:t.clicked=!0,n.sliceClick&&n.sliceClick(t.data),n.type){case"donutChart":case"pieChart":k.centroid(t);t.clicked?d3.select(e).transition().duration(100).attr("transform",E(t,!0)):d3.select(e).transition().duration(100).attr("transform",E(t,!1));break;case"funnelChart":t.clicked?d3.select(e).transition().duration(100).attr("transform","translate("+f+",0)"):d3.select(e).transition().duration(100).attr("transform","translate(0,0)");break;default:{let n=m/2,a=g/2;t.clicked?(n+=f,d3.select(e).transition().duration(100).attr("transform","rotate(180,"+n+","+a+")")):d3.select(e).transition().duration(100).attr("transform","rotate(180,"+n+","+a+")")}break}},E=function(e,t){switch(n.type){case"pieChart":case"donutChart":{let n=t?f:0,a=(e.startAngle+e.endAngle)/2;return"translate("+Math.sin(a)*n+","+-Math.cos(a)*n+")"}break}},V=function(e,t){let a="eve-vis-series",i=e.data&&e.data[l.xField]?e.data[l.xField]:"";return i||(i=e[l.xField]),null!=e.index?a+=" eve-vis-series-"+e.index:null!=t&&(a+=" eve-vis-series-"+t),i&&(n.columnNames[i]&&(i=n.columnNames[i].toString()),a+=" serie-"+i.toString().toClassSelector()),a};switch(n.type){case"donutChart":case"pieChart":!function(){let t=d3.pie().sort(null).value(function(e){return Math.abs(+e[l.yField])||Math.abs(+e[l.sizeField])||Math.abs(+e[l.valueField])}),o=0,v=0,E="",N=0,L=0,B=0,G=.5,D=12;function I(e){if("auto"!==l.labelAngle)return l.labelAngle;let t=90*(e.startAngle+e.endAngle)/Math.PI-90;return t>90?t-180:t}function Z(){again=!1,d.each(function(e,t){a=this,da=d3.select(a),y1=da.attr("y"),d.each(function(e,t){b=this,a!=b&&(db=d3.select(b),da.attr("text-anchor")==db.attr("text-anchor")&&(y2=db.attr("y"),deltaY=y1-y2,Math.abs(deltaY)>D||(again=!0,sign=deltaY>0?1:-1,adjust=sign*G,da.attr("y",+y1+adjust),db.attr("y",+y2-adjust))))})}),again&&setTimeout(Z,20)}m=n.plot.width-n.plot.left-n.plot.right-f,g=n.plot.height-n.plot.bottom-n.plot.top-f,h=(n.plot.width-n.plot.left-n.plot.right)/2,F=n.plot.top+g/2,p=n.svg.append("g").attr("class","eve-vis-g"),"auto"===l.labelPosition&&(l.labelPosition="inside"),i="auto"===l.labelFontSize?11:l.labelFontSize,v=0,r.forEach(function(t,a){let i=n.legend.legendColors.length>0?e.matchGroup(t[n.xField],n.legend.legendColors,"color"):null,o=i||(a>=e.colors.length?e.randColor():e.colors[a]),r=n.getContent(t,l,l.labelFormat).toString();for(let e in t.value=t[l.valueField],t[l.valueField]=Math.abs(t[l.valueField]),r.length>v&&(v=r.length,E=r),t.sliceColor=o,s[a]&&(s[a].sliceColor=o),""!==l.colorField?(t.sliceColor=t[l.colorField],s[a]&&(s[a].sliceColor=t[l.colorField])):l.dataColors&&(t.sliceColor=l.dataColors[t[n.xField].toString()],s[a]&&(s[a].sliceColor=l.dataColors[t[n.xField].toString()])),t)s[a]&&(e===l.yField?s[a][e]=0:e===l.sizeField?s[a][e]=0:e===l.valueField&&(s[a][e]=0))}),w=p.append("text").style("font-size",i+"px").style("font-family",l.labelFontFamily).style("font-style","bold"===l.labelFontStyle?"normal":l.labelFontStyle).style("font-weight","bold"===l.labelFontStyle?"bold":"normal").text(E),A=w.node().getBoundingClientRect(),w.remove(),o=A.width/2,m=n.plot.width-n.plot.left-n.plot.right-f-o,g=n.plot.height-n.plot.bottom-n.plot.top-f-o,h=(n.plot.width-n.plot.left-n.plot.right)/2,F=(n.plot.height-n.plot.top-n.plot.bottom)/2,N=Math.min(m,g)/2-(""!==l.labelFormat&&"outside"===l.labelPosition?o:0),L="donutChart"===n.type?N/2:0,k=d3.arc().outerRadius(N).innerRadius(L),C=d3.arc().outerRadius(N).innerRadius(N-1),B="inside"===l.labelPosition?N-o:N+10,z=d3.arc().outerRadius(B).innerRadius(B),p.attr("transform","translate("+h+","+F+")"),n.__tempArc=k,u=p.selectAll("path").data(t(s)).enter().append("path").attr("d",k).attr("class",V).attr("fill-opacity",l.alpha).attr("fill",function(e){return e.data.sliceColor}).attr("stroke",""===l.sliceStrokeColor?"rgb(255,255,255)":l.sliceStrokeColor).attr("stroke-opacity",l.sliceStrokeAlpha).attr("stroke-width",l.sliceStrokeThickness).on("click",function(e){_(this,e)}).on("mousemove",function(e){T(this,e)}).on("mouseout",function(e){M(this,e)}).each(function(e){this._current=e}),function(){if(!l.labelFormat)return!1;switch(l.labelPosition){case"inside":d=p.selectAll("text").data(t(r)).enter().append("text").attr("dy",".35em").style("text-anchor","middle").style("pointer-events","none").style("fill",function(e){return"auto"===l.labelFontColor?d3.color(e.data.sliceColor).brighter(5):l.labelFontColor}).style("font-size",i+"px").style("font-family",l.labelFontFamily).style("font-style","bold"===l.labelFontStyle?"normal":l.labelFontStyle).style("font-weight","bold"===l.labelFontStyle?"bold":"normal").text(function(e){return n.getContent(e,l,l.labelFormat)}).attr("transform",function(e){return"translate(0,0)rotate("+I(e)+")"}).each(function(e,t){S=this.getBBox();let n=z.centroid(e);n[0],S.x,n[1],S.y,S.width,S.height,S.width,S.height,e.visible=!0}).style("display",function(e){return"auto"!==l.labelFontSize?null:"always"===l.labelVisibility?null:e.visible?null:"none"});break;default:c=p.selectAll("line").data(t(r)).enter().append("line").style("stroke",l.segmentLineColor).style("stroke-width",l.segmentLineThickness).style("stroke-opacity",l.segmentLineAlpha).attr("dy",".35em").attr("x1",function(e){return C.centroid(e)[0]}).attr("y1",function(e){return C.centroid(e)[1]}).attr("x2",function(e){return C.centroid(e)[0]}).attr("y2",function(e){return C.centroid(e)[1]}),d=p.selectAll("text").data(t(r)).enter().append("text").attr("dy",".35em").style("text-anchor",function(e){return arcCentroid=k.centroid(e),midAngle=Math.atan2(arcCentroid[1],arcCentroid[0]),x=Math.cos(midAngle)*(N+v),x>0?"start":"end"}).style("pointer-events","none").style("fill",function(e){return"auto"===l.labelFontSize?"#333333":"auto"===l.labelFontColor?d3.color(e.data.sliceColor).brighter(5):l.labelFontColor}).style("font-size",i+"px").style("font-family",l.labelFontFamily).style("font-style","bold"===l.labelFontStyle?"normal":l.labelFontStyle).style("font-weight","bold"===l.labelFontStyle?"bold":"normal").text(function(e){return n.getContent(e,l,l.labelFormat)}).attr("x",0).attr("y",0);break}}(),function(){let e=t(r);if(n.__slicedSet=e,u.data(e).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attrTween("d",function(e){let t=d3.interpolate(this._current,e);return this._current=t(0),function(e){return k(t(e))}}),!l.labelFormat)return!1;switch(l.labelPosition){case"inside":d.transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("transform",function(e){return"translate("+k.centroid(e)+")rotate("+I(e)+")"});break;case"outside":d.style("text-anchor",function(e){return arcCentroid=k.centroid(e),midAngle=Math.atan2(arcCentroid[1],arcCentroid[0]),x=Math.cos(midAngle)*(N+v),x>0?"start":"end"}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("x",function(e){return arcCentroid=k.centroid(e),midAngle=Math.atan2(arcCentroid[1],arcCentroid[0]),xPos=Math.cos(midAngle)*(N+v),sign=xPos>0?1:-1,labelX=xPos+5*sign,labelX}).attr("y",function(e){return arcCentroid=k.centroid(e),midAngle=Math.atan2(arcCentroid[1],arcCentroid[0]),y=Math.sin(midAngle)*(N+v),y}),c.transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("x2",function(e){return arcCentroid=k.centroid(e),midAngle=Math.atan2(arcCentroid[1],arcCentroid[0]),xPos=Math.cos(midAngle)*(N+v),xPos}).attr("y2",function(e){return arcCentroid=k.centroid(e),midAngle=Math.atan2(arcCentroid[1],arcCentroid[0]),yPos=Math.sin(midAngle)*(N+v),yPos}),Z();break}}()}();break;case"funnelChart":case"pyramidChart":!function(){let t=n.plot.height-n.plot.top-n.plot.bottom-l.neckHeight,m=n.plot.width-n.plot.left-n.plot.right,g="funnelChart"===n.type?.1:.005,h=2*t/(m-g*m),y=(m+g*m)*t/2,x=d3.sum(r,function(e){return Math.abs(e[o])}),b=null,F=null,k=0,C=0,z="",E=0,N=0,L=0,B=null,G=d3.line().x(function(e){return e[0]}).y(function(e){return e[1]});function D(e){let t=[],i=[];return function r(s,u,d,c){c>=e.length||(v=e[c][o],a=v*y/x,pw=u-s,nw=Math.sqrt((h*pw*pw-4*a)/h),nl=(pw-nw)/2+s,nr=u-(pw-nw)/2,nh=h*(pw-nw)/2+d,(i=[[nr,nh]]).push([u,d]),i.push([s,d]),i.push([nl,nh]),i.push([nr,nh]),l.neckHeight>0&&"funnelChart"===n.type&&c===e.length-1&&(i.push([nr,nh+l.neckHeight]),i.push([nl,nh+l.neckHeight]),i.push([nl,nh])),t.push(i),r(nl,nr,nh,c+1))}(0,m,0,0),t}p=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+n.plot.left+","+n.plot.top+")"),function(){"auto"===l.labelPosition&&(l.labelPosition="inside"),i="auto"===l.labelFontSize?11:l.labelFontSize,C=0,r.forEach(function(t,a){let i=n.legend.legendColors.length>0?e.matchGroup(t[n.xField],n.legend.legendColors,"color"):null,o=i||(a>=e.colors.length?e.randColor():e.colors[a]),r=n.getContent(t,l,l.labelFormat).toString();for(let e in t[l.valueField]=Math.abs(t[l.valueField]),r.length>C&&(C=r.length,z=r),t.sliceColor=o,s[a]&&(s[a].sliceColor=o),""!==l.colorField?(t.sliceColor=t[l.colorField],s[a]&&(s[a].sliceColor=t[l.colorField])):l.dataColors&&(t.sliceColor=l.dataColors[t[n.xField].toString()],s[a]&&(s[a].sliceColor=l.dataColors[t[n.xField].toString()])),t)s[a]&&(e===l.yField?s[a][e]=0:e===l.sizeField?s[a][e]=0:e===l.valueField&&(s[a][e]=0))}),w=p.append("text").style("font-size",i+"px").style("font-family",l.labelFontFamily).style("font-style","bold"===l.labelFontStyle?"normal":l.labelFontStyle).style("font-weight","bold"===l.labelFontStyle?"bold":"normal").text(z),A=w.node().getBoundingClientRect(),w.remove(),k=l.labelFormat&&"outside"===l.labelPosition?A.width:0,m=n.plot.width-n.plot.left-n.plot.right-f-k,t=n.plot.height-n.plot.bottom-n.plot.top-f;let a="funnelChart"===n.type?.1:.005;h=2*t/(m-a*m),y=(m+a*m)*t/2,b=D(s),F=D(r),n.__funnelWidth=m,n.__funnelHeight=t}(),function(){if("outside"===l.labelPosition&&l.labelFormat&&(c=p.selectAll("line").data(r).enter().append("line").style("stroke",l.segmentLineColor).style("stroke-width",l.segmentLineThickness).style("stroke-opacity",.2).attr("dy",".35em").attr("x1",m/2).attr("y1",function(e,a){return B=F[a],L=B[0][1]-B[1][1],"funnelChart"===n.type?B[0][1]-L/2:t-B[0][1]+L/2}).attr("x2",m/2).attr("y2",function(e,a){return B=F[a],L=B[0][1]-B[1][1],"funnelChart"===n.type?B[0][1]-L/2:t-B[0][1]+L/2})),u=p.selectAll("path.eve-vis-series").data(s).enter().insert("path").attr("class",function(e,t){return V(e,t)}).attr("d",function(e,t){return G(b[t])}).attr("fill-opacity",function(e){return l.alphaField?+e[l.alphaField]:l.alpha}).attr("fill",function(e){return e.sliceColor}).attr("stroke",""===l.sliceStrokeColor?"rgb(255,255,255)":l.sliceStrokeColor).attr("stroke-opacity",l.sliceStrokeAlpha).attr("stroke-width",l.sliceStrokeThickness).on("click",function(e){_(this,e)}).on("mousemove",function(e){T(this,e)}).on("mouseout",function(e){M(this,e)}),"pyramidChart"===n.type&&u.attr("transform","rotate(180,"+m/2+","+t/2+")"),!l.labelFormat)return!1;d=p.selectAll("text").data(r).enter().append("text").style("text-anchor","inside"===l.labelPosition?"middle":"end").style("pointer-events","none").style("fill",function(e){return"outside"===l.labelPosition&&"auto"===l.labelFontSize?"#333333":"auto"===l.labelFontColor?d3.color(e.sliceColor).brighter(5):l.labelFontColor}).style("font-size",i+"px").style("font-family",l.labelFontFamily).style("font-style","bold"===l.labelFontStyle?"normal":l.labelFontStyle).style("font-weight","bold"===l.labelFontStyle?"bold":"normal").text(function(e){return n.getContent(e,l,l.labelFormat)}).each(function(e,t){B=F[t],L=B[0][1]-B[1][1],e.visible=L>i}).style("display",function(e){return"always"===l.labelVisibility?null:e.visible?null:"none"})}(),function(){if(b=D(r),u.data(n.data).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("d",function(e,t){return G(b[t])}),!l.labelFormat)return!1;"inside"===l.labelPosition?d.transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("transform",function(e,a){return B=b[a],L=B[0][1]-B[1][1],E=m/2,N="funnelChart"===n.type?B[0][1]-L/2+i/2:t-B[1][1]-L/2+i/2,"translate("+E+","+N+")"}):(d.transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("transform",function(e,a){return B=b[a],S=this.getBBox(),L=B[0][1]-B[1][1],E=m+S.width,N="funnelChart"===n.type?B[0][1]-L/2+i/2:t-B[0][1]+L/2,"translate("+E+","+N+")"}),c.transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("x2",function(e,t){return(B=F[t])[0][0]+(m-B[0][0])}))}()}();break}return n.update=function(e,t){n.data=e,$("#"+n.container).html(""),t&&(n.title.content=t),eve[n.type](n)},n.clear=function(){n.svg.selectAll(".eve-vis-g").remove()},n}eve.donutChart=function(n){return n.type="donutChart",n.masterType="sliced",e.visualizations.push(n),new t(n)},eve.funnelChart=function(n){return n.type="funnelChart",n.masterType="sliced",e.visualizations.push(n),new t(n)},eve.pieChart=function(n){return n.type="pieChart",n.masterType="sliced",e.visualizations.push(n),new t(n)},eve.pyramidChart=function(n){return n.type="pyramidChart",n.masterType="sliced",e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){let n,a=eve.initVis(t),l=a.series[0],i=e.clone(a.data),o=null,r=0,s=0,u=1.5,d=10,c=0,p=0,f=null,m=null,g=null,h=null,y=[],x=8,b=null,v=null,F=[];function w(){g.attr("opacity","add"===a.animation.effect?0:1).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attr("opacity",1).attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}),l.labelFormat&&n.attr("fill-opacity",function(e,t){return b=g._groups[0][t].getBBox(),v=this.getBBox(),"always"===l.labelVisibility?1:v.width>b.width?0:1}).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attr("x",function(e){return e.x}).attr("y",function(e){return e.y})}function A(e){d3.event.active||o.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y}function k(e){e.fx=d3.event.x,e.fy=d3.event.y}function S(e){e.fixed=!0,d3.select(this).classed("fixed",!0),d3.event.active||o.stop()}function C(e){m.forEach(function(t){let n=F[t.cluster];if(!n)return;if(n===t)return;let a=t.x-n.x,l=t.y-n.y,i=Math.sqrt(a*a+l*l),o=t.r+n.r;i!==o&&(i=(i-o)/i*e,t.x-=a*=i,t.y-=l*=i,n.x+=a,n.y+=l)})}function z(e){let t=d3.quadtree().x(function(e){return e.x+1.5}).y(function(e){return e.y+1.5}).addAll(m);m.forEach(function(n){let a=n.r+l.maxBulletSize+Math.max(u,d),i=n.x-a,o=n.x+a,r=n.y-a,s=n.y+a;t.visit(function(t,a,l,c,p){if(t.data&&t.data!==n){let a=n.x-t.data.x,l=n.y-t.data.y,i=Math.sqrt(a*a+l*l),o=n.r+t.data.r+(n.cluster===t.data.cluster?u:d);i<o&&(i=(i-o)/i*e,n.x-=a*=i,n.y-=l*=i,t.data.x+=a,t.data.y+=l)}return a>o||c<i||l>s||p<r})})}function T(){r=a.plot.width-a.plot.left-a.plot.right,s=a.plot.height-a.plot.top-a.plot.bottom,c=a.domains.minY,p=a.domains.maxY,l.maxBulletSize||(l.maxBulletSize=Math.sqrt(r*s/i.length/Math.PI)-5),l.minBulletSize||(l.minBulletSize=l.maxBulletSize*c/p),f=d3.scalePow().exponent(.5).domain([c,p]).range([l.minBulletSize,l.maxBulletSize]),y=e.getUniqueValues(i,l.groupField),F=new Array(y.length),m=d3.range(i.length).map(function(e){let t=i[e],n=f(+t[l.measureField]);n<0&&(n=.1);let o={source:t[l.sourceField],cluster:y.indexOf(t[l.groupField]),clusterName:t[l.groupField],measure:+t[l.measureField],r:n};return a.additionalFields&&a.additionalFields.length>0&&a.additionalFields.forEach(function(e){o[e.dataField]=t[e.dataField]}),(!F[t.cluster]||o.measure>F[t.cluster].measure)&&(F[t.cluster]=o),o})}function M(){g=h.append("g").datum(m).selectAll(".circle").data(function(e){return e}).enter().append("circle").attr("r",function(e){return e.r}).attr("cx",0).attr("cy",0).style("fill",function(t){if(l.groupField)if(a.legend.legendColors.length>0){let n=e.matchGroup(t.clusterName,a.legend.legendColors,"color");t.sliceColor=n||(t.cluster>=e.colors.length?e.randColor():e.colors[t.cluster])}else t.sliceColor=t.cluster>=e.colors.length?e.randColor():e.colors[t.cluster];else""!==a.legend.gradientColors[0]?t.sliceColor=a.legend.gradientColors[0]:t.sliceColor=t.cluster>=e.colors.length?e.randColor():e.colors[t.cluster];return t.sliceColor}).style("fill-opacity",.9).on("mousemove",function(e,t){a.showTooltip(a.getContent(e,l,a.tooltip.format))}).on("mouseout",function(e,t){a.hideTooltip()}).call(d3.drag().on("start",A).on("drag",k).on("end",S)),l.labelFormat&&(n=h.selectAll("text").data(m).enter().append("text").attr("class","eve-force-tree-text").style("pointer-events","none").style("text-anchor","middle").style("fill",function(e){return"auto"===l.labelFontColor?a.getAutoColor(e.sliceColor):l.labelFontColor}).style("font-family",l.labelFontFamily).style("font-style","bold"===l.labelFontStyle?"normal":l.labelFontStyle).style("font-weight","bold"===l.labelFontStyle?"bold":"normal").text(function(e){return a.getContent(e,l,l.labelFormat)}).style("font-size",function(e){return"auto"===l.labelFontSize?e.fontSize=Math.min(2*e.r,(2*e.r-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*x):e.fontSize=l.labelFontSize,e.fontSize<x&&(e.fontSize=x),e.fontSize+"px"}).attr("x",0).attr("y",0).attr("dy",".35em")),o=d3.forceSimulation(m).alphaMin(.04).alphaDecay(.05).force("x",d3.forceX().strength(.1)).force("y",d3.forceY().strength(.1)).force("charge",y.length<=1?d3.forceManyBody(1):null).force("collision",z).force("cluster",C).on("tick",w),a.simulations.push(o),o.nodes(m)}return a.simulations=[],T(),h=a.svg.append("g").attr("width",r).attr("height",s).attr("class","eve-vis-g").attr("transform","translate("+r/2+","+s/2+")"),M(),a.update=function(e){a.data=e,i=e,a.calculateDomain(),a.updateLegend(),T(),a.animation.effect?"fade"===a.animation.effect?h.transition().duration(1e3).style("opacity",0).remove():"dim"===a.animation.effect?h.style("opacity",.15):"add"===a.animation.effect?h.style("opacity",1):h.remove():h.remove(),h=a.svg.append("g").attr("width",r).attr("height",s).attr("class","eve-vis-g").attr("transform","translate("+r/2+","+s/2+")"),M()},a.clear=function(){a.svg.selectAll(".eve-vis-g").remove()},a}e.bubbleForce=function(n){return n.type="bubbleForce",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)},e.bubbleDiagram=function(n){return n.type="bubbleForce",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){t.legend?t.legend.enabled=!1:t.legend={enabled:!1};let n=eve.initVis(t),a=n.series[0],l=e.clone(n.data),i=null,o=10,r=10+n.xAxis.labelFontSize,s=n.plot.height-n.plot.top-n.plot.bottom,u=(n.multipleWidth?n.multipleWidth:n.plot.width)-n.plot.left-n.plot.right-n.margin.left-n.margin.right,d=s/l.length-r,c=d-o,p=a.rangeFields||a.rangeField,f=0,m=0,g="",h=0,y=0,x=null,b=null,v="",F=10,w=[],A=0,k=0,S=null,C=null,z=null,T=null,M=8,_=null;function E(e){let t=[];return p.forEach(function(n){null!==e[n]&&t.push(parseFloat(e[n]))}),0===t.length?[0]:t.sort(d3.descending)}function V(e){let t={ranges:[],marker:0,measure:0,max:0};return n.xAxis.locked?(w=[],l.forEach(function(e,t){w.push(d3.sum(E(e))),w.push(e[a.measureField]?+e[a.measureField]:0),w.push(e[a.markerField]?+e[a.markerField]:0)}),t.max=d3.max(w),t.ranges=E(e),t.marker=e[a.markerField]?+e[a.markerField]:0,t.measure=e[a.measureField]?+e[a.measureField]:0):(t.ranges=E(e),t.marker=e[a.markerField]?+e[a.markerField]:0,t.measure=e[a.measureField]?+e[a.measureField]:0,t.max=Math.max(d3.sum(t.ranges),t.marker,t.measure)),n.yAxis.max&&(t.max=n.yAxis.max),t}function N(t){let l=10,o=function(){let e=Number.MIN_VALUE;return n.data.forEach(function(t){for(var n in t)n!==a.groupField&&+t[n]>e&&(e=+t[n])}),e}();return n.maxMeasureValue&&(o=n.maxMeasureValue),x=i.append("text").style("font-size",n.yAxis.labelFontSize+"px").style("color",n.yAxis.labelFontColor).style("font-family",n.yAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==n.yAxis.labelFontStyle?"normal":n.yAxis.labelFontStyle).style("font-weight","bold"==n.yAxis.labelFontStyle?"bold":"normal").text(e.formatNumber(o,n.yAxis.labelFormat)),tempXAxisSVGOffset=x.node().getBoundingClientRect(),x.remove(),(l="auto"===n.yAxis.tickCount?Math.ceil(t/tempXAxisSVGOffset.width)-1:parseInt(n.yAxis.tickCount))>10&&(l=10),5}function L(){h=0,l.forEach(function(e){(v=e[a.groupField])&&v.toString().length>h&&(g=v,h=v.toString().length)}),x=i.append("text").style("font-size",n.xAxis.labelFontSize+"px").style("color",n.xAxis.labelFontColor).style("font-family",n.xAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==n.xAxis.labelFontStyle?"normal":n.xAxis.labelFontStyle).style("font-weight","bold"==n.xAxis.labelFontStyle?"bold":"normal").text(g),b=x.node().getBoundingClientRect(),y=b.width+F,x.remove(),n.xAxis.locked&&(r=n.xAxis.labelFontSize+2),m=u-y,d=s/l.length-r,(c=d-o)<=0&&(c=d),"auto"===a.labelFontSize&&(a.labelFontSize=c/1.5),a.labelFontSize<M&&(a.labelFontSize=M),"auto"===a.labelFontColor&&(a.labelFontColor="#333333")}function B(){l.forEach(function(t,l){p.length>0&&(_=V(t),S=d3.scaleLinear().domain([0,n.yAxis.locked?n.yAxis.max:_.max]).range([0,m]),C=d3.axisBottom().scale(S).ticks(N(m)),i.selectAll(".eve-bullet-range-"+l).data(_.ranges).enter().append("rect").attr("class","eve-bullet-range-"+l).attr("height",d).style("fill",a.rangeColor).style("fill-opacity",0).attr("width",0).attr("transform",function(e,t){return"translate("+(A=0)+","+(k=(d+r)*l)+")"}),function(t){if(n.xAxis.locked&&t<n.data.length-1)return!1;(z=i.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform","translate("+y+","+((d+r)*t+d)+")").attr("class","eve-x-axis").call(C)).selectAll("path").style("stroke-opacity",n.xAxis.alpha).style("stroke-width",n.xAxis.thickness+"px").style("stroke",n.xAxis.color),z.selectAll("line").style("fill","none").style("stroke-width",n.xAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",n.xAxis.alpha).style("stroke",n.xAxis.color),z.selectAll("text").style("fill",n.xAxis.labelFontColor).style("font-size",n.xAxis.labelFontSize+"px").style("font-family",n.xAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.xAxis.labelFontStyle?"normal":n.xAxis.labelFontStyle).style("font-weight","bold"===n.xAxis.labelFontStyle?"bold":"normal").style("text-anchor","middle").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).text(function(t,a){return formattedText=e.formatNumber(t,n.xAxis.labelFormat),formattedText})}(l))}),i.selectAll(".eve-bullet-group").data(l).enter().append("text").attr("class","eve-bullet-group").style("font-size",n.yAxis.labelFontSize+"px").style("fill",n.yAxis.labelFontColor).style("font-family",n.yAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==n.yAxis.labelFontStyle?"normal":n.yAxis.labelFontStyle).style("font-weight","bold"==n.yAxis.labelFontStyle?"bold":"normal").text(function(e){return e[a.groupField]}).attr("transform","translate(0,0)"),i.selectAll(".eve-bullet-bar").data(l).enter().append("rect").attr("class","eve-bullet-bar").style("fill",a.color?a.color:e.colors[0]).style("fill-opacity",a.alpha).attr("height",c).attr("width",0).attr("transform",function(e,t){return k=(d+r)*t+o/2,d===c&&(k=(d+r)*t),"translate("+(A=y)+","+k+")"}).on("click",function(e){n.onClick&&n.onClick(e)}).on("mousemove",function(e){d3.select(this).style("fill-opacity",a.sliceHoverAlpha),n.showTooltip(n.getContent(e,a,n.tooltip.format))}).on("mouseout",function(e){d3.select(this).style("fill-opacity",a.alpha),n.hideTooltip()}),i.selectAll(".eve-bullet-label").data(l).enter().append("text").attr("class","eve-bullet-label").style("pointer-events","none").style("fill",a.labelFontColor).style("font-size",a.labelFontSize+"px").style("font-family",a.labelFontFamily).style("font-style","bold"===a.labelFontStyle?"normal":a.labelFontStyle).style("font-weight","bold"===a.labelFontStyle?"bold":"normal").text(function(e){return n.getContent(e,a,a.labelFormat)}).attr("transform",function(e,t){return"translate(0,"+(k=(d+r)*t+d/2+this.getBBox().height/2+c/2)+")"}),i.selectAll(".eve-bullet-marker").data(l).enter().append("rect").attr("class","eve-bullet-marker").style("fill",a.markerColor).attr("width",a.markerWidth).attr("height",d).attr("transform",function(e,t){return"translate("+(A=y)+","+(k=(d+r)*t)+")"}).on("click",function(e){n.onClick&&n.onClick(e)}).on("mousemove",function(e){d3.select(this).style("fill-opacity",a.sliceHoverAlpha),n.showTooltip(n.getContent(e,a,n.tooltip.format))}).on("mouseout",function(e){d3.select(this).style("fill-opacity",a.alpha),n.hideTooltip()})}function G(){l.forEach(function(e,t){p.length>0&&(_=V(e),i.selectAll(".eve-bullet-range-"+t).style("fill-opacity","add"===n.animation.effect?0:1).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).style("fill-opacity",function(e,t){return(t+1)/_.ranges.length}).attr("width",function(e){return e/_.max*m}).attr("transform",function(e,n){return f=0===n?0:_.ranges[n-1]/_.max*m,"translate("+(A=y+f)+","+(k=(d+r)*t)+")"}))}),i.selectAll(".eve-bullet-group").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).text(function(e){return e[a.groupField]}).attr("transform",function(e,t){return k=(d+r)*t+d/2+this.getBBox().height/2,"translate("+(A=0)+","+k+")"}),i.selectAll(".eve-bullet-bar").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("height",c).attr("width",function(e){return(_=V(e)).measure/_.max*m}).attr("transform",function(e,t){return k=(d+r)*t+o/2,d===c&&(k=(d+r)*t),"translate("+(A=y)+","+k+")"}),i.selectAll(".eve-bullet-label").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("transform",function(e,t){return _=V(e),T=this.getBBox(),k=(d+r)*t+o/2+c/2+a.labelFontSize/2,(A=y+_.measure/_.max*m+5)+T.width>m&&(A-=T.width),"translate("+A+","+k+")"}),i.selectAll(".eve-bullet-marker").style("fill-opacity",a.markerField?1:0).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("height",d).attr("transform",function(e,t){return _=V(e),k=(d+r)*t,"translate("+(A=y+_.marker/_.max*m)+","+k+")"})}return n.xAxis.locked&&(r=n.xAxis.labelFontSize,d=s/l.length-r,c=d-o),c<=0&&(c=d),i=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+n.plot.left+","+n.plot.top+")"),L(),B(),G(),n.update=function(e){n.data=e,l=e,n.calculateDomain(),L(),n.animation.effect?"fade"===n.animation.effect?i.transition().duration(1e3).style("opacity",0).remove():"dim"===n.animation.effect?i.style("opacity",.15):(n.animation.effect,i.remove()):i.remove(),i=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+n.plot.left+","+n.plot.top+")"),B(),G()},n.clear=function(){n.svg.selectAll(".eve-vis-g").remove()},n}e.bullet=function(n){return n.masterType="sliced",n.type="bullet",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){t.legend?t.legend.enabled=!1:t.legend={enabled:!1},t.yAxis?t.yAxis.stacked=!1:t.yAxis={stacked:!1};let n=eve.initVis(t),a=n.series[0],l=e.clone(n.data),i=null,o=[],r=[],s=[],u=0,d=0,c=0,p=0,f=0,m=null,g=null,h=null,y=0,x=0,b={left:5,top:5,right:5,bottom:2*n.xAxis.labelFontSize+10},v=0,F=null,w=null,A=null,k=null,S=null,C=null,z={},T=null,M=null,_=null,E=null,V=null,N=null,L=null,B=[],G=[],D=null,I=0;function Z(t){o=[],r=e.getUniqueValues(l,a.sourceField),xValues=e.getUniqueValues(l,a.xField),d3.keys(l[0]).map(function(e,t){e!==a.sourceField&&"_total"!==e&&"total"!==e&&e&&o.push("numeric"===a.dataType?+e:new Date(e))}),r.forEach(function(t,n){z[t]=n>=e.colors.length?e.randColor():e.colors[n]}),t||(u=d3.min(o),d=d3.max(o),v=d3.max(r,function(e){return e.toString().length})),s=[],l.forEach(function(e){o.forEach(function(t){s.push(+e[t])}),t||(f=d3.min(s),I=d3.max(s))}),b.right=n.yAxis.labelFontSize/2*(v+1)+n.yAxis.labelFontSize+5,b.left=n.yAxis.labelFontSize/2*(e.formatNumber(I,n.yAxis.numberFormat).toString().length+1)+n.yAxis.labelFontSize+5,x=n.plot.width-b.right-b.left,y=n.plot.height-b.bottom-b.top,g=d3.scaleLinear().domain([f,I]).range([0,y-b.top]),h=d3.scaleLinear().domain([f,I]).range([0,y-b.top]),(m="numeric"===a.dataType?d3.scaleLinear():d3.scaleUtc()).domain([u,d]).range([0,x]).clamp(!0),T=function(){return r.map(function(e,t){var l={name:e,values:function(e){let t=[];n.data.forEach(function(n){let l=n[a.sourceField];l===e&&t.push(n)});let l=[];return o.forEach(function(n){let i=r.indexOf(e),o=z[e],s="numeric"===a.dataType?+n:new Date(n),u=d3.max(t,function(e){return parseFloat(e[n.toString()])});u>0&&l.push({name:e,xValue:s,yValue:u,group:s,measure:u,index:i,color:o})}),l}(e),index:t,color:z[e]};return l})}(),B=[],T.forEach(function(e){e.values.forEach(function(t){t.xValue.toString()===d.toString()&&B.push({source:e.name,value:t.yValue})})}),B.sort(function(e,t){return e.value-t.value}),G=[],0===f&&G.push(""),B.forEach(function(e){G.push(e.source)}),F=d3.axisBottom().scale(m).ticks(function(){let e=10,t=n.xAxis.labelFontSize/2*(o[o.length-1].toString().length+1)+n.xAxis.labelFontSize+5;return o.length<5?o.length:((e=x/t-1)>o.length&&0!==o.length&&(e=o.length),Math.ceil(e))}()),w=d3.axisLeft().scale(h).ticks(I),A=d3.axisRight().scale(g).ticks(I),"auto"===a.labelFontSize&&(a.labelFontSize=11),"auto"===a.labelFontColor&&(a.labelFontColor="#333333")}function P(){k=i.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform","translate("+b.left+","+(y-b.top)+")").attr("class","eve-x-axis").call(F),S=i.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform","translate("+b.left+", "+b.top+")").attr("class","eve-y-axis").call(w),C=i.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform","translate("+(x+b.left)+", "+b.top+")").attr("class","eve-y-axis").call(A),k.selectAll("path").style("stroke-opacity",n.xAxis.alpha).style("stroke-width",n.xAxis.thickness+"px").style("stroke",n.xAxis.color),k.selectAll("line").style("fill","none").style("stroke-width",n.xAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",n.xAxis.alpha).style("stroke",n.xAxis.color),k.selectAll("text").style("fill",n.xAxis.labelFontColor).style("font-size",n.xAxis.labelFontSize+"px").style("font-family",n.xAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.xAxis.labelFontStyle?"normal":n.xAxis.labelFontStyle).style("font-weight","bold"===n.xAxis.labelFontStyle?"bold":"normal").style("text-anchor","middle").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).text(function(e){return!isNaN(parseFloat(e))&&e.toString().indexOf(".")>-1?"":e}),S.selectAll("path").style("stroke-opacity",n.yAxis.alpha).style("stroke-width",n.yAxis.thickness+"px").style("stroke",n.yAxis.color),S.selectAll("line").style("fill","none").style("stroke-width",n.yAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",n.yAxis.alpha).style("stroke",n.yAxis.color),S.selectAll("text").style("fill",n.yAxis.labelFontColor).style("font-size",n.yAxis.labelFontSize+"px").style("font-family",n.yAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.yAxis.labelFontStyle?"normal":n.yAxis.labelFontStyle).style("font-weight","bold"===n.yAxis.labelFontStyle?"bold":"normal").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).text(function(e){return e}),C.selectAll("path").style("stroke-opacity",n.yAxis.alpha).style("stroke-width",n.yAxis.thickness+"px").style("stroke",n.yAxis.color),C.selectAll("line").style("fill","none").style("stroke-width",n.yAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",n.yAxis.alpha).style("stroke",n.yAxis.color),C.selectAll("text").style("fill",function(e,t){return(D=G[t])?z[D]:"rgb(255,255,255)"}).style("font-size",n.yAxis.labelFontSize+"px").style("font-family",n.yAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.yAxis.labelFontStyle?"normal":n.yAxis.labelFontStyle).style("font-weight","bold"===n.yAxis.labelFontStyle?"bold":"normal").style("cursor","pointer").on("click",function(e,t){if(!(D=G[t]))return!1;{let e=r.indexOf(D),t=B[e];t||B.forEach(function(e){e.source===D&&(t=e)}),t.clicked?t.clicked=!t.clicked:t.clicked=!0,t.clicked?(d3.selectAll(".eve-bump-serie").style("stroke-opacity",.1),d3.selectAll(".eve-bump-point").style("stroke-opacity",.1),d3.selectAll(".eve-bump-point").style("fill-opacity",.1),d3.selectAll(".eve-bump-label").style("fill-opacity",.1),d3.selectAll(".eve-bump-serieLabel").style("fill-opacity",.1),d3.selectAll(".eve-bump-serie-"+e).style("stroke-opacity",.9),d3.selectAll(".eve-bump-point-"+e).style("stroke-opacity",1),d3.selectAll(".eve-bump-point-"+e).style("fill-opacity",1),d3.selectAll(".eve-bump-label-"+e).style("fill-opacity",1),d3.selectAll(".eve-bump-serieLabel-"+e).style("fill-opacity",1)):(d3.selectAll(".eve-bump-serie").style("stroke-opacity",.9),d3.selectAll(".eve-bump-point").style("stroke-opacity",1),d3.selectAll(".eve-bump-point").style("fill-opacity",1),d3.selectAll(".eve-bump-label").style("fill-opacity",1),d3.selectAll(".eve-bump-serieLabel").style("fill-opacity",1))}}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).text(function(e,t){return(D=G[t])||""})}function O(){M=d3.line().curve(d3.curveLinear).x(function(e){return m(e.xValue)+b.left}).y(function(e){return y}),_=d3.symbol().type(function(e){return"none"===a.bullet?d3.symbolCircle:a.bullet.toSymbol()}).size(function(e){return Math.pow(a.bulletSize,2)}),E=i.selectAll(".eve-bump-series").data(T).enter().append("g").attr("class","eve-bump-series"),V=E.append("path").attr("class",function(e,t){return"eve-bump-serie eve-bump-serie-"+t}).attr("d",function(e){return M(e.values)}).style("fill","none").style("stroke-opacity",1).style("stroke-width",a.bulletSize/2).style("stroke",function(e,t){return e.color}).on("click",function(e){e.clicked?e.clicked=!e.clicked:e.clicked=!0,e.clicked?(d3.selectAll(".eve-bump-serie").style("stroke-opacity",.1),d3.selectAll(".eve-bump-point").style("stroke-opacity",.1),d3.selectAll(".eve-bump-point").style("fill-opacity",.1),d3.selectAll(".eve-bump-label").style("fill-opacity",.1),d3.selectAll(".eve-bump-serieLabel").style("fill-opacity",.1),d3.selectAll(".eve-bump-serie-"+e.index).style("stroke-opacity",.9),d3.selectAll(".eve-bump-point-"+e.index).style("stroke-opacity",1),d3.selectAll(".eve-bump-point-"+e.index).style("fill-opacity",1),d3.selectAll(".eve-bump-label-"+e.index).style("fill-opacity",1),d3.selectAll(".eve-bump-serieLabel-"+e.index).style("fill-opacity",1)):(d3.selectAll(".eve-bump-serie").style("stroke-opacity",.9),d3.selectAll(".eve-bump-point").style("stroke-opacity",1),d3.selectAll(".eve-bump-point").style("fill-opacity",1),d3.selectAll(".eve-bump-label").style("fill-opacity",1),d3.selectAll(".eve-bump-serieLabel").style("fill-opacity",1))}),N=E.selectAll(".eve-bump-point").data(function(e){return e.values}).enter().append("path").attr("class",function(e,t){return"eve-bump-point eve-bump-point-"+e.index}).attr("d",function(e){return _(e)}).style("cursor","pointer").style("stroke-opacity",1).style("stroke",function(e,t){return e.color}).style("fill-opacity",1).style("fill",function(e,t){return e.color}).attr("transform",function(e){return"translate("+(c=m(e.xValue)+b.left)+","+(p=y)+")"}).on("click",function(e){e.clicked?e.clicked=!e.clicked:e.clicked=!0,e.clicked?(d3.selectAll(".eve-bump-serie").style("stroke-opacity",.1),d3.selectAll(".eve-bump-point").style("stroke-opacity",.1),d3.selectAll(".eve-bump-point").style("fill-opacity",.1),d3.selectAll(".eve-bump-label").style("fill-opacity",.1),d3.selectAll(".eve-bump-serieLabel").style("fill-opacity",.1),d3.selectAll(".eve-bump-serie-"+e.index).style("stroke-opacity",.9),d3.selectAll(".eve-bump-point-"+e.index).style("stroke-opacity",1),d3.selectAll(".eve-bump-point-"+e.index).style("fill-opacity",1),d3.selectAll(".eve-bump-label-"+e.index).style("fill-opacity",1),d3.selectAll(".eve-bump-serieLabel-"+e.index).style("fill-opacity",1)):(d3.selectAll(".eve-bump-serie").style("stroke-opacity",.9),d3.selectAll(".eve-bump-point").style("stroke-opacity",1),d3.selectAll(".eve-bump-point").style("fill-opacity",1),d3.selectAll(".eve-bump-label").style("fill-opacity",1),d3.selectAll(".eve-bump-serieLabel").style("fill-opacity",1))}).on("mousemove",function(e,t){n.showTooltip(n.getContent(e,a,n.tooltip.format))}).on("mouseout",function(e,t){n.hideTooltip()}),L=E.selectAll(".eve-bump-labels").data(function(e){return e.values}).enter().append("text").attr("class",function(e,t){return"eve-bump-labels eve-bump-label-"+e.index}).style("text-anchor","middle").style("pointer-events","none").style("fill",a.labelFontColor).style("font-size",a.labelFontSize+"px").style("font-family",a.labelFontFamily).style("font-style","bold"===a.labelFontStyle?"normal":a.labelFontStyle).style("font-weight","bold"===a.labelFontStyle?"bold":"normal").text(function(e){return n.getContent(e,a,a.labelFormat)}).attr("transform",function(e){return"translate("+(c=m(e.xValue)+b.left)+","+(p=y)+")"}),M=d3.line().curve(d3.curveLinear).x(function(e){return m(e.xValue)+b.left}).y(function(e){return h(e.yValue)}),V.attr("opacity","add"===n.animation.effect?0:1).transition().duration(50).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("opacity",1).attr("d",function(e){return M(e.values)}),N.attr("opacity","add"===n.animation.effect?0:1).transition().duration(50).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("opacity",1).attr("transform",function(e){return c=m(e.xValue)+b.left,p=h(e.yValue),"translate("+c+","+p+")"}),L.transition().duration(50).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("transform",function(e){return c=m(e.xValue)+b.left,p=h(e.yValue)-a.bulletSize/2-3,"translate("+c+","+p+")"})}return Z(),i=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+n.plot.left+","+n.plot.top+")"),P(),O(),n.update=function(e){n.data=e,n.calculateDomain(),Z(),n.animation.effect?"fade"===n.animation.effect?i.transition().duration(1e3).style("opacity",0).remove():"dim"===n.animation.effect?i.style("opacity",.15):"add"===n.animation.effect?i.style("opacity",1):i.remove():i.remove(),i=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+n.plot.left+","+n.plot.top+")"),P(),O()},n.clear=function(){n.svg.selectAll(".eve-vis-g").remove()},n}e.bump=function(n){return n.type="bump",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)},e.bumpDiagram=function(n){return n.type="bump",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){d3.timeParse("%Y-%m-%d");let n=eve.initVis(t),a=n.series[0],l=e.clone(n.data),i=[],o=(d3.min(l,function(e){return e[a.dateField]}),d3.max(l,function(e){return e[a.dateField]}),d3.min(l,function(e){return+e[a.measureField]})),r=d3.max(l,function(e){return+e[a.measureField]}),s=5,u=n.xAxis.labelFontSize+n.xAxis.titleFontSize,d=53,c=7,p=12,f=(n.plot.left,n.plot.right,n.plot.top,n.plot.bottom,0),m=0,g=0,h=0,y=null,x=0,b=0,v=d3.timeFormat("%w"),F=d3.timeFormat("%U"),w=null,A=null,k=null,S=null,C=null,z=null,T=null,M=null,_="",E="",V="",N=0,L=null,B=null,G=null,D=0,I=null,Z=0,P=0,O=8,Y=0,R=0;function H(){i=[],l=l.filter(function(e){if(null!=e[a.measureField])return e}),d3.map(l,function(e){M=d3.timeDay(new Date(e[a.dateField])),_=M.getFullYear(),-1===i.indexOf(_)&&i.push(_)}),o===r&&n.domains.maxY>r&&(r=n.domains.maxY),m=n.plot.width,f=(n.plot.height-s)/i.length,g=(m-u-(Z=(m-u)/d-1)*d)/2,h=f-(P=(f-s)/c-2)*c-s,D=(o+r)/n.legend.gradientColors.length,R=Math.min(Z,P),z=d3.nest().key(function(e){return M=d3.timeDay(new Date(e[a.dateField])),_=M.getFullYear(),E=M.getMonth(),V=M.getDate(),d3.timeDay(new Date(_,E,V,0,0,0))}).map(l);let e=d3.range(o,r,(r-o)/(n.legend.gradientColors.length-1));e.push(r),G=d3.scaleLinear().range(n.legend.gradientColors).domain(e),I=d3.scalePow().exponent(.5).domain([o,r]).range([R,R])}function U(e){let t=d3.timeDay(new Date(e.getFullYear(),e.getMonth()+1,0)),n=+v(e),a=+F(e),l=+v(t),i=+F(t),o=(a+1)*Z+u;return"M"+o+","+(n*P+s)+"H"+(a*Z+u)+"V"+(7*P+s)+"H"+(i*Z+u)+"V"+((l+1)*P+s)+"H"+((i+1)*Z+u)+"V5H"+o+"Z"}function W(){w.attr("transform",function(e,t){return g=(m-u-Z*d)/2,h=t*(f-s)+s+n.xAxis.titleFontSize,"translate("+g+","+h+")"}),A.attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("opacity",1).text(function(e){return e}).attr("transform",function(e,t){return y=this.getBBox(),"translate("+(g=-1*y.height)+","+(h=P*(c/2))+")rotate(-90)"}),k.attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("opacity",1).attr("y",function(e,t){return t*P+P/2+this.getBBox().height/2+s/2}),S.attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("opacity",1).attr("x",function(e,t){return d*Z/p*(t+1)-Z*c/4+c}).attr("y",0),C.attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.animation.delay/2)}).attr("opacity",1).attr("d",U)}function q(){S=n.svg.append("g").attr("class","eve-calendarmap-month-g").attr("transform",function(e,t){return h=s+n.xAxis.titleFontSize,"translate("+g+","+h+")"}).selectAll(".eve-calendarmap-monthnames").data(e.monthsMin).enter().append("text").attr("class","eve-calendarmap-monthnames").style("fill",n.xAxis.labelFontColor).style("fill-opacity",1).style("font-size",n.xAxis.labelFontSize+"px").style("font-family",n.xAxis.labelFontFamily).style("font-style","bold"===n.xAxis.labelFontStyle?"normal":n.xAxis.labelFontStyle).style("font-weight","bold"===n.xAxis.labelFontStyle?"bold":"normal").text(function(e){return e}).attr("x",function(e,t){return d*Z/p*(t+1)-Z*c/4+c}).attr("y",0),w=n.svg.selectAll(".eve-calendarmap-g").data(i).enter().append("g").attr("class","eve-calendarmap-g").attr("transform",function(e,t){return h=t*(f-s)+s+n.xAxis.titleFontSize,"translate("+g+","+h+")"}),A=w.append("text").attr("class","eve-calendarmap-years").style("text-anchor","middle").style("fill",n.xAxis.labelFontColor).style("fill-opacity",1).style("font-size",n.xAxis.titleFontSize+"px").style("font-family",n.xAxis.titleFontFamily).style("font-style","bold"===n.xAxis.titleFontStyle?"normal":n.xAxis.titleFontStyle).style("font-weight","bold"===n.xAxis.titleFontStyle?"bold":"normal").text(function(e){return e}).attr("transform",function(e,t){return y=this.getBBox(),"translate("+(g=-1*y.height)+",0)rotate(-90)"}),L=w.selectAll(".eve-calendarmap-days").data(function(e){return d3.timeDays(new Date(e,0,1),new Date(e+1,0,1))}).enter().append("rect").attr("class","eve-calendarmap-days").style("fill","rgb(255,255,255)").style("fill-opacity",a.alpha).style("stroke","rgb(239,239,239)").style("stroke-opacity",1).attr("width",Z).attr("height",P).attr("x",function(e){return F(e)*Z+u}).attr("y",function(e){return v(e)*P+s}),B=w.selectAll(".eve-calendarmap-labels").data(function(e){return d3.timeDays(new Date(e,0,1),new Date(e+1,0,1))}).enter().append("text").attr("class","eve-calendarmap-labels").style("text-anchor","middle").style("pointer-events","none").style("fill","#333333").style("font-size",a.labelFontSize+"px").style("font-family",a.labelFontFamily).style("font-style","bold"===a.labelFontStyle?"normal":a.labelFontStyle).style("font-weight","bold"===a.labelFontStyle?"bold":"normal").text(""),k=w.selectAll(".eve-calendarmap-daynames").data(e.daysMin).enter().append("text").attr("class","eve-calendarmap-daynames").style("fill",n.xAxis.labelFontColor).style("fill-opacity",1).style("font-size",n.xAxis.labelFontSize+"px").style("font-family",n.xAxis.labelFontFamily).style("font-style","bold"===n.xAxis.labelFontStyle?"normal":n.xAxis.labelFontStyle).style("font-weight","bold"===n.xAxis.labelFontStyle?"bold":"normal").text(function(e){return e}).attr("x",c/2*-1).attr("y",0),C=w.selectAll(".eve-calendarmap-month").data(function(e){return d3.timeMonths(new Date(e,0,1),new Date(e+1,0,1))}).enter().append("path").attr("class","eve-calendarmap-month").style("fill","none").style("fill-opacity",0).style("stroke","rgb(215,215,215)").style("stroke-opacity",1).style("stroke-width",1).attr("d",U)}function X(){L.filter(function(e){return"$"+e.toString()in z}).attr("class","eve-calendarmap-days eve-calendarmap-data").on("mousemove",function(e){T=z["$"+e.toString()][0],d3.select(this).style("fill-opacity",a.sliceHoverAlpha),n.showTooltip(n.getContent(T,a,n.tooltip.format))}).on("mouseout",function(e){d3.select(this).style("fill-opacity",a.alpha),n.hideTooltip()}).attr("fill-opacity","add"===n.animation.effect?0:a.alpha).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.animation.delay/4)}).attr("fill-opacity",a.alpha).style("fill",function(e){return T=z["$"+e.toString()][0],N=T[a.measureField]?+T[a.measureField]:0,G(N)}),B.filter(function(e){return"$"+e.toString()in z}).text(function(e){return T=z["$"+e.toString()][0],n.getContent(T,a,a.labelFormat)}).style("font-size",function(e){return T=z["$"+e.toString()][0],N=T[a.measureField]?+T[a.measureField]:0,Y=I(N),"auto"===a.labelFontSize?e.fontSize=Math.min(2*Y,(2*Y-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*O):e.fontSize=a.labelFontSize,e.fontSize<O&&d3.select(this).text(""),e.fontSize<O&&(e.fontSize=O),e.fontSize+"px"}).style("fill",function(e){return T=z["$"+e.toString()][0],N=T[a.measureField]?+T[a.measureField]:0,"auto"===a.labelFontColor?n.getAutoColor(G(N)):a.labelFontColor}).attr("fill-opacity",function(e){return y=this.getBBox(),"always"===("auto"===a.labelFontSize?"fitting":"always")?1:y.width>Z?0:1}).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.animation.delay/4)}).attr("opacity",1).attr("transform",function(e,t,n){return y=this.getBBox(),x=F(e)*Z+u,b=v(e)*P+s,g=x+Z/2,h=b+P/2+y.height/2-2,"translate("+g+","+h+")"}).text(function(e){return T=z["$"+e.toString()][0],n.getContent(T,a,a.labelFormat)})}return H(),q(),X(),W(),n.update=function(e){n.data=e,l=e,n.calculateDomain(),n.updateLegend(),H(),w.remove(),d3.selectAll(".eve-calendarmap-month-g").remove(),q(),X(),W()},n}e.calendarmap=function(n){return n.masterType="standard",n.type="calendarMap",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)},e.calendarMap=function(n){return n.masterType="standard",n.type="calendarMap",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){t.legend?t.legend.enabled=!1:t.legend={enabled:!1};let n=eve.initVis(t),a=n.series[0],l=[],i=[],o=[],r=[],s=[],u=0,d=0,c=0,p=0,f=0,m="",g=null,h=0,y="",x=0,b=0,v=0,F=0,w=0,A=0,k=null,S=null,C=null,z=null,T={},M=null,_=0,E=null,V=null,N=15,L=15,B=[];function G(e,t){let l=0,i=0,o=0,r=0,s=0;switch(n.data.forEach(function(n){if(n[a.sourceField]==e&&n[a.targetField]==t||n[a.sourceField]==t&&n[a.targetField]==e){let e=parseFloat(n[a.measureField]);isNaN(e)&&(e=0),l+=e,e>o&&(o=e),r++}}),i=o,n.data.forEach(function(n){if(n[a.sourceField]==e&&n[a.targetField]==t||n[a.sourceField]==t&&n[a.targetField]==e){let e=parseFloat(n[a.measureField]);isNaN(e)&&(e=0),e<i&&(i=e)}}),a.expression){case"avg":s=l/r;break;case"count":s=r;break;case"max":s=o;break;case"min":s=i;break;default:s=l;break}return isNaN(s)?0:s}function D(e){let t=0,l="";for(var o=0;o<=n.data.length-1;o++){var r=n.data[o];if(r[a.sourceField]==e){l=r[a.groupField];break}}return-1==(t=i.indexOf(l))?0:t}function I(){l=[],B=e.colors,o=e.getUniqueValues(n.data,a.sourceField),r=e.getUniqueValues(n.data,a.targetField),a.groupField&&(i=e.getUniqueValues(n.data,a.groupField)),o.sort(function(e,t){return isNaN(e)||isNaN(t)?e<t?-1:e>t?1:0:e-t}),r.sort(function(e,t){return isNaN(e)||isNaN(t)?e<t?-1:e>t?1:0:e-t}),s=o.concat(r);var t=[];if(o.forEach(function(e){null!=(t=n.data.filter(function(t){return t[a.sourceField]===e}))[0].Row0AVG&&(T[e]=t[0].Row0AVG)}),r.forEach(function(e){null!=(t=n.data.filter(function(t){return t[a.targetField]===e}))[0].LastRowAVG&&(T[e]=t[0].LastRowAVG)}),s.forEach(function(e){let t=[];s.forEach(function(n){t.push(G(e,n))}),l.push(t)}),s.forEach(function(e){(d=function(e,t){let n=0;return t.forEach(function(t){if(t){let a=G(e,t.toString());isNaN(a)||(n+=a)}}),isNaN(n)?0:n}(e,s))>u&&(u=d)}),a.groupField){if(i.length>B.length){p=i.length-B.length;for(var _=0;_<=p;_++)B.push(e.randColor())}}else if(s.length>B.length){p=s.length-B.length;for(_=0;_<=p;_++)B.push(e.randColor())}l.forEach(function(e){(h=d3.max(e))>c&&(c=h)}),z=d3.chord().sortSubgroups(d3.descending).padAngle(.05),(M=z(l)).groups.forEach(function(e,t){e.group=i[D(s[t])];let l=n.getContent(e,a,a.labelFormat);l.length>f&&(m=l,f=l.length)}),tempTextSVG=n.svg.append("text").style("fill",a.labelFontColor).style("font-size","auto"===a.labelFontSize?"11px":a.labelFontSize+"px").style("font-family",a.labelFontFamily).style("font-style","bold"===a.labelFontStyle?"normal":a.labelFontStyle).style("font-weight","bold"===a.labelFontStyle?"bold":"normal").text(m),g=tempTextSVG.node().getBoundingClientRect(),tempTextSVG.remove(),y=e.formatNumber(c,n.xAxis.numberFormat),x=a.labelFormat?Math.max(g.width,g.height)+N:n.xAxis.labelFormat?(y.length+1)*(n.xAxis.labelFontSize/2):N,b=n.plot.width-x,v=n.plot.height-x,F=Math.min(b,v)/2,w=Math.abs(F-x),A=w+L,S=d3.scaleOrdinal().domain(d3.range(s.length)).range(B),k=d3.arc().innerRadius(w).outerRadius(0),C=d3.ribbon().radius(F)}function Z(e,t){return a.groupField?(_=D(s[e.index]),S(_)):S(e.index)}function P(e,t){return a.groupField?(_=D(s[e.target.index]),S(_)):S(e.target.index)}function O(e){return"rotate("+(180*e.angle/Math.PI-90)+")translate("+(w+20)+")"+(e.angle>Math.PI?"rotate(180)":"")}function Y(e){return e.angle>Math.PI?"end":null}let R=function(e){let t=eve.clone(e),l=n.data.filter(function(t){return t[a.sourceField]===e.sourceValue}),i=n.data.filter(function(t){return t[a.targetField]===e.sourceValue}),o=l;switch(0===o.length&&(o=i),a.expression){case"avg":t.measureValue=e.measureValue/o.length,null!=T[t.sourceValue]&&(t.measureValue=+T[t.sourceValue]);break;case"min":t.measureValue=d3.min(o,function(e){return e[a.measureField]}),null!=T[t.sourceValue]&&(t.measureValue=+T[t.sourceValue]);break;case"max":t.measureValue=d3.max(o,function(e){return e[a.measureField]}),null!=T[t.sourceValue]&&(t.measureValue=+T[t.sourceValue]);break}return t};function H(e,t){return function(l,o){if("mouseover"===t){let e={group:i[D(s[l.index])],sourceValue:s[l.index],measureValue:l.value},t=n.getContent(R(e),a,n.tooltip.format);n.showTooltip(t)}else"mouseout"===t&&n.hideTooltip();W.selectAll(".chord path").filter(function(e){return e.source.index!=o&&e.target.index!=o}).transition().style("fill-opacity",e)}}function U(){k=d3.arc().innerRadius(w).outerRadius(A),C=d3.ribbon().radius(w),E=W.append("g").selectAll("path").data(function(e){return e.groups}).enter().append("path").style("fill",Z).style("stroke",Z).on("mouseover",H(.1,"mouseover")).on("mouseout",H(1,"mouseout")).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("d",k),V=W.append("g").attr("class","chord").selectAll("path").data(function(e){return e}).enter().append("path").style("fill",P).style("fill-opacity",1).on("mouseover",function(e,t){W.selectAll(".chord path").transition().style("fill-opacity",function(t,l){return e.target.index==t.target.index&&e.source.index==t.source.index?(_=D(s[t.source.index]),e.group=i[_],e.sourceValue=s[t.source.index],e.targetValue=s[e.target.index],e.measureValue=e.source.value,n.showTooltip(n.getContent(e,a,n.tooltip.format)),1):.1})}).on("mouseout",function(e){n.hideTooltip(),W.selectAll(".chord path").transition().style("fill-opacity",1)}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("d",C),chordLabels=W.append("g").selectAll("text").data(function(e){return e.groups}).enter().append("text").each(function(e){e.angle=(e.startAngle+e.endAngle)/2}).attr("text-anchor",Y).style("pointer-events","none").style("fill",function(e,t){return"auto"===a.labelFontColor?n.getAutoColor(Z(e)):a.labelFontColor}).style("font-size","auto"===a.labelFontSize?"11px":a.labelFontSize+"px").style("font-family",a.labelFontFamily).style("font-style","bold"===a.labelFontStyle?"normal":a.labelFontStyle).style("font-weight","bold"===a.labelFontStyle?"bold":"normal").text(function(e,t){return _=D(s[t]),e.group=i[_],n.getContent(e,a,a.labelFormat)}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("transform",O)}I();let W=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+n.plot.width/2+","+n.plot.height/2+")").datum(z(l));return U(),n.update=function(e){n.data=e,n.calculateDomain(),I(),n.animation.effect?"fade"===n.animation.effect?W.transition().duration(1e3).style("opacity",0).remove():"dim"===n.animation.effect?W.style("opacity",.15):"add"===n.animation.effect?W.style("opacity",1):W.remove():W.remove(),W=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+n.plot.width/2+","+n.plot.height/2+")").datum(z(l)),U(),k=d3.arc().innerRadius(w).outerRadius(A),C=d3.ribbon().radius(w),E.style("fill",Z).style("stroke",Z).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("opacity",1).attr("d",k),V.style("fill",P).style("fill-opacity","add"===n.animation.effect?0:1).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).style("fill-opacity",1).attr("d",C)},n.clear=function(){n.svg.selectAll(".eve-vis-g").remove()},n}e.chord=function(n){return n.type="chord",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){t.legend?t.legend.enabled=!1:t.legend={enabled:!1};let n=eve.initVis(t),a=n.series[0],l=null,i=null,o=null,r=null,s=null,u=null,d=null,c=[],p=[],f={left:0,top:5,bottom:5,right:0},m=0,g=0,h=0,y=0,x=[],b=[],v=0,F=0,w=0,A=0,k=null,S="",C=-1,z="",T=0,M=3,_=a.bulletSize,E=.8,V=null,N=null,L=null,B=0,G=0,D=[];function I(t){c=n.xAxis.xValues?n.xAxis.xValues:e.getUniqueValues(n.data,a.sourceField),D=[],p=[],k=[],c.forEach(function(t,n){D.push({source:t,color:n>=e.colors.length?e.randColor():e.colors[n]})}),d3.keys(n.data[0]).map(function(e,t){e!==a.sourceField&&"total"!==e&&p.push(e)}),y=d3.max(p,function(e){if(e)return e.toString().length}),h=d3.max(c,function(e){if(e)return e.toString().length}),f.left=5+(n.yAxis.labelFontSize/2*(h+1)+n.yAxis.labelFontSize),f.right=5+2*n.yAxis.labelFontSize,f.bottom=5+n.xAxis.labelFontSize,m=n.plot.width-f.left-f.right,g=n.plot.height-f.top-f.top,p.forEach(function(e){v=d3.min(n.data,function(t){return+t[e]}),F=d3.max(n.data,function(t){return+t[e]}),x.push(parseFloat(v)),b.push(parseFloat(F))}),w=d3.min(x),A=d3.max(b),n.yAxis.locked&&(n.yAxis.min&&(w=n.yAxis.min),n.yAxis.max&&(A=n.yAxis.max)),l=d3.scaleLinear().domain([w,A]).range([0,m]),i=d3.scaleBand().domain(c).range([g-f.bottom-f.top,0]).padding(.1),o=Z(),r=d3.axisLeft().scale(i).tickSize(5),n.data.forEach(function(e){for(let t in S=e[a.sourceField],C=c.indexOf(S),z=D[C].color,e)if(t!==a.sourceField&&(T=e[t]?+e[t]:0)>0){let a={radius:_,color:z,cx:l(T),cy:i(S)+i.bandwidth()/2,measure:T,source:S,group:t};n.additionalFields&&n.additionalFields.forEach(function(t){a[t.dataField]=e[t.dataField]}),k.push(a)}})}function Z(){let t=e.formatNumber(A,n.xAxis.numberFormat),a=t?t.toString().length:0,i=a+Math.ceil(a/3),o=n.xAxis.labelFontSize/2*(i+4)+n.xAxis.labelFontSize,r=Math.ceil(m/o);return d3.axisBottom().scale(l).tickSize(5).tickPadding(8).ticks(r)}function P(){d=R.append("g").attr("class","eve-x-grid").attr("transform",function(){return"translate("+f.left+", "+(g-f.bottom-f.top)+")"}).call(Z().tickSize(-m,0,0).tickFormat("")),s=R.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform","translate("+f.left+","+(g-f.bottom-f.top)+")").attr("class","eve-x-axis").call(o),u=R.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform","translate("+f.left+")").attr("class","eve-y-axis").call(r),d.selectAll(".domain").style("stroke","none").style("stroke-width","0px"),d.selectAll("line").style("stroke-opacity",1).style("stroke-width",1).style("stroke","rgb(238,238,238)"),s.selectAll("path").style("stroke-opacity",n.xAxis.alpha).style("stroke-width",n.xAxis.thickness+"px").style("stroke",n.xAxis.color),s.selectAll("line").style("fill","none").style("stroke-width",n.xAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",n.xAxis.alpha).style("stroke",n.xAxis.color),s.selectAll("text").style("fill",n.xAxis.labelFontColor).style("font-size",n.xAxis.labelFontSize+"px").style("font-family",n.xAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.xAxis.labelFontStyle?"normal":n.xAxis.labelFontStyle).style("font-weight","bold"===n.xAxis.labelFontStyle?"bold":"normal").style("text-anchor","middle").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).text(function(t){let a=e.getType(t);return"number"===a?e.formatNumber(t,n.xAxis.labelFormat):"date"===a?e.formatDate(t,n.xAxis.labelFormat):t}),u.selectAll("path").style("stroke-opacity",n.yAxis.alpha).style("stroke-width",n.yAxis.thickness+"px").style("stroke",n.yAxis.color),u.selectAll("line").style("fill","none").style("stroke-width",n.yAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",n.yAxis.alpha).style("stroke",n.yAxis.color),u.selectAll("text").style("fill",n.yAxis.labelFontColor).style("font-size",n.yAxis.labelFontSize+"px").style("font-family",n.yAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.yAxis.labelFontStyle?"normal":n.yAxis.labelFontStyle).style("font-weight","bold"===n.yAxis.labelFontStyle?"bold":"normal").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).text(function(t){let a=e.getType(t);return"number"===a?e.formatNumber(t,n.yAxis.labelFormat):"date"===a?e.formatDate(t,n.yAxis.labelFormat):t})}function O(){V=d3.forceSimulation(k).velocityDecay(.2).force("x",d3.forceX().strength(5e-4)).force("y",d3.forceY().strength(5e-4)).force("charge",d3.forceManyBody()).on("tick",Y),n.simulations.push(V),V.nodes(k),N=R.selectAll("circle").data(k).enter().append("circle").attr("class",function(e,t){return"eve-circles eve-circles-"+e.group.replace(/[^\w\s]/gi,"").replaceAll(" ","")}).attr("r",function(e){return e.radius}).style("fill",function(e){return e.color}).on("click",function(e,t){e.selected?e.selected=!1:e.selected=!0;let n="eve-circles-"+e.group.replace(/[^\w\s]/gi,"").replaceAll(" ","");e.selected?(R.selectAll(".eve-circles").style("fill-opacity",.1),R.selectAll("."+n).style("fill-opacity",1)):R.selectAll(".eve-circles").style("fill-opacity",1)}).on("mousemove",function(t,l){let i=e.clone(t);i.source=t.group,i.group=t.source,n.showTooltip(n.getContent(i,a,n.tooltip.format))}).on("mouseout",function(e,t){n.hideTooltip()}),L=R.selectAll(".eve-cluster-labels").data(k).enter().append("text").attr("class","eve-cluster-labels").style("pointer-events","none").style("text-anchor","middle").style("fill",a.labelFontColor).style("font-size",a.labelFontSize+"px").style("font-family",a.labelFontFamily).style("font-style","bold"===a.labelFontStyle?"normal":a.labelFontStyle).style("font-weight","bold"===a.labelFontStyle?"bold":"normal").text(function(t){let l=e.clone(t);return l.source=t.group,l.group=t.source,n.additionalFields&&n.additionalFields.forEach(function(e){l[e.dataField]=t[e.datafield]}),n.getContent(l,a,a.labelFormat)})}function Y(){var e;N.each((e=1*E,function(t){t.y+=(t.cy-t.y)*e,t.x+=(t.cx-t.x)*e})).each(function(e){let t=d3.quadtree().x(function(e){return e.x}).y(function(e){return e.y}).addAll(k);return function(n){let a=n.radius+_+M,l=n.x-a,i=n.x+a,o=n.y-a,r=n.y+a;t.visit(function(t,a,s,u,d){if(t.data&&t.data!==n){let a=n.x-t.data.x,l=n.y-t.data.y,i=Math.sqrt(a*a+l*l),o=n.radius+t.data.radius+(n.color!==t.data.color)*M;i<o&&(i=(i-o)/i*e,n.x-=a*=i,n.y-=l*=i,t.data.x+=a,t.data.y+=l)}return a>i||u<l||s>r||d<o})}}(.5)).style("fill",function(e){return e.color}).attr("cy",function(e){return e.y}).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("opacity",1).attr("cx",function(e,t){return f.left+e.x}),L.transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("transform",function(e){return B=f.left+e.x,G=e.y-_-2,"translate("+B+","+G+")"})}n.simulations=[],I();let R=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+n.plot.left+","+n.plot.top+")");return P(),O(),n.update=function(e,t){n.data=e,n.calculateDomain(),I(),n.animation.effect?"fade"===n.animation.effect?(s.style("opacity",0).remove(),u.style("opacity",0).remove(),R.transition().duration(1e3).style("opacity",0).remove()):"dim"===n.animation.effect?(s.style("opacity",0).remove(),u.style("opacity",0).remove(),R.style("opacity",.15)):"add"===n.animation.effect?(s.style("opacity",0).remove(),u.style("opacity",0).remove(),R.style("opacity",1)):(s.style("opacity",0).remove(),u.style("opacity",0).remove(),R.remove()):(s.style("opacity",0).remove(),u.style("opacity",0).remove(),R.remove()),R=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+n.plot.left+","+n.plot.top+")"),P(),O()},n.clear=function(){n.svg.selectAll(".eve-vis-g").remove()},n}e.circleClusters=function(n){return n.type="circleClusters",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)},e.circleclusters=function(n){return n.type="circleClusters",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(e){let t=eve.initVis(e),n=t.series[0],a=(t.margin.left+t.margin.right+t.margin.bottom+t.margin.top)/4,l=t.plot.width-t.plot.left-t.plot.right,i=t.plot.height-t.plot.top-t.plot.bottom,o=Math.min(l,i),r=null,s=null,u=null,d=0,c=null,p=null,f=null,m=null,g=null,h=8,y="",x=0,b=0,v=null;function F(){l=t.plot.width-t.plot.left-t.plot.right,i=t.plot.height-t.plot.top-t.plot.bottom,o=Math.min(l,i),r=d3.pack().padding(2).size([o-a,o-a]),s=d3.hierarchy(t.data).each(function(e){/^other[0-9]+$/.test(e.data[n.labelField])&&(e.data[n.labelField]=null)}).sum(function(e){return+e[n.sizeField]}).sort(function(e,t){return t.value-e.value});let e=d3.range(-1,5,6/(t.legend.gradientColors.length-1));e.push(5),v=d3.scaleLinear().range(t.legend.gradientColors).domain(e),u=s,(c=r(s)).each(function(e){e.depth>d&&(d=e.depth)})}function w(){f=S.selectAll("circle").data(s.descendants()).enter().append("circle").attr("class",function(e){return e.parent?e.children?"eve-cp-node":"eve-cp-node node--leaf":"eve-cp-node node--root"}).style("cursor","pointer").style("fill",function(e){return e.children?0===e.depth?v(d):v(e.depth):null}).on("click",function(e){u!==e&&(e.depth==d?A(e.parent):A(e),d3.event.stopPropagation()),t.sliceClick&&t.sliceClick(e.data)}).on("mousemove",function(e){e.data.children?e.data._measureValue=d3.sum(e.data.children,function(e){return e.size}):e.data._measureValue=e.data.size,t.showTooltip(t.getContent(e,n,t.tooltip.format))}).on("mouseout",function(e){t.hideTooltip()}),m=S.selectAll("text").data(s.descendants()).enter().append("text").attr("class","eve-circlepacking-labels").style("text-shadow","0 1px 0 #fff, 1px 0 0 #fff, 0 -1px 0 #fff, -1px 0 0 #fff").style("pointer-events","none").style("text-anchor","middle").style("fill",function(e){return"auto"===n.labelFontColor?e.children?(y=0===e.depth?v(d):v(e.depth),t.getAutoColor(y)):"#333333":n.labelFontColor}).style("font-family",n.labelFontFamily).style("font-style","bold"===n.labelFontStyle?"normal":n.labelFontStyle).style("font-weight","bold"===n.labelFontStyle?"bold":"normal").text(function(e){return e.data.children?e.data._measureValue=d3.sum(e.data.children,function(e){return e.size}):e.data._measureValue=e.data.size,t.getContent(e,n,n.labelFormat)}).style("font-size",function(e){return"auto"===n.labelFontSize?e.fontSize=Math.min(2*e.r,(2*e.r-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*h):e.fontSize=n.labelFontSize,e.fontSize<h&&(e.fontSize=h),e.fontSize+"px"}).attr("transform","translate(0,0)").attr("dy",".35em"),g=S.selectAll("circle"),k([s.x,s.y,2*s.r+a])}function A(e){u=e,descendantsData=s.descendants();let t=d3.transition().duration(d3.event.altKey?7500:750).tween("zoom",function(e){let t=d3.interpolateZoom(p,[u.x,u.y,2*u.r+a]);return function(e){k(t(e))}});m.style("fill-opacity",0),t.selectAll(".eve-circlepacking-labels").filter(function(e){return e.parent===u||"inline"===this.style.display}).style("fill-opacity",function(e){return e.parent===u?1:0}).on("start",function(e){e.parent===u&&(this.style.display="inline")}).on("end",function(e){e.parent!==u&&(this.style.display="none")})}function k(e){let n=o/e[2];p=e,g.attr("transform",function(t){return"translate("+(t.x-e[0])*n+","+(t.y-e[1])*n+")"}),f.attr("opacity","add"===t.animation.effect?0:1).transition().duration(t.animation.duration).ease(t.animation.easing.toEasing()).delay(function(e,n){return n*t.animation.delay}).attr("opacity",1).attr("r",function(e){return e.r*n}),m.style("fill-opacity",function(e){return e.parent===u?1:0}).transition().duration(t.animation.duration).ease(t.animation.easing.toEasing()).delay(function(e,n){return n*t.animation.delay}).style("font-size",function(e){let t=Math.min(2*e.r,(2*e.r-8)/this.getComputedTextLength()*24);return t<h&&(t=h),e.depth>1&&(e.fontSize=t),e.fontSize+"px"}).attr("transform",function(t){return x=(t.x-e[0])*n,b=(t.y-e[1])*n,"translate("+x+","+b+")"})}F();let S=t.svg.append("g").attr("transform","translate("+t.plot.left+","+t.plot.top+")").append("svg").attr("width",l-t.plot.left).attr("height",i).attr("fill",t.backColor).attr("stroke","none").append("g").attr("class","eve-vis-g").attr("transform","translate("+l/2+","+i/2+")");return w(),t.update=function(e){t.data=e,t.calculateDomain(),t.updateLegend(),F(),t.animation.effect?"fade"===t.animation.effect?S.transition().duration(1e3).style("opacity",0).remove():"dim"===t.animation.effect?S.style("opacity",.15):"add"===t.animation.effect?S.style("opacity",1):S.remove():S.remove(),S=t.svg.append("g").attr("transform","translate("+t.plot.left+","+t.plot.top+")").append("svg").attr("width",l-t.plot.left).attr("height",i).attr("fill",t.backColor).attr("stroke","none").append("g").attr("class","eve-vis-g").attr("transform","translate("+l/2+","+i/2+")"),w()},t.clear=function(){t.svg.selectAll(".eve-vis-g").remove()},t}e.circlePacking=function(n){return n.masterType="tree",n.type="circlePacking",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)},e.circlepacking=function(n){return n.masterType="tree",n.type="circlePacking",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(e){let t,n,a,l,i,o,r,s,u,d,c,p,f,m=eve.initVis(e),g=m.series[0],h=[],y=[],x=0,b=[],v=[],F="",w={left:0,top:0,bottom:m.margin.bottom,right:m.margin.right},A=0,k=0,S=0,C=0,z=0,T=null,M=0,_=0,E=null,V=8,N={};function L(e){for(let t in this.source=0,this.target=0,this.measure=0,this.value=0,e)this.hasOwnProperty(t)&&(this[t]=e[t])}function B(){m.data.forEach(function(e){let t=e[g.sourceField],n=e[g.targetField],a={},l=g.groupField?e[g.groupField]:"";-1===y.indexOf(t)&&(a={name:t},g.groupField&&(a.group=l),y.push(t),v.push(a)),-1==y.indexOf(n)&&(a={name:n},g.groupField&&(a.group=l),y.push(n),v.push(a)),t&&t.length>x&&(x=t.length),n&&n.length>x&&(x=n.length)}),m.data.forEach(function(e){let t=e[g.sourceField],n=e[g.targetField],a=isNaN(+e[g.measureField])?0:+e[g.measureField],l=y.indexOf(t),i=y.indexOf(n),o=y.indexOf(n),r=y.indexOf(t),s=new L({source:l,target:i,value:1,measure:a});h.push(s);let u=new L({source:o,target:r,value:1,measure:a});h.push(u)}),h.forEach(function(e){let t=function(e,t,n){let a=new function(e){for(let t in this.count=0,this.totalMeasure=0,e)this.hasOwnProperty(t)&&(this[t]=e[t])},l=null;for(let i=0;i<=n.length-1;i++)(l=n[i]).source==e&&l.target==t&&(a.count=parseFloat(a.count)+1,a.totalMeasure=parseFloat(a.totalMeasure)+parseFloat(l.measure));return a}(e.source,e.target,h);if(-1==function(e,t,n){let a=-1;for(let l=0;l<=n.length-1;l++){let i=n[l];i.source==e&&i.target==t&&(a=l)}return a}(e.source,e.target,b)){let n=new L({source:e.source,target:e.target,value:+t.count,measure:+t.totalMeasure});b.push(n)}}),N.links=b,N.nodes=v}function G(){B(),N.nodes.forEach(function(e){e.name.length>=x&&(F=e.name,x=e.name.length)});let e=d3.min(N.links,function(e){return e.measure}),s=d3.max(N.links,function(e){return e.measure}),u=d3.range(e,s,(s-e)/(m.legend.gradientColors.length-1));u.push(s),1===u.length&&u.push(u[0]+1),m.domains.minY=e,m.domains.maxY=s,A=x*(m.yAxis.labelFontSize/2)+1,w.left=m.margin.left+A,w.top=m.margin.top+A,C=m.plot.width-m.plot.left-m.plot.right,z=m.plot.height-m.plot.top-m.plot.bottom,k=Math.min(C,z),t=d3.scaleBand().range([0,k-w.left]),n=d3.scaleLinear().domain([0,4]).clamp(!0),a=d3.scaleOrdinal(d3.schemeCategory10).domain(d3.range(10)),T=d3.scaleLinear().range(m.legend.gradientColors).domain(u),E=d3.scalePow().exponent(.5).domain([m.domains.minY,m.domains.maxY]).range([t.bandwidth(),t.bandwidth()]),l=[],i=N.nodes,o=i.length,S=k-A,i.forEach(function(e,t){e.index=t,e.count=0,l[t]=d3.range(o).map(function(e){return{x:e,y:t,z:0}})}),N.links.forEach(function(e){l[e.source][e.target].z+=e.value,l[e.target][e.source].z+=e.value,l[e.source][e.source].z+=e.value,l[e.target][e.target].z+=e.value,l[e.target][e.target].m+=e.measure,i[e.source].count+=e.value,i[e.target].count+=e.value}),r={name:d3.range(o).sort(function(e,t){return d3.ascending(i[e].name,i[t].name)}),count:d3.range(o).sort(function(e,t){return i[t].count-i[e].count}),group:d3.range(o).sort(function(e,t){return i[t].group-i[e].group})},"name"==g.orderMode?t.domain(r.name):"frequency"==g.orderMode?t.domain(r.count):"custom"==g.orderMode?t.domain(r.group):t.domain(r.name),m.updateLegend()}function D(e){let t="";return i.forEach(function(n,a){n.index===e&&(t=n.name)}),t}function I(){(u=O.selectAll(".row").data(l).enter().append("g").attr("class","row").attr("transform",function(e,n){return"translate(0,"+t(n)+")"}).each(P)).append("line").style("stroke","rgb(255,255,255)").attr("x2",S),u.append("text").attr("x",-8).attr("y",t.bandwidth()/2).attr("dy",".32em").attr("text-anchor","end").style("fill",m.yAxis.labelFontColor).style("font-size",m.yAxis.labelFontSize+"px").style("font-family",m.yAxis.labelFontFamily).style("font-style","bold"===m.yAxis.labelFontStyle?"normal":m.yAxis.labelFontStyle).style("font-weight","bold"===m.yAxis.labelFontStyle?"bold":"normal").text(function(e,t){return i[t].name}),(d=O.selectAll(".column").data(l).enter().append("g").attr("class","column").attr("transform",function(e,n){return"translate("+t(n)+")"})).append("line").style("stroke","rgb(255,255,255)").attr("y1",S),d.append("text").attr("x",6).attr("y",t.bandwidth()/2).attr("transform","rotate(-90)").attr("dy",".32em").attr("text-anchor","start").style("fill",m.xAxis.labelFontColor).style("font-size",m.xAxis.labelFontSize+"px").style("font-family",m.xAxis.labelFontFamily).style("font-style","bold"===m.xAxis.labelFontStyle?"normal":m.xAxis.labelFontStyle).style("font-weight","bold"===m.xAxis.labelFontStyle?"bold":"normal").text(function(e,t){return i[t].name})}function Z(e,t){let n={source:-1,target:-1,value:0,measure:0};return N.links.forEach(function(a){a.source==e&&a.target==t&&(n=a)}),n}function P(e){c=d3.select(this).selectAll(".cell").data(e).enter().append("rect").attr("class","cell").attr("x",function(e){return t(e.x)}).attr("width",t.bandwidth()).attr("height",t.bandwidth()).on("mousemove",function(e,t){let n=e.y,a=e.x,l=Z(n,a),i=D(n),o=D(a);-1!==l.source&&-1!==l.target&&m.showTooltip(m.getContent(l,g,m.tooltip.format,i,o))}).on("mouseout",function(e,t){m.hideTooltip()}).attr("opacity","add"===m.animation.effect?0:1).transition().duration(m.animation.duration).ease(m.animation.easing.toEasing()).delay(function(e,t){return t*m.animation.delay}).attr("opacity",1).style("fill",function(e){let t=Z(e.y,e.x);return-1!==t.source&&-1!==t.target?T(t.measure):"rgb(238,238,238)"}),p=d3.select(this).selectAll(".eve-cooccurence-label").data(e.filter(function(e){return e.z})).enter().append("text").style("pointer-events","none").style("fill",function(e){let t=Z(e.y,e.x);return"auto"===g.labelFontColor?m.getAutoColor(T(t.measure)):g.labelFontColor}).style("font-family",g.labelFontFamily).style("font-style","bold"===g.labelFontStyle?"normal":g.labelFontStyle).style("font-weight","bold"===g.labelFontStyle?"bold":"normal").style("font-size",V).text(function(e){let t=e.y,n=e.x,a=Z(t,n),l=D(t),i=D(n);return-1!==a.source&&-1!==a.target?m.getContent(a,g,g.labelFormat,l,i):""}).style("font-size",function(e){Z(e.y,e.x);return currentRadius=t.bandwidth()/2,"auto"===g.labelFontSize?e.fontSize=Math.min(2*currentRadius,(2*currentRadius-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*V):e.fontSize=g.labelFontSize,e.fontSize+"px"}).style("fill-opacity",function(e){return f=this.getBBox(),"auto"!==g.labelFontSize?1:"always"===g.labelVisibility?1:e.fontSize<8?0:f.width>t.bandwidth()?0:1}).transition().duration(m.animation.duration).ease(m.animation.easing.toEasing()).delay(function(e,t){return t*m.animation.delay}).attr("transform",function(e){return f=this.getBBox(),M=t(e.x)+(t.bandwidth()-f.width)/2,_=t.bandwidth()/2+(f.height/2-2),"translate("+M+","+_+")"})}G();let O=m.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+(C/2-k/2+w.left/2)+","+w.top+")");return s=O.append("rect").attr("class","eve-cooc-back").style("fill","rgb(238,238,238)").style("fill-opacity",1).attr("width",k-w.left).attr("height",k-w.top),I(),m.update=function(e){m.data=e,h=[],y=[],b=[],v=[],m.calculateDomain(),G(),m.animation.effect?"fade"===m.animation.effect?O.transition().duration(1e3).style("opacity",0).remove():"dim"===m.animation.effect?O.style("opacity",.15):"add"===m.animation.effect?O.style("opacity",1):O.remove():O.remove(),O=m.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+(C/2-k/2+w.left/2)+","+w.top+")"),I()},m.clear=function(){m.svg.selectAll(".eve-vis-g").remove()},m}e.cooccurenceMatrix=function(n){return n.type="cooccurenceMatrix",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)},e.cooccurence=function(n){return n.type="cooccurenceMatrix",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){e.dendrogram=function(t){return t.masterType="tree",t.type="dendrogram",t.yAxis&&(t.yAxis.stacked=!1),e.visualizations.push(t),new function(t){t.legend?t.legend.enabled=!1:t.legend={enabled:!1};let n=this,a=eve.initVis(t),l=a.series[0],i=0,o=0,r={left:0,top:0,bottom:0,right:0},s=0,u=0,d=0,c=null,p=null,f=0,m=null,g=null,h="",y="",x=null;function b(){x=d3.hierarchy(a.data).each(function(e){/^other[0-9]+$/.test(e.data[l.labelField])&&(e.data[l.labelField]=null)}).sum(function(e){return+e[l.sizeField]}).sort(function(e,t){return t.value-e.value}),"auto"===l.labelFontSize&&(l.labelFontSize=11),"auto"===l.labelFontColor&&(l.labelFontColor="#333333"),x.descendants().forEach(function(e){(h=a.getContent(e,l,l.labelFormat)).length>i&&(y=h,i=h.length)}),m=z.append("text").style("font-size",l.labelFontSize+"px").style("color",l.labelFontColor).style("font-family",l.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==l.labelFontStyle?"normal":l.labelFontStyle).style("font-weight","bold"==l.labelFontStyle?"bold":"normal").text(y),g=m.node().getBoundingClientRect(),m.remove(),o=g.width+10,r.left=a.margin.left+("linear"===l.direction?7:o),r.right=a.margin.right+o,r.top=a.margin.top+("linear"===l.direction?0:o),r.bottom=a.margin.bottom+("linear"===l.direction?0:o),s=a.plot.width-r.left-r.right,u=a.plot.height-r.top-r.bottom,d=Math.min(s,u)/2,c=a.data}function v(){z.attr("transform","translate("+r.left+","+r.top+")"),C(x)}function F(){z.attr("transform","translate("+(r.left+s/2)+","+(r.top+u/2)+")"),S()}function w(e){return"M"+e.y+","+e.x+"C"+(e.parent.y+100)+","+e.x+" "+(e.parent.y+100)+","+e.parent.x+" "+e.parent.y+","+e.parent.x}function A(e){e.children?(e._children=e.children,e.children=null):(e.children=e._children,e._children=null),"linear"===l.direction?C(e):S()}function k(e,t){let n=(e-90)/180*Math.PI,a=t;return[a*Math.cos(n),a*Math.sin(n)]}function S(t){(p=d3.cluster().size([360,d]))(x);let i=x.descendants(),o=i.slice(1);z.selectAll(".radialDendLink").remove(),z.selectAll(".radialDendNode").remove(),z.selectAll(".radialDendText").remove(),z.selectAll("path.radialDendLink").data(o,function(e){return e.id}).enter().append("g").attr("class","radialDendLink").insert("path").style("stroke",function(t){return e.colors[t.depth]}).style("stroke-width",function(e){let t=Math.round(Math.log(Math.abs(e.size)))/2;return t<1&&(t=1),n.lineMeasures?t:2}).style("stroke-opacity",.5).style("fill","none").style("fill-opacity",0).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attr("d",function(e){return"M"+k(e.x,e.y)+"C"+k(e.x,(e.y+e.parent.y)/2)+" "+k(e.parent.x,(e.y+e.parent.y)/2)+" "+k(e.parent.x,e.parent.y)});let r=z.selectAll("g.radialDendNode").data(i,function(e){return e.id||(e.id=++f)}).attr("fill","none").enter().append("g").attr("class","radialDendNode").attr("transform",function(e){return"translate("+k(e.x,e.y)+")"}).on("click",A);r.append("circle").attr("r",function(e){try{let t=e.data.size;if(!t)if(t=0,e.children)for(let n=0;n<=e.children.length-1;n++)t+=e.children[n].data.size;else if(e._children)for(let n=0;n<=e._children.length-1;n++)t+=e._children[n].data.size;let n=Math.round(Math.log(Math.abs(t)))/2;return n<1&&(n=1),n}catch(e){return 5.5}}).style("stroke",function(t){return e.colors[t.depth]}).style("fill",function(t){return e.colors[t.depth]}).on("mousemove",function(e,t){a.showTooltip(a.getContent(e,l,a.tooltip.format))}).on("mouseout",function(e,t){a.hideTooltip()}),r.append("text").attr("x",function(e){return e.x>=180||e.children||e._children?-5:5}).attr("dy",3).attr("class","radialDendText").attr("text-anchor",function(e){return e.x>=180||e.children||e._children?"end":"start"}).attr("transform",function(e){return e.parent?"rotate("+(e.x<180?e.x-90:e.x+90)+")":null}).text(function(e){return a.getContent(e,l,l.labelFormat)}).style("fill",l.labelFontColor).style("font-size",l.labelFontSize+"px").style("font-family",l.labelFontFamily).style("font-style","bold"===l.labelFontStyle?"normal":l.labelFontStyle).style("font-weight","bold"===l.labelFontStyle?"bold":"normal").style("pointer-events","none").style("text-shadow","0 1px 0 rgb(255,255,255), 1px 0 0 rgb(255,255,255), 0 -1px 0 rgb(255,255,255), -1px 0 0 rgb(255,255,255)").style("fill-opacity",1),r.attr("opacity","add"===a.animation.effect?0:1).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attr("opacity",1).attr("transform",function(e){return"translate("+k(e.x,e.y)+")"}),i.forEach(function(e){e.x0=e.x,e.y0=e.y})}function C(t){(p=d3.cluster().size([u,s]))(x);let n=x.descendants(),i=n.slice(1);z.selectAll(".dendLink").remove(),z.selectAll(".dendNode").remove(),z.selectAll(".dendText").remove();let o=z.selectAll("path.dendLink").data(i,function(e){return e.id}).enter().append("g").attr("class","dendLink").insert("path").style("stroke",function(t){return e.colors[t.depth]}).style("stroke-width",function(e){let t=Math.round(Math.log(Math.abs(e.size)))/2;return t<1&&(t=1),l.lineMeasures?t:2}).style("stroke-opacity",.5).style("fill","none").style("fill-opacity",0);o.transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attr("d",w),o.exit().transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attr("d",w).remove();let r=z.selectAll("g.dendNode").data(n,function(e){return e.id||(e.id=++f)}).attr("fill","none").enter().append("g").attr("class","dendNode").attr("transform",function(e){return"translate("+e.y+","+e.x+")"}).on("click",A);r.append("circle").attr("r",0).style("stroke",function(t){return e.colors[t.depth]}).style("fill",function(t){return e.colors[t.depth]}).on("mousemove",function(e,t){a.showTooltip(a.getContent(e,l,a.tooltip.format))}).on("mouseout",function(e,t){a.hideTooltip()}),r.append("text").attr("x",5).attr("dy",3).attr("class","dendText").attr("text-anchor","start").text(function(e){return a.getContent(e,l,l.labelFormat)}).style("fill",l.labelFontColor).style("font-size",l.labelFontSize+"px").style("font-family",l.labelFontFamily).style("font-style","bold"===l.labelFontStyle?"normal":l.labelFontStyle).style("font-weight","bold"===l.labelFontStyle?"bold":"normal").style("pointer-events","none").style("text-shadow","0 1px 0 rgb(255,255,255), 1px 0 0 rgb(255,255,255), 0 -1px 0 rgb(255,255,255), -1px 0 0 rgb(255,255,255)").style("fill-opacity",0);let d=r.attr("opacity","add"===a.animation.effect?0:1).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attr("opacity",1).attr("transform",function(e){return"translate("+e.y+","+e.x+")"});d.select("circle").style("stroke",function(t){return e.colors[t.depth]}).style("fill",function(t){return e.colors[t.depth]}).attr("opacity","add"===a.animation.effect?0:1).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attr("opacity",1).attr("r",function(e){try{let t=e.data.size;if(!t)if(t=0,e.children)for(let n=0;n<=e.children.length-1;n++)t+=e.children[n].data.size;else if(e._children)for(let n=0;n<=e._children.length-1;n++)t+=e._children[n].data.size;let n=Math.round(Math.log(Math.abs(t)))/2;return n<1&&(n=1),n}catch(e){return 5.5}}),d.select("text").style("fill-opacity",1).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attr("x",5);let c=r.exit().transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attr("transform",function(e){return"translate("+t.y+","+t.x+")"}).remove();c.select("circle").attr("r",0),c.select("text").style("fill-opacity",0).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attr("x",function(e){return 0})}let z=a.svg.append("g").attr("class","eve-vis-g");return b(),"linear"===l.direction?v():F(),a.update=function(e){a.data=e,a.animation.effect?"fade"===a.animation.effect?z.transition().duration(1e3).style("opacity",0).remove():"dim"===a.animation.effect?z.style("opacity",.15):"add"===a.animation.effect?z.style("opacity",1):z.remove():z.remove(),z=a.svg.append("g").attr("class","eve-vis-g"),b(),"linear"===l.direction?v():F()},a.clear=function(){a.svg.selectAll(".eve-vis-g").remove()},a}(t)}}(eve),function(e){function t(t){t.legend?t.legend.enabled=!1:t.legend={enabled:!1};let n,a,l,i,o,r=eve.initVis(t),s=r.series[0],u=0,d=0,c=null,p=0,f=0,m=0,g=0,h=0,y=null,x="",b=8;function v(){u=r.plot.width-r.plot.left-r.plot.right,d=r.plot.height-r.plot.top-r.plot.bottom,p=Math.min(u,d)/2/4,c=d3.hierarchy(r.data),m=r.domains.minY,g=d3.max(r.data.children,function(e){return+e.size}),s.maxBulletSize||(s.maxBulletSize=Math.sqrt(u*d/r.data.length/Math.PI)-5),s.minBulletSize||(s.minBulletSize=s.maxBulletSize*m/g),y=d3.scalePow().exponent(.5).domain([m,g]).range([s.minBulletSize,s.maxBulletSize]),i=function(e){let t=[];return function e(n){n.children&&n.children.forEach(e),n.id?++h:n.id=++h,t.push(n)}(e),t}(c),o=c.links(),"auto"===s.labelPosition&&(s.labelPosition="outside")}function F(){l=d3.forceSimulation().force("link",d3.forceLink().id(function(e){return e.id})).force("charge",d3.forceManyBody()).force("center",d3.forceCenter(u/2,d/2)).velocityDecay(c.links().length>100?.9:.2).force("x",d3.forceX().strength(5e-4)).force("y",d3.forceY().strength(5e-4)).on("tick",k),r.simulations.push(l),w()}function w(){(a=_.selectAll(".eve-force-tree-link").data(o,function(e){return e.target.id})).exit().remove();let e=a.enter().append("line").attr("class",function(e){return"eve-force-tree-link eve-force-tree-link-"+e.source.id}).style("stroke-width","1px").style("stroke","rgb(204,204,204)");a=e.merge(a),(n=_.selectAll(".eve-force-tree-node").data(i,function(e){return e.id})).exit().remove();let t=n.enter().append("g").attr("class",function(e){return"eve-force-tree-node eve-force-tree-node-"+e.id}).on("click",S).on("dblclick",C).call(d3.drag().on("start",z).on("drag",T).on("end",M));t.append("circle").attr("r",function(e){let t=0;return t=void 0===e.data[s.sizeField]?2*s.minBulletSize:y(e.data[s.sizeField]),e.cRadius=t,t}).style("fill",A).style("fill-opacity",.9).style("stroke",A).style("stroke-opacity",1).style("stroke-width","0px").on("mousemove",function(e,t){r.showTooltip(r.getContent(e,s,r.tooltip.format))}).on("mouseout",function(e,t){r.hideTooltip()}),s.labelFormat&&t.append("text").attr("class",function(e){return"eve-force-tree-text eve-force-tree-text-"+e.id}).attr("dy",".35em").attr("x",function(e){return"inside"===s.labelPosition?0:e.children?-8:8}).style("pointer-events","none").style("text-anchor",function(e){return"inside"===s.labelPosition?"middle":e.children?"end":"start"}).style("fill",function(e,t){return x=A(e),"auto"===s.labelFontColor?r.getAutoColor(x):s.labelFontColor}).style("font-family",s.labelFontFamily).style("font-style","bold"===s.labelFontStyle?"normal":s.labelFontStyle).style("font-weight","bold"===s.labelFontStyle?"bold":"normal").text(function(e){return r.getContent(e,s,s.labelFormat)}).style("font-size",function(e){return"inside"===s.labelPosition?e.fontSize=Math.min(2*e.cRadius,(2*e.cRadius-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*b):e.fontsize="auto"===s.labelFontSize?b:s.labelFontSize,e.fontSize<b&&(e.fontSize=b),e.fontSize+"px"}),n=t.merge(n),l.nodes(i),l.force("link").links(o)}function A(t){return(f=t.children?t.depth:t.depth+1)>=e.colors.length?e.randColor():e.colors[f]}function k(){a.attr("x1",u/2).attr("y1",d/2).attr("x2",u/2).attr("y2",d/2).attr("opacity","add"===r.animation.effect?0:1).transition().duration(r.animation.duration).ease(r.animation.easing.toEasing()).delay(function(e,t){return t*r.animation.delay}).attr("opacity",1).attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),n.attr("opacity","add"===r.animation.effect?0:1).attr("transform","translate("+u/2+","+d/2+")").transition().duration(r.animation.duration).ease(r.animation.easing.toEasing()).delay(function(e,t){return t*r.animation.delay}).attr("opacity",1).attr("transform",function(e){return"translate("+e.x+","+e.y+")"})}function S(e){if(!d3.event.defaultPrevented){let t=_.selectAll(".eve-force-tree-link-"+e.id),l=_.selectAll(".eve-force-tree-node-"+e.id),i=null;s.labelFormat&&(i=_.selectAll(".eve-force-tree-text-"+e.id)),e.selected=!e.selected,a.style("stroke-width","1px").style("stroke","rgb(204,204,204)"),n.style("fill-opacity",.9).style("stroke-opacity",1),e.selected&&(n.style("fill-opacity",.2).style("stroke-opacity",.2),l.style("fill-opacity",.9).style("stroke-opacity",1),e.children&&e.children.length>0&&e.children.forEach(function(e){_.selectAll(".eve-force-tree-node-"+e.id).style("fill-opacity",.9).style("stroke-opacity",1),s.labelFormat&&_.selectAll(".eve-force-tree-text-"+e.id).style("fill-opacity",1)}),t.style("stroke","rgb(0,102,204)").style("stroke-width","2px"),s.labelFormat&&i.style("fill-opacity",1))}}function C(e){e.children?(e._children=e.children,e.children=null,w(),l.restart()):(e.children=e._children,e._children=null,w(),l.restart())}function z(e){d3.event.active||l.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y}function T(e){e.fx=d3.event.x,e.fy=d3.event.y}function M(e){e.fixed=!0,d3.select(this).classed("fixed",!0)}r.simulations=[],v();let _=r.svg.append("g").attr("width",u).attr("height",d).attr("class","eve-vis-g");return F(),r.update=function(e){r.data=e,r.calculateDomain(),v(),r.animation.effect?"fade"===r.animation.effect?_.transition().duration(1e3).style("opacity",0).remove():"dim"===r.animation.effect?_.style("opacity",.15):"add"===r.animation.effect?_.style("opacity",1):_.remove():_.remove(),_=r.svg.append("g").attr("width",u).attr("height",d).attr("class","eve-vis-g"),F()},r.clear=function(){r.svg.selectAll(".eve-vis-g").remove()},r}e.force=function(n){return n.masterType="tree",n.type="force",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){let n=eve.initVis(t),a=n.series[0],l=0,o=null,r=null,s=0,u={left:0,top:0,right:0,bottom:0},d=d3.utcFormat("%x"),c=0,p=0,f=0,m=0,g=0,h=0,y=null,x=null,b=null,v=null,F=[],w=[],A=null,k=null,S=null,C=0,z=!1,T=0,M=0,_=null,E=null,V=null,N=a.startField||a.startDateField,L=a.endField||a.endDateField;function B(t){l=d3.max(n.data,function(e){return e[a.sourceField].toString().length}),F=e.getUniqueValues(n.data,a.sourceField),w=e.getUniqueValues(n.data,a.groupField),o=d3.min(n.data,function(e){return new Date(e[N])}),r=d3.max(n.data,function(e){return new Date(e[L])}),f=r.diff(o),d=f>365?d3.utcFormat("%e-%b-%Y"):f<1?d3.utcFormat("%X"):d3.utcFormat("%b-%e"),s=n.yAxis.labelFontSize/2*(l+1)+n.yAxis.labelFontSize,u.left=n.margin.left+s,u.right=n.margin.right,u.top=n.margin.top,u.bottom=n.margin.bottom,c=n.plot.width-n.plot.left-n.plot.right-u.left-u.right,p=n.plot.height-n.plot.top-n.plot.bottom-u.top-u.bottom,m=d(r).length,g=n.xAxis.labelFontSize/2*m+n.xAxis.labelFontSize,h=Math.floor(c/g),y=d3.scaleUtc().domain([o,r]).range([0,c]).clamp(!0),x=d3.scaleBand().domain(F).range([p-u.top-u.bottom,0]).padding(.1),b=d3.axisBottom().scale(y).ticks(h/2).tickFormat(d),v=d3.axisLeft().scale(x).tickSize(0),"auto"===a.labelFontSize&&(a.labelFontSize=11)}function G(){A=R.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform","translate(0,"+(p-u.bottom-u.top)+")").attr("class","eve-x-axis").call(b),V=R.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform","translate(0)").attr("class","eve-y-axis").call(v),A.selectAll("path").style("stroke-opacity",n.xAxis.alpha).style("stroke-width",n.xAxis.thickness+"px").style("stroke",n.xAxis.color),A.selectAll("line").style("fill","none").style("stroke-width",n.xAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",n.xAxis.alpha).style("stroke",n.xAxis.color),A.selectAll("text").style("fill",n.xAxis.labelFontColor).style("font-size",n.xAxis.labelFontSize+"px").style("font-family",n.xAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.xAxis.labelFontStyle?"normal":n.xAxis.labelFontStyle).style("font-weight","bold"===n.xAxis.labelFontStyle?"bold":"normal").style("text-anchor","middle").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).text(function(e){return d(new Date(e))}),V.selectAll("path").style("stroke-opacity",n.yAxis.alpha).style("stroke-width",n.yAxis.thickness+"px").style("stroke",n.yAxis.color),V.selectAll("line").style("fill","none").style("stroke-width",n.yAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",n.yAxis.alpha).style("stroke",n.yAxis.color),V.selectAll("text").style("fill",n.yAxis.labelFontColor).style("font-size",n.yAxis.labelFontSize+"px").style("font-family",n.yAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.yAxis.labelFontStyle?"normal":n.yAxis.labelFontStyle).style("font-weight","bold"===n.yAxis.labelFontStyle?"bold":"normal").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).text(function(e){return e})}let D=function(e){return e[N]+e[a.sourceField]+e[L]},I=function(e,t){return"translate("+(t?0:y(new Date(e[N])))+","+x(e[a.sourceField])+")"},Z=function(e,t){return T=t?0:y(new Date(e[N]))+5,M=x(e[a.sourceField])+x.bandwidth()/2+a.labelFontSize/2,"translate("+T+","+M+")"},P=function(t){let l=e.colors[0],o=[];return n.data.forEach(function(e){-1===o.indexOf(e[a.groupField])&&o.push(e[a.groupField])}),o.sort(),a.groupField?n.legend.legendColors&&n.legend.legendColors.length?n.legend.legendColors.forEach(function(e){e.value===t[a.groupField]&&(l=e.color)}):o.forEach(function(n,i){n===t[a.groupField]&&(l=i>e.colors.length?e.randColor():e.colors[i])}):l=n.legend.legendColors.length>0?n.legend.legendColors[0].color:i>=e.colors.length?e.randColor():e.colors[0],l};function O(){k.attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("opacity",1).style("fill",P).attr("transform",function(e){return I(e,!1)}).attr("rx",2).attr("ry",2).attr("y",0).attr("height",function(e){return x.bandwidth()}).attr("width",function(e){return(C=y(new Date(e[L]))-y(new Date(e[N])))<0?0:C}),S.style("fill-opacity",function(e){return _=this.getBBox(),C=y(new Date(e[L]))-y(new Date(e[N])),"always"===a.labelVisibility?C<0?0:1:C>_.width?1:0}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("transform",function(e){return Z(e,!1)})}function Y(){k=R.selectAll(".eve-gantt-chart").data(n.data,D).enter().append("rect").attr("class","eve-gantt-chart").attr("fill",P).attr("fill-opacity",a.alpha).attr("rx",2).attr("ry",2).attr("y",0).attr("height",function(e){return x.bandwidth()}).attr("width",0).attr("transform",function(e){return I(e,!0)}).style("cursor","pointer").on("click",function(e,t){null==e.clicked?e.clicked=!0:e.clicked=!e.clicked,e.clicked?(z=!0,R.selectAll(".eve-gantt-chart").attr("fill-opacity",.05),R.selectAll(".eve-gantt-labels").attr("fill-opacity",.05),d3.select(this).attr("fill-opacity",1),d3.select("#"+n.container+"_svgText_"+t).attr("fill-opacity",1)):(z=!1,R.selectAll(".eve-gantt-chart").attr("fill-opacity",1),R.selectAll(".eve-gantt-labels").attr("fill-opacity",1))}).on("mousemove",function(e,t){z||(n.showTooltip(n.getContent(e,a,n.tooltip.format)),d3.select(this).attr("fill-opacity",1))}).on("mouseout",function(e,t){z||(n.hideTooltip(),d3.select(this).attr("fill-opacity",a.alpha))}),S=R.selectAll(".eve-gantt-labels").data(n.data,D).enter().append("text").attr("class","eve-gantt-labels").style("pointer-events","none").style("text-anchor","start").style("fill",function(e,t){return E=P(e,t),"auto"===a.labelFontColor?n.getAutoColor(E):a.labelFontColor}).style("font-family",a.labelFontFamily).style("font-style","bold"===a.labelFontStyle?"normal":a.labelFontStyle).style("font-weight","bold"===a.labelFontStyle?"bold":"normal").style("font-size",a.labelFontSize+"px").text(function(e){return n.getContent(e,a,a.labelFormat)}).attr("transform",function(e){return Z(e,!0)})}B();let R=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+u.left+","+n.plot.top+")");return G(),Y(),O(),n.update=function(e,t){n.data=e,n.updateLegend(),B(),n.animation.effect?"fade"===n.animation.effect?R.transition().duration(1e3).style("opacity",0).remove():"dim"===n.animation.effect?R.style("opacity",.15):"add"===n.animation.effect?R.style("opacity",1):R.remove():R.remove(),R=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+u.left+","+n.plot.top+")"),G(),Y(),O()},n.clear=function(){n.svg.selectAll(".eve-vis-g").remove()},n}e.gantt=function(n){return n.masterType="grouped",n.type="gantt",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)},e.gannt=function(n){return n.masterType="grouped",n.type="gantt",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t,n){t.legend?t.legend.enabled=!1:t.legend={enabled:!1};let a=eve.initVis(t),l=a.series[0];"number"!=typeof a.data&&(a.data=0),null!=l.minRange&&"number"==typeof l.minRange||(l.minRange=0),null!=l.maxRange&&"number"==typeof l.maxRange||(l.maxRange=0),0===l.minRange&&0===l.maxRange&&(l.minRange=0,l.maxRange=100);let i,o,r,s,u,d=0,c=null==a.data,p=+a.data,f=+a.data,m=0,g=0,h=0,y=0,x=0,b=0,v=a.plot.width-a.plot.left-a.plot.right,F=a.plot.height,w=0,A=0,k=0,S=0,C=0,z=0,T=null,M=null,_=null,E=null,V=null,N=null,L=null,B=null,G=null,D=null,I=null,Z=0,P=5,O=null,Y=null,R=""!==l.title,H=R?F/P:0,U=0,W=0,q="",X=null,j=0,K=8,$=l.color?l.color:e.colors[0],J=document.getElementById(a.container),Q=e.offset(J),ee=Number.MIN_VALUE,te=0,ne=0,ae=0,le=0,ie=0,oe=0,re=0,se=0,ue=0,de=l.labelFormat?"auto"===l.labelFontSize?11:l.labelFontSize:0,ce=a.plot.height,pe=a.plot.width,fe=0,me=0;function ge(e){let t=Math.abs(e)/d*100-l.minRange/d*100;return isNaN(t)&&(t=0),t}function he(e,t){return t/e*100-l.minRange/e*100}function ye(e){return function(e){return e/d*270-(l.minRange/d*270+45)}(e)*Math.PI/180}function xe(e,t){let n={x:y-g*t*Math.cos(ye(e)),y:x-g*t*Math.sin(ye(e))};return isNaN(n.x)&&(n.x=0),isNaN(n.y)&&(n.y=0),n}function be(e){let t=d/13,n=xe(e,.85),a=xe(e-t,.12),l=xe(e+t,.12),i=e-d*(1/.75)/2,o=xe(i,.28),r=xe(i-t,.12);return[n,a,xe(i+t,.12),o,r,l,n]}function ve(e,t){let n=d3.interpolate(t||0,e);return function(e){return M(n(e))}}function Fe(){J=document.getElementById(a.container),Q=e.offset(J),v=Q.width+a.margin.left,F=Q.height+a.margin.top,a.svg.remove(),a.svg=d3.select("#"+a.innerContainer).append("svg").attr("id",a.container+"_svg").attr("class","vis_svg").attr("width",v-a.margin.left).attr("height",F-a.margin.top),(Ae=a.svg.append("g").attr("transform","translate(0,0)").attr("width",v).attr("height",F+a.margin.top)).append("rect").attr("width",v).attr("height",F).style("fill","transparent").attr("x",0).attr("y",0),l.minRange<0?(d=l.maxRange-l.minRange,U=Math.abs(l.minRange)/d,W=Math.abs(l.maxRange)/d,o=Math.abs(f)/d*100,f>0?(i=v*U,L=Ae.append("rect").style("fill",$).style("fill-opacity",l.alpha).attr("y",0).attr("height",F).attr("x",i).attr("width",v*o/100)):(i=v*U-v*o/100,L=Ae.append("rect").style("fill",l.negativeColor).style("fill-opacity",l.alpha).attr("y",0).attr("height",F).attr("x",i).attr("width",v*o/100))):L=Ae.append("rect").style("fill",$).style("fill-opacity",l.alpha).attr("x",0).attr("y",0).attr("width",v*w/100).attr("height",F),N=Ae.append("text").style("fill","#333333").style("font-size",("auto"===l.labelFontSize?11:l.labelFontSize)+"px").style("font-family",l.labelFontFamily).style("font-style","bold"===l.labelFontStyle?"normal":l.labelFontStyle).style("font-weight","bold"===l.labelFontStyle?"bold":"normal").style("text-anchor",function(){if(l.labelPosition){if("right"===l.labelPosition)return"end";if("center"===l.labelPosition)return"middle"}return"start"}).text(l.labelHidden?"":c?"":e.formatNumber(a.data,l.numberFormat||l.labelFormat)).attr("transform",function(){return X=this.getBBox(),r=X.height,i=0,l.labelPosition&&("right"===l.labelPosition?i=v-a.margin.left:"center"===l.labelPosition&&(i=(v-a.margin.left)/2)),"translate("+i+","+r+")"})}function we(){a.marker||(a.marker=0),"auto"===l.labelFontSize&&(l.labelFontSize=11),a.trends.forEach(function(e){e.end>ee&&(ee=e.end)}),a.data>ee&&(ee=a.data),a.marker>ee&&(ee=a.marker),l.maxLength||(l.maxLength=l.labelFormat.length),"vertical"===l.orientation?(re=a.plot.width/5,N=Ae.append("text").text(l.labelFormat).style("fill","auto"===l.labelFontColor?a.getAutoColor($):l.labelFontColor).style("font-size",("auto"===l.labelFontSize?11:l.labelFontSize)+"px").style("font-family",l.labelFontFamily).style("font-style","bold"===l.labelFontStyle?"normal":l.labelFontStyle).style("font-weight","bold"===l.labelFontStyle?"bold":"normal").style("text-anchor","middle").attr("transform",function(e){return r="auto"===l.labelFontSize?11:l.labelFontSize,i=a.plot.width/2,X=this.getBBox(),de=X.height+2,"translate("+i+", "+r+")"}),ce=a.plot.height-de,a.trends.forEach(function(t){Ae.append("rect").attr("fill",t.color).attr("fill-opacity",l.alpha).attr("width",a.plot.width).attr("height",function(){return te=he(ee,t.end-t.start),le=ce*te/100}).attr("x",a.margin.left).attr("y",function(e){return te=he(ee,t.end-t.start),le=ce*te/100,w=he(ee,t.start),(r=ce-(le+ce*w/100))+de}).on("mousemove",function(n,i){q=(t.title||t.name)+" starts from "+e.formatNumber(t.start,l.numberFormat||l.labelFormat)+" ends at "+e.formatNumber(t.end,l.numberFormat||l.labelFormat),a.showTooltip(q)}).on("mouseout",function(e,t){a.hideTooltip()})}),L=Ae.append("rect").attr("fill",$).on("mousemove",function(t,n){q=e.formatNumber(a.data,l.numberFormat||l.labelFormat),a.showTooltip(q)}).on("mouseout",function(e,t){a.hideTooltip()}).attr("width",a.plot.width-re).attr("height",0).attr("x",re/2).attr("y",a.plot.height).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).attr("height",function(){return w=he(ee,a.data),ie=ce*w/100}).attr("y",function(){return ce-ie+de}),G=Ae.append("rect").attr("fill","#333333").attr("width",a.plot.width-re).attr("height",5).on("mousemove",function(t,n){q=e.formatNumber(a.marker,l.numberFormat||l.labelFormat),a.showTooltip(q)}).on("mouseout",function(e,t){a.hideTooltip()}).attr("x",re/2).attr("y",a.plot.height).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).attr("y",function(){return ue=he(ee,a.marker),(r=ce-(ie=ce*ue/100)+de)<0?0:r})):(se=a.plot.height/5,N=Ae.append("text").text(l.labelFormat).style("fill","auto"===l.labelFontColor?a.getAutoColor($):l.labelFontColor).style("font-size",("auto"===l.labelFontSize?11:l.labelFontSize)+"px").style("font-family",l.labelFontFamily).style("font-style","bold"===l.labelFontStyle?"normal":l.labelFontStyle).style("font-weight","bold"===l.labelFontStyle?"bold":"normal").style("text-anchor","start").attr("transform",function(e){return X=this.getBBox(),i=0,r=a.plot.height/2,"translate("+i+", "+r+")"}),fe=l.maxLength*(l.labelFontSize/2)+1,pe=a.plot.width-fe,a.trends.forEach(function(t){Ae.append("rect").attr("fill",t.color).attr("fill-opacity",l.alpha).attr("width",function(e){return ne=he(ee,t.end-t.start),ae=pe*ne/100}).attr("height",a.plot.height).attr("x",function(e){return X=this.getBBox(),i=fe+me,me+=X.width,i}).attr("y",0).on("mousemove",function(n,i){q=(t.title||t.name)+" starts from "+e.formatNumber(t.start,l.numberFormat||l.labelFormat)+" ends at "+e.formatNumber(t.end,l.numberFormat||l.labelFormat),a.showTooltip(q)}).on("mouseout",function(e,t){a.hideTooltip()})}),L=Ae.append("rect").attr("fill",$).on("mousemove",function(t,n){q=e.formatNumber(a.data,l.numberFormat||l.labelFormat),a.showTooltip(q)}).on("mouseout",function(e,t){a.hideTooltip()}).attr("width",0).attr("height",a.plot.height-se).attr("x",fe).attr("y",se/2).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).attr("width",function(){return w=he(ee,a.data),oe=pe*w/100}),G=Ae.append("rect").attr("fill","#333333").on("mousemove",function(t,n){q=e.formatNumber(a.marker,l.numberFormat||l.labelFormat),a.showTooltip(q)}).on("mouseout",function(e,t){a.hideTooltip()}).attr("width",5).attr("height",a.plot.height-se).attr("x",fe).attr("y",se/2).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).attr("x",function(){return ue=he(ee,a.marker),(i=(oe=pe*ue/100)+fe)>pe?pe:i}))}a.data>l.maxRange&&(l.maxRange=a.data),d=l.maxRange-l.minRange,w=ge(f);let Ae=null;switch("linear"!==n&&(Ae=a.svg.append("g").attr("width",v).attr("height",F).on("click",function(){a.onClick&&a.onClick()})),n){case"standard":b=10,m=a.trends.length>0?b:0,g=(Math.min(v,F)-m)/2,S=.5*(k=g/4),C=.4*k,z=.9*k,y=(v-m)/2,x=F/2+(h=g/2+b),T=d3.arc().outerRadius(g).innerRadius(h).startAngle(0).endAngle(Math.PI),M=d3.arc().outerRadius(g).innerRadius(h).startAngle(0).endAngle(function(e){return e/100*Math.PI}),B=Ae.append("g").attr("transform","translate(0,"+(x-y)+")"),D=B.append("path").attr("transform","rotate(270,"+y+",0)").style("fill",l.backColor).style("stroke",l.borderColor).attr("d",T),I=B.append("path").attr("transform","rotate(270,"+y+",0)").attr("class","eve-handle").style("fill",$).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attrTween("d",function(){return ve(w)}),a.trends.forEach(function(t,n){let i=0,o=0,r=ge(t.start),s=ge(t.end),u=null;i=r/100*Math.PI,o=s/100*Math.PI,u=d3.arc().outerRadius(g+b).innerRadius(g).startAngle(i).endAngle(o),t.start>=l.minRange&&t.start<=l.maxRange&&t.end>=l.minRange&&t.end<=l.maxRange&&t.end>=t.start&&B.append("path").attr("transform","rotate(270,"+y+",0)").style("fill",t.color).style("fill-opacity",l.alpha).attr("d",u).on("mousemove",function(n,i){d3.select(this).attr("fill-opacity",1),q=(t.title||t.name)+" starts from "+e.formatNumber(t.start,l.numberFormat||l.labelFormat)+" ends at "+e.formatNumber(t.end,l.numberFormat||l.labelFormat),a.showTooltip(q)}).on("mouseout",function(e,t){d3.select(this).attr("fill-opacity",l.alpha),a.hideTooltip()})}),l.isSparkline||(""!==l.title&&(_=Ae.append("text").text(l.title).style("fill",l.titleColor).style("font-size",k+"px").style("text-anchor","middle").attr("x",y).attr("y",x-g-k/2)),E=Ae.append("text").text(e.formatNumber(l.minRange,l.numberFormat||l.labelFormat)).style("fill",l.labelFontColor).style("font-size",S+"px").style("text-anchor","start").attr("x",function(e){return y-g}).attr("y",x+S),V=Ae.append("text").text(e.formatNumber(l.maxRange,l.numberFormat||l.labelFormat)).style("fill",l.labelFontColor).style("font-size",S+"px").style("text-anchor","end").attr("x",function(e){return y+g}).attr("y",x+S),L=Ae.append("text").text(e.formatNumber(p,l.numberFormat||l.labelFormat)).style("fill",l.labelFontColor).style("font-size",z+"px").style("text-anchor","middle").attr("x",y).attr("y",x),N=Ae.append("text").text(l.labelFormat).style("fill",l.labelFontColor).style("font-size",C+"px").style("text-anchor","middle").attr("x",y).attr("y",x+z/2));break;case"dial":!function(){Z=Math.min(v,F),g=Z/2,y=v/2,x=F/2,d=l.maxRange-l.minRange,k=Z/12,S=Z/20,z=Z/11,O=be(a.data),Y=d3.line().x(function(e){return e.x}).y(function(e){return e.y}),Ae.append("circle").attr("cx",y).attr("cy",x).attr("r",g).style("fill",l.backColor).style("stroke",l.borderColor).style("stroke-width","0.5px"),Ae.append("circle").attr("cx",y).attr("cy",x).attr("r",.9*g).style("fill",l.fillColor?l.fillColor:"rgb(255,255,255)").style("stroke",d3.color(l.borderColor).darker(.2)).style("stroke-width","1px"),""!==l.title&&(_=Ae.append("text").text(l.title).style("fill",l.titleColor).style("font-size",k+"px").style("text-anchor","middle").attr("x",y).attr("y",x-.8*g+k).attr("dy",k/2)),(B=Ae.append("g").attr("transform","translate(0,"+(x-y)+")")).selectAll(".eve-gauge-trend").data(a.trends).enter().append("path").attr("class","eve-gauge-trend").style("fill",function(e){return e.color}).attr("transform","rotate(270,"+y+",0)").on("mousemove",function(t,n){d3.select(this).attr("fill-opacity",1),q=(t.title||t.name)+" starts from "+e.formatNumber(t.start,l.numberFormat||l.labelFormat)+" ends at "+e.formatNumber(t.end,l.numberFormat||l.labelFormat),a.showTooltip(q)}).on("mouseout",function(e,t){d3.select(this).attr("fill-opacity",l.alpha),a.hideTooltip()}).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attrTween("d",function(e){return d3.arc().outerRadius(.88*g).innerRadius(.8*g).startAngle(ye(e.start)).endAngle(ye(e.end))});let t=d/(l.majorTicks-1);for(let n=l.minRange;n<=l.maxRange;n+=t){let a=t/l.minorTicks;for(let e=n+a;e<Math.min(n+t,l.maxRange);e+=a)s=xe(e,.75),u=xe(e,.85),Ae.append("line").attr("x1",s.x).attr("y1",s.y).attr("x2",u.x).attr("y2",u.y).style("stroke",d3.color(l.borderColor).darker(.3)).style("stroke-width","1px");if(s=xe(n,.7),u=xe(n,.85),Ae.append("line").attr("x1",s.x).attr("y1",s.y).attr("x2",u.x).attr("y2",u.y).style("stroke",d3.color(l.borderColor).darker(.5)).style("stroke-width","2px"),n==l.minRange||n==l.maxRange){let t=xe(n,.63);Ae.append("text").attr("x",t.x).attr("y",t.y).attr("dy",S/3).style("text-anchor",n==l.minRange?"start":"end").text(e.formatNumber(n,l.numberFormat||l.labelFormat)).style("font-size",S+"px").style("fill",l.labelFontColor)}}(L=Ae.append("g").attr("class","eve-gauge-handle")).selectAll("path").data([be(l.minRange)]).enter().append("path").attr("d",Y).style("fill",$).style("stroke",d3.color($).darker(.5)).style("fill-opacity",.7),O=be(a.data),L.selectAll("path").data([O]).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attr("d",Y),Ae.append("circle").attr("cx",y).attr("cy",x).attr("r",.12*g).style("fill",l.backColor).style("stroke",l.borderColor).style("fill-opacity",1),N=Ae.append("text").text(e.formatNumber(p,l.numberFormat||l.labelFormat)).style("fill",l.labelFontColor).style("font-size",z+"px").style("text-anchor","middle").attr("x",v/2).attr("y",x+g-z-z/2),Ae.append("text").text(l.labelFormat).style("fill",l.labelFontColor).style("font-size",z/2+"px").style("text-anchor","middle").attr("x",v/2).attr("y",x+g-z)}();break;case"digital":z=v/6,x=H/2+(k=H/1.5)/2-P,y=v/2,valueHeight=F-H,Ae.append("rect").attr("width",v).attr("height",F).style("fill",l.backColor).style("stroke",l.borderColor).style("stroke-width","0.5px"),R&&(Ae.append("rect").attr("width",v).attr("height",H).style("fill",d3.color(l.backColor).darker(.2)).style("stroke",l.borderColor),Ae.append("text").text(l.title).style("fill",l.titleColor).style("font-family","Arial").style("font-size","10px").style("font-size",function(e){var t=(H-6)/this.getBBox().height*10,n=(v-6)/this.getComputedTextLength()*10;return k=Math.min(t,n),x=H/2+k/2-P,k+"px"}).style("text-anchor","middle").attr("x",y).attr("y",x)),N=Ae.append("text").style("font-size",K+"px").text(e.formatNumber(a.data,l.numberFormat||l.labelFormat)).style("fill",$).style("font-family","Arial").style("font-size",function(t){return j=v/2,(z=Math.min(2*j,(2*j-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*K))>valueHeight&&(z=valueHeight),"Firefox"===e.getBrowserName()&&(z-=10)<K&&(z=K),z+"px"}).style("text-anchor","middle").attr("x",y).attr("y",function(){return(F-H)/2+z/2+K}),Ae.append("text").text(l.labelFormat).style("fill",l.handleColor).style("font-family","Arial").style("font-size",z/2+"px").style("text-anchor","middle").attr("x",v/2).attr("y",F/2+z);break;case"bullet":we();break;case"linear":Fe();break}return a.update=function(t,i){switch(0===arguments.length&&(t=a.data),p=t,A=w,a.data=t,f=t,A>100&&(A=100),i&&(a.marker=i),a.data>l.maxRange&&(l.maxRange=a.data),(w=ge(f))>100&&(w=100),n){case"standard":L.transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).text(e.formatNumber(f,l.numberFormat||l.labelFormat)),Ae.selectAll(".eve-handle").transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attrTween("d",function(){return ve(w,A)});break;case"dial":N.transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).text(e.formatNumber(f,l.numberFormat||l.labelFormat)),O=be(a.data),L.selectAll("path").data([O]).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attr("d",Y);break;case"digital":N.text(e.formatNumber(a.data,l.numberFormat||l.labelFormat));break;case"linear":Ae.remove(),Fe();break;case"bullet":Ae.remove(),Ae=a.svg.append("g").attr("width",v).attr("height",F),fe=0,me=0,we();break}},a}e.standardGauge=function(n){return n.type="standardGauge",e.visualizations.push(n),new t(n,"standard")},e.dialGauge=function(n){return n.type="dialGauge",e.visualizations.push(n),new t(n,"dial")},e.digitalGauge=function(n){return n.type="digitalGauge",e.visualizations.push(n),new t(n,"digital")},e.linearGauge=function(n){return n.type="linearGauge",e.visualizations.push(n),new t(n,"linear")},e.linearBullet=function(n){return n.type="linearBullet",e.visualizations.push(n),new t(n,"bullet")}}(eve),function(e){e.heatmap=function(t){return t.type="heatmap",t.yAxis&&(t.yAxis.stacked=!1),e.visualizations.push(t),new function(t){let n=eve.initVis(t),a=n.series[0],l=[],i=[],o={left:0,right:n.margin.right,top:0,bottom:n.margin.bottom},r=0,s=0,u=0,d=0,c=0,p=0,f=0,m=0,g=null,h=null,y=null,x=null,b=null,v=null,F=null,w=0,A=0,k=0,S=8,C="",z=null;function T(t){l=n.xAxis.values?n.xAxis.values:e.getUniqueValues(n.data,a.sourceField),i=n.yAxis.values?n.yAxis.values:e.getUniqueValues(n.data,a.targetField),rowDataProps=typeof n.data[0][a.sourceField],C=typeof n.data[0][a.targetField],l.sort(d3.ascending),i.sort(d3.ascending),u=d3.max(l,function(t){return"date"===e.getType(t)?e.formatDate(t).toString().length:t?t.toString().length:0}),d=d3.max(i,function(t){return"date"===e.getType(t)?e.formatDate(t).toString().length:t?t.toString().length:0}),c=n.yAxis.labelFontSize/2*(u+1)+n.yAxis.labelFontSize,p=n.xAxis.labelFontSize/2*(d+1)+n.xAxis.labelFontSize,o.left=n.margin.left+c,o.top=n.margin.top+p,r=n.plot.width-n.plot.left-n.plot.right-o.left-o.right,s=n.plot.height-n.plot.top-n.plot.bottom-o.top-o.bottom,f=r/i.length,m=s/l.length,w=Math.min(f,m);let h=d3.range(n.domains.minY,n.domains.maxY,(n.domains.maxY-n.domains.minY)/(n.legend.gradientColors.length-1));h.push(n.domains.maxY),g=d3.scaleLinear().range(n.legend.gradientColors).domain(h),v=d3.scalePow().exponent(.5).domain([n.domains.minY,n.domains.maxY]).range([w,w])}function M(){h.attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("opacity",1).attr("x",function(e){return i.indexOf(e[a.targetField])*f}).attr("y",function(e){return l.indexOf(e[a.sourceField])*m}).attr("width",f).attr("height",m).style("fill",function(e){return e[a.measureField]?g(+e[a.measureField]):"none"}),y.style("fill-opacity",function(e){return b=this.getBBox(),"auto"!==a.labelFontSize?1:"always"===a.labelVisibility?1:f>b.width?1:0}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("x",function(e){return b=this.getBBox(),i.indexOf(e[a.targetField])*f+f/2-b.width/2}).attr("y",function(e){return l.indexOf(e[a.sourceField])*m+m/2+e.fontSize/2}),x.transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("x",0).attr("y",function(e,t){return t*m}).attr("transform",function(e,t){return"translate(-6,"+(this.getBBox().height/2+m/2-4)+")"}),z.transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("x",0).attr("y",function(e,t){return t*f}).attr("transform","translate("+f/2+", -6)rotate(-90)")}function _(){h=E.selectAll(".eve-heatmap-data").data(n.data).enter().append("rect").attr("class","eve-heatmap-data eve-heatmap-cell").attr("x",0).attr("y",function(e){return l.indexOf(e[a.sourceField])*m}).attr("width",0).attr("height",m).style("fill",function(e){return g(+e[a.measureField])}).on("mousemove",function(e,t){n.showTooltip(n.getContent(e,a,n.tooltip.format))}).on("mouseout",function(e,t){n.hideTooltip()}),y=E.selectAll(".eve-heatmap-labels").data(n.data).enter().append("text").attr("class","eve-heatmap-labels").style("pointer-events","none").style("text-anchor","start").style("fill",function(e){return F=g(+e[a.measureField]),"auto"===a.labelFontColor?n.getAutoColor(F):a.labelFontColor}).style("font-family",a.labelFontFamily).style("font-style","bold"===a.labelFontStyle?"normal":a.labelFontStyle).style("font-weight","bold"===a.labelFontStyle?"bold":"normal").text(function(e){return n.getContent(e,a,a.labelFormat)}).style("font-size",function(e){return A=+e[a.measureField],k=v(A),"auto"===a.labelFontSize?e.fontSize=Math.min(2*k,(2*k-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*S):e.fontSize=a.labelFontSize,e.fontSize<S&&(e.fontSize=S),e.fontSize+"px"}).attr("x",0).attr("y",function(e){return l.indexOf(e[a.sourceField])*m+m/2+e.fontSize/2}),x=E.selectAll(".eve-heatmap-rows").data(l).enter().append("text").attr("x",0).attr("y",function(e,t){return t*m}).style("text-anchor","end").attr("class","eve-heatmap-rows").style("fill",n.yAxis.labelFontColor).style("font-size",n.yAxis.labelFontSize+"px").style("font-family",n.yAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.yAxis.labelFontStyle?"normal":n.yAxis.labelFontStyle).style("font-weight","bold"===n.yAxis.labelFontStyle?"bold":"normal").text(function(t){return"date"===e.getType(t)?e.formatDate(t):t}).attr("transform","translate(-6,0)"),z=E.selectAll(".eve-heatmap-cols").data(i).enter().append("text").attr("x",0).attr("y",function(e,t){return t*f}).attr("class","eve-heatmap-cols").style("fill",n.xAxis.labelFontColor).style("font-size",n.xAxis.labelFontSize+"px").style("font-family",n.xAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.xAxis.labelFontStyle?"normal":n.xAxis.labelFontStyle).style("font-weight","bold"===n.xAxis.labelFontStyle?"bold":"normal").text(function(t){return"date"===e.getType(t)?e.formatDate(t):t}).attr("transform","translate(0, -6)rotate(-90)")}T();let E=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+o.left+","+o.top+")");return _(),M(),n.update=function(e,t){n.data=e,n.calculateDomain(),n.updateLegend(),T(),n.animation.effect?"fade"===n.animation.effect?E.transition().duration(1e3).style("opacity",0).remove():"dim"===n.animation.effect?E.style("opacity",.15):"add"===n.animation.effect?E.style("opacity",1):E.remove():E.remove(),E=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+o.left+","+o.top+")"),_(),M()},n.clear=function(){n.svg.selectAll(".eve-vis-g").remove()},n}(t)}}(eve),function(e){function t(t){t.frozenYAxis="string",t.frozenXAxis="string",t.legend={enabled:!1};let n=eve.initVis(t),a=eve.initClassicalAxis(n),l=n.series[0],i=null,o=null,r=0,s=0,u=0,d=0,c=l.minBulletSize,p=l.maxBulletSize,f=0,m=0,g={},h=null,y=null,x=0,b=0,v=0,F="",w=0;l.bullet.indexOf(!1)&&(l.bullet="none");let A=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+n.plot.left+","+n.plot.top+")");i=d3.symbol().type(function(e){return"none"===l.bullet?d3.symbolCircle:l.bullet.toSymbol()}).size(function(e){return k(e,!0)});let k=function(e,t){return t?1:0===f?p:+e[l.measureField]/f*w-r/f*w+c},S=function(e,t){return x="string"===n.xDataType?a.xScale(e[n.xField])+a.xScale.bandwidth()/2:a.xScale(e[n.xField]),b=t?n.plot.height:a.yScale(e[l.yField])+a.yScale.bandwidth()/2,"translate("+x+","+b+")"},C=function(e,t){return x="string"===n.xDataType?a.xScale(e[n.xField])+a.xScale.bandwidth()/2:a.xScale(e[n.xField]),b=t?n.plot.height:a.yScale(e[l.yField])+a.yScale.bandwidth()/2,"translate("+x+","+b+")"},z=function(){r=d3.min(n.data,function(e){return+e[l.measureField]}),s=d3.max(n.data,function(e){return+e[l.measureField]}),u="string"===n.xDataType?a.xScale.bandwidth()-10:n.plot.width/10-10,d=a.yScale.bandwidth(),p=Math.pow(Math.min(u,d),2),f=s-r,w=p-(c=25),a.yScale.domain().map(function(t,n){g[t]=n>=e.colors.length?e.randColor():e.colors[n]})},T=function(){i=d3.symbol().type(function(e){return"none"===l.bullet?d3.symbolCircle:l.bullet.toSymbol()}).size(function(e){return k(e,!1)}),A.selectAll(".eve-network-bullet").attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("opacity",1).attr("d",i).attr("transform",function(e){return S(e,!1)}),A.selectAll(".eve-network-label").attr("fill-opacity",function(e){return m=+e[l.measureField],v=Math.abs(Math.sqrt(k(e,!1))),h=this.getBBox(),isNaN(m)||0===m?0:"always"===l.labelVisibility?1:e.fontSize<8?0:1}).transition().duration(n.data.length>1e3?0:n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*(n.data.length>1e3?0:n.animation.delay)}).attr("transform",function(e){return C(e,!1)})},M=function(){o=A.selectAll(".eve-network-bullet").data(n.data).enter().append("path").attr("class","eve-network-bullet").attr("d",i).attr("fill-opacity",l.showBullets?l.bulletAlpha:0).attr("stroke-opacity",l.bulletStrokeAlpha).attr("stroke-width",l.bulletStrokeSize).attr("fill",function(e){return g[e[l.yField]]}).attr("fill-opacity",function(e){return m=+e[l.measureField],isNaN(m)||0===m?0:l.alpha}).attr("transform",function(e){return S(e,!0)}).on("click",function(e){n.sliceClick&&n.sliceClick(e)}).on("mousemove",function(e,t){(m=+e[l.measureField])&&(d3.select(this).attr("fill-opacity",l.sliceHoverAlpha),n.showTooltip(n.getContent(e,l,n.tooltip.format)))}).on("mouseout",function(e,t){(m=+e[l.measureField])&&d3.select(this).attr("fill-opacity",l.alpha),n.hideTooltip()}),y=A.selectAll(".eve-network-label").data(n.data).enter().append("text").attr("class","eve-network-label").style("pointer-events","none").style("text-anchor","middle").style("fill",function(e){return F=g[e[l.yField]],"auto"===l.labelFontColor?n.getAutoColor(F):l.labelFontColor}).style("font-family",l.labelFontFamily).style("font-style","bold"===l.labelFontStyle?"normal":l.labelFontStyle).style("font-weight","bold"===l.labelFontStyle?"bold":"normal").text(function(e){return n.getContent(e,l,l.labelFormat)}).attr("transform",function(e){return C(e,!0)}).style("font-size",function(e){return v=Math.abs(Math.sqrt(k(e,!1))-2),"auto"===l.labelFontSize?e.fontSize=Math.min(2*v,(2*v-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*8):e.fontSize=l.labelFontSize,e.fontSize>0?e.fontSize+"px":"0px"}).attr("dy",".35em")};return z(),M(),T(),n.update=function(e,t){n.data=e,n.calculateDomain(),n.updateLegend(),a.update(),z(),n.animation.enabled&&n.animation.effect?"fade"===n.animation.effect?A.transition().duration(1e3).style("opacity",0).remove():"dim"===n.animation.effect?A.style("opacity",.15):"add"===n.animation.effect?A.style("opacity",1):A.remove():A.remove(),A=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+n.plot.left+","+n.plot.top+")"),M(),T()},n.clear=function(){n.svg.selectAll(".eve-vis-g").remove()},n}e.networkMatrix=function(n){return n.masterType="xy",n.type="networkMatrix",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)},e.networkmatrix=function(n){return n.masterType="xy",n.type="networkMatrix",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){let n=eve.initVis(t),a=n.series[0],l=null,i=null,o=null,r=null,s=null,u=null,d=null,c=null,p=null,f=11,m=[],g=0,h="",y=null,x=null,b=[],v=0,F=(n.data[0][a.sourceField],0),w=0,A=0,k=0,S=0,C=0,z=null,T=null,M=null,_=0,E=null,V=null,N=null,L=null;function B(e){return d3.axisBottom("left"===e?l:i).tickValues([w,A])}function G(){m=d3.keys(n.data[0]).filter(function(e){if(e!==a.sourceField&&"total"!==e&&-1===e.indexOf("_"))return e}),n.data.forEach(function(e){for(let t in e)t!==a.sourceField&&(e[t]=+e[t])}),(b=e.getUniqueValues(n.data,a.sourceField)).forEach(function(e){e&&e.toString().length>g&&(g=e.toString().length,h=e.toString())}),n.xAxis.xValues&&(b=n.xAxis.xValues),y=P.append("text").text(h).style("font-size",n.yAxis.labelFontSize+"px").style("color",n.yAxis.labelFontColor).style("font-family",n.yAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==n.yAxis.labelFontStyle?"normal":n.yAxis.labelFontStyle).style("font-weight","bold"==n.yAxis.labelFontStyle?"bold":"normal"),x=y.node().getBoundingClientRect(),y.remove(),v=x.width+10,F=(n.plot.width-n.plot.left-n.plot.right-v)/2,k=F+v,S=2*F+v,C=n.plot.height-n.plot.top-n.plot.bottom-n.margin.top-n.margin.bottom-n.xAxis.labelFontSize,_=k-v/2+10,b.sort(d3.descending),w=d3.min(n.data,function(e){return d3.min(m,function(t){return e[t]})}),n.xAxis.startsFromZero&&(n.domains.minY=0,w=0),A=d3.max(n.data,function(e){return d3.max(m,function(t){return e[t]})}),n.domains.xValues=b,n.domains.minY=w/2,n.domains.maxY=1.2*A,n.yAxis.locked&&(isNaN(n.yAxis.min)||null===n.yAxis.min||(w=n.yAxis.min,n.domains.minY=n.yAxis.min/2),isNaN(n.yAxis.max)||null===n.yAxis.max||(A=n.yAxis.max,n.domains.maxY=1.2*n.yAxis.max)),l=d3.scaleLinear().range([F,0]).domain([n.domains.minY,n.domains.maxY]),i=d3.scaleLinear().range([k,S]).domain([n.domains.minY,n.domains.maxY]),o=d3.scaleBand().range([0,C]).padding(.1).round(!0).domain(n.domains.xValues),"auto"===a.labelFontSize&&(a.labelFontSize=f)}function D(){z=P.append("g").attr("transform","translate(0, 0)"),T=P.append("g").attr("transform","translate(0, 0)"),M=P.append("g").attr("transform","translate(0, 0)"),r=B("left"),s=B("right"),u=d3.axisLeft(o),d=z.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform","translate(0,"+C+")").attr("class","eve-x-axis").call(r),c=M.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform","translate(0,"+C+")").attr("class","eve-x-axis").call(s),p=T.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform","translate("+_+")").attr("class","eve-y-axis").call(u)}function I(){d.selectAll("path").style("stroke-opacity",n.xAxis.alpha).style("stroke-width",n.xAxis.thickness+"px").style("stroke",n.xAxis.color),d.selectAll("line").style("fill","none").style("stroke-width",n.xAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",n.xAxis.alpha).style("stroke",n.xAxis.color),d.selectAll("text").style("fill",n.xAxis.labelFontColor).style("font-size",n.xAxis.labelFontSize+"px").style("font-family",n.xAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.xAxis.labelFontStyle?"normal":n.xAxis.labelFontStyle).style("font-weight","bold"===n.xAxis.labelFontStyle?"bold":"normal").style("text-anchor","middle").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).text(function(t){if("number"===e.getType(t)){if(n.xAxis.labelFormat)return e.formatNumber(t,n.xAxis.labelFormat);if(t.toString().indexOf(".")>-1)return t.toFixed(2)}return t}),c.selectAll("path").style("stroke-opacity",n.xAxis.alpha).style("stroke-width",n.xAxis.thickness+"px").style("stroke",n.xAxis.color),c.selectAll("line").style("fill","none").style("stroke-width",n.xAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",n.xAxis.alpha).style("stroke",n.xAxis.color),c.selectAll("text").style("fill",n.xAxis.labelFontColor).style("font-size",n.xAxis.labelFontSize+"px").style("font-family",n.xAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.xAxis.labelFontStyle?"normal":n.xAxis.labelFontStyle).style("font-weight","bold"===n.xAxis.labelFontStyle?"bold":"normal").style("text-anchor","middle").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).text(function(t){if("number"===e.getType(t)){if(n.xAxis.labelFormat)return e.formatNumber(t,n.xAxis.labelFormat);if(t.toString().indexOf(".")>-1)return t.toFixed(2)}return t}),p.selectAll("path").style("stroke-opacity",0).style("stroke-width","0px").style("stroke",n.yAxis.color),p.selectAll("line").style("fill","none").style("stroke-width",n.yAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",0).style("stroke",n.yAxis.color),p.selectAll("text").style("fill",n.yAxis.labelFontColor).style("font-size",n.yAxis.labelFontSize+"px").style("font-family",n.yAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.yAxis.labelFontStyle?"normal":n.yAxis.labelFontStyle).style("font-weight","bold"===n.yAxis.labelFontStyle?"bold":"normal").style("text-anchor","middle").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).text(function(t){if("number"===e.getType(t)){if(n.yAxis.labelFormat)return e.formatNumber(t,n.yAxis.labelFormat);if(t.toString().indexOf(".")>-1)return t.toFixed(2)}return t})}function Z(){E=z.selectAll("eve-mirror-left").data(n.data).enter().append("rect").attr("class","eve-mirror-left").attr("height",o.bandwidth()).attr("width",function(e){return e._rectWidth=F-l(e[m[0]]),0}).attr("fill",n.legend.legendColors.length>0?e.matchGroup(m[0],n.legend.legendColors,"color"):e.colors[0]).attr("stroke",n.legend.legendColors.length>0?e.matchGroup(m[0],n.legend.legendColors,"color"):e.colors[0]).attr("fill-opacity","add"===n.animation.effect?0:a.alpha).attr("stroke-opacity","add"===n.animation.effect?0:a.sliceStrokeAlpha).attr("stroke-width",a.sliceStrokeThickness).attr("y",function(e){return o(e[a.sourceField])}).attr("x",function(e){return e._rectX=F-e._rectWidth,F}).on("mousemove",function(e,t){d3.select(this).attr("fill-opacity",a.sliceHoverAlpha),e._measureValue=e[m[0]],e._groupValue=m[0],n.showTooltip(n.getContent(e,a,n.tooltip.format))}).on("mouseout",function(e,t){d3.select(this).attr("fill-opacity",a.alpha),n.hideTooltip()}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("fill-opacity",a.alpha).attr("stroke-opacity",a.sliceStrokeAlpha).attr("width",function(e){return e._rectWidth}).attr("x",function(e){return e._rectX}),V=M.selectAll("eve-mirror-right").data(n.data).enter().append("rect").attr("class","eve-mirror-right").attr("height",o.bandwidth()).attr("width",function(e){return e._rectWidth=F-l(e[m[1]]),0}).attr("fill",n.legend.legendColors.length>0?e.matchGroup(m[1],n.legend.legendColors,"color"):e.colors[1]).attr("stroke",n.legend.legendColors.length>0?e.matchGroup(m[1],n.legend.legendColors,"color"):e.colors[1]).attr("fill-opacity","add"===n.animation.effect?0:a.alpha).attr("stroke-opacity","add"===n.animation.effect?0:a.sliceStrokeAlpha).attr("stroke-width",a.sliceStrokeThickness).attr("y",function(e){return o(e[a.sourceField])}).attr("x",k).on("mousemove",function(e,t){d3.select(this).attr("fill-opacity",a.sliceHoverAlpha),e._measureValue=e[m[1]],e._groupValue=m[1],n.showTooltip(n.getContent(e,a,n.tooltip.format))}).on("mouseout",function(e,t){d3.select(this).attr("fill-opacity",a.alpha),n.hideTooltip()}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("fill-opacity",a.alpha).attr("stroke-opacity",a.sliceStrokeAlpha).attr("width",function(e){return e._rectWidth}),a.labelFormat&&(N=z.selectAll("eve-mirror-label-left").data(n.data).enter().append("text").attr("class","eve-mirror-label-left").text(function(e){return e._measureValue=e[m[0]],e._groupValue=m[0],n.getContent(e,a,a.labelFormat)}).style("fill",a.labelFontColor).style("font-size",a.labelFontSize+"px").style("font-family",a.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===a.labelFontStyle?"normal":a.labelFontStyle).style("font-weight","bold"===a.labelFontStyle?"bold":"normal").style("text-anchor","left").attr("x",F).attr("y",function(e){return o(e[a.sourceField])+o.bandwidth()/2+a.labelFontSize/2}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("x",function(e){return e._rectX-this.getBBox().width}),L=z.selectAll("eve-mirror-label-right").data(n.data).enter().append("text").attr("class","eve-mirror-label-right").text(function(e){return e._measureValue=e[m[1]],e._groupValue=m[1],n.getContent(e,a,a.labelFormat)}).style("fill",a.labelFontColor).style("font-size",a.labelFontSize+"px").style("font-family",a.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===a.labelFontStyle?"normal":a.labelFontStyle).style("font-weight","bold"===a.labelFontStyle?"bold":"normal").style("text-anchor","left").attr("x",k).attr("y",function(e){return o(e[a.sourceField])+o.bandwidth()/2+a.labelFontSize/2}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("x",function(e){return k+e._rectWidth}))}let P=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate(10,0)");return G(),D(),I(),Z(),n.update=function(e){n.data=e,n.animation.effect?"fade"===n.animation.effect?P.transition().duration(1e3).style("opacity",0).remove():"dim"===n.animation.effect?P.style("opacity",.15):"add"===n.animation.effect?P.style("opacity",1):P.remove():P.remove(),P=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate(10,0)"),G(),D(),I(),Z()},n.clear=function(){n.svg.selectAll(".eve-vis-g").remove()},n}e.mirroredBars=function(n){return n.type="mirroredBars",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){"map"===t.series[0].type&&(t.series[0].type="standardMap");let n=t.series[0],a=n.yField||n.measureField||n.valueField,l=n.colorField,i=n.latField,o=n.longField,r=n.xField,s=null,u=null;if(t.data)if(t.multiples){if("standardMap"===n.type&&!1===t.multiples.lockAxisX||"bubbleForce"===n.type&&!1===t.multiples.lockAxisX)u=t.legend.enabled,t.legend.enabled=!1;else if("bubbleForce"===n.type&&t.legend.enabled&&n.groupField){let a=[];t.data.forEach(function(t){let l;"array"===e.getType(t.values)?t.values.length&&t.values.length>0&&(l=e.getUniqueValues(t.values,n.groupField)):t.values&&t.values.groups&&(l=t.values.groups),a=a.concat(l)}),t.manualLegendValues=e.getUniqueValues(a).filter(function(e){return" "!==e})}}else if("standardMap"===n.type&&!t.yAxis.locked||"bubbleForce"===n.type&&!t.yAxis.locked)u=t.legend.enabled,t.legend.enabled=!1;else if("bubbleForce"===n.type&&t.legend.enabled&&n.groupField){let a=[];t.data.forEach(function(t){let l;"array"===e.getType(t.values)?t.values.length&&t.values.length>0&&(l=e.getUniqueValues(t.values,n.groupField)):t.values&&t.values.groups&&(l=t.values.groups),a=a.concat(l)}),t.manualLegendValues=e.getUniqueValues(a).filter(function(e){return" "!==e})}let d=e.initVis(t),c=0,p=d.plot.width-d.plot.left-d.plot.right,f=d.plot.height-d.plot.top-d.plot.bottom,m=0,g=0,h=0,y=0,x=0,b=0,v=null,F=[],w=0,A=0,k=[],S=[],C=[],z=[],T=0,M=0,_=0,E="",V=[],N={},L=function(e){switch(e.type){case"area":case"areaChart":case"areachart":case"bar":case"barChart":case"barchart":case"bubble":case"bubbleChart":case"bubblechart":case"column":case"columnChart":case"columnchart":case"donut":case"donutChart":case"donutchart":case"funnel":case"funnelChart":case"funnelchart":case"line":case"lineChart":case"linechart":case"pie":case"pieChart":case"piechart":case"pyramid":case"pyramidChart":case"pyramidchart":case"radar":case"radarChart":case"radarchart":case"scatter":case"scatterChart":case"scatterchart":case"combinationChart":case"combinationchart":return"chart";case"standardMap":case"tileMap":case"ddCartogram":case"locationMap":case"routeMap":case"densityMap":case"contCartogram":case"standardmap":case"tilemap":case"ddcartogram":case"locationmap":case"routemap":case"densitymap":case"contcartogram":return"map";case"standardGauge":case"dialGauge":case"digitalGauge":case"linearGauge":case"standardgauge":case"dialgauge":case"digitalgauge":case"lineargauge":return"gauge";default:return"diagram"}}(n);u&&(d.legend.enabled=u),d.simulations=[];let B=function(){let e=4/3;switch(n.type){case"donutChart":case"donut":case"pieChart":case"pie":case"radarChart":case"radar":case"bubbleDiagram":case"bubbleForce":case"chord":case"circlepacking":case"circlePacking":case"force":case"networkForce":case"networkDiagram":case"sunburst":e=1;break}return e};return function(t){n=d.series[0],V=[],d.data.forEach(function(t){"array"===e.getType(t.values)?t.values.length&&t.values.length>0&&V.push(e.clone(t)):t.values&&V.push(e.clone(t))}),V.forEach(function(t){"array"===e.getType(t.values)?t.values.length&&t.values.length>0&&c++:t.values&&c++,t.values&&t.values.length&&t.values.forEach(function(e){let n=0;d.series.forEach(function(t){e[t.yField]&&(n+=1)}),N[t.group]=n})});let s=B(),u=null;switch(u=1===s?e.getBestDimension(p,f,c):e.getBestDimension(p,f,c,s),m=u.width,g=u.height,L){case"chart":{h=d3.min(d.data,function(e){return d3.min(e.values,function(e){return parseFloat(e[a])})}),y=d3.max(d.data,function(e){return d3.max(e.values,function(e){return parseFloat(e[a])})}),w=d3.min(d.data,function(e){return d3.min(e.values,function(e){return parseFloat(e[r])})}),A=d3.max(d.data,function(e){return d3.max(e.values,function(e){return parseFloat(e[r])})});let e=!1;d.series.forEach(function(t){"bar"!==t.type&&"column"!==t.type||(e=!0)});for(let t=0;t<V.length;t++)if((S=V[t]).values&&S.values.length>0)for(let t=0;t<S.values.length;t++){let a=S.values[t],l=0;if(n.grouped){let e=0;for(let t in a)t!==r&&(e=parseFloat(a[t]),C.push(e),l+=e)}z.push(l),-1===k.indexOf(a[r])&&e&&k.push(a[r])}h=d3.min(C),y=d.yAxis.stacked?1*d3.max(z):1.2*d3.max(C),k.sort()}break;case"diagram":switch(n.type){case"circlePacking":case"circlepacking":case"dendrogram":case"force":case"sunburst":case"treemap":h=d.domains.minY,y=d.domains.maxY;break;default:h=d.domains.minY,y=d.domains.maxY,w=d.domains.minX,A=d.domains.maxX;break}break;case"map":switch(n.type){case"standardMap":case"tileMap":h=d3.min(d.data,function(e){return d3.min(e.values,function(e){return parseFloat(e[a])})}),y=d3.max(d.data,function(e){return d3.max(e.values,function(e){return parseFloat(e[a])})});break;case"ddCartogram":case"contCartogram":h=d3.min(d.data,function(e){return d3.min(e.values,function(e){return parseFloat(e[a])})}),y=d3.max(d.data,function(e){return d3.max(e.values,function(e){return parseFloat(e[a])})}),x=d3.min(d.data,function(e){return d3.min(e.values,function(e){return parseFloat(e[l])})}),b=d3.max(d.data,function(e){return d3.max(e.values,function(e){return parseFloat(e[l])})});break;case"routeMap":case"densityMap":d.yAxis.locked&&F();break;case"locationMap":h=d3.min(d.data,function(e){return d3.min(e.values,function(e){return parseFloat(e[a])})}),y=d3.max(d.data,function(e){return d3.max(e.values,function(e){return parseFloat(e[a])})}),d.yAxis.locked&&F();break}break}function F(){v=[0,0];let e=[],t=[];V.forEach(function(n){let a=0,l=0,r=0,s=0;a=d3.min(n.values,function(e){return parseFloat(e[i])}),l=d3.max(n.values,function(e){return parseFloat(e[i])}),r=d3.min(n.values,function(e){return parseFloat(e[o])}),s=d3.max(n.values,function(e){return parseFloat(e[o])}),a>0&&l>0||a<0&&l<0?e.push(Math.abs(l-a)):e.push(Math.abs(l)+Math.abs(a)),r>0&&s>0||r<0&&s<0?t.push(Math.abs(s-r)):t.push(Math.abs(s)+Math.abs(r))}),v[0]=d3.max(e),v[1]=d3.max(t)}}(),function(t){if(s=d3.select("#"+d.innerContainer).style("width",p+"px").style("height",f+"px").style("position","relative").html(""),_=0,m<60||g<60)return void s.html('&nbsp;&nbsp;<i class="fa fa-warning"></i> Not enough space to create multiples. Please resize the container!');s.html("");let a=Math.floor(p/m);V.forEach(function(t,l){if(function(t){let n=!1;return"array"===e.getType(t)?t.values&&t.values.length>0&&(n=!0):t&&(n=!0),n}(t)){switch(E=d.container+"_"+l,T=l%a*m,l>=a&&l%a==0&&_++,M=_*g,s.append("div").attr("id",E).style("left",T+"px").style("top",M+"px").style("width",m+"px").style("height",g+"px"),L){case"chart":!function(t,a,l){let i=n.type+"Chart",o=a[n.multipleField]||a.group,s=[],u={},c=e.clone(d.tooltip),p=null,f=e.clone(d.legend);d.series.forEach(function(e){e.type!==n.type&&(i="combinationChart")}),f.enabled=!1,d.manualLegendValues&&d.manualLegendValues.forEach(function(t,n){f.legendColors.length>0?u[t.toString()]=e.matchGroup(t.toString(),f.legendColors,"color"):u[t.toString()]=n>=e.colors.length?e.randColor():e.colors[n]}),f.legendColors&&f.legendColors.forEach(function(e){u[e.value.toString()]=e.color}),d.series.forEach(function(t,n){(p=e.clone(t)).xField=t.xField,p.yField=t.yField,p.dataColors=u,p.color=n>=e.colors.length?e.randColor():e.colors[n],p.labelFormat=p.labelFormat.replaceAll("{multiple}",a.group),s.push(p)}),c.format=c.format.replaceAll("{multiple}",a.group);let x=d.xAxis,b=d.yAxis;if(x.locked=d.xAxis.locked,x.min=d.xAxis.locked?null!=d.xAxis.min?d.xAxis.min:w:null,x.max=d.xAxis.locked?null!=d.xAxis.max?d.xAxis.max:A:null,b.locked=d.yAxis.locked,b.min=d.yAxis.locked?null!=d.yAxis.min?d.yAxis.min:h:null,b.max=d.yAxis.locked?null!=d.yAxis.max?d.yAxis.max:y:null,b.minRight=d.yAxis.locked?null!=d.yAxis.minRight?d.yAxis.minRight:h:null,b.maxRight=d.yAxis.locked?null!=d.yAxis.maxRight?d.yAxis.maxRight:y:null,d.yAxis.stacked&&d.yAxis.locked){let e=[];for(let t=0;t<d.data.length;t++)for(let n=0;n<d.data[t].values.length;n++){let a=d.data[t].values[n],l=0;d.series.forEach(function(e){l+=a[e.yField]}),e.push(l)}b.max=d.domains.maxY}let v=!0;Object.keys(N).forEach(function(e){N[e]>1&&(v=!1)}),v&&(b.stacked=!1);let F={container:t,data:a.values,backColor:d.backColor,title:{content:o,position:d.title.position},tooltip:c,legend:f,animation:d.animation,zoomable:d.zoomable,xField:r,series:s,width:m,height:g,fromMultiples:!0,columnNames:d.columnNames,xAxis:x,yAxis:b};F.yAxis.values&&1===F.yAxis.values.length&&""==F.yAxis.values[0]&&(F.yAxis.values=null),eve[i](F)}(E,t);break;case"diagram":!function(t,a,l){let i,o=a[n.multipleField]||a.group,s=[],c={},p=e.clone(d.tooltip),f=null,x=e.clone(d.legend);switch(x.enabled=u||!1,d.manualLegendValues?d.manualLegendValues.forEach(function(t,n){t&&(x.legendColors.length>0?c[t.toString()]=e.matchGroup(t.toString(),x.legendColors,"color"):c[t.toString()]=n>=e.colors.length?e.randColor():e.colors[n])}):c=null,p.format=p.format.replaceAll("{multiple}",a.group),n.type){case"abacus":case"streamGraph":case"streamgraph":d.series.forEach(function(t,n){(f=e.clone(t)).labelFormat=f.labelFormat.replaceAll("{multiple}",a.group);let l=f.yField,i="";f.yField&&""!==f.yField?l=f.yField:f.valueField&&""!==f.valueField?l=f.valueField:f.measureField&&""!==f.measureField&&(l=f.measureField);let o=e.filterSensitive(d.legend.legendColors,"value",l);i=o.length>0?o[0].color:n>=e.colors.length?e.randColor():e.colors[n],""===f.color&&(f.color=i),""===i.sliceStrokeColor&&(i.sliceStrokeColor=i),s.push(f)});break;case"circlePacking":case"circlepacking":case"dendrogram":case"force":case"sunburst":case"treemap":r="",(f=e.clone(n)).color=l>=e.colors.length?e.randColor():e.colors[l],f.labelFormat=f.labelFormat.replaceAll("{multiple}",a.group),f.dataColors=c,s.push(f);break;default:(f=e.clone(n)).color=l>=e.colors.length?e.randColor():e.colors[l],f.labelFormat=f.labelFormat.replaceAll("{multiple}",a.group),f.dataColors=c,s.push(f);break}let b=d.xAxis,v=d.yAxis;b.min=d.xAxis.locked?w:d.xAxis.min?d.xAxis.min:null,b.max=d.xAxis.locked?A:d.xAxis.max?d.xAxis.max:null,"mirroredBars"!==n.type?(b.xValues=d.yAxis.locked&&d.domains.xValues?d.domains.xValues:null,v.min=d.yAxis.locked?h:d.yAxis.min?d.yAxis.min:null,v.max=d.yAxis.locked?y:d.yAxis.max?d.yAxis.max:null):(v.min=d.yAxis.locked&&d.yAxis.min?d.yAxis.min:h,v.max=d.yAxis.locked&&d.yAxis.max?d.yAxis.max:y),v.min&&v.max&&(d.domains.minY=v.min,d.domains.maxY=v.max),a.values.dataArray||a.values;let F={container:t,data:a.values.dataArray||a.values,backColor:d.backColor,title:{content:o,position:d.title.position},tooltip:p,legend:x,animation:d.animation,zoomable:d.zoomable,xField:r,series:s,width:m,height:g,fromMultiples:!0,maxMeasureValue:d.domains.minY&&d.domains.maxY?d.domains.maxY:null,columnNames:d.columnNames,xAxis:b,yAxis:v};(i=eve[n.type](F)).simulations&&i.simulations.forEach(function(e){d.simulations.push(e)})}(E,t,l);break;case"map":!function(t,a,l){let i,o=n.type,r=e.clone(d.tooltip),s=a[n.multipleField]||a.group,c=e.clone(n),p=e.clone(d.legend),f={min:d.yAxis.min?d.yAxis.min:h,max:d.yAxis.max?d.yAxis.max:y,colorMin:d.yAxis.colorMin?d.yAxis.colorMin:x,colorMax:d.yAxis.colorMax?d.yAxis.colorMax:b,diffDegrees:v};c.labelsEnabled=!0,c.labelFormat=c.labelFormat.replaceAll("{multiple}",a.group),r.format=r.format.replaceAll("{multiple}",a.group),u?(f.min=d.yAxis.min?d.yAxis.min:null,f.max=d.yAxis.max?d.yAxis.max:null):p.enabled=!1;let w={container:t,data:a.values,backColor:d.backColor,title:{content:s,position:d.title.position},tooltip:r,legend:p,animation:d.animation,zoomable:d.zoomable,series:[c],width:m,height:g,columnNames:d.columnNames,hideZoom:!0,fromMultiples:!0,yAxis:f};"routeMap"===o||"locationMap"===o||"densityMap"===o?F.push(eve[o](w)):i=eve[o](w),i&&i.simulations&&i.simulations.forEach(function(e){d.simulations.push(e)})}(E,t);break;case"gauge":break}d3.select("#"+E).style("position","absolute")}}),d.tempSVG=s,s=null}(),d.update=function(n,a){d3.select("#"+d.innerContainer).remove(),t.data=eve.clone(n),t.title.content=a,d=e.multiples(t)},d.clear=function(){d3.select("#"+d.innerContainer).remove()},d.toCanvas=function(t){if(e.detectMS()){let n=document.getElementById(d.container),a=(document.getElementById(d.innerContainer),n.querySelectorAll(".vis_svg")),l=n.querySelectorAll(".legend_svg"),i=0,o=0,r=null,s="",u=[],c=[],p=[],f=[];F.length>0&&F.forEach(function(e){e&&(i++,e.toCanvas(e.container).then(function(e){let t=document.getElementById(e.id.split("-")[0]);t.parentNode.insertBefore(e,t),t.parentNode.removeChild(t),u.push(t),c.push(e),o++}))});for(let t=0;t<a.length;t++)r=document.createElement("canvas"),s=(new XMLSerializer).serializeToString(a[t]),e.detectMS()&&(s=s.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),i++,canvg(r,s,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){o++}}),a[t].parentNode.insertBefore(r,a[t]),a[t].parentNode.removeChild(a[t]),p.push(r);for(let t=0;t<l.length;t++)r=document.createElement("canvas"),s=(new XMLSerializer).serializeToString(l[t]),e.detectMS()&&(s=s.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),i++,canvg(r,s,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){o++}}),l[t].parentNode.insertBefore(r,l[t]),l[t].parentNode.removeChild(l[t]),f.push(r);return new Promise(function(e){let r=setInterval(function(){o===i&&(html2canvas(n).then(function(n){c.forEach(function(e,t){e.parentNode.insertBefore(u[t],e),e.parentNode.removeChild(e)}),p.forEach(function(e,t){e.parentNode.insertBefore(a[t],e),e.parentNode.removeChild(e)}),f.forEach(function(e,t){e.parentNode.insertBefore(l[t],e),e.parentNode.removeChild(e)}),n.id=t+"-canvas",e(n)}),clearInterval(r))},500)})}return new Promise(function(e){domtoimage.toPng(document.getElementById(d.container)).then(function(n){let a=document.createElement("canvas"),l=a.getContext("2d"),i=new Image;a.id=t+"-canvas",i.onload=function(){a.width=i.width,a.height=i.height,l.drawImage(i,0,0),e(a)},i.src=n})})},d.toImage=function(){if(e.detectMS()){let t=document.getElementById(d.container),n=(document.getElementById(d.innerContainer),t.querySelectorAll(".vis_svg")),a=t.querySelectorAll(".legend_svg"),l=0,i=0,o=null,r="",s=[],u=[],c=[],p=[];F.length>0&&F.forEach(function(e){e&&(l++,e.toCanvas(e.container).then(function(e){let t=document.getElementById(e.id.split("-")[0]);t.parentNode.insertBefore(e,t),t.parentNode.removeChild(t),s.push(t),u.push(e),i++}))});for(let t=0;t<n.length;t++)o=document.createElement("canvas"),r=(new XMLSerializer).serializeToString(n[t]),e.detectMS()&&(r=r.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),l++,canvg(o,r,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){i++}}),n[t].parentNode.insertBefore(o,n[t]),n[t].parentNode.removeChild(n[t]),c.push(o);for(let t=0;t<a.length;t++)o=document.createElement("canvas"),r=(new XMLSerializer).serializeToString(a[t]),e.detectMS()&&(r=r.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),l++,canvg(o,r,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){i++}}),a[t].parentNode.insertBefore(o,a[t]),a[t].parentNode.removeChild(a[t]),p.push(o);return new Promise(function(e){let o=setInterval(function(){i===l&&(html2canvas(t).then(function(t){u.forEach(function(e,t){e.parentNode.insertBefore(s[t],e),e.parentNode.removeChild(e)}),c.forEach(function(e,t){e.parentNode.insertBefore(n[t],e),e.parentNode.removeChild(e)}),p.forEach(function(e,t){e.parentNode.insertBefore(a[t],e),e.parentNode.removeChild(e)}),e(t.toDataURL("image/png"))}),clearInterval(o))},500)})}return new Promise(function(e){domtoimage.toPng(document.getElementById(d.container)).then(function(t){e(t)})})},d}e.multiples=function(n){return n.type="multiples",e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){let n,a,l,i=eve.initVis(t),o=i.series[0],r=null,s=Number.MAX_VALUE,u=Number.MIN_VALUE,d=null,c=null,p=[],f=[],m=[],g=[],h=[],y={},x=8,b=o.maxBulletSize/2,v="",F=0,w=0;i.simulations=[];let A=function(e){return"nodes node_"+e.id.toString().toLowerCase().replaceAll(" ","_")},k=function(e){return"links link_"+e.source.toString().toLowerCase().replaceAll(" ","_")+" link_"+e.target.toString().toLowerCase().replaceAll(" ","_")},S=function(e){e.clicked?e.clicked=null:e.clicked=!0;let t=e.id.toString().toLowerCase().replaceAll(" ","_");n.attr("opacity",.1),a.attr("opacity",.1),e.clicked?(N.selectAll(".link_"+t).attr("opacity",1),N.selectAll(".node_"+t).attr("opacity",1),N.selectAll(".link_"+t).each(function(){let e=arguments[0].sourceValue.toString().toLowerCase().replaceAll(" ",""),t=arguments[0].targetValue.toString().toLowerCase().replaceAll(" ","");N.selectAll(".node_"+t).attr("opacity",1),N.selectAll(".node_"+e).attr("opacity",1)})):(n.attr("opacity",1),a.attr("opacity",1))},C=function(e,t){let n=i.data.filter(function(n){return n[o.sourceField]===e&&n[o.targetField]===t||n[o.sourceField]===t&&n[o.targetField]===e}),a=0;switch(o.expression){case"sum":a=d3.sum(n,function(e){return e[o.measureField]});break;case"avg":a=d3.mean(n,function(e){return e[o.measureField]});break;case"min":a=d3.min(n,function(e){return e[o.measureField]});break;case"max":a=d3.max(n,function(e){return e[o.measureField]});break;default:a=n.length;break}return a};function z(){p=[],f=[],F=i.plot.width-i.plot.left-i.plot.right,w=i.plot.height-i.plot.top-i.plot.bottom,m=e.getUniqueValues(i.data,o.sourceField),g=e.getUniqueValues(i.data,o.targetField),h=e.getUniqueValues(i.data,o.groupField);m.forEach(function(e){let t=i.data.filter(function(t){return t[o.sourceField]===e}),n=d3.sum(t,function(e){return+e[o.measureField]});y[e]=n,y[e]<s&&(s=y[e]),y[e]>u&&(u=y[e])}),g.forEach(function(e){let t=i.data.filter(function(t){return t[o.targetField]===e}),n=d3.sum(t,function(e){return+e[o.measureField]});y[e]?y[e]+=n:y[e]=n,y[e]<s&&(s=y[e]),y[e]>u&&(u=y[e])}),o.maxBulletSize||(o.maxBulletSize=Math.sqrt(F*w/i.data.length/Math.PI)-5),o.minBulletSize||(o.minBulletSize=o.maxBulletSize*s/u),d=d3.scalePow().exponent(.5).domain([s,u]).range([o.minBulletSize,o.maxBulletSize]),c=d3.scaleLinear().range(i.legend.gradientColors).domain([s,u]),function(){let t=[];for(let n=0;n<i.data.length;n++){let a=i.data[n],l=a[o.sourceField],r=a[o.targetField],s=+a[o.measureField],u=o.groupField?a[o.groupField]:"",d=h.length>0&&u?h.indexOf(u):0,m=c(s),g=C(l,r);if(-1===t.indexOf(l)){let n={id:l,group:d,measure:y[l],color:c(y[l]),sourceValue:l,targetValue:r,groupValue:u,measureValue:s};m=d>=e.colors.length?e.randColor():e.colors[d],i.legend.enabled||(n.color=m),p.push(n),t.push(l)}if(-1===t.indexOf(r)){let n={id:r,group:d,measure:y[r],color:c(y[r]),sourceValue:l,targetValue:r,groupValue:u,measureValue:s};m=d>=e.colors.length?e.randColor():e.colors[d],i.legend.enabled||(n.color=m),p.push(n),t.push(r)}f.push({source:l,target:r,measure:s,sourceValue:l,targetValue:r,measureValue:s,groupValue:u,value:n,expressionedDataValue:o.expression?g:s})}p.sort(function(e,t){let n=typeof e.id;return"string"===n?e.id<t.id?-1:e.id>t.id?1:0:"number"===n?e.id-t.id:new Date(e.id)-new Date(t.id)}),f.sort(function(e,t){let n=typeof e.source;return"string"===n?e.source<t.source?-1:e.source>t.source?1:0:"number"===n?e.source-t.source:new Date(e.source)-new Date(t.source)})}()}function T(){r=d3.forceSimulation().force("link",d3.forceLink().id(function(e){return e.id})).force("charge",d3.forceManyBody()).force("center",d3.forceCenter(F/2,w/2)),i.simulations.push(r),n=N.append("g").selectAll("line").data(f).enter().append("line").attr("class",k).style("stroke-width",function(e){return d(e.measure)}).style("stroke","rgb(204,204,204)").on("mousemove",function(e,t){i.showTooltip(i.getContent(e,o,i.tooltip.format))}).on("mouseout",function(e,t){i.hideTooltip()}),a=N.append("g").selectAll("circle").data(p).enter().append("circle").attr("class",A).style("fill",function(e){return e.color}).style("stroke","none").attr("r",function(e){return d(e.measure)}).on("click",S).call(d3.drag().on("start",M).on("drag",_).on("end",E)),o.labelFormat&&(l=N.append("g").selectAll("text").data(p).enter().append("text").attr("class","pagos-force-texts").style("pointer-events","none").style("text-anchor",function(e){return"inside"===o.labelPosition?"middle":e.children?"end":"start"}).style("fill",function(e){return v=e.color,"auto"===o.labelFontColor?i.getAutoColor(v):o.labelFontColor}).style("font-family",o.labelFontFamily).style("font-style","bold"===o.labelFontStyle?"normal":o.labelFontStyle).style("font-weight","bold"===o.labelFontStyle?"bold":"normal").text(function(e){return i.getContent(e,o,o.labelFormat)}).style("font-size",function(e){return"auto"===o.labelFontSize?(b=d(e.measure),e.fontSize=Math.min(2*b,(2*b-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*x)):e.fontSize=o.labelFontSize,e.fontSize<x&&(e.fontSize=x),e.fontSize+"px"}).style("opacity",function(e){let t=this.getBBox().width;return 2*d(e.measure)>t?1:0})),r.nodes(p).on("tick",V),r.force("link").links(f)}function M(e){d3.event.active||r.alphaTarget(.05).restart(),e.fx=e.x,e.fy=e.y}function _(e){e.fx=d3.event.x,e.fy=d3.event.y}function E(e){e.fixed=!0,d3.select(this).classed("fixed",!0)}function V(){n.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),a.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}),o.labelFormat&&l.attr("x",function(e){return e.x-this.getBBox().width/2}).attr("y",function(e){return e.y+e.fontSize/2-2})}z();let N=i.svg.append("g").attr("width",F).attr("height",w).attr("class","eve-vis-g");return T(),i.update=function(e){i.data=e,i.calculateDomain(),i.updateLegend(),z(),i.animation.effect?"fade"===i.animation.effect?N.transition().duration(1e3).style("opacity",0).remove():"dim"===i.animation.effect?N.style("opacity",.15):"add"===i.animation.effect?N.style("opacity",1):N.remove():N.remove(),N=i.svg.append("g").attr("width",F).attr("height",w).attr("class","eve-vis-g"),T()},i.clear=function(){i.svg.selectAll(".eve-vis-g").remove()},i}e.networkForce=function(n){return n.type="networkForce",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)},e.networkDiagram=function(n){return n.type="networkForce",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){t.legend?t.legend.enabled=!1:t.legend={enabled:!1};let n,a,l,i,o,r=eve.initVis(t),s=r.series[0],u=0,d=0,c=0,p=Number.MIN_VALUE,f=[],m="",g=[],h=0,y=[],x=null,b={},v={},F=d3.line(),w=d3.axisLeft(),A=0,k=0;function S(t){f=s.measureField.split(","),(g=s.groupField?e.getUniqueValues(r.data,s.groupField):e.getUniqueValues(r.data,s.sourceField)).forEach(function(t,n){y.push(n>=e.colors.length?e.randColor():e.colors[n])}),t||(f.forEach(function(e){(h=d3.max(r.data,function(t){return+t[e]}))>p&&(p=h)}),m=e.formatNumber(p,r.yAxis.numberFormat)),c=2*r.xAxis.labelFontSize,u=r.plot.width-r.margin.left-r.margin.right,d=r.plot.height-r.margin.top-r.margin.bottom-2*r.xAxis.labelFontSize,x=d3.scalePoint().range([0,u]).padding(1),F=d3.line(),w=d3.axisLeft(),b={},t||(n=d3.keys(r.data[0]).filter(function(e){return e!=s.sourceField&&e!=s.groupField&&(b[e]=d3.scaleLinear().domain(d3.extent(r.data,function(t){return+t[e]})).range([d,0]))}),x.domain(n)),"auto"===s.labelFontSize&&(s.labelFontSize=11),"auto"===s.labelFontColor&&(s.labelFontColor="#333333")}function C(){i.attr("opacity","add"===r.animation.effect?0:1).transition().duration(r.animation.duration).ease(r.animation.easing.toEasing()).delay(function(e,t){return t*r.animation.delay}).attr("opacity",1).attr("d",E),s.labelFormat&&o.style("fill-opacity",1).transition().duration(r.animation.duration).ease(r.animation.easing.toEasing()).delay(function(e,t){return t*r.animation.delay}).attr("transform",function(e,t){let a=n.map(function(t){return[T(t),b[t](+e[t])]});return A=a[0][0],(k=a[0][1])<=0&&(k=s.labelFontSize),"translate("+A+","+k+")"})}function z(){l=N.append("g").attr("class","eve-parallel-lines-background").style("fill","none").style("stroke","rgb(221,221,221)").style("shape-rendering","crispEdges").style("fill-opacity",0).selectAll("path").data(r.data).enter().append("path").attr("d",_),N.selectAll(".eve-parallel-lines-background path").attr("stroke-opacity",0),i=N.append("g").selectAll("path").data(r.data).enter().append("path").attr("class",function(e,t){return"eve-parallel-lines-foreground eve-parallel-line-"+t}).style("fill","none").style("fill-opacity",0).style("stroke",function(e){let t=s.groupField?e[s.groupField]:e[s.sourceField],n=g.indexOf(t);return y[n]}).style("stroke-width",2.5).style("stroke-opacity",.8).on("click",function(e,t){e.selected?e.selected=!1:e.selected=!0;let n="eve-parallel-line-"+t;e.selected?(N.selectAll(".eve-parallel-lines-foreground").style("stroke-opacity",.1),N.selectAll("."+n).style("stroke-opacity",1).style("stroke-width",5)):N.selectAll(".eve-parallel-lines-foreground").style("stroke-opacity",1).style("stroke-width",2.5)}).on("mousemove",function(e){r.showTooltip(r.getContent(e,s,r.tooltip.format))}).on("mouseout",function(e){r.hideTooltip()}).attr("d",_),s.labelFormat&&(o=N.append("g").selectAll(".eve-parallel-labels").data(r.data).enter().append("text").attr("class",function(e,t){return"eve-parallel-labels eve-parallel-label-"+t}).style("text-anchor","middle").style("pointer-events","none").style("fill",s.labelFontColor).style("fill-opacity",0).style("font-size",s.labelFontSize+"px").style("font-family",s.labelFontFamily).style("font-style","bold"===s.labelFontStyle?"normal":s.labelFontStyle).style("font-weight","bold"===s.labelFontStyle?"bold":"normal").text(function(e){return r.getContent(e,s,s.labelFormat)}).attr("transform","translate("+r.margin.left+","+d+")")),(a=N.selectAll(".dimension").data(n).enter().append("g").attr("class","dimension").attr("transform",function(e){return"translate("+x(e)+")"}).call(d3.drag().subject(function(e){return{x:x(e)}}).on("start",function(e){v[e]=x(e),l.attr("visibility","hidden")}).on("drag",function(e){v[e]=Math.min(u,Math.max(0,d3.event.x)),i.attr("d",_),n.sort(function(e,t){return T(e)-T(t)}),x.domain(n),a.attr("transform",function(e){return"translate("+T(e)+")"})}).on("end",function(e,t){if(delete v[e],M(d3.select(this)).attr("transform","translate("+x(e)+")"),M(i).attr("d",E),l.attr("d",_).transition().delay(500).duration(0).attr("visibility",null),r.yAxis.labelFormat){let e=i[0][t].getBBox(),n=d3.select(i[0][t]).attr("d"),a=e.x+10,l=parseFloat(n.split(",")[1])-2;return l<=0&&(l=r.yAxis.labelFontSize),"translate("+a+","+l+")"}}))).append("g").attr("class","eve-parallel-lines-axis").each(function(e){d3.select(this).call(w.scale(b[e]))}).append("text").style("text-anchor","middle").style("fill",r.xAxis.labelFontColor).style("font-size",r.xAxis.labelFontSize+"px").style("font-family",r.xAxis.labelFontFamily).style("font-style","bold"===r.xAxis.labelFontStyle?"normal":r.xAxis.labelFontStyle).style("font-weight","bold"===r.xAxis.labelFontStyle?"bold":"normal").attr("y",-9).text(function(e){let t=e;return r.columnNames&&null!=r.columnNames&&r.columnNames[e]&&(t=r.columnNames[e]),t}),a.append("g").attr("class","eve-y-brush").each(function(e){d3.select(this).call(b[e].brush=d3.brushY(b[e]).extent([[-8,0],[10,d]]).on("brush end",V))}).selectAll("rect"),N.selectAll(".eve-parallel-lines-axis").selectAll("path").style("fill","none").style("stroke","rgb(51,51,51)"),N.selectAll(".eve-parallel-lines-axis text").style("fill",r.yAxis.labelFontColor).style("font-size",r.yAxis.labelFontSize+"px").style("font-family",r.yAxis.labelFontFamily).style("font-style","bold"===r.yAxis.labelFontStyle?"normal":r.yAxis.labelFontStyle).style("font-weight","bold"===r.yAxis.labelFontStyle?"bold":"normal").text(function(t){if("string"==typeof t){let e=t;return r.columnNames&&null!=r.columnNames&&r.columnNames[t]&&(e=r.columnNames[t]),e}return e.formatNumber(t,r.yAxis.numberFormat||r.yAxis.labelFormat)})}function T(e){let t=v[e];return null==t?x(e):t}function M(e){return e.transition().duration(r.animation.duration)}function _(e){return F(n.map(function(e){return[T(e),b[e](0)]}))}function E(e){return F(n.map(function(t){return[T(t),b[t](+e[t])]}))}function V(){if(!d3.event.selection)return;let e=n.filter(function(e){return d3.event.selection.map(b[e].invert)}),t=e.map(function(e){return d3.event.selection.map(b[e].invert)}),a=[];i.style("stroke-opacity",.1),r.data.forEach(function(n,l){e.forEach(function(e,i){t[i][1]<=+n[e]&&t[i][0]>=+n[e]&&-1===a.indexOf(".eve-parallel-line-"+l)&&a.push(".eve-parallel-line-"+l)})}),a.forEach(function(e){N.selectAll(e).style("stroke-opacity",1)})}S();let N=r.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+r.margin.left+","+c+")");return z(),C(),r.update=function(e,t){r.data=e,S(),r.animation.effect?"fade"===r.animation.effect?N.transition().duration(1e3).style("opacity",0).remove():"dim"===r.animation.effect?N.style("opacity",.15):"add"===r.animation.effect?N.style("opacity",1):N.remove():N.remove(),N=r.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+r.margin.left+","+c+")"),z(),C()},r.clear=function(){r.svg.selectAll(".eve-vis-g").remove()},r}e.parallelLines=function(n){return n.type="parallelLines",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)},e.parallellines=function(n){return n.type="parallelLines",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){t.legend?t.legend.enabled=!1:t.legend={enabled:!1};let n,a,l,i=eve.initVis(t),o=i.series[0],r=0,s=0,u=0,d=0,c=0,p={left:0,top:0,bottom:i.margin.bottom,right:0},f=0,m=0,g=null,h=null,y=0,x=0,b=null,v=null;function F(){i.data.nodes.forEach(function(t,n){t.color=n>=e.colors.length?e.randColor():e.colors[n]}),r=d3.sum(i.data.links,function(e){return+e[o.measureField]}),s=d3.max(i.data.nodes,function(e){return e.name.toString().length}),u=s>r.toString().length?s:r.toString().length,"auto"===o.labelFontSize&&(o.labelFontSize=11),"auto"===o.labelFontColor&&(o.labelFontColor="#333333"),d=10,c=i.xAxis.labelFormat?2*i.xAxis.labelFontSize:10,p.left=d,p.right=d,p.top=c+i.xAxis.labelFontSize,p.bottom=c,f=i.plot.width-p.left-p.right,m=i.plot.height-p.top-p.bottom}function w(){b.attr("opacity","add"===i.animation.effect?0:1).transition().duration(i.animation.duration).ease(i.animation.easing.toEasing()).delay(function(e,t){return t*i.animation.delay}).attr("opacity",1).attr("stroke",function(e){return e.source.color}).attr("stroke-width",function(e){return Math.max(1,e.dy)}),n.attr("opacity","add"===i.animation.effect?0:1).transition().duration(i.animation.duration).ease(i.animation.easing.toEasing()).delay(function(e,t){return t*i.animation.delay}).attr("opacity",1).attr("transform",function(e){return"translate(0,0)"}).attr("height",function(e){return Math.abs(e.dy)}).attr("fill",function(e){return e.color}).attr("stroke",function(e){return d3.rgb(e.color).darker(2)}),a.transition().duration(i.animation.duration).ease(i.animation.easing.toEasing()).delay(function(e,t){return t*i.animation.delay}).attr("transform",function(e){return"translate(0,"+i.xAxis.labelFontSize/2*-1+")"}),l.style("text-anchor",function(e){return e.x<f/2?"start":"end"}).transition().duration(i.animation.duration).ease(i.animation.easing.toEasing()).delay(function(e,t){return t*i.animation.delay}).attr("transform",function(e){return y=e.x<f/2?g.nodeWidth()+5:-5,x=e.dy/2,"translate("+y+","+x+")"})}function A(){g=d3.sankey().nodeWidth(36).nodePadding(5).size([f,m]),h=g.link(),g.nodes(i.data.nodes).links(i.data.links).layout(32);b=S.append("g").selectAll(".eve-sankey-link").data(i.data.links).enter().append("path").attr("class","eve-sankey-link").style("stroke-opacity",.5).style("fill","none").style("fill-opacity",0).attr("d",h).attr("stroke",function(e){return e.source.color}).attr("stroke-width",1).on("mousemove",function(e,t){i.showTooltip(i.getContent(e,o,i.tooltip.format,e.source.name,e.target.name))}).on("mouseout",function(e,t){i.hideTooltip()}).sort(function(e,t){return t.dy-e.dy}),v=S.append("g").selectAll(".eve-sankey-node").data(i.data.nodes).enter().append("g").attr("class","eve-sankey-node").attr("transform",function(e){return y=e.x,x=isNaN(e.y)?0:e.y,"translate("+y+","+x+")"}),n=v.append("rect").attr("width",g.nodeWidth()).attr("height",0).style("stroke-width",1).attr("fill",function(e){return e.color}).attr("stroke",function(e){return d3.rgb(e.color).darker(0)}).on("mousemove",function(e,t){e.expressionedDataValue=function(e){let t=e.value,n=e.sourceLinks&&e.sourceLinks.length?e.sourceLinks:e.targetLinks;if(0===n.length)return t;switch(o.expression){case"avg":t=e.value/n.length,null!=(a=i.data.averages[e.name])&&(t=a);break;case"min":t=d3.min(n,function(e){return e.value}),null!=(a=i.data.averages[e.name])&&(t=a);break;case"max":var a;t=d3.max(n,function(e){return e.value}),null!=(a=i.data.averages[e.name])&&(t=a);break}return t}(e),i.showTooltip(i.getContent(e,o,""!==i.tooltip.format?"{source}: {value}":""))}).on("mouseout",function(e,t){i.hideTooltip()}),a=v.append("text").style("fill",i.xAxis.labelFontColor).style("font-size",i.xAxis.labelFontSize+"px").style("font-family",i.xAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===i.xAxis.labelFontStyle?"normal":i.xAxis.labelFontStyle).style("font-weight","bold"===i.xAxis.labelFontStyle?"bold":"normal").style("text-anchor","start").text(function(e){return i.getContent(e,o,i.xAxis.labelFormat)}),l=v.append("text").style("fill",o.labelFontColor).style("font-size",o.labelFontSize+"px").style("font-family",o.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===o.labelFontStyle?"normal":o.labelFontStyle).style("font-weight","bold"===o.labelFontStyle?"bold":"normal").style("text-anchor","start").attr("dy",".35em").text(function(e){return i.getContent(e,o,o.labelFormat)}),v.call(d3.drag().subject(function(e){return e}).on("start",function(e){this.parentNode.appendChild(this)}).on("drag",k))}function k(e){d3.select(this).attr("transform","translate("+e.x+","+(e.y=Math.max(0,Math.min(m-e.dy,d3.event.y)))+")"),g.relayout(),b.attr("d",h)}F();let S=i.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+i.plot.left+","+p.top+")");return A(),w(),i.update=function(e){i.data=e,F(),i.animation.effect?"fade"===i.animation.effect?S.transition().duration(1e3).style("opacity",0).remove():"dim"===i.animation.effect?S.style("opacity",.15):"add"===i.animation.effect?S.style("opacity",1):S.remove():S.remove(),S=i.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+i.plot.left+","+p.top+")"),A(),w()},i.clear=function(){i.svg.selectAll(".eve-vis-g").remove()},i}e.sankey=function(n){return n.type="sankey",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){"linear"===t.series[0].direction&&(t.legend?t.legend.enabled=!1:t.legend={enabled:!1});let n=eve.initVis(t),a=n.series[0],l=0,i=[],o=[],r=0,s=0,u=0,d=0,c=0,p=0,f="",m=null,g=null,h=null,y=0,x=null,b="circle"===a.bullet?"circle":"square",v=0,F=0,w=0,A=0,k=.5,S=0,C=0,z=0,T=.5,M=[],_=null,E=0,V=null;function N(){V=d3.nest().key(function(e){return e[a.groupField]}).entries(n.data),i=n.xAxis.xValues?n.xAxis.xValues:e.getUniqueValues(n.data,a.groupField),o=e.getUniqueValues(n.data,a.sourceField),r=n.plot.width-n.plot.left-n.plot.right-n.margin.left-n.margin.right,s=n.plot.height-n.plot.top-n.plot.bottom-n.margin.top-n.margin.bottom,u=20,E=i.length,n.yAxis.maxSizeValue&&(E=n.yAxis.maxSizeValue===Number.MIN_VALUE?i.length:n.yAxis.maxSizeValue),l=r/E-u,"linear"===a.direction&&(c=d3.max(V,function(e){return e.values.length}),n.xAxis.maxSizeValue&&(c=n.xAxis.maxSizeValue===Number.MIN_VALUE?c:n.xAxis.maxSizeValue),p=10*Math.ceil(c/10),h=d3.treemap().tile(d3.treemapResquarify).size([l,s-l]).round(!0).paddingInner(0))}function L(e,t){let n=0;for(let a=0;a<=t;a++)n+=e(a);return n}function B(){_&&(n.animation.effect?"fade"===n.animation.effect?_.transition().duration(1e3).style("opacity",0).remove(""):"dim"===n.animation.effect?_.style("opacity",.15):"add"===n.animation.effect?_.style("opacity",1):_.remove(""):_.remove("")),_=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+n.plot.left+","+n.plot.top+")");let t=[],i=[],o=0,r=0,c=0,v=0;V.forEach(function(e,a){d=a*(l+(0===a?0:u));let o=(g=_.append("g").attr("transform","translate("+d+")")).append("text").style("fill",n.xAxis.titleFontColor).style("fill-opacity",.5).style("font-size",n.xAxis.titleFontSize+"px").style("font-family",n.xAxis.titleFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.xAxis.titleFontStyle?"normal":n.xAxis.titleFontStyle).style("font-weight","bold"===n.xAxis.titleFontStyle?"bold":"normal").text(e.key).attr("transform","translate(0, "+n.xAxis.titleFontSize+")");n.wrapText(o,l),x=o.node().getBoundingClientRect(),i.push(x.height),t.push(g)}),v=d3.max(i)+n.xAxis.titleFontSize,V.forEach(function(i,u){m=function(e,t,n){let l={name:t,children:[]},i=null;for(let t=0;t<p;t++){let n=e[t],i={name:n?n[a.sourceField]:"",key:n?n[a.sourceField]:"",size:1,value:n?1:0};l.children.push(i)}return i=d3.hierarchy(l).each(function(e){/^other[0-9]+$/.test(e.name)&&(e.name=null)}).sum(function(e){return+e.size}).sort(function(e,t){return t.value-e.value}),h(i),0===n&&(C=i._squarify.length,S=i._squarify[0].value),i.leaves()}(i.values,i.key,u),f=n.legend.legendColors.length>0?e.matchGroup(i.key,n.legend.legendColors,"color"):u>=e.colors.length?e.randColor():e.colors[u],o=0,r=0,y=Math.min(l,s)/S-2;let d=t[u].selectAll("g").data(m).enter().append("g").attr("transform",function(e,t){return c=(t+1)%S,e._width=y,e._height=y,e._cornerRadius=y/10,e._radius=2*Math.sqrt(y),e._backColor=t<i.values.length?f:"none","circle"===b?(e._posX=2*e._radius*r+e._radius,e._posY=2*e._radius*o+v+e._radius):(e._posX=y*r+2*r,e._posY=y*o+v+2*o),0===c?(o++,r=0):r++,"translate("+e._posX+",0)"});"circle"===b?d.append("circle").attr("r",function(e){return e._radius}).attr("fill",function(e,t){return e._backColor}).attr("fill-opacity","add"===n.animation.effect?0:a.alpha).on("mousemove",function(e,t){if(t<i.values.length){d3.select(this).attr("fill-opacity",1);let l=!!e.data.key&&e.data.key.toString().indexOf("Seat")>-1,o=(t+1).toString(),r=l?o:e.data.key;e.data._groupValue=i.key,e.data._sourceValue=r||1,n.showTooltip(n.getContent(e.data,a,n.tooltip.format,e.data._sourceValue))}}).on("mouseout",function(e,t){t<i.values.length&&(d3.select(this).attr("fill-opacity",a.alpha),n.hideTooltip())}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).attr("fill-opacity",a.alpha).attr("transform",function(e){return"translate(0,"+e._posY+")"}):d.append("rect").attr("id",function(e){return e.data.id}).attr("rx",function(e){return e._cornerRadius}).attr("ry",function(e){return e._cornerRadius}).attr("width",function(e){return e._width}).attr("height",function(e){return e._height}).attr("fill",function(e,t){return e._backColor}).attr("fill-opacity","add"===n.animation.effect?0:a.alpha).on("mousemove",function(e,t){if(t<i.values.length){d3.select(this).attr("fill-opacity",1);let l=e.data.key.toString().indexOf("Seat")>-1,o=(t+1).toString(),r=l?o:e.data.key;e.data._groupValue=i.key,e.data._sourceValue=r||1,n.showTooltip(n.getContent(e.data,a,n.tooltip.format,e.data._sourceValue))}}).on("mouseout",function(e,t){t<i.values.length&&(d3.select(this).attr("fill-opacity",a.alpha),n.hideTooltip())}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).attr("fill-opacity",a.alpha).attr("transform",function(e){return"translate(0,"+e._posY+")"})})}function G(){M=[],v=Math.min(r/2,s),F=v*T,V.forEach(function(t,a){t._backColor=t?n.legend.legendColors.length>0?e.matchGroup(t.key,n.legend.legendColors,"color"):a>=e.colors.length?e.randColor():e.colors[a]:"none"}),w=n.data.length,function(){let e=T/(1-T);for(;A<w;)k+=e,A=L(function(e){return Math.floor(Math.PI*(k+e))},++C-1)}(),z=(v-F)/C,function(){let e=A-w;for(let t=0;t<C;t++){let n=F+z*(t+.5),a=Math.floor(Math.PI*(k+t))-Math.floor(e/C)-(e%C>t?1:0),l=Math.PI/a;for(let e=0;e<a;e++){let t={};t.polar={r:n,teta:-Math.PI+l*(e+.5)},t.cartesian={x:t.polar.r*Math.cos(t.polar.teta),y:t.polar.r*Math.sin(t.polar.teta)},M.push(t)}}}(),M.sort(function(e,t){return e.polar.teta-t.polar.teta||t.polar.r-e.polar.r}),function(){let e=0,t=0;M.forEach(function(n){let a=V[e],l=a?a.values.length:0;t>=l&&(t=0,a=V[++e]),n.set=a,n.data=a?a.values[t]:{},t++})}();let t=function(e){return e.cartesian.x},l=function(e){return e.cartesian.y},i=function(e){let t=.4*z;return e.data&&"number"==typeof e.data.size&&(t*=e.data.size),t};if(_&&(n.animation.effect?"fade"===n.animation.effect?_.transition().duration(1e3).style("opacity",0).remove(""):"dim"===n.animation.effect?_.style("opacity",.15):"add"===n.animation.effect?_.style("opacity",1):_.remove(""):_.remove("")),_=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+r/2+","+v+")"),"circle"===b){_.selectAll(".eve-seatmap").data(M).enter().append("circle").attr("class","eve-seatmap").attr("cx",0).attr("cy",0).attr("r",0).attr("fill",function(e,t){return e.set?e.set._backColor:"none"}).attr("fill-opacity","add"===n.animation.effect?0:a.alpha).on("mousemove",function(e,t){d3.select(this).attr("fill-opacity",1),n.showTooltip(n.getContent(e.data,a,n.tooltip.format))}).on("mouseout",function(e,t){d3.select(this).attr("fill-opacity",a.alpha),n.hideTooltip()}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("fill-opacity",a.alpha).attr("cx",t).attr("cy",l).attr("r",i)}else{_.selectAll(".eve-seatmap").data(M).enter().append("rect").attr("class","eve-seatmap").attr("x",0).attr("y",0).attr("width",0).attr("height",0).attr("fill",function(e,t){return e._width=2*i(e),e._height=e._width,e._cornerRadius=e._width/10,e.set?e.set._backColor:"none"}).attr("fill-opacity","add"===n.animation.effect?0:a.alpha).attr("rx",function(e){return e._cornerRadius}).attr("ry",function(e){return e._cornerRadius}).on("mousemove",function(e,t){d3.select(this).attr("fill-opacity",1),n.showTooltip(n.getContent(e.data,a,n.tooltip.format))}).on("mouseout",function(e,t){d3.select(this).attr("fill-opacity",a.alpha),n.hideTooltip()}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("fill-opacity",a.alpha).attr("x",t).attr("y",l).attr("width",function(e){return e._width}).attr("height",function(e){return e._height})}}return N(),"linear"===a.direction?B():G(),n.update=function(e,t){n.data=e,n.updateLegend(),N(),"linear"===a.direction?B():G()},n.clear=function(){n.svg.selectAll(".eve-vis-g").remove()},n}e.seatMap=function(n){return n.masterType="grouped",n.type="seatMap",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)},e.seatmap=function(n){return n.masterType="grouped",n.type="seatMap",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){t.legend?t.legend.enabled=!1:t.legend={enabled:!1};let n=eve.initVis(t),a=n.series[0],l=n.plot.width-n.plot.left-n.plot.right-n.margin.left-n.margin.right,i=n.plot.height-n.plot.top-n.plot.bottom-n.margin.top-n.margin.bottom,o=0,r=n.title.fontSize-10,s=0,u=0,d=0,c=0,p=null,f=null,m=0,g=null,h=null,y=null,x=null,b=null,v=a.groupField||a.sourceField,F=[];function w(){b=[],n.xAxis.xValues&&n.xAxis.xValues.length>0?(F=n.xAxis.xValues.sort()).forEach(function(t){let a={key:t,values:[]};n.data.forEach(function(n){n[v]===t&&a.values.push(e.clone(n))}),b.push(a)}):b=d3.nest().key(function(e){return e[a.groupField]}).entries(n.data),s=d3.min(n.data,function(e){return+e[a.measureField]}),u=1.1*d3.max(n.data,function(e){return+e[a.measureField]}),d=d3.min(n.data,function(e){return e[a.rangeField]}),c=d3.max(n.data,function(e){return e[a.rangeField]}),F=n.xAxis.xValues&&n.xAxis.xValues.length>0?n.xAxis.xValues:e.getUniqueValues(n.data,a.groupField),isNaN(n.yAxis.min)||null===n.yAxis.min||(s=n.yAxis.min),isNaN(n.yAxis.max)||null===n.yAxis.max||(u=1.2*n.yAxis.max),isNaN(n.xAxis.min)||null===n.xAxis.min||(d=n.xAxis.min),isNaN(n.xAxis.max)||null===n.xAxis.max||(c=n.xAxis.max),p=n.svg.append("text").text(e.formatNumber(u,n.yAxis.labelFormat)).style("font-size",n.yAxis.labelFontSize+"px").style("color",n.yAxis.labelFontColor).style("font-family",n.yAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"==n.yAxis.labelFontStyle?"normal":n.yAxis.labelFontStyle).style("font-weight","bold"==n.yAxis.labelFontStyle?"bold":"normal"),tempTextOffset=p.node().getBoundingClientRect(),p.remove(),l+=o,i+=2*r+m,o=tempTextOffset.width+10,r=2*n.title.fontSize,i-=2*r;let t=((l-=o)-10)/b.length-o;m=0,b.forEach(function(e){let a=null===e.key||void 0===e.key||"undefined"===e.key?"":e.key;p=n.svg.append("text").style("fill",n.title.fontColor).style("font-size",n.title.fontSize+"px").style("font-family",n.title.fontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.title.fontStyle?"normal":n.title.fontStyle).style("font-weight","bold"===n.title.fontStyle?"bold":"normal").style("text-anchor","middle").text(a),n.wrapText(p,t),f=p.node().getBoundingClientRect(),p.remove(),f.height>m&&(m=f.height)}),i-=m,g=d3.scaleLinear().range([i,0]).domain([s,u]),y=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+n.plot.left+","+r+")")}function A(){x=y.append("g").attr("transform","translate(0, "+m+")"),(h=x.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform","translate("+o+")").attr("class","eve-y-axis").call(k())).selectAll("path").style("stroke-opacity",n.yAxis.alpha).style("stroke-width",n.yAxis.thickness+"px").style("stroke",n.yAxis.color),h.selectAll("line").style("fill","none").style("stroke-width",n.yAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",n.yAxis.alpha).style("stroke",n.yAxis.color),h.selectAll("text").style("fill",n.yAxis.labelFontColor).style("font-size",n.yAxis.labelFontSize+"px").style("font-family",n.yAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.yAxis.labelFontStyle?"normal":n.yAxis.labelFontStyle).style("font-weight","bold"===n.yAxis.labelFontStyle?"bold":"normal").transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).text(function(e){return e})}function k(){return d3.axisLeft(g)}function S(e,t,n,l){let s=0,u=0;return"translate("+(s=t(e[a.rangeField])+o+("string"===l.type?t.bandwidth()/2:0))+","+(u=n?i:g(e[a.measureField])-r)+")"}function C(e,t,n,l){let s=0,u=0;return"translate("+(s=t(e[a.rangeField])+o+("string"===l.type?t.bandwidth()/2:0))+","+(u=n?i:g(e[a.measureField])-r-a.bulletSize)+")"}function z(){let t=typeof n.data[0][a.rangeField],s=e.getUniqueValues(n.data,a.rangeField).sort(),u=(l-10)/b.length-o;b.forEach(function(l,p){let f="string"===t.type?s[0]:d3.min(l.values,function(e){return e[a.rangeField]}),h="string"===t.type?s[1]:d3.max(l.values,function(e){return e[a.rangeField]}),b=0===p?0:u*p+o*p,v=function(e,t,n){let l=[];return e.forEach(function(e){let i={},o=e[a.rangeField];o!==t&&o!==n||(i[a.rangeField]=o,i[a.sourceField]=e[a.sourceField],i[a.measureField]=e[a.measureField],""!==a.groupField&&(i[a.groupField]=e[a.groupField]),l.push(i))}),l}(l.values,f,h),w=null;"string"!==t.type&&(isNaN(n.xAxis.min)||null===n.xAxis.min||(f=d),isNaN(n.xAxis.max)||null===n.xAxis.max||(h=c)),w="string"===t.type?d3.scaleBand().range([0,u]).padding(.1).round(!0).domain([f,h]):d3.scaleLinear().range([0,u]).domain([f,h]);let A=d3.axisBottom(w).tickValues([f,h]),z=y.append("g").attr("transform","translate("+b+", "+(r+m)+")"),T=d3.line().x(function(e){return w(e[a.rangeField])+o+("string"===t.type?w.bandwidth()/2:0)}).y(function(e){return i}),M=d3.line().x(function(e){return w(e[a.rangeField])+o+("string"===t.type?w.bandwidth()/2:0)}).y(function(e){return g(e[a.measureField])-r}),_=d3.symbol().type(function(e){return"none"===a.bullet?d3.symbolCircle:a.bullet.toSymbol()}).size(function(e){return Math.pow(a.bulletSize,2)});!function(t,a){let l=i-r,s=t.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("transform","translate("+o+", "+l+")").attr("class","eve-x-axis").call(a);s.selectAll("path").style("stroke-opacity",n.xAxis.alpha).style("stroke-width",n.xAxis.thickness+"px").style("stroke",n.xAxis.color),s.selectAll("line").style("fill","none").style("stroke-width",n.xAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",n.xAxis.alpha).style("stroke",n.xAxis.color),s.selectAll("text").style("fill",n.xAxis.labelFontColor).style("font-size",n.xAxis.labelFontSize+"px").style("font-family",n.xAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.xAxis.labelFontStyle?"normal":n.xAxis.labelFontStyle).style("font-weight","bold"===n.xAxis.labelFontStyle?"bold":"normal").style("text-anchor",function(e,t){return 0===t?"start":"end"}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).text(function(t,n){return"number"===e.getType(t)&&t.toString().indexOf(".")>-1?t.toFixed(2):t})}(z,A);let E=[];d3.nest().key(function(e){return e[a.sourceField]}).entries(v).forEach(function(t){E.push(e.clone(t.values))}),yAxisGrid=z.append("g").attr("class","eve-y-grid"),yAxisGrid.attr("transform","translate("+o+", "+-r+")").call(k().tickSize(-u,0,0).tickFormat("")),yAxisGrid.selectAll(".domain").style("stroke","none").style("stroke-width","0px"),yAxisGrid.selectAll("line").style("stroke-opacity",n.yAxis.gridLineAlpha).style("stroke-width",n.yAxis.gridLineThickness+"px").style("stroke",n.yAxis.gridLineColor);let V=null===l.key||void 0===l.key||"undefined"===l.key?"":l.key,N=(x.node().getBBox().width,""),L=y.append("text").style("fill",n.title.fontColor).style("font-size",n.title.fontSize+"px").style("font-family",n.title.fontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===n.title.fontStyle?"normal":n.title.fontStyle).style("font-weight","bold"===n.title.fontStyle?"bold":"normal").style("text-anchor","middle").text(V).attr("transform","translate("+(o+b+u/2)+", 0)");n.wrapText(L,u);let B=z.selectAll(".eve-slope-serie").data(E).enter().append("g").attr("class","eve-slope-serie");B.append("path").attr("d",T).attr("fill","none").attr("class",function(e,t){return"eve-slope-line eve-slope-line-"+(N=e[0][a.sourceField].toString().trim().toLowerCase().replace(/[^a-zA-Z ]/g,""))}).attr("stroke",function(t,n){return F.length>0?p>=e.colors.length?e.randColor():e.colors[p]:n>=e.colors.length?e.randColor():e.colors[n]}).attr("stroke-opacity",1).attr("stroke-width",2),B.selectAll("path").on("click",function(e,t){null==e.clicked?(N=e[0][a.sourceField].toString().trim().toLowerCase().replace(/[^a-zA-Z ]/g,""),y.selectAll(".eve-slope-line").attr("stroke-opacity",.1),y.selectAll(".eve-slope-line-"+N).attr("stroke-opacity",1),e.clicked=!0):e.clicked?(y.selectAll(".eve-slope-line").attr("stroke-opacity",1),e.clicked=!1):(N=e[0][a.sourceField].toString().trim().toLowerCase().replace(/[^a-zA-Z ]/g,""),y.selectAll(".eve-slope-line").attr("stroke-opacity",.1),y.selectAll(".eve-slope-line-"+N).attr("stroke-opacity",1),e.clicked=!0)}).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("opacity",1).attr("d",M),E.forEach(function(l,i){z.selectAll(".eve-slope-bullet-"+i).data(l).enter().append("path").attr("class","eve-slope-bullet"+i).attr("d",_).attr("fill-opacity",0).attr("stroke-opacity",a.bulletStrokeAlpha).attr("stroke-width",a.bulletStrokeSize).attr("fill",function(t,n){return i>=e.colors.length?e.randColor():e.colors[i]}).attr("transform",function(e){return S(e,w,!0,t)}).on("mousemove",function(e,t){e._groupValue=e[a.sourceField],n.showTooltip(n.getContent(e,a,n.tooltip.format))}).on("mouseout",function(e,t){n.hideTooltip()}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("transform",function(e){return S(e,w,!1,t)}),a.labelFormat&&z.selectAll(".eve-slope-label-"+i).data(l).enter().append("text").attr("class","eve-slope-label"+i).style("fill",a.labelFontColor).style("font-size",("auto"===a.labelFontSize?11:a.labelFontSize)+"px").style("font-family",a.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===a.labelFontStyle?"normal":a.labelFontStyle).style("font-weight","bold"===a.labelFontStyle?"bold":"normal").attr("text-anchor","middle").text(function(e){return n.getContent(e,a,a.labelFormat)}).attr("transform",function(e){return C(e,w,!0,t)}).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("transform",function(e){return C(e,w,!1,t)})})})}return w(),A(),z(),n.update=function(e){n.data=e,n.animation.effect?"fade"===n.animation.effect?y.transition().duration(1e3).style("opacity",0).remove():"dim"===n.animation.effect?y.style("opacity",.15):"add"===n.animation.effect?y.style("opacity",1):y.remove():y.remove(),w(),A(),z()},n.clear=function(){n.svg.selectAll(".eve-vis-g").remove()},n}e.slopeGraph=function(n){return n.masterType="sourced",n.type="slopeGraph",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)},e.slope=function(n){return n.masterType="sourced",n.type="slopeGraph",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){t.legend?t.legend.enabled=!1:t.legend={enabled:!1};let n,a=eve.initVis(t),l=a.series[0],i=0,o=0,r={left:0,top:0,bottom:0,right:0},s=0,u=0,d=0,c=null,p=null,f=null,m=null,g=null,h=null,y=null,x="",b=null,v=null;function F(){p=d3.hierarchy(a.data).each(function(e){/^other[0-9]+$/.test(e.data[l.labelField])&&(e.data[l.labelField]=null)}).sum(function(e){return+e[l.sizeField]}).sort(function(e,t){return t.value-e.value}),i=d3.max(p.descendants(),function(e){return a.getContent(e,l,l.labelFormat).toString().length}),"auto"===l.labelFontSize&&(l.labelFontSize=11),o=l.labelFormat?l.labelFontSize*i+1:10,r.left=a.margin.left+o,r.right=a.margin.right+o,r.top=a.margin.top,r.bottom=a.margin.bottom,s=a.plot.width-r.left-r.right,u=a.plot.height-r.top-r.bottom,d=Math.abs(Math.min(a.plot.width-o,a.plot.height-o)/2),c=d3.partition().size([360,d]).padding(0),f=d3.hierarchy(a.data,function(e){return e.children}).sum(function(e){return e.children?0:e.size}),c(f),g=d3.scaleLinear().domain([0,360]).range([0,2*Math.PI]).clamp(!0),m=d3.scaleOrdinal(e.colors),h=d3.arc().startAngle(function(e){return g(e.x0)}).endAngle(function(e){return g(e.x1)}).innerRadius(function(e){return e.y0}).outerRadius(function(e){return 10}),n=d3.arc().startAngle(function(e){return g(e.x0)}).endAngle(function(e){return g(e.x1)}).innerRadius(function(e){return e.y0}).outerRadius(function(e){return e.y1})}function w(){h=d3.arc().startAngle(function(e){return g(e.x0)}).endAngle(function(e){return g(e.x1)}).innerRadius(function(e){return e.y0}).outerRadius(function(e){return e.y1}),b.attr("opacity","add"===a.animation.effect?0:1).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attr("opacity",1).attr("d",h),b.exit().remove(),v.attr("opacity","add"===a.animation.effect?0:1).transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay}).attr("opacity",1).attr("x",function(e){return g(e.y0)}).attr("transform",function(e){return e.depth>0?"translate("+n.centroid(e)+")rotate("+k(e,!0)+")":null}),v.exit().remove()}function A(){b=S.selectAll("path").data(f.descendants()).enter().append("path").attr("display",function(e){return e.depth?null:"none"}).attr("d",h).attr("class","eve-sunburst-node").attr("stroke","rgb(255,255,255)").attr("fill",function(e){return m((e.children?e:e.parent).data.name)}).attr("fill-rule","evenodd").on("mousemove",function(e,t){y=function(e){let t=[],n=e;for(;n.parent;)t.unshift(n),n=n.parent;return t}(e),S.selectAll(".eve-sunburst-node").style("opacity",.3),S.selectAll(".eve-sunburst-node").filter(function(e){return y.indexOf(e)>=0}).style("opacity",1),e.expressionedDataValue=function(e){let t=e.value,n=e.children?e.children:[];if(0===n.length)return t;switch(l.expression){case"avg":t=e.value/n.length,null!=a.data.averages[e.data.name]&&(t=+a.data.averages[e.data.name]);break;case"min":t=d3.min(n,function(e){return e.value}),null!=a.data.averages[e.data.name]&&(t=+a.data.averages[e.data.name]);break;case"max":t=d3.max(n,function(e){return e.value}),null!=a.data.averages[e.data.name]&&(t=+a.data.averages[e.data.name]);break}return t}(e),a.showTooltip(a.getContent(e,l,a.tooltip.format))}).on("mouseout",function(e,t){S.selectAll(".eve-sunburst-node").style("opacity",1),a.hideTooltip()}),v=S.selectAll("text").data(f.descendants()).enter().append("text").style("fill",function(e){return x=m((e.children?e:e.parent).data.name),"auto"===l.labelFontColor?d3.color(x).brighter(5):l.labelFontColor}).style("font-size",l.labelFontSize+"px").style("font-family",l.labelFontFamily).style("font-style","bold"===l.labelFontStyle?"normal":l.labelFontStyle).style("font-weight","bold"===l.labelFontStyle?"bold":"normal").attr("text-anchor","middle").text(function(e){return a.getContent(e,l,l.labelFormat)}).attr("dx",0).attr("dy",".5em").attr("x",function(e){return g(e.y0)}).attr("transform",function(e){return e.depth>0?"translate("+h.centroid(e)+")rotate("+k(e,!0)+")":null})}function k(e,t){let a=0;return(a=t?180/Math.PI*(h.startAngle()(e)+h.endAngle()(e))/2-90:180/Math.PI*(n.startAngle()(e)+n.endAngle()(e))/2-90)>90?a-180:a}F();let S=a.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+a.plot.width/2+","+u/2+")");return A(),w(),a.update=function(e){a.data=e,F(),a.animation.effect?"fade"===a.animation.effect?S.transition().duration(1e3).style("opacity",0).remove():"dim"===a.animation.effect?S.style("opacity",.15):"add"===a.animation.effect?S.style("opacity",1):S.remove():S.remove(),S=a.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+a.plot.width/2+","+u/2+")"),A(),w()},a.clear=function(){a.svg.selectAll(".eve-vis-g").remove()},a}e.sunburst=function(n){return n.type="sunburst",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){let n,a,l,i,o=eve.initVis(t),r=o.series[0],s=o.plot.height-o.plot.top-o.plot.bottom-o.margin.bottom-o.margin.top,u=s/4,d=10,c={top:10,left:0,right:o.plot.right,bottom:u},p={top:s-u+2*o.xAxis.labelFontSize,left:0,right:o.plot.right,bottom:0},f=s-p.top-p.bottom-2*o.xAxis.labelFontSize+d,m=s-c.top-c.bottom,g=o.plot.width-o.plot.left-o.plot.right-o.margin.right-o.margin.left,h=null,y=null,x=null,b=[],v="",F="",w={},A=d3.scaleUtc().range([0,g]),k=d3.scaleUtc().range([0,g]),S=d3.scaleBand().range([0,m]).padding(.1),C=d3.scaleBand().range([0,f]).padding(.1),z=null,T=null,M=null,_=null,E=null,V=null,N=null,L=m/o.data.length,B=4,G=0,D=null,I=0,Z=0,P=r.color,O=r.labelField||r.sourceField,Y=0;if(0===o.data.length)return;function R(e){return d3.axisBottom().scale(e?k:A)}function H(e,t){let n=0;return w[e].forEach(function(e,a){r.dateEndField?t[r.startField]==e[r.startField]&&t[r.endField]==e[r.endField]&&t[r.groupField]==e[r.groupField]&&(n=a):t[r.startField]==e[r.startField]&&t[r.groupField]==e[r.groupField]&&(n=a)}),n}function U(e){let t=25+2*L;return F=e[O],Y=H(F,e),I=A(new Date(e[r.startField])),(Z=S(e[O])+L*Y)>=m-t&&(Z=m-t),"translate("+(isNaN(I)?0:I)+","+Z+")"}function W(e){return I=k(new Date(e[r.startField])),Z=C(e[O]),"translate("+(isNaN(I)?0:I)+","+Z+")"}function q(t,n){return r.groupField?P=o.legend.legendColors.length>0?e.matchGroup(t[r.groupField],o.legend.legendColors,"color"):n>=e.colors.length?e.randColor():e.colors[n]:o.legend.legendColors.length>0?o.legend.legendColors[0].color:n>=e.colors.length?e.randColor():e.colors[0]}function X(){E.selectAll(".domain").style("stroke","none").style("stroke-width","0px"),E.selectAll("line").style("stroke-opacity",o.xAxis.gridLineThickness).style("stroke-width",o.xAxis.gridLineAlpha).style("stroke-dasharray","2,2").style("stroke",o.xAxis.gridLineColor),T.selectAll("path").style("stroke-opacity",o.xAxis.alpha).style("stroke-width",o.xAxis.thickness+"px").style("stroke",o.xAxis.color),T.selectAll("line").style("fill","none").style("stroke-width",o.xAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",o.xAxis.alpha).style("stroke",o.xAxis.color),T.selectAll("text").style("fill",o.xAxis.labelFontColor).style("font-size",o.xAxis.labelFontSize+"px").style("font-family",o.xAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===o.xAxis.labelFontStyle?"normal":o.xAxis.labelFontStyle).style("font-weight","bold"===o.xAxis.labelFontStyle?"bold":"normal")}function j(){let e=d3.event.selection||k.range();A.domain(e.map(k.invert,k)),l.attr("transform",U).attr("rx",r.endField?L/2:0).attr("ry",r.endField?L/2:0).attr("width",function(e){return r.endField?(G=Math.abs(A(new Date(e[r.endField]))-A(new Date(e[r.startField]))),isNaN(G)?0:G):B}),r.labelFormat&&N.attr("transform",function(e){return D=this.getBBox(),F=e[O],Y=H(F,e),I=A(new Date(e[r.startField]))+10,Z=S(e[O])+L*Y-2,"translate("+I+","+Z+")"}),T.call(z),E.call(R().tickSize(-m,0,0).tickFormat("")),X()}let K=o.svg.append("g").attr("transform","translate("+o.plot.left+", "+o.plot.top+")").append("svg").attr("width",g).attr("height",o.plot.height-o.plot.top-o.plot.bottom).attr("fill",o.backColor).attr("stroke","none").append("g").attr("class","eve-vis-g").attr("transform","translate(0,0)").attr("width",g);var J;return function(t){o.data.sort(function(e,t){return d3.ascending(e[O],t[O])}),t||(h=d3.min(o.data,function(e){return new Date(e[r.startField])}),y=d3.max(o.data,function(e){return r.endField?new Date(e[r.endField]):new Date(e[r.startField])}),x=y.diff(h)),x>365?(h=d3.timeMonth.offset(h,-1),y=d3.timeMonth.offset(y,1)):(h=d3.timeDay.offset(h,-1),y=d3.timeDay.offset(y,1)),o.data.forEach(function(t,n){F=t[O],-1===b.indexOf(F)&&b.push(F),F!==v?w[F]?w[F].push(e.clone(t)):(w[F]=[],w[F].push(e.clone(t))):w[F].push(e.clone(t)),v=F}),z=R(!1),M=R(!0),L=m/o.data.length,A.domain([h,y]),S.domain(b),k.domain(A.domain()),C.domain(S.domain()),"auto"===r.labelFontSize&&(r.labelFontSize=11),"auto"===r.labelFontColor&&(r.labelFontColor="#333333")}(J),K.append("defs").append("clipPath").attr("id","eve-timeline-clip").append("rect").attr("width",g).attr("height",m),n=K.append("g").attr("class","eve-timeline-base").attr("width",g).attr("transform","translate("+c.left+","+c.top+")"),a=K.append("g").attr("class","eve-timeline-context").attr("width",g).attr("transform","translate("+p.left+","+p.top+")"),l=n.append("g").selectAll(".eve-timeline-base-content").data(o.data).enter().append("rect").attr("class","eve-timeline-base-content").attr("transform",U).style("fill",q).attr("height",r.endField?L:B).attr("rx",r.endField?L/2:0).attr("ry",r.endField?L/2:0).attr("width",function(e){return r.endField?(G=Math.abs(A(new Date(e[r.endField]))-A(new Date(e[r.startField]))),isNaN(G)?0:G):B}).on("mousemove",function(e,t){o.showTooltip(o.getContent(e,r,o.tooltip.format.replaceAll("{source}","{label}")))}).on("mouseout",function(e,t){o.hideTooltip()}),r.labelFormat&&(N=n.append("g").selectAll(".pagos-timeline-focus-labels").data(o.data).enter().append("text").style("text-anchor","start").style("fill",r.labelFontColor).style("font-size",r.labelFontSize+"px").style("font-family",r.labelFontFamily).style("font-style","bold"===r.labelFontStyle?"normal":r.labelFontStyle).style("font-weight","bold"===r.labelFontStyle?"bold":"normal").text(function(e){return o.getContent(e,r,r.labelFormat.replaceAll("{source}","{label}"))}).attr("transform",function(e){return D=this.getBBox(),F=e[O],Y=H(F,e),I=A(new Date(e[r.startField]))+10,Z=S(e[O])+L*Y-2,"translate("+I+","+Z+")"})),i=a.append("g").selectAll(".eve-timeline-lane-content").data(o.data).enter().append("rect").attr("class","eve-timeline-lane-content").attr("transform",W).style("fill",q).style("fill-opacity",.1).attr("rx",r.endField?B/2:0).attr("ry",r.endField?B/2:0).attr("height",B).attr("width",function(e){return r.endField?(G=Math.abs(k(new Date(e[r.endField]))-k(new Date(e[r.startField]))),isNaN(G)?0:G):B}),E=n.append("g").attr("class","eve-x-grid").attr("transform","translate(0,"+m+")").call(R(!1).tickSize(-m,0,0).tickFormat("")),T=n.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("class","eve-timeline-x-axis-base").attr("transform","translate(0,"+m+")").call(z),(_=a.append("g").style("fill","none").style("shape-rendering","crispEdges").attr("class","eve-timeline-x-axis-base").attr("transform","translate(0,"+f+")").call(M)).selectAll("path").style("stroke-opacity",o.xAxis.alpha).style("stroke-width",o.xAxis.thickness+"px").style("stroke",o.xAxis.color),_.selectAll("line").style("fill","none").style("stroke-width",o.xAxis.thickness+"px").style("shape-rendering","crispEdges").style("stroke-opacity",o.xAxis.alpha).style("stroke",o.xAxis.color),_.selectAll("text").style("fill",o.xAxis.labelFontColor).style("font-size",o.xAxis.labelFontSize+"px").style("font-family",o.xAxis.labelFontFamily+", Arial, Helvetica, Ubuntu").style("font-style","bold"===o.xAxis.labelFontStyle?"normal":o.xAxis.labelFontStyle).style("font-weight","bold"===o.xAxis.labelFontStyle?"bold":"normal"),X(),function(){V=d3.brushX().extent([[0,0],[g,f]]).on("brush end",j);let e=A.range(),t=e[1]-e[0],n=t/2,l=t/d,i=n-l,o=n+l;a.append("g").attr("class","eve-x-brush").call(V).call(V.move,[i,o]).selectAll("rect").attr("y",0).attr("height",f)}(),o.update=function(e,t){o.data=e,$("#"+o.container).html(""),eve[o.type](o)},o.clear=function(){o.svg.selectAll(".eve-vis-g").remove()},o}e.timeline=function(n){return n.masterType="grouped",n.type="timeline",n.yAxis&&(n.yAxis.stacked=!1),n.legend&&n.series&&n.series.length>0&&(n.series[0].groupField||(n.legend.enabled=!1)),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(e){let t,n=eve.initVis(e),a=n.series[0],l=25,i="",o=0,r=0,s=null,u=null,d=null,c=null,p=null,f=0,m=null,g=8,h=0,y=0,x=0,b=null,v=null;function F(){o=n.plot.width-2*n.plot.left-n.plot.right,r=n.plot.height-n.plot.top-n.plot.bottom-l,s=d3.scaleLinear().domain([0,o]).range([0,o]),u=d3.scaleLinear().domain([0,r]).range([l,r+l]);let e=d3.range(n.domains.minY,n.domains.maxY,(n.domains.maxY-n.domains.minY)/(n.legend.gradientColors.length-1));e.push(n.domains.maxY),d=d3.scaleLinear().range(n.legend.gradientColors).domain(e),i=d3.rgb(n.legend.gradientColors[n.legend.gradientColors.length-1]).darker();let t=d3.pack().padding(2).size([n.plot.width,n.plot.height])(d3.hierarchy(n.data).each(function(e){/^other[0-9]+$/.test(e.data[a.sourceField])&&(e.data[a.sourceField]=null)}).sum(function(e){return+e[a.sizeField]}).sort(function(e,t){return t.value-e.value})).descendants();f=d3.max(t,function(e){return e.depth}),m=d3.scaleLinear().domain([1,2]).range([f,0]),c=d3.layout.treemap().children(function(e,t){return e.value=e.size?e.size:0,t?null:e._children}).sort(function(e,t){return e.value-t.value}).ratio(r/o*.5*(1+Math.sqrt(5))).round(!1)}function w(){var e;(p=S.append("g").attr("class","grandparent")).append("rect").attr("y",0).attr("width",o).attr("height",l).style("fill",i),p.append("text").attr("x",6).attr("y",6).attr("dy",".75em"),(e=n.data).x=e.y=0,e.dx=o,e.dy=r,e.depth=0,function e(t){return(t._children=t.children)?t.value=t.children.reduce(function(t,n){return t+e(n)},0):t.value}(n.data),function e(t){t._children&&(c.nodes({_children:t._children}),t._children.forEach(function(n){n.x=t.x+n.x*t.dx,n.y=t.y+n.y*t.dy,n.dx*=t.dx,n.dy*=t.dy,n.parent=t,n._depth=t.depth+1,e(n)}))}(n.data),function e(l){p.datum(l.parent).on("click",r).select("text").text(function e(t){return t.parent?e(t.parent)+"."+t.name:t.name}(l));let i=S.insert("g",".grandparent").datum(l).attr("class","depth").attr("transform","translate(0,4)");let o=i.selectAll("g").data(l._children).enter().append("g");o.selectAll(".parent").data(function(e){return e._children?[e]:[]}).enter().append("rect").attr("class","parent").style("fill","none").style("stroke-width",7).style("stroke","#ffffff").style("stroke-opacity",a.bulletStrokeAlpha).call(k);o.filter(function(e){return e._children}).classed("children",!0).on("click",r);v=o.selectAll(".child").data(function(e){return e._children||[e]}).enter().append("rect").attr("class","child").style("fill",function(e){return e.value>n.domains.maxY?d(n.domains.maxY):d(e.value)}).style("fill-opacity",.9).style("stroke-width",1).style("stroke","#ffffff").style("stroke-opacity",a.bulletStrokeAlpha).on("mousemove",function(e){n.showTooltip(n.getContent(e,a,n.tooltip.format))}).on("mouseout",function(e){n.hideTooltip()}).call(k);b=o.append("text").attr("dy",".75em").style("pointer-events","none").style("text-anchor","middle").style("font-family",a.labelFontFamily).style("font-style","bold"===a.labelFontStyle?"normal":a.labelFontStyle).style("font-weight","bold"===a.labelFontStyle?"bold":"normal").style("font-size",g+"px").text(function(e){return n.getContent(e,a,a.labelFormat)}).style("fill",function(e){return"auto"===a.labelFontColor?n.getAutoColor(d(e.value)):a.labelFontColor}).style("font-size",function(e){if(!t)return y=s(e.x+e.dx)-s(e.x),x=u(e.y+e.dy)-u(e.y),h=Math.max(y,x)/4,"auto"===a.labelFontSize?e.fontSize=Math.min(2*h,(2*h-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*g):e.fontSize=a.labelFontSize,e.fontSize+"px"}).style("fill-opacity",function(e){return bbox=this.getBBox(),y=s(e.x+e.dx)-s(e.x),"auto"===a.labelFontSize?e.fontSize<g?0:1:"always"===a.labelVisibility?1:bbox.width<y?1:0}).call(A);function r(n){if(t||!n)return;t=!0;let l=e(n),o=i.transition().duration(750),r=l.transition().duration(750);s.domain([n.x,n.x+n.dx]),u.domain([n.y,n.y+n.dy]),S.style("shape-rendering",null),S.selectAll(".depth").sort(function(e,t){return e.depth-t.depth}),l.selectAll("text").style("fill-opacity",0),o.selectAll("text").call(A).style("fill-opacity",0),r.selectAll("text").call(A).style("fill-opacity",1),o.selectAll("rect").call(k),r.selectAll("rect").call(k),o.remove().each(function(){S.style("shape-rendering","crispEdges"),t=!1}),b.style("font-size",function(e){return y=s(e.x+e.dx)-s(e.x),x=u(e.y+e.dy)-u(e.y),h=Math.max(y,x)/4,"auto"===a.labelFontSize?e.fontSize=Math.min(2*h,(2*h-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*g):e.fontSize=a.labelFontSize,e.fontSize+"px"})}return o}(n.data)}function A(e){e.attr("x",function(e){return bbox=this.getBBox(),y=s(e.x+e.dx)-s(e.x),x=u(e.y+e.dy)-u(e.y),s(e.x)+y/2}).attr("y",function(e){return bbox=this.getBBox(),y=s(e.x+e.dx)-s(e.x),x=u(e.y+e.dy)-u(e.y),u(e.y)+x/2-bbox.height/2})}function k(e){e.attr("x",function(e){return s(e.x)}).attr("y",function(e){return u(e.y)}).attr("width",function(e){return s(e.x+e.dx)-s(e.x)}).attr("height",0).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("opacity",1).attr("height",function(e){return u(e.y+e.dy)-u(e.y)})}F();let S=n.svg.append("g").style("fill","rgb(255,255,255)").attr("class","eve-vis-g").attr("transform","translate("+n.plot.left+","+n.plot.top+")");return w(),n.update=function(e){n.data=e,n.calculateDomain(),n.updateLegend(),F(),n.animation.effect?"fade"===n.animation.effect?S.transition().duration(1e3).style("opacity",0).remove():"dim"===n.animation.effect?S.style("opacity",.15):"add"===n.animation.effect?S.style("opacity",1):S.remove():S.remove(),S=n.svg.append("g").style("fill","rgb(255,255,255)").attr("class","eve-vis-g").attr("transform","translate("+n.plot.left+","+n.plot.top+")"),w()},n.clear=function(){n.svg.selectAll(".eve-vis-g").remove()},n}e.treemap=function(n){return n.masterType="tree",n.type="treemap",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){let n=eve.initVis(t),a=n.series[0],l=0,i=e.colors[0],o=0,r=0,s=0,u=null,d=null,c=null,p=0;function f(){s=n.plot.width-n.plot.left-n.plot.right-n.margin.left-n.margin.right,p=n.plot.height-n.plot.top-n.plot.bottom-n.margin.bottom-n.margin.top,u=d3.scaleLinear().range(n.legend.gradientColors).domain([n.domains.minY,n.domains.maxY]),d=d3.scaleLinear().domain([n.domains.minY,n.domains.maxY]).range([a.minFontSize,a.maxFontSize]),n.data.forEach(function(t,s){l=+t[a.measureField],i=n.legend.enabled?u(l):s>=e.colors.length?e.randColor():e.colors[s],o=e.randInt(-90,90),r=d(l),t.value=l,t.fontSize=r,t.size=r,t.fontColor=i,t.color=i,t.angle=o})}function m(){d3.layout.cloud().size([s,p]).words(n.data).padding(5).rotate(function(){return 90*~~(2*Math.random())}).font(a.fontFamily).fontSize(function(e){return e.size}).on("end",g).start()}function g(e){(c=h.selectAll("text").data(e).enter().append("text").style("font-size",function(e){return e.size+"px"}).style("font-family",a.fontFamily).style("cursor","pointer").style("fill",function(e,t){return e.color}).attr("text-anchor","middle").attr("transform",function(e){return"translate("+[0,0]+")rotate(0)"}).on("mousemove",function(e,t){n.showTooltip(n.getContent(e,a,n.tooltip.format))}).on("mouseout",function(e,t){n.hideTooltip()}).text(function(e){return e.text})).attr("opacity","add"===n.animation.effect?0:1).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).attr("opacity",1).style("font-size",function(e){return e.size+"px"}).style("fill",function(e,t){return e.color}).attr("transform",function(e){return"translate("+[e.x,e.y]+")rotate("+e.rotate+")"})}f();let h=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+s/2+","+p/2+")");return m(),n.update=function(e){n.data=e,n.calculateDomain(),n.updateLegend(),f(),n.animation.effect?"fade"===n.animation.effect?h.transition().duration(1e3).style("opacity",0).remove():"dim"===n.animation.effect?h.style("opacity",.15):"add"===n.animation.effect?h.style("opacity",1):h.remove():h.remove(),h=n.svg.append("g").attr("class","eve-vis-g").attr("transform","translate("+s/2+","+p/2+")"),m()},n.clear=function(){n.svg.selectAll(".eve-vis-g").remove()},n}e.wordCloud=function(n){return n.masterType="standard",n.type="wordCloud",e.visualizations.push(n),new t(n)},e.wordcloud=function(n){return n.masterType="standard",n.type="wordCloud",n.yAxis&&(n.yAxis.stacked=!1),e.visualizations.push(n),new t(n)}}(eve),function(){!function(e){if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(e){return e&&DataView.prototype.isPrototypeOf(e)},l=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1};d.prototype.append=function(e,t){e=r(e),t=s(t);var n=this.map[e];this.map[e]=n?n+","+t:t},d.prototype.delete=function(e){delete this.map[r(e)]},d.prototype.get=function(e){return e=r(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(r(e))},d.prototype.set=function(e,t){this.map[r(e)]=s(t)},d.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},d.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),u(e)},d.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),u(e)},d.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),u(e)},t.iterable&&(d.prototype[Symbol.iterator]=d.prototype.entries);var i=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];h.prototype.clone=function(){return new h(this,{body:this._bodyInit})},g.call(h.prototype),g.call(x.prototype),x.prototype.clone=function(){return new x(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},x.error=function(){var e=new x(null,{status:0,statusText:""});return e.type="error",e};var o=[301,302,303,307,308];x.redirect=function(e,t){if(-1===o.indexOf(t))throw new RangeError("Invalid status code");return new x(null,{status:t,headers:{location:e}})},e.Headers=d,e.Request=h,e.Response=x,e.fetch=function(e,n){return new Promise(function(a,l){var i=new h(e,n),o=new XMLHttpRequest;o.onload=function(){var e,t,n={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",t=new d,e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),a=n.shift().trim();if(a){var l=n.join(":").trim();t.append(a,l)}}),t)};n.url="responseURL"in o?o.responseURL:n.headers.get("X-Request-URL");var l="response"in o?o.response:o.responseText;a(new x(l,n))},o.onerror=function(){l(new TypeError("Network request failed"))},o.ontimeout=function(){l(new TypeError("Network request failed"))},o.open(i.method,i.url,!0),"include"===i.credentials&&(o.withCredentials=!0),"responseType"in o&&t.blob&&(o.responseType="blob"),i.headers.forEach(function(e,t){o.setRequestHeader(t,e)}),o.send(void 0===i._bodyInit?null:i._bodyInit)})},e.fetch.polyfill=!0}function r(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function s(e){return"string"!=typeof e&&(e=String(e)),e}function u(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(n[Symbol.iterator]=function(){return n}),n}function d(e){this.map={},e instanceof d?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function c(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function f(e){var t=new FileReader,n=p(t);return t.readAsArrayBuffer(e),n}function m(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&a(e))this._bodyArrayBuffer=m(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!l(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=m(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=c(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?c(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(f)}),this.text=function(){var e,t,n,a=c(this);if(a)return a;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=p(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),a=0;a<t.length;a++)n[a]=String.fromCharCode(t[a]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(y)}),this.json=function(){return this.text().then(JSON.parse)},this}function h(e,t){var n,a,l=(t=t||{}).body;if(e instanceof h){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,l||null==e._bodyInit||(l=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new d(t.headers)),this.method=(n=t.method||this.method||"GET",a=n.toUpperCase(),i.indexOf(a)>-1?a:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&l)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(l)}function y(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),a=n.shift().replace(/\+/g," "),l=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(a),decodeURIComponent(l))}}),t}function x(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:void 0);var e=n,t={read:function(e,t,n,a,l){var i,o,r=8*l-a-1,s=(1<<r)-1,u=s>>1,d=-7,c=n?l-1:0,p=n?-1:1,f=e[t+c];for(c+=p,i=f&(1<<-d)-1,f>>=-d,d+=r;d>0;i=256*i+e[t+c],c+=p,d-=8);for(o=i&(1<<-d)-1,i>>=-d,d+=a;d>0;o=256*o+e[t+c],c+=p,d-=8);if(0===i)i=1-u;else{if(i===s)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,a),i-=u}return(f?-1:1)*o*Math.pow(2,i-a)},write:function(e,t,n,a,l,i){var o,r,s,u=8*i-l-1,d=(1<<u)-1,c=d>>1,p=23===l?Math.pow(2,-24)-Math.pow(2,-77):0,f=a?0:i-1,m=a?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(r=isNaN(t)?1:0,o=d):(o=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-o))<1&&(o--,s*=2),(t+=o+c>=1?p/s:p*Math.pow(2,1-c))*s>=2&&(o++,s/=2),o+c>=d?(r=0,o=d):o+c>=1?(r=(t*s-1)*Math.pow(2,l),o+=c):(r=t*Math.pow(2,c-1)*Math.pow(2,l),o=0));l>=8;e[n+f]=255&r,f+=m,r/=256,l-=8);for(o=o<<l|r,u+=l;u>0;e[n+f]=255&o,f+=m,o/=256,u-=8);e[n+f-m]|=128*g}};function n(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;function a(e){return e.type===n.Bytes?e.readVarint()+e.pos:e.pos+1}function l(e,t,n){return n?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function i(e,t,n){var a=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.ceil(Math.log(t)/(7*Math.LN2));n.realloc(a);for(var l=n.pos-1;l>=e;l--)n.buf[l+a]=n.buf[l]}function o(e,t){for(var n=0;n<e.length;n++)t.writeVarint(e[n])}function r(e,t){for(var n=0;n<e.length;n++)t.writeSVarint(e[n])}function s(e,t){for(var n=0;n<e.length;n++)t.writeFloat(e[n])}function u(e,t){for(var n=0;n<e.length;n++)t.writeDouble(e[n])}function d(e,t){for(var n=0;n<e.length;n++)t.writeBoolean(e[n])}function c(e,t){for(var n=0;n<e.length;n++)t.writeFixed32(e[n])}function p(e,t){for(var n=0;n<e.length;n++)t.writeSFixed32(e[n])}function f(e,t){for(var n=0;n<e.length;n++)t.writeFixed64(e[n])}function m(e,t){for(var n=0;n<e.length;n++)t.writeSFixed64(e[n])}function g(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function h(e,t,n){e[n]=t,e[n+1]=t>>>8,e[n+2]=t>>>16,e[n+3]=t>>>24}function y(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}n.prototype={destroy:function(){this.buf=null},readFields:function(e,t,n){for(n=n||this.length;this.pos<n;){var a=this.readVarint(),l=a>>3,i=this.pos;this.type=7&a,e(l,t,this),this.pos===i&&this.skip(a)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=g(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=y(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=g(this.buf,this.pos)+4294967296*g(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=g(this.buf,this.pos)+4294967296*y(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=t.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=t.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,n,a=this.buf;return t=127&(n=a[this.pos++]),n<128?t:(t|=(127&(n=a[this.pos++]))<<7,n<128?t:(t|=(127&(n=a[this.pos++]))<<14,n<128?t:(t|=(127&(n=a[this.pos++]))<<21,n<128?t:function(e,t,n){var a,i,o=n.buf;if(i=o[n.pos++],a=(112&i)>>4,i<128)return l(e,a,t);if(i=o[n.pos++],a|=(127&i)<<3,i<128)return l(e,a,t);if(i=o[n.pos++],a|=(127&i)<<10,i<128)return l(e,a,t);if(i=o[n.pos++],a|=(127&i)<<17,i<128)return l(e,a,t);if(i=o[n.pos++],a|=(127&i)<<24,i<128)return l(e,a,t);if(i=o[n.pos++],a|=(1&i)<<31,i<128)return l(e,a,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(n=a[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=function(e,t,n){var a="",l=t;for(;l<n;){var i,o,r,s=e[l],u=null,d=s>239?4:s>223?3:s>191?2:1;if(l+d>n)break;1===d?s<128&&(u=s):2===d?128==(192&(i=e[l+1]))&&(u=(31&s)<<6|63&i)<=127&&(u=null):3===d?(i=e[l+1],o=e[l+2],128==(192&i)&&128==(192&o)&&((u=(15&s)<<12|(63&i)<<6|63&o)<=2047||u>=55296&&u<=57343)&&(u=null)):4===d&&(i=e[l+1],o=e[l+2],r=e[l+3],128==(192&i)&&128==(192&o)&&128==(192&r)&&((u=(15&s)<<18|(63&i)<<12|(63&o)<<6|63&r)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,d=1):u>65535&&(u-=65536,a+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),a+=String.fromCharCode(u),l+=d}return a}(this.buf,this.pos,e);return this.pos=e,t},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){var n=a(this);for(e=e||[];this.pos<n;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===n.Varint)for(;this.buf[this.pos++]>127;);else if(t===n.Bytes)this.pos=this.readVarint()+this.pos;else if(t===n.Fixed32)this.pos+=4;else{if(t!==n.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var n=new Uint8Array(t);n.set(this.buf),this.buf=n,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),h(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),h(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),h(this.buf,-1&e,this.pos),h(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),h(this.buf,-1&e,this.pos),h(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var n,a;e>=0?(n=e%4294967296|0,a=e/4294967296|0):(a=~(-e/4294967296),4294967295^(n=~(-e%4294967296))?n=n+1|0:(n=0,a=a+1|0));if(e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,n){n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos]=127&e}(n,0,t),function(e,t){var n=(7&e)<<4;if(t.buf[t.pos++]|=n|((e>>>=3)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;t.buf[t.pos++]=127&e}(a,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,n){for(var a,l,i=0;i<t.length;i++){if((a=t.charCodeAt(i))>55295&&a<57344){if(!l){a>56319||i+1===t.length?(e[n++]=239,e[n++]=191,e[n++]=189):l=a;continue}if(a<56320){e[n++]=239,e[n++]=191,e[n++]=189,l=a;continue}a=l-55296<<10|a-56320|65536,l=null}else l&&(e[n++]=239,e[n++]=191,e[n++]=189,l=null);a<128?e[n++]=a:(a<2048?e[n++]=a>>6|192:(a<65536?e[n++]=a>>12|224:(e[n++]=a>>18|240,e[n++]=a>>12&63|128),e[n++]=a>>6&63|128),e[n++]=63&a|128)}return n}(this.buf,e,this.pos);var n=this.pos-t;n>=128&&i(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeFloat:function(e){this.realloc(4),t.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),t.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var n=0;n<t;n++)this.buf[this.pos++]=e[n]},writeRawMessage:function(e,t){this.pos++;var n=this.pos;e(t,this);var a=this.pos-n;a>=128&&i(n,a,this),this.pos=n-1,this.writeVarint(a),this.pos+=a},writeMessage:function(e,t,a){this.writeTag(e,n.Bytes),this.writeRawMessage(t,a)},writePackedVarint:function(e,t){this.writeMessage(e,o,t)},writePackedSVarint:function(e,t){this.writeMessage(e,r,t)},writePackedBoolean:function(e,t){this.writeMessage(e,d,t)},writePackedFloat:function(e,t){this.writeMessage(e,s,t)},writePackedDouble:function(e,t){this.writeMessage(e,u,t)},writePackedFixed32:function(e,t){this.writeMessage(e,c,t)},writePackedSFixed32:function(e,t){this.writeMessage(e,p,t)},writePackedFixed64:function(e,t){this.writeMessage(e,f,t)},writePackedSFixed64:function(e,t){this.writeMessage(e,m,t)},writeBytesField:function(e,t){this.writeTag(e,n.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,n.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,n.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,n.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,n.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,n.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,n.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,n.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,n.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,n.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var x=b;function b(e,t){this.x=e,this.y=t}b.prototype={clone:function(){return new b(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,n=e.y-this.y;return t*t+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,n=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=n,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),n=Math.sin(e),a=t*this.x-n*this.y,l=n*this.x+t*this.y;return this.x=a,this.y=l,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},b.convert=function(e){return e instanceof b?e:Array.isArray(e)?new b(e[0],e[1]):e};var v=x,F=w;function w(e,t,n,a,l){this.properties={},this.extent=n,this.type=0,this._pbf=e,this._geometry=-1,this._keys=a,this._values=l,e.readFields(A,this,t)}function A(e,t,n){1==e?t.id=n.readVarint():2==e?function(e,t){var n=e.readVarint()+e.pos;for(;e.pos<n;){var a=t._keys[e.readVarint()],l=t._values[e.readVarint()];t.properties[a]=l}}(n,t):3==e?t.type=n.readVarint():4==e&&(t._geometry=n.pos)}function k(e){for(var t,n,a=0,l=0,i=e.length,o=i-1;l<i;o=l++)t=e[l],a+=((n=e[o]).x-t.x)*(t.y+n.y);return a}w.types=["Unknown","Point","LineString","Polygon"],w.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,n=e.readVarint()+e.pos,a=1,l=0,i=0,o=0,r=[];e.pos<n;){if(!l){var s=e.readVarint();a=7&s,l=s>>3}if(l--,1===a||2===a)i+=e.readSVarint(),o+=e.readSVarint(),1===a&&(t&&r.push(t),t=[]),t.push(new v(i,o));else{if(7!==a)throw new Error("unknown command "+a);t&&t.push(t[0].clone())}}return t&&r.push(t),r},w.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,n=1,a=0,l=0,i=0,o=1/0,r=-1/0,s=1/0,u=-1/0;e.pos<t;){if(!a){var d=e.readVarint();n=7&d,a=d>>3}if(a--,1===n||2===n)l+=e.readSVarint(),i+=e.readSVarint(),l<o&&(o=l),l>r&&(r=l),i<s&&(s=i),i>u&&(u=i);else if(7!==n)throw new Error("unknown command "+n)}return[o,s,r,u]},w.prototype.toGeoJSON=function(e,t,n){var a,l,i=this.extent*Math.pow(2,n),o=this.extent*e,r=this.extent*t,s=this.loadGeometry(),u=w.types[this.type];function d(e){for(var t=0;t<e.length;t++){var n=e[t],a=180-360*(n.y+r)/i;e[t]=[360*(n.x+o)/i-180,360/Math.PI*Math.atan(Math.exp(a*Math.PI/180))-90]}}switch(this.type){case 1:var c=[];for(a=0;a<s.length;a++){if(s[a][0].x>this.extent||s[a][0].y>this.extent||s[a][0].x<0||s[a][0].y<0)return null;c[a]=s[a][0]}d(s=c);break;case 2:for(a=0;a<s.length;a++)d(s[a]);break;case 3:for(s=function(e){var t=e.length;if(t<=1)return[e];for(var n,a,l=[],i=0;i<t;i++){var o=k(e[i]);0!==o&&(void 0===a&&(a=o<0),a===o<0?(n&&l.push(n),n=[e[i]]):n.push(e[i]))}n&&l.push(n);return l}(s),a=0;a<s.length;a++)for(l=0;l<s[a].length;l++)d(s[a][l]);break}1===s.length?s=s[0]:u="Multi"+u;var p={type:"Feature",geometry:{type:u,coordinates:s},properties:this.properties};return"id"in this&&(p.id=this.id),p};var S=F,C=z;function z(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(T,this,t),this.length=this._features.length}function T(e,t,n){15===e?t.version=n.readVarint():1===e?t.name=n.readString():5===e?t.extent=n.readVarint():2===e?t._features.push(n.pos):3===e?t._keys.push(n.readString()):4===e&&t._values.push(function(e){var t=null,n=e.readVarint()+e.pos;for(;e.pos<n;){var a=e.readVarint()>>3;t=1===a?e.readString():2===a?e.readFloat():3===a?e.readDouble():4===a?e.readVarint64():5===a?e.readVarint():6===a?e.readSVarint():7===a?e.readBoolean():null}return t}(n))}z.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new S(this._pbf,t,this.extent,this._keys,this._values)};var M=C;function _(e,t,n){if(3===e){var a=new M(n,n.readVarint()+n.pos);a.length&&(t[a.name]=a)}}var E=function(e,t){this.layers=e.readFields(_,{},t)};var V={getVectorTilePromise:function(t){var n,a=(n=t).base+n.z+"/"+n.x+"/"+n.y+".pbf.pict?key="+n.token;return fetch(a,{}).then(function(t){return t.ok?t.blob().then(function(t){var n=new FileReader;return new Promise(function(a){n.addEventListener("loadend",function(){var t=new e(n.result);return a(new E(t))}),n.readAsArrayBuffer(t)})}):{layers:[]}}).then(function(e){var n=Object.keys(e.layers);Array.isArray(n)||(n=[n]);var a={};return n.forEach(function(n){var l={type:"FeatureCollection",features:[]},i=e.layers[n];if(i)for(var o=0;o<i.length;o++){var r=i.feature(o).toGeoJSON(t.x,t.y,t.z);r&&l.features.push(r)}a[n]=l}),a})}};"undefined"!=typeof amd?define(function(){return V}):"object"==typeof module&&module.exports?module.exports=V:window.vectorJSON=V}(),function(e){e.contCartogram=function(t){return t.type="contCartogram",t.masterType="map",e.visualizations.push(t),new function(t){let n=e.initVis(t),a=n.series[0],l=a.labelField,i=a.valueField,o=a.colorField,r=a.parentField,s=e.mapDirectory+"cartomaps/",u=null,d=null,c=0,p="",f=null,m=null,g=null,h=null,y=null,x=0,b=0,v="",F="",w=null,A=null,k="",S="",C=[],z=0,T=0,M="";n.plot.width=n.plot.width-n.plot.left-n.plot.right,n.plot.height=n.plot.height-n.plot.top-n.plot.bottom;let _=n.svg.append("g").attr("transform","translate("+n.plot.left+","+n.plot.top+")").append("svg").attr("width",n.plot.width-n.plot.left).attr("height",n.plot.height).attr("transform","translate(0,0)");function E(){""===o?(x=n.domains.minY,b=n.domains.maxY,M=i):(x=n.domains.minColor,b=n.domains.maxColor,M=o);let t=d3.scaleLinear().domain([n.domains.minY,n.domains.maxY]).range([n.domains.minY===n.domains.maxY?500:1,500]);m.value(function(a){if(a.currentData?(F=d3.select(this).attr("fill"),w=a.currentData):(F="",w=null),a.currentData=null,"code2"===k)switch(c){case 0:A=e.filterSingle(n.data,{key:l,values:a.properties.iso_a2});break;case 1:a.properties.postal&&(A=e.filterSingle(n.data,{key:l,values:a.properties.postal}));break;default:A=null}else if("code3"===k)switch(c){case 0:A=e.filterSingle(n.data,{key:l,values:a.properties.iso_a3});break;default:A=null}else{let t,i=[];switch(a.properties.name_alt?(i.push(a.properties.name),(t=a.properties.name_alt.split("|")).forEach(function(e){i.push(e)})):i=a.properties.name,c){case 2:A="SC_USACounties"===p?e.filterSingle(n.data,[{key:l,values:i},{key:r,values:"code"===S?a.properties.parent:a.properties.parentName}]):e.filterSingle(n.data,{key:l,values:i,replaceChar:!0});break;case 3:A=e.filterSingle(n.data,{key:l,values:i},!0);break;default:A=e.filterSingle(n.data,{key:l,values:i,replaceChar:!0})}}if(A&&0!=A[i]&&null!=A[i]){switch("default"!==n.legend.type&&(A[i]=parseFloat(A[i])),n.legend.type){case"default":v=e.matchGroup(A[M],n.legend.legendColors,"color")||"rgb(221,221,221)";break;case"ranged":{let t=e.matchRange(A[M],n.legend.rangeList,"color");t?(v=t.color,a.legendClass="ranged-"+t.index):v="rgb(221,221,221)"}break;default:T=x!==b?A[M]/(b-x)*100-x/(b-x)*100:1,v=e.gradient(n.legend.gradientColors,T)}z=1,a.currentData=A}return a.currentData||n.animation.effect&&("fade"===n.animation.effect?(v="rgb(221,221,221)",z=.9):"dim"===n.animation.effect?w?(v=F,z=.3,a.currentData=w):(v="rgb(221,221,221)",z=.9):"add"===n.animation.effect&&w?(v=F,z=1,a.currentData=w):(v="rgb(221,221,221)",z=.9)),a.fillColor=v,a.fillOpacity=z,a.currentData?t(a.currentData[i]):1});let a,s,f=m(u,d).features;if("world"===p||"worldwoantarctica"===p){a=e.filterSingle(f,{key:"id",values:"USA"}),s=Number.MAX_SAFE_INTEGER;for(let e=0;e<a.geometry.coordinates.length;e++)for(let t=0;t<a.geometry.coordinates[e][0].length;t++)a.geometry.coordinates[e][0][t][0]<s&&(s=a.geometry.coordinates[e][0][t][0]);for(let e=0;e<f.length;e++)if("RUS"==f[e].id)for(let t=0;t<f[e].geometry.coordinates.length;t++)for(let a=0;a<f[e].geometry.coordinates[t][0].length;a++)f[e].geometry.coordinates[t][0][a][0]<s&&(f[e].geometry.coordinates[t][0][a][0]=n.plot.width)}h.data(f).transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay/Math.max(1,Math.sqrt(t/8))}).attr("fill-opacity",function(e){return e.fillOpacity}).attr("fill",function(e){return e.fillColor}).attr("d",m.path),""!==n.series[0].labelFormat&&null!==g&&g.data(f).text(function(e){return labelFormat=n.series[0].labelFormat,labelValue=e.properties.name,codeValue=3===p.length?e.properties.postal:e.properties.iso_a2,null!==e.properties.iso_a3&&("STP"===e.properties.iso_a3?labelValue="Sao Tome and Principe":"CIV"===e.properties.iso_a3?labelValue="Cote dIvoire":"BLM"===e.properties.iso_a3?labelValue="St-Barthelemy":"CUW"===e.properties.iso_a3&&(labelValue="Curacao")),e.currentData?(labelFormat=labelFormat.replaceAll("{code}",codeValue).replaceAll("{label}",labelValue),labelFormat=n.getContent(e.currentData,n.series[0],labelFormat)):(C="",C+=-1!==labelFormat.search("{code}")?codeValue:"",C+=-1!==labelFormat.search("{label}")?C?" "+labelValue:labelValue:"",labelFormat=C),labelFormat}).style("fill",function(e){return"auto"===n.series[0].labelFontColor?n.getAutoColor(e.fillColor):n.series[0].labelFontColor}).style("font-size",n.series[0].labelFontSize+"px").attr("transform",function(e){return"translate("+m.path.centroid(e)+")"}),n.renderComplete&&setTimeout(function(){n.renderComplete()},1e3)}return function(){let t=[],a=[],i=0,o=0;3===(p=n.series[0].map.replace("%20","").trim()).length?(s=e.mapDirectory+"cartomaps/countries/",c=1):"SC_"===p.substring(0,3)&&(s=e.mapDirectory+"cartomaps/SubCountries/",c="SC_Zip"===p.substring(0,6)?3:2),f="USA"===p||"SC_USACounties"===p?d3.geoAlbersUsa():d3.geoEquirectangular(),i=n.data.length>10?10:n.data.length;let u=0;for(;t.length<i;)(isNaN(n.data[u][l])||3===c)&&t.push(n.data[u][l].length),u++;if(r)for(u=0;a.length<i;)isNaN(n.data[u][r])&&a.push(n.data[u][r].length),u++;o=d3.max(t),k=o<3?"code2":o<4?"code3":"name",""!==r&&null!==r&&(o=d3.max(a),S=o<3?"code":"name")}(),function(){let e="",t="",a="";d3.json(s+p+".json",function(l,i){u=i,d=i.objects[p+".geo"].geometries;let o=topojson.feature(i,{type:"GeometryCollection",geometries:i.objects[p+".geo"].geometries});f.fitExtent([[0,0],[n.plot.width,n.plot.height]],o),y=d3.geoPath().projection(f);let r=(m=d3.cartogram().projection(f).properties(function(e){return e.properties}).value(function(e){return 1})).features(u,d);h=_.append("g").selectAll("path").data(r).enter().append("path").attr("d",y).attr("stroke","rgb(255,255,255)").attr("stroke-width",.5).attr("fill","#fafafa").attr("width",n.plot.width).attr("height",n.plot.width/2).on("mousemove",function(l,i){""!==n.tooltip.format&&(e="no data available",l.currentData&&(a=3===p.length?l.properties.postal:l.properties.iso_a2,t=l.properties.name,null!==l.properties.iso_a3&&("STP"===l.properties.iso_a3?t="Sao Tome and Principe":"CIV"===l.properties.iso_a3?t="Cote dIvoire":"BLM"===l.properties.iso_a3?t="St-Barthelemy":"CUW"===l.properties.iso_a3&&(t="Curacao")),e=n.tooltip.format.replaceAll("{code}",a).replaceAll("{label}",t),e=n.getContent(l.currentData,n.series[0],e)),n.showTooltip(e))}).on("mouseout",function(e){n.hideTooltip()}),""!==n.series[0].labelFormat&&(g=_.append("g").selectAll("text").data(r).enter().append("text").style("text-anchor","middle").style("font-family",n.series[0].labelFontFamily).style("font-style","bold"===n.series[0].labelFontStyle?"normal":n.series[0].labelFontStyle).style("font-weight","bold"===n.series[0].labelFontStyle?"bold":"normal").attr("dy",".35em").on("mousemove",function(l,i){""!==n.tooltip.format&&(e="no data available",l.currentData&&(a=3===p.length?l.properties.postal:l.properties.iso_a2,t=l.properties.name,null!==l.properties.iso_a3&&("STP"===l.properties.iso_a3?t="Sao Tome and Principe":"CIV"===l.properties.iso_a3?t="Cote dIvoire":"BLM"===l.properties.iso_a3?t="St-Barthelemy":"CUW"===l.properties.iso_a3&&(t="Curacao")),e=n.tooltip.format.replaceAll("{code}",a).replaceAll("{label}",t),e=n.getContent(l.currentData,n.series[0],e)),n.showTooltip(e))}).on("mouseout",function(e){n.hideTooltip()})),n.onLoaded&&n.onLoaded(),E()}),n.clear=function(){h.each(function(e){e.currentData=null})},n.update=function(e,t){n.data=e,n.calculateDomain(),n.updateLegend(),E()},n.legendClick=function(e,t){"ranged"===n.legend.type&&(e.clicked?h.attr("fill-opacity",function(e){return e.legendClass==="ranged-"+t?.1:e.fillOpacity}):h.attr("fill-opacity",function(e){return e.legendClass==="ranged-"+t?1:e.fillOpacity}))},n.onLegendHover=function(e,t,a){"ranged"===n.legend.type&&(a?h.attr("fill-opacity",function(e){return e.legendClass!=="ranged-"+t?.1:e.fillOpacity}):h.attr("fill-opacity",function(e){return e.fillOpacity}))}}(),n}(t)}}(eve),function(e){e.ddCartogram=function(t){return t.type="ddCartogram",t.masterType="map",e.visualizations.push(t),new function(t){let n=e.initVis(t),a=n.series[0],l=a.labelField,i=a.valueField,o=a.colorField,r=a.parentField,s=e.mapDirectory+"cartomaps/",u=0,d="",c=null,p=null,f=null,m=null,g=null,h=0,y=!1,x=null,b=null,v=null,F=null,w="",A="",k=3,S=0,C=[],z=0,T=8,M=d3.forceLink().distance(function(e){return e.source.r+e.target.r+k}).strength(.6);n.simulations=[],n.plot.width=n.plot.width-n.plot.left-n.plot.right,n.plot.height=n.plot.height-n.plot.top-n.plot.bottom;let _=n.svg.append("g").attr("transform","translate("+n.plot.left+","+n.plot.top+")");function E(){switch(a.tileIcon){case"circle":f.transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("fill",function(e){return e.fillColor}).attr("fill-opacity",function(e){return e.fillOpacity}).attr("stroke",function(e){return e.fillColor}).attr("stroke-opacity",function(e){return e.fillOpacity}).attr("r",function(e){return e.r});break;case"square":f.transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("fill",function(e){return e.fillColor}).attr("fill-opacity",function(e){return e.fillOpacity}).attr("stroke",function(e){return e.fillColor}).attr("stroke-opacity",function(e){return e.fillOpacity}).attr("width",function(e){return 2*e.r}).attr("height",function(e){return 2*e.r});break;default:f.transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("fill",function(e){return e.fillColor}).attr("fill-opacity",function(e){return e.fillOpacity}).attr("stroke",function(e){return e.fillColor}).attr("stroke-opacity",function(e){return e.fillOpacity}).attr("r",function(e){return e.r})}""!==a.labelFormat&&p.transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).style("fill",function(e){return e.fillColor?"auto"===n.series[0].labelFontColor?n.getAutoColor(e.fillColor):n.series[0].labelFontColor:"rgb(221, 221, 221)"}),n.renderComplete&&setTimeout(function(){n.renderComplete()},1e3)}function V(){switch(a.tileIcon){case"circle":f.attr("transform",function(e){return"translate("+e.x+","+e.y+")"});break;case"square":f.attr("transform",function(e){return"translate("+(e.x-e.r)+","+(e.y-e.r)+")"});break;default:f.attr("transform",function(e){return"translate("+e.x+","+e.y+")"})}""!==a.labelFormat&&null!==p&&p.attr("transform",function(e){return"translate("+e.x+", "+e.y+")"})}function N(e){d3.event.active||m.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y}function L(e){e.fx=d3.event.x,e.fy=d3.event.y}function B(e){e.fixed=!0,d3.select(this).classed("fixed",!0)}function G(e){let t=d3.quadtree().x(function(e){return e.x}).y(function(e){return e.y}).addAll(g);g.forEach(function(e){let n=e.r+a.maxBulletSize+k,l=e.x-n,i=e.x+n,o=e.y-n,r=e.y+n;t.visit(function(t,n,s,u,d){if(t.data&&t.data!==e){if(e.index>t.data.index)return;if("square"===a.tileIcon){let n=e.x+e.vx-t.data.x-t.data.vx,a=e.y+e.vy-t.data.y-t.data.vy,l=Math.abs(n),i=Math.abs(a),o=e.r+t.data.r+k;l<o&&i<o&&(l>i?(l=(l-o)*(n<0?-.5:.5),e.vx-=l,t.data.vx+=l):(i=(i-o)*(a<0?-.5:.5),e.vy-=i,t.data.vy+=i))}else{let n=e.x-t.data.x,a=e.y-t.data.y,l=Math.sqrt(n*n+a*a),i=e.r+t.data.r+k;l<i&&(l=(l-i)/l*.5,e.x-=n*=l,e.y-=a*=l,t.data.x+=n,t.data.y+=a)}}return n>i||u<l||s>r||d<o})})}return function(){let t=[],i=[],o=0,c=0;3===(d=a.map.replace("%20","").trim()).length?(s=e.mapDirectory+"cartomaps/countries/",u=1):"SC_"===d.substring(0,3)&&(s=e.mapDirectory+"cartomaps/SubCountries/",u="SC_Zip"===d.substring(0,6)?3:2),y="USA"===d||"SC_USACounties"===d,o=n.data.length>10?10:n.data.length;let p=0;for(;t.length<o;)(isNaN(n.data[p][l])||3===u)&&t.push(n.data[p][l].length),p++;if(r)for(p=0;i.length<o;)isNaN(n.data[p][r])&&i.push(n.data[p][r].length),p++;c=d3.max(t),w=c<3?"code2":c<4?"code3":"name",""!==r&&null!==r&&(c=d3.max(i),A=c<3?"code":"name")}(),function(){let t="",k="",D="",I="";d3.json(s+d+".json",function(s,v){let F=topojson.feature(v,v.objects[d+".geo"]).features,T=e.clone(v);a.linkShapes&&topojson.neighbors(v.objects[d+".geo"].geometries).forEach(function(e,t){e.forEach(function(e){C.push({target:e,source:t})})}),T.arcs=[],delete T.transform,F.forEach(function(e,t){T.objects[d+".geo"].geometries[t]={type:"Point",id:e.id,properties:e.properties,coordinates:d3.geoCentroid(e)}}),F=topojson.feature(T,T.objects[d+".geo"]).features;let Z=topojson.feature(T,{type:"GeometryCollection",geometries:T.objects[d+".geo"].geometries});h=n.domains.minY===n.domains.maxY?a.maxBulletSize:a.minBulletSize,x=d3.scalePow().exponent(.5).domain([n.domains.minY,n.domains.maxY]).range([h,a.maxBulletSize]),y?((c=d3.geoAlbersUsa()).fitExtent([[a.maxBulletSize,a.maxBulletSize],[n.plot.width-a.maxBulletSize,n.plot.height-a.maxBulletSize]],Z),c.translate([n.plot.width/2,n.plot.height/2])):(c=d3.geoEquirectangular()).fitExtent([[a.maxBulletSize,a.maxBulletSize],[n.plot.width-a.maxBulletSize,n.plot.height-a.maxBulletSize]],Z);let P=[];switch(F.forEach(function(e){P.push({coordinates:c(e.geometry.coordinates),properties:e.properties})}),(g=P.map(function(e){return{coordinates:e.coordinates,x:e.coordinates[0],y:e.coordinates[1],properties:e.properties}})).forEach(function(t){if(t.currentData=null,t.fillColor="rgb(221,221,221)",t.fillOpacity=.9,a.hideEmptyShapes?t.r=0:t.r=a.minBulletSize,"code2"===w)switch(u){case 0:b=e.filterSingle(n.data,{key:l,values:t.properties.iso_a2});break;case 1:t.properties.postal&&(b=e.filterSingle(n.data,{key:l,values:t.properties.postal}));break;default:b=null}else if("code3"===w)switch(u){case 0:b=e.filterSingle(n.data,{key:l,values:t.properties.iso_a3});break;default:b=null}else{let a,i=[];switch(t.properties.name_alt?(i.push(t.properties.name),(a=t.properties.name_alt.split("|")).forEach(function(e){i.push(e)})):i=t.properties.name,u){case 2:b="SC_USACounties"===d?e.filterSingle(n.data,[{key:l,values:i},{key:r,values:"code"===A?t.properties.parent:t.properties.parentName}]):e.filterSingle(n.data,{key:l,values:i,replaceChar:!0});break;case 3:b=e.filterSingle(n.data,{key:l,values:i},!0);break;default:b=e.filterSingle(n.data,{key:l,values:i,replaceChar:!0})}}if(b&&0!=b[i]&&null!=b[i])if("default"!==n.legend.type&&(b[i]=parseFloat(b[i])),t.currentData=b,t.fillOpacity=1,t.r=x(b[i]),""===o)t.fillColor=n.legend.gradientColors[0];else if(0!=b[o])switch("default"!==n.legend.secondaryType&&(b[o]=parseFloat(b[o])),n.legend.secondaryType){case"default":t.fillColor=e.matchGroup(b[o],n.legend.legendColors,"color")||"rgb(221,221,221)";break;case"ranged":{let a=e.matchRange(b[o],n.legend.rangeList,"color");a?(t.fillColor=a.color,t.legendClass="ranged-"+a.index):t.fillColor="rgb(221,221,221)"}break;default:S=n.domains.minColor!==n.domains.maxColor?b[o]/(n.domains.maxColor-n.domains.minColor)*100-n.domains.minColor/(n.domains.maxColor-n.domains.minColor)*100:1,t.fillColor=e.gradient(n.legend.gradientColors,S)}}),a.tileIcon){case"circle":f=_.append("g").selectAll(".circle").data(g).enter().append("circle");break;case"square":f=_.append("g").selectAll(".rect").data(g).enter().append("rect");break;default:f=_.append("g").selectAll(".circle").data(g).enter().append("circle")}f.style("stroke-width","0px").on("mousemove",function(e){""!==n.tooltip.format&&(t="no data available",e.currentData&&(I=3===d.length?e.properties.postal:e.properties.iso_a2,D=e.properties.name,null!==e.properties.iso_a3&&("STP"===e.properties.iso_a3?D="Sao Tome and Principe":"CIV"===e.properties.iso_a3?D="Cote dIvoire":"BLM"===e.properties.iso_a3?D="St-Barthelemy":"CUW"===e.properties.iso_a3&&(D="Curacao")),t=n.tooltip.format.replaceAll("{code}",I).replaceAll("{label}",D),""===o&&(t=t.replaceAll("{color}","")),t=n.getContent(e.currentData,n.series[0],t)),n.showTooltip(t))}).on("mouseout",function(e){n.hideTooltip()}).call(d3.drag().on("start",N).on("drag",L).on("end",B)),m=d3.forceSimulation(g).alphaMin(.04).alphaDecay(.05).force("link",M).force("collision",G).force("x",d3.forceX(function(e){return e.x})).force("y",d3.forceY(function(e){return e.y})).on("tick",V),n.simulations.push(m),a.linkShapes&&m.force("link").links(C),m.nodes(g),""!==a.labelFormat&&(p=_.append("g").selectAll("text").data(g).enter().append("text").style("text-anchor","middle").style("font-size","24px").style("font-family",a.labelFontFamily).style("font-style","bold"===a.labelFontStyle?"normal":a.labelFontStyle).style("font-weight","bold"===a.labelFontStyle?"bold":"normal").text(function(e){return a.hideEmptyShapes&&!e.currentData?"":(k=n.series[0].labelFormat,D=e.properties.name,I=3===d.length?e.properties.postal:e.properties.iso_a2,null!==e.properties.iso_a3&&("STP"===e.properties.iso_a3?D="Sao Tome and Principe":"CIV"===e.properties.iso_a3?D="Cote dIvoire":"BLM"===e.properties.iso_a3?D="St-Barthelemy":"CUW"===e.properties.iso_a3&&(D="Curacao")),e.currentData?(k=k.replaceAll("{code}",I).replaceAll("{label}",D),""===o&&(k=k.replaceAll("{color}","")),k=n.getContent(e.currentData,n.series[0],k)):(labelwoutMeasure="",labelwoutMeasure+=-1!==k.search("{code}")?I:"",labelwoutMeasure+=-1!==k.search("{label}")?labelwoutMeasure?" "+D:D:"",k=labelwoutMeasure),k)}).style("font-size",function(e){return"auto"===a.labelFontSize?(z=(2*e.r-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*24)<8&&d3.select(this).text(""):z=a.labelFontSize,z+"px"}).style("fill","none").attr("dy","0.35em").on("mousemove",function(e){""!==n.tooltip.format&&(t="no data available",e.currentData&&(I=3===d.length?e.properties.postal:e.properties.iso_a2,D=e.properties.name,null!==e.properties.iso_a3&&("STP"===e.properties.iso_a3?D="Sao Tome and Principe":"CIV"===e.properties.iso_a3?D="Cote dIvoire":"BLM"===e.properties.iso_a3?D="St-Barthelemy":"CUW"===e.properties.iso_a3&&(D="Curacao")),t=n.tooltip.format.replaceAll("{code}",I).replaceAll("{label}",D),""===o&&(t=t.replaceAll("{color}","")),t=n.getContent(e.currentData,n.series[0],t)),n.showTooltip(t))}).on("mouseout",function(e){n.hideTooltip()}).call(d3.drag().on("start",N).on("drag",L).on("end",B))),n.onLoaded&&n.onLoaded(),E()}),n.clear=function(){g.forEach(function(e){e.currentData=null})},n.update=function(t,s){n.data=t,n.calculateDomain(),n.updateLegend(),h=n.domains.minY===n.domains.maxY?a.maxBulletSize:a.minBulletSize,x=d3.scalePow().exponent(.5).domain([n.domains.minY,n.domains.maxY]).range([h,a.maxBulletSize]),g.forEach(function(t){if(t.x=t.coordinates[0],t.y=t.coordinates[1],t.vx=0,t.vy=0,t.currentData?(F=t.fillColor,v=t.currentData):(F="",v=null),t.currentData=null,a.hideEmptyShapes?t.r=0:t.r=a.minBulletSize,"code2"===w)switch(u){case 0:b=e.filterSingle(n.data,{key:l,values:t.properties.iso_a2});break;case 1:t.properties.postal&&(b=e.filterSingle(n.data,{key:l,values:t.properties.postal}));break;default:b=null}else if("code3"===w)switch(u){case 0:b=e.filterSingle(n.data,{key:l,values:t.properties.iso_a3});break;default:b=null}else{let a,i=[];switch(t.properties.name_alt?(i.push(t.properties.name),(a=t.properties.name_alt.split("|")).forEach(function(e){i.push(e)})):i=t.properties.name,u){case 2:b="SC_USACounties"===mapToRender?e.filterSingle(n.data,[{key:l,values:i},{key:r,values:"code"===A?t.properties.parent:t.properties.parentName}]):e.filterSingle(n.data,{key:l,values:i,replaceChar:!0});break;case 3:b=e.filterSingle(n.data,{key:l,values:i},!0);break;default:b=e.filterSingle(n.data,{key:l,values:i,replaceChar:!0})}}if(b&&0!=b[i]&&null!=b[i])if("default"!==n.legend.type&&(b[i]=parseFloat(b[i])),t.currentData=b,t.fillOpacity=1,t.r=x(b[i]),""===o)t.fillColor=n.legend.gradientColors[0];else if(0!=b[o])switch("default"!==n.legend.secondaryType&&(b[o]=parseFloat(b[o])),n.legend.secondaryType){case"default":t.fillColor=e.matchGroup(b[o],n.legend.legendColors,"color")||"rgb(221,221,221)";break;case"ranged":{let a=e.matchRange(b[o],n.legend.rangeList,"color");a?(t.fillColor=a.color,t.legendClass="ranged-"+a.index):t.fillColor="rgb(221,221,221)"}break;default:S=n.domains.minColor!==n.domains.maxColor?b[o]/(n.domains.maxColor-n.domains.minColor)*100-n.domains.minColor/(n.domains.maxColor-n.domains.minColor)*100:1,t.fillColor=e.gradient(n.legend.gradientColors,S)}t.currentData||n.animation.effect&&("fade"===n.animation.effect?(t.fillColor="rgb(221,221,221)",t.fillOpacity=.9):"dim"===n.animation.effect?v?(t.fillColor=F,t.fillOpacity=.3,t.currentData=v,t.r=x(v[i])):(t.fillColor="rgb(221,221,221)",t.fillOpacity=.9):"add"===n.animation.effect&&v?(t.fillColor=F,t.fillOpacity=1,t.currentData=v,t.r=x(v[i])):(t.fillColor="rgb(221,221,221)",t.fillOpacity=.9))}),f.data(g),m.alpha(1).restart(),""!==a.labelFormat&&p.data(g).style("font-size","24px").text(function(e){return a.hideEmptyShapes&&!e.currentData?"":(k=n.series[0].labelFormat,D=e.properties.name,I=3===d.length?e.properties.postal:e.properties.iso_a2,null!==e.properties.iso_a3&&("STP"===e.properties.iso_a3?D="Sao Tome and Principe":"CIV"===e.properties.iso_a3?D="Cote dIvoire":"BLM"===e.properties.iso_a3?D="St-Barthelemy":"CUW"===e.properties.iso_a3&&(D="Curacao")),e.currentData?(k=k.replaceAll("{code}",I).replaceAll("{label}",D),""===o&&(k=k.replaceAll("{color}","")),k=n.getContent(e.currentData,n.series[0],k)):(labelwoutMeasure="",labelwoutMeasure+=-1!==k.search("{code}")?I:"",labelwoutMeasure+=-1!==k.search("{label}")?labelwoutMeasure?" "+D:D:"",k=labelwoutMeasure),k)}).style("font-size",function(e){return"auto"===a.labelFontSize?(z=(2*e.r-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*24)<T&&d3.select(this).text(""):z=a.labelFontSize,z+"px"}).style("fill","none").attr("dy","0.35em"),E()},n.legendClick=function(e,t){"ranged"===n.legend.secondaryType&&(e.clicked?f.attr("fill-opacity",function(e){return e.legendClass==="ranged-"+t?.1:e.fillOpacity}):f.attr("fill-opacity",function(e){return e.legendClass==="ranged-"+t?1:e.fillOpacity}))},n.onLegendHover=function(e,t,a){"ranged"===n.legend.secondaryType&&(a?f.attr("fill-opacity",function(e){return e.legendClass!=="ranged-"+t?.1:e.fillOpacity}):f.attr("fill-opacity",function(e){return e.fillOpacity}))}}(),n}(t)}}(eve),function(e){function t(t){let n=e.initVis(t),a=n.series[0].latField,l=n.series[0].longField,o=n.series[0].valueField,r=n.series[0].expression,s=1<<22,u=[{minValue:90,maxValue:360,zoom:512},{minValue:45,maxValue:90,zoom:1024},{minValue:22.5,maxValue:45,zoom:2048},{minValue:11.25,maxValue:22.5,zoom:4096},{minValue:5.625,maxValue:11.25,zoom:8192},{minValue:2.813,maxValue:5.625,zoom:16384},{minValue:1.406,maxValue:2.813,zoom:32768},{minValue:.703,maxValue:1.406,zoom:65536},{minValue:.352,maxValue:.703,zoom:1<<17},{minValue:.176,maxValue:.352,zoom:1<<18},{minValue:.088,maxValue:.176,zoom:1<<19},{minValue:.044,maxValue:.088,zoom:1<<20},{minValue:.022,maxValue:.044,zoom:1<<21},{minValue:.011,maxValue:.022,zoom:1<<22}],d=2*Math.PI,c=d3.geoMercator().scale(1/d).translate([0,0]),p=null,f=null,m=null,g=n.series[0].colorizeVisible,h=[],y=n.series[0].radius,x=n.series[0].blur,b=document.createElement("canvas"),v=null,F=[],w=!1,A=!1,k=[],S=null,C=[],z="";z=window.app&&(n.index||0===n.index)?"vysda":window.report&&report.dashboard&&report.dashboard.tabs?"ssweb":"eve",n.plot.width=n.plot.width-2*n.plot.left-n.plot.right,n.plot.height=n.plot.height-n.plot.top;let T=d3.select("#"+n.innerContainer).style("padding-left",n.plot.left+"px").append("div").attr("class","vectormap").style("position","relative").style("overflow","hidden").style("width",n.plot.width+"px").style("height",n.plot.height+"px").attr("id",n.container+"_map"),M=T.append("div").attr("id",n.container+"_zoomApply").append("div").attr("class","vectorlayer").style("position","absolute").style("will-change","transform").attr("id",n.container+"_vectorlayer");M.insert("defs",":first-child").html(e.vectorTileStyle);let E=M.append("svg").attr("class","overlay").style("position","absolute").attr("id",n.container+"_svgOverlay"),V=document.createElement("canvas");function N(t){let a=[];if(1===n.data.length)C=[n.domains.minLong,n.domains.minLat],s=1<<22;else{n.domains.minLat>0&&n.domains.maxLat>0||n.domains.minLat<0&&n.domains.maxLat<0?(C[1]=n.domains.maxLat-Math.abs(n.domains.maxLat-n.domains.minLat)/2,a[0]=Math.abs(n.domains.maxLat-n.domains.minLat)):(C[1]=n.domains.maxLat-(Math.abs(n.domains.minLat)+Math.abs(n.domains.maxLat))/2,a[0]=Math.abs(n.domains.maxLat)+Math.abs(n.domains.minLat)),n.domains.minLong>0&&n.domains.maxLong>0||n.domains.minLong<0&&n.domains.maxLong<0?(C[0]=n.domains.maxLong-Math.abs(n.domains.maxLong-n.domains.minLong)/2,a[1]=Math.abs(n.domains.maxLong-n.domains.minLong)):(C[0]=n.domains.maxLong-(Math.abs(n.domains.minLong)+Math.abs(n.domains.maxLong))/2,a[1]=Math.abs(n.domains.maxLong)+Math.abs(n.domains.minLong)),n.yAxis.diffDegrees&&(a=e.clone(n.yAxis.diffDegrees));let t=n.plot.width/256,l=n.plot.height/256;a[0]=a[0]/l,a[1]=a[1]/t,512==(s=Math.min(e.findRange(a[0],u,"zoom"),e.findRange(a[1],u,"zoom")))&&n.plot.width>512&&(s=1024)}C=d3.geoMercator().scale(1/d).translate([0,0])(C),t&&(A=!0,d3.select("#"+n.container+"_zoomApply").call(m.transform,d3.zoomIdentity.translate(n.plot.width/2,n.plot.height/2).scale(s).translate(-C[0],-C[1])))}function L(){let t,a=d3.event.transform,l=[n.plot.width/2,n.plot.height/2],o=!1,r=[0,0];if(A)A=!1,t={x:a.x,y:a.y,k:a.k,center:l};else{if(!a.k)return;if("vysda"===z?t=app.maps[n.index].currTransform:"ssweb"===z?report.dashboard.tabs.forEach(function(e){e.id===n.tabID&&e.visualizations.forEach(function(e){e.visualizationID===n.visualizationID&&e.currTransform&&(t=JSON.parse(e.currTransform))})}):t=n.currTransform,null==t)t={x:a.x,y:a.y,k:a.k,center:l};else{if(t.center&&l[0]!=t.center[0]&&l[1]!=t.center[1]&&(r[0]=l[0]-t.center[0],r[1]=l[1]-t.center[1]),a===t)return;t.k<a.k?(a.x=2*t.x-l[0]+r[0],a.y=2*t.y-l[1]+r[1],a.k=2*t.k):t.k>a.k?(a.x=.5*t.x+l[0]/2,a.y=.5*t.y+l[1]/2,a.k=.5*t.k):t.k==a.k&&(a.x=a.x+r[0],a.y=a.y+r[1],o=!w),r=[0,0],t.x=a.x,t.y=a.y,t.k=a.k,t.center=l}}"vysda"===z?app.maps[n.index].currTransform=t:"ssweb"===z?report.dashboard.tabs.forEach(function(e){e.id===n.tabID&&e.visualizations.forEach(function(e){e.visualizationID===n.visualizationID&&(e.currTransform=JSON.stringify(t))})}):n.currTransform=t,w=!1,f=p.scale(a.k).translate([a.x,a.y])(),c.scale(a.k/d).translate([a.x,a.y]);let s=M.style("transform",function(e,t,n){let a=e/256,l=e%1?Number:Math.round;return"matrix3d("+[a,0,0,0,0,a,0,0,0,0,a,0,l((t[0]+n[0])*e),l((t[1]+n[1])*e),0,1]+")"}(f.scale,f.translate,f[0])).selectAll(".tile").data(f,function(e){return e});s.exit().each(function(e){this.labels&&this.labels.remove(),this.labels=null}).remove(),s.enter().append("svg").attr("class",n.container+" tile").style("position","absolute").style("background-color","rgb(221,221,221)").style("width","256px").style("height","256px").each(function(t){let a=Math.pow(2,t[2])-1,l=this;this.labels&&this.labels.remove(),t[0]<=a&&t[1]<=a?function(t,a){let l=e.clone(n.series[0].mapLayers);-1===l.indexOf("landcover")&&l.push("landcover");-1===l.indexOf("water")&&l.push("water");for(let e=0;e<l.length;e++)"boundaries"===l[e]?l[e]="boundary":"buildings"===l[e]?(l[e]="building",l.push("housenumber")):"places"===l[e]?l[e]="place":"roads"===l[e]?l[e]="transportation":"lakesandrivers"===l[e]&&(l[e]="waterway");-1!==l.indexOf("aeroway")&&l.splice(l.indexOf("aeroway"),1);-1!==l.indexOf("landcover")&&l.push("landcover");-1!==l.indexOf("mountain_peak")&&l.splice(l.indexOf("mountain_peak"),1);-1!==l.indexOf("park")&&l.splice(l.indexOf("park"),1);-1!==l.indexOf("pois")&&l.splice(l.indexOf("pois"),1);-1!==l.indexOf("transit")&&l.splice(l.indexOf("transit"),1);-1!==l.indexOf("water_name")&&l.splice(l.indexOf("water_name"),1);-1!==l.indexOf("transportation_name")&&l.splice(l.indexOf("transportation_name"),1);if(!e.vectorSource||!e.vectorKey)return e.renderVectorError(a),new Promise(function(e,t){e(null)});let o={base:e.vectorSource,z:t[2],x:t[0],y:t[1],token:e.vectorKey};return vectorJSON.getVectorTilePromise(o).then(function(n){if(_.isEmpty(n))return e.renderVectorError(a),null;let o=[],r=[],s=256*Math.pow(2,t[2]),u=d3.geoMercator().scale(s/d).translate([s/2-256*t[0],s/2-256*t[1]]).precision(0);return l.forEach(function(e){if(n[e]&&n[e].features.length>0)for(i=0;i<n[e].features.length;i++){if("boundary"===e)if(2===n[e].features[i].properties.admin_level)n[e].features[i].properties.cssClass="outerBorder";else{if(4!==n[e].features[i].properties.admin_level)continue;t[2]<6?n[e].features[i].properties.cssClass="innerBorder":n[e].features[i].properties.cssClass="outerBorder"}else if("building"===e||"housenumber"===e){if(t[2]<=14&&n[e].features[i].properties.render_height>=100)continue;n[e].features[i].properties.cssClass="buildingAndHouseNo"}else if("landcover"===e)n[e].features[i].properties.cssClass="notVisible";else if("water"===e)n[e].features[i].properties.cssClass="water";else if("waterway"===e)n[e].features[i].properties.cssClass="waterway";else if("place"===e)if(t[2]<3)if("continent"===n[e].features[i].properties.class)n[e].features[i].properties.cssClass="noneStyle";else{if("country"!==n[e].features[i].properties.class||1!==n[e].features[i].properties.rank)continue;n[e].features[i].properties.cssClass="noneStyle"}else if(t[2]<5){if("continent"!==n[e].features[i].properties.class&&"country"!==n[e].features[i].properties.class&&"state"!==n[e].features[i].properties.class&&"province"!==n[e].features[i].properties.class)continue;n[e].features[i].properties.cssClass="noneStyle"}else if(t[2]<9)if("continent"===n[e].features[i].properties.class||"country"===n[e].features[i].properties.class||"state"===n[e].features[i].properties.class||"province"===n[e].features[i].properties.class)n[e].features[i].properties.cssClass="noneStyle";else{if("city"!==n[e].features[i].properties.class&&"town"!==n[e].features[i].properties.class)continue;n[e].features[i].properties.cssClass="noneStyle"}else n[e].features[i].properties.cssClass="noneStyle";else if("transportation"===e){let t=n[e].features[i].properties.class;n[e].features[i].properties.cssClass="motorway"===t?"roads-motorway":"trunk"===t||"primary"===t||"secondary"===t||"tertiary"===t||"trunk"===t?"roads-major_road":"raceway"===t||"service"===t||"minor"===t?"roads-minor_road":"rail"===t?"roads-rail":"notVisible"}else n[e].features[i].properties.cssClass="notVisible";n[e].features[i].layer_name=e,"place"===e?r.push(n[e].features[i]):o.push(n[e].features[i])}}),d3.select(a).selectAll("path").data(o).enter().append("path").attr("class",function(e){return e.properties.cssClass}).attr("d",d3.geoPath().projection(u)),r})}(t,this).then(function(e){e&&(l.labels=function(e){let t,a={style:"",weight:"",size:0};e.length>0&&(t=E.selectAll(".tile-label").data(e).enter().append("text").style("text-anchor","middle").style("font-family",n.series[0].labelFontFamily).style("font-style",function(e){return"continent"===e.properties.class?a.style="oblique":"region"===e.properties.class?a.style="italic":a.style="normal",a.style}).style("font-weight",function(e){return"country"===e.properties.class?a.weight="600":a.weight="normal",a.weight}).attr("dy",".35em").text(function(e){return e.properties["name:en"]?e.properties["name:en"]:e.properties.name}).style("fill","black").style("font-size",function(e){return"continent"===e.properties.class?a.size=12:"region"===e.properties.class?a.size=12:"country"===e.properties.class?a.size=11:a.size=10,a.size+"px"}).attr("transform",function(e){let t=B([e.geometry.coordinates[0],e.geometry.coordinates[1]],f.scale,f.translate,!0);return"translate("+t[0]+","+t[1]+")"}),F.push(t));return t}(e))}):this.parentNode.removeChild(this)}),M.selectAll(".tile").style("left",function(e){return 256*(e[0]-f[0][0])+"px"}).style("top",function(e){return 256*(e[1]-f[0][1])+"px"}),d3.select("#"+n.container+"_map").selectAll("svg").sort(function(e,t){return e?-1:0}),d3.select("#"+n.container+"_map").selectAll("svg").sort(function(e,t){return e?0:1}),E.style("left",B("",f.scale,f.translate)[0]+"px").style("top",B("",f.scale,f.translate)[1]+"px").style("width",n.plot.width+"px").style("height",n.plot.height+"px"),F.length>0&&F.forEach(function(e){e.attr("transform",function(e){let t=B([e.geometry.coordinates[0],e.geometry.coordinates[1]],f.scale,f.translate,!0);return"translate("+t[0]+","+t[1]+")"})}),M.node().appendChild(V),V.style.left=B("",f.scale,f.translate)[0]+"px",V.style.top=B("",f.scale,f.translate)[1]+"px",G(a.k,o)}function B(e,t,n,a){let l=c(e),i=t%1?Number:Math.round;return a?[l[0],l[1]]:[-i((n[0]+f[0][0])*t),-i((n[1]+f[0][1])*t)]}function G(t,i){let s,u,d,c=y/2,p=1/Math.pow(2,Math.max(0,Math.min(24-(C=t,Math.log(C)/Math.log(2)),12))),m=[],F=[],w=[0,0],A=0;var C;"vysda"===z?d=app.maps[n.index].currTransform:"ssweb"===z?report.dashboard.tabs.forEach(function(e){e.id===n.tabID&&e.visualizations.forEach(function(e){e.visualizationID===n.visualizationID&&e.currTransform&&(d=JSON.parse(e.currTransform))})}):d=n.currTransform,i?(F[0]=S.x-d.x,F[1]=S.y-d.y,F[0]<0&&(w[0]=-Math.floor(F[0]/c)),F[1]<0&&(w[1]=-Math.floor(F[1]/c))):S=e.clone(d);for(var T=0,M=h.length;T<M;T++){var _,E,N;if(N=B([h[T][l],h[T][a]],f.scale,f.translate,!0),!g||!(N[0]<0||N[0]>V.width||N[1]<0||N[1]>V.height)){if(i?(_=Math.floor((N[0]+F[0])/c)+w[0],E=Math.floor((N[1]+F[1])/c)+w[1]):(_=Math.floor(N[0]/c),E=Math.floor(N[1]/c)),m[E]=m[E]||[],u=m[E][_],o)switch(r){case"count":u?(u[0]=(u[0]*u[2]+N[0])/(u[2]+1),u[1]=(u[1]*u[2]+N[1])/(u[2]+1),u[2]+=1):m[E][_]=[N[0],N[1],1];break;case"sum":s=h[T][o],u?(u[0]=(u[0]*u[2]+N[0]*s)/(u[2]+s),u[1]=(u[1]*u[2]+N[1]*s)/(u[2]+s),u[2]+=s):m[E][_]=[N[0],N[1],s];break;case"avg":s=h[T][o],u?(u[0]=(u[0]*u[2]+N[0]*s)/(u[2]+s),u[1]=(u[1]*u[2]+N[1]*s)/(u[2]+s),u[3]+=s,u[4]+=1,u[2]=u[3]/u[4]):m[E][_]=[N[0],N[1],s,s,1];break;case"max":s=h[T][o],u?(u[0]=(u[0]*u[2]+N[0]*s)/(u[2]+s),u[1]=(u[1]*u[2]+N[1]*s)/(u[2]+s),u[2]=Math.max(s,u[2])):m[E][_]=[N[0],N[1],s];break;case"min":s=h[T][o],u?(u[0]=(u[0]*u[2]+N[0]*s)/(u[2]+s),u[1]=(u[1]*u[2]+N[1]*s)/(u[2]+s),u[2]=Math.min(s,u[2])):m[E][_]=[N[0],N[1],s];break;default:u?(u[0]=(u[0]*u[2]+N[0]*p)/(u[2]+p),u[1]=(u[1]*u[2]+N[1]*p)/(u[2]+p),u[2]+=p):m[E][_]=[N[0],N[1],p];break}else u?(u[0]=(u[0]*u[2]+N[0]*p)/(u[2]+p),u[1]=(u[1]*u[2]+N[1]*p)/(u[2]+p),u[2]+=p):m[E][_]=[N[0],N[1],p];m[E][_][2]>A&&(A=m[E][_][2])}}k=[],m.forEach(function(e){e.forEach(function(e){k.push([Math.round(e[0]),Math.round(e[1]),e[2]])})}),k.sort(function(e,t){return e[2]-t[2]}),function(e){try{let t=V.getContext("2d");t.clearRect(0,0,n.plot.width,n.plot.height);for(let n,a=0,l=k.length;a<l;a++)n=k[a],t.globalAlpha=Math.max(n[2]/e,.05),t.drawImage(b,n[0]-(y+x),n[1]-(y+x));let a=t.getImageData(0,0,n.plot.width,n.plot.height);!function(e,t){for(let n,a=0,l=e.length;a<l;a+=4)(n=4*e[a+3])&&(e[a]=t[n],e[a+1]=t[n+1],e[a+2]=t[n+2])}(a.data,v),t.putImageData(a,0,0),n.renderComplete&&setTimeout(function(){n.renderComplete()},1e3)}catch(e){}}(A)}return V.className="overlay",V.style.position="absolute",V.id=n.container+"_overlay",V.width=n.plot.width,V.height=n.plot.height,null==n.currTransform&&N(),function(){let e=b.getContext("2d"),t=y+x;b.width=b.height=2*t,e.shadowOffsetX=e.shadowOffsetY=2*t,e.shadowBlur=x,e.shadowColor="black",e.beginPath(),e.arc(-t,-t,y,0,2*Math.PI,!0),e.closePath(),e.fill()}(),function(){let e=document.createElement("canvas"),t=e.getContext("2d"),a=t.createLinearGradient(0,0,0,256),l=1/(n.legend.gradientColors.length-1);e.width=1,e.height=256;for(let e=0;e<n.legend.gradientColors.length;e++)e===n.legend.gradientColors.length-1?a.addColorStop(1,n.legend.gradientColors[e]):a.addColorStop(e*l,n.legend.gradientColors[e]);t.fillStyle=a,t.fillRect(0,0,1,256),v=t.getImageData(0,0,1,256).data}(),function(){if(m=d3.zoom().scaleExtent([512,1<<22]).on("zoom",L),p=d3.tile().size([n.plot.width,n.plot.height]),!n.hideZoom){let e=T.append("div").attr("class","zoom-container").style("position","absolute").style("top","10px").style("left","10px").attr("id",n.container+"_zoom_container");e.append("a").attr("class","zoom").attr("id","zoom_in").text("+").on("click",function(){m.scaleBy(d3.select("#"+n.container+"_zoomApply"),2)}),e.append("a").attr("class","zoom").attr("id","zoom_out").text("-").on("click",function(){m.scaleBy(d3.select("#"+n.container+"_zoomApply"),.5)})}let e;T.append("div").attr("class","info").style("position","absolute").style("bottom","0px").style("right","0px").style("background","rgba(255, 255, 255, 0.8)").style("padding","0px 5px").style("font-family","Tahoma, Arial, Helvetica, Ubuntu").style("font-size","11px").attr("id",n.container+"_info").html('<a href="https://www.maptiler.com/license/maps/" target="_blank">&copy MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy OpenStreetMap contributors</a>'),h=n.data.filter(function(e){return!isNaN(parseFloat(e[a]))&&0!==parseFloat(e[a])&&!isNaN(parseFloat(e[l]))&&0!==parseFloat(e[l])}),w=!0,null!=n.currTransform?(e="string"==typeof n.currTransform?JSON.parse(n.currTransform):n.currTransform,d3.select("#"+n.container+"_zoomApply").call(m).on("dblclick.zoom",null).call(m.transform,d3.zoomIdentity.translate(e.x,e.y).scale(e.k))):d3.select("#"+n.container+"_zoomApply").call(m).on("dblclick.zoom",null).call(m.transform,d3.zoomIdentity.translate(n.plot.width/2,n.plot.height/2).scale(s).translate(-C[0],-C[1])),n.onLoaded&&n.onLoaded(),n.clear=function(){},n.update=function(e,t){let i;n.data=e,h=n.data.filter(function(e){return!isNaN(parseFloat(e[a]))&&0!==parseFloat(e[a])&&!isNaN(parseFloat(e[l]))&&0!==parseFloat(e[l])}),"vysda"===z?i=app.maps[n.index].currTransform:"ssweb"===z?report.dashboard.tabs.forEach(function(e){e.id===n.tabID&&e.visualizations.forEach(function(e){e.visualizationID===n.visualizationID&&e.currTransform&&(i=JSON.parse(e.currTransform))})}):i=n.currTransform,G(i.k),n.calculateDomain(),n.updateLegend(),n.series[0].updateReZoom&&N(!0)}}(),n.toCanvas=function(t){let a,l,i,o,r=document.getElementById(n.container+"_map"),s=document.getElementById(n.container+"_legend_svg"),u=r.getElementsByClassName("tile"),d=document.getElementById(n.container+"_svgOverlay"),c=parseFloat(V.style.top),p=parseFloat(V.style.left),f=document.createElement("canvas"),m=document.createElement("canvas"),g=m.getContext("2d"),h=document.createElement("div"),y=document.createElement("defs");y.innerHTML=e.vectorTileStyle,h.style.position=r.style.position,h.style.overflow=r.style.overflow,h.style.width=r.style.width,h.style.height=r.style.height,m.style.top=0,m.style.left=0,m.style.position="absolute",m.width=n.plot.width,m.height=n.plot.height,g.fillStyle="rgb(221, 221, 221)";for(let t=0;t<u.length;t++)a=parseFloat(u[t].style.top)-c,l=parseFloat(u[t].style.left)-p,u[t].insertBefore(y,u[t].firstChild),o=(new XMLSerializer).serializeToString(u[t]),e.detectMS()&&(o=o.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(f,o,{ignoreMouse:!0,ignoreAnimation:!0}),g.fillRect(l,a,f.width,f.height),g.drawImage(f,l,a),u[t].removeChild(y);return o=(new XMLSerializer).serializeToString(d),e.detectMS()&&(o=o.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(f,o,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){g.drawImage(f,0,0),f.svg.stop()}}),m.getContext("2d").drawImage(V,0,0),h.appendChild(m),h.appendChild(document.getElementById(n.container+"_info").cloneNode(!0)),r.parentNode.insertBefore(h,r),r.parentNode.removeChild(r),s&&(i=document.createElement("canvas"),o=(new XMLSerializer).serializeToString(s),e.detectMS()&&(o=o.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(i,o,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){i.svg.stop()}}),s.parentNode.appendChild(i),s.parentNode.removeChild(s)),new Promise(function(e){html2canvas(document.getElementById(n.container)).then(function(n){s&&(i.parentNode.appendChild(s),i.parentNode.removeChild(i)),h.parentNode.insertBefore(r,h),h.parentNode.removeChild(h),n.id=t+"-canvas",e(n)})})},n.toImage=function(){let t,a,l,i,o=document.getElementById(n.container+"_map"),r=document.getElementById(n.container+"_legend_svg"),s=o.getElementsByClassName("tile"),u=document.getElementById(n.container+"_svgOverlay"),d=parseFloat(V.style.top),c=parseFloat(V.style.left),p=document.createElement("canvas"),f=document.createElement("canvas"),m=f.getContext("2d"),g=document.createElement("div"),h=document.createElement("defs");h.innerHTML=e.vectorTileStyle,g.style.position=o.style.position,g.style.overflow=o.style.overflow,g.style.width=o.style.width,g.style.height=o.style.height,f.style.top=0,f.style.left=0,f.style.position="absolute",f.width=n.plot.width,f.height=n.plot.height,m.fillStyle="rgb(221, 221, 221)";for(let n=0;n<s.length;n++)t=parseFloat(s[n].style.top)-d,a=parseFloat(s[n].style.left)-c,s[n].insertBefore(h,s[n].firstChild),i=(new XMLSerializer).serializeToString(s[n]),e.detectMS()&&(i=i.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(p,i,{ignoreMouse:!0,ignoreAnimation:!0}),m.fillRect(a,t,p.width,p.height),m.drawImage(p,a,t),s[n].removeChild(h);return i=(new XMLSerializer).serializeToString(u),e.detectMS()&&(i=i.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(p,i,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){m.drawImage(p,0,0),p.svg.stop()}}),f.getContext("2d").drawImage(V,0,0),g.appendChild(f),g.appendChild(document.getElementById(n.container+"_info").cloneNode(!0)),o.parentNode.insertBefore(g,o),o.parentNode.removeChild(o),r&&(l=document.createElement("canvas"),i=(new XMLSerializer).serializeToString(r),e.detectMS()&&(i=i.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(l,i,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){l.svg.stop()}}),r.parentNode.appendChild(l),r.parentNode.removeChild(r)),new Promise(function(e){html2canvas(document.getElementById(n.container)).then(function(t){r&&(l.parentNode.appendChild(r),l.parentNode.removeChild(l)),g.parentNode.insertBefore(o,g),g.parentNode.removeChild(g),e(t.toDataURL("image/png"))})})},n}e.densityMap=function(n){return n.type="densityMap",n.masterType="map",e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){let n=t.legend.enabled;t.series[0].valueField||t.series[0].groupField||(t.legend.enabled=!1);let a=e.initVis(t),l=a.series[0].valueField,o=a.series[0].latField,r=a.series[0].longField,s=a.series[0].groupField,u=a.series[0].minBulletSize,d=a.series[0].maxBulletSize,c=""!=a.series[0].groupField,p=[],f=a.legend.legendColors[0].color,m=1<<22,g=[{minValue:90,maxValue:360,zoom:512},{minValue:45,maxValue:90,zoom:1024},{minValue:22.5,maxValue:45,zoom:2048},{minValue:11.25,maxValue:22.5,zoom:4096},{minValue:5.625,maxValue:11.25,zoom:8192},{minValue:2.813,maxValue:5.625,zoom:16384},{minValue:1.406,maxValue:2.813,zoom:32768},{minValue:.703,maxValue:1.406,zoom:65536},{minValue:.352,maxValue:.703,zoom:1<<17},{minValue:.176,maxValue:.352,zoom:1<<18},{minValue:.088,maxValue:.176,zoom:1<<19},{minValue:.044,maxValue:.088,zoom:1<<20},{minValue:.022,maxValue:.044,zoom:1<<21},{minValue:.011,maxValue:.022,zoom:1<<22}],h=2*Math.PI,y=d3.geoMercator().scale(1/h).translate([0,0]),x=(d3.geoPath().projection(y),null),b=null,v=null,F=[],w=null,A=null,k=null,S=null,C=!1,z=0,T=8,M=[],E="";E=window.app&&(a.index||0===a.index)?"vysda":window.report&&report.dashboard&&report.dashboard.tabs?"ssweb":"eve",t.legend.enabled=n,a.plot.width=a.plot.width-2*a.plot.left-a.plot.right,a.plot.height=a.plot.height-a.plot.top-a.plot.bottom;let V=d3.select("#"+a.innerContainer).style("padding-left",a.plot.left+"px").append("div").attr("class","vectormap").style("position","relative").style("overflow","hidden").style("width",a.plot.width+"px").style("height",a.plot.height+"px").attr("id",a.container+"_map"),N=V.append("div").attr("id",a.container+"_zoomApply").append("div").attr("class","vectorlayer").style("position","absolute").style("will-change","transform").attr("id",a.container+"_vectorlayer");N.insert("defs",":first-child").html(e.vectorTileStyle);let L=N.append("svg").attr("class","overlay").style("position","absolute").attr("id",a.container+"_overlay"),B=L.append("g");function G(t){let n=[];if(1===a.data.length)M=[a.domains.minLong,a.domains.minLat],m=1<<22;else{a.domains.minLat>0&&a.domains.maxLat>0||a.domains.minLat<0&&a.domains.maxLat<0?(M[1]=a.domains.maxLat-Math.abs(a.domains.maxLat-a.domains.minLat)/2,n[0]=Math.abs(a.domains.maxLat-a.domains.minLat)):(M[1]=a.domains.maxLat-(Math.abs(a.domains.minLat)+Math.abs(a.domains.maxLat))/2,n[0]=Math.abs(a.domains.maxLat)+Math.abs(a.domains.minLat)),a.domains.minLong>0&&a.domains.maxLong>0||a.domains.minLong<0&&a.domains.maxLong<0?(M[0]=a.domains.maxLong-Math.abs(a.domains.maxLong-a.domains.minLong)/2,n[1]=Math.abs(a.domains.maxLong-a.domains.minLong)):(M[0]=a.domains.maxLong-(Math.abs(a.domains.minLong)+Math.abs(a.domains.maxLong))/2,n[1]=Math.abs(a.domains.maxLong)+Math.abs(a.domains.minLong)),a.yAxis.diffDegrees&&(n=e.clone(a.yAxis.diffDegrees));let t=a.plot.width/256,l=a.plot.height/256;n[0]=n[0]/l,n[1]=n[1]/t,512==(m=Math.min(e.findRange(n[0],g,"zoom"),e.findRange(n[1],g,"zoom")))&&a.plot.width>512&&(m=1024)}M=d3.geoMercator().scale(1/h).translate([0,0])(M),t&&(C=!0,d3.select("#"+a.container+"_zoomApply").call(b.transform,d3.zoomIdentity.translate(a.plot.width/2,a.plot.height/2).scale(m).translate(-M[0],-M[1])))}function D(){switch(a.series[0].tileIcon){case"circle":w.transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay/Math.max(1,Math.sqrt(t/16))}).attr("r",function(e){return S(e[l])});break;case"square":w.transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay/Math.max(1,Math.sqrt(t/16))}).attr("width",function(e){return 2*S(e[l])}).attr("height",function(e){return 2*S(e[l])});break;default:w.transition().duration(a.animation.duration).ease(a.animation.easing.toEasing()).delay(function(e,t){return t*a.animation.delay/Math.max(1,Math.sqrt(t/16))}).attr("r",function(e){return S(e[l])})}a.renderComplete&&setTimeout(function(){a.renderComplete()},1e3)}function I(){let t,n=d3.event.transform,s=[a.plot.width/2,a.plot.height/2],u=[0,0];if(C)C=!1,t={x:n.x,y:n.y,k:n.k,center:s};else{if(!n.k)return;if("vysda"===E?t=app.maps[a.index].currTransform:"ssweb"===E?report.dashboard.tabs.forEach(function(e){e.id===a.tabID&&e.visualizations.forEach(function(e){e.visualizationID===a.visualizationID&&e.currTransform&&(t=JSON.parse(e.currTransform))})}):t=a.currTransform,null==t)t={x:n.x,y:n.y,k:n.k,center:s};else{if(t.center&&s[0]!=t.center[0]&&s[1]!=t.center[1]&&(u[0]=s[0]-t.center[0],u[1]=s[1]-t.center[1]),n===t)return;t.k<n.k?(n.x=2*t.x-s[0]+u[0],n.y=2*t.y-s[1]+u[1],n.k=2*t.k):t.k>n.k?(n.x=.5*t.x+s[0]/2,n.y=.5*t.y+s[1]/2,n.k=.5*t.k):t.k==n.k&&(n.x=n.x+u[0],n.y=n.y+u[1]),u=[0,0],t.x=n.x,t.y=n.y,t.k=n.k,t.center=s}}"vysda"===E?app.maps[a.index].currTransform=t:"ssweb"===E?report.dashboard.tabs.forEach(function(e){e.id===a.tabID&&e.visualizations.forEach(function(e){e.visualizationID===a.visualizationID&&(e.currTransform=JSON.stringify(t))})}):a.currTransform=t,tiles=x.scale(n.k).translate([n.x,n.y])(),y.scale(n.k/h).translate([n.x,n.y]);let d=N.style("transform",function(e,t,n){let a=e/256,l=e%1?Number:Math.round;return"matrix3d("+[a,0,0,0,0,a,0,0,0,0,a,0,l((t[0]+n[0])*e),l((t[1]+n[1])*e),0,1]+")"}(tiles.scale,tiles.translate,tiles[0])).selectAll(".tile").data(tiles,function(e){return e});switch(d.exit().each(function(e){this.labels&&this.labels.remove(),this.labels=null}).remove(),d.enter().append("svg").attr("class",a.container+" tile").style("position","absolute").style("background-color","rgb(221,221,221)").style("width","256px").style("height","256px").each(function(t){let n=Math.pow(2,t[2])-1,l=this;this.labels&&this.labels.remove(),t[0]<=n&&t[1]<=n?function(t,n){let l=e.clone(a.series[0].mapLayers);-1===l.indexOf("landcover")&&l.push("landcover");-1===l.indexOf("water")&&l.push("water");for(let e=0;e<l.length;e++)"boundaries"===l[e]?l[e]="boundary":"buildings"===l[e]?(l[e]="building",l.push("housenumber")):"places"===l[e]?l[e]="place":"roads"===l[e]?l[e]="transportation":"lakesandrivers"===l[e]&&(l[e]="waterway");-1!==l.indexOf("aeroway")&&l.splice(l.indexOf("aeroway"),1);-1!==l.indexOf("landcover")&&l.push("landcover");-1!==l.indexOf("mountain_peak")&&l.splice(l.indexOf("mountain_peak"),1);-1!==l.indexOf("park")&&l.splice(l.indexOf("park"),1);-1!==l.indexOf("pois")&&l.splice(l.indexOf("pois"),1);-1!==l.indexOf("transit")&&l.splice(l.indexOf("transit"),1);-1!==l.indexOf("water_name")&&l.splice(l.indexOf("water_name"),1);-1!==l.indexOf("transportation_name")&&l.splice(l.indexOf("transportation_name"),1);if(!e.vectorSource||!e.vectorKey)return e.renderVectorError(n),new Promise(function(e,t){e(null)});let o={base:e.vectorSource,z:t[2],x:t[0],y:t[1],token:e.vectorKey};return vectorJSON.getVectorTilePromise(o).then(function(a){if(_.isEmpty(a))return e.renderVectorError(n),null;let o=[],r=[],s=256*Math.pow(2,t[2]),u=d3.geoMercator().scale(s/h).translate([s/2-256*t[0],s/2-256*t[1]]).precision(0);return l.forEach(function(e){if(a[e]&&a[e].features.length>0)for(i=0;i<a[e].features.length;i++){if("boundary"===e)if(2===a[e].features[i].properties.admin_level)a[e].features[i].properties.cssClass="outerBorder";else{if(4!==a[e].features[i].properties.admin_level)continue;t[2]<6?a[e].features[i].properties.cssClass="innerBorder":a[e].features[i].properties.cssClass="outerBorder"}else if("building"===e||"housenumber"===e){if(t[2]<=14&&a[e].features[i].properties.render_height>=100)continue;a[e].features[i].properties.cssClass="buildingAndHouseNo"}else if("landcover"===e)a[e].features[i].properties.cssClass="notVisible";else if("water"===e)a[e].features[i].properties.cssClass="water";else if("waterway"===e)a[e].features[i].properties.cssClass="waterway";else if("place"===e)if(t[2]<3)if("continent"===a[e].features[i].properties.class)a[e].features[i].properties.cssClass="noneStyle";else{if("country"!==a[e].features[i].properties.class||1!==a[e].features[i].properties.rank)continue;a[e].features[i].properties.cssClass="noneStyle"}else if(t[2]<5){if("continent"!==a[e].features[i].properties.class&&"country"!==a[e].features[i].properties.class&&"state"!==a[e].features[i].properties.class&&"province"!==a[e].features[i].properties.class)continue;a[e].features[i].properties.cssClass="noneStyle"}else if(t[2]<9)if("continent"===a[e].features[i].properties.class||"country"===a[e].features[i].properties.class||"state"===a[e].features[i].properties.class||"province"===a[e].features[i].properties.class)a[e].features[i].properties.cssClass="noneStyle";else{if("city"!==a[e].features[i].properties.class&&"town"!==a[e].features[i].properties.class)continue;a[e].features[i].properties.cssClass="noneStyle"}else a[e].features[i].properties.cssClass="noneStyle";else if("transportation"===e){let t=a[e].features[i].properties.class;a[e].features[i].properties.cssClass="motorway"===t?"roads-motorway":"trunk"===t||"primary"===t||"secondary"===t||"tertiary"===t||"trunk"===t?"roads-major_road":"raceway"===t||"service"===t||"minor"===t?"roads-minor_road":"rail"===t?"roads-rail":"notVisible"}else a[e].features[i].properties.cssClass="notVisible";a[e].features[i].layer_name=e,"place"===e?r.push(a[e].features[i]):o.push(a[e].features[i])}}),d3.select(n).selectAll("path").data(o).enter().append("path").attr("class",function(e){return e.properties.cssClass}).attr("d",d3.geoPath().projection(u)),r})}(t,this).then(function(e){e&&(l.labels=function(e){let t,n={style:"",weight:"",size:0};e.length>0&&(t=B.selectAll(".tile-label").data(e).enter().append("text").style("text-anchor","middle").style("font-family",a.series[0].labelFontFamily).style("font-style",function(e){return"continent"===e.properties.class?n.style="oblique":"region"===e.properties.class?n.style="italic":n.style="normal",n.style}).style("font-weight",function(e){return"country"===e.properties.class?n.weight="600":n.weight="normal",n.weight}).attr("dy",".35em").text(function(e){return e.properties["name:en"]?e.properties["name:en"]:e.properties.name}).style("fill","black").style("font-size",function(e){return"continent"===e.properties.class?n.size=12:"region"===e.properties.class?n.size=12:"country"===e.properties.class?n.size=11:n.size=10,n.size+"px"}).attr("transform",function(e){let t=Z([e.geometry.coordinates[0],e.geometry.coordinates[1]],tiles.scale,tiles.translate,!0);return"translate("+t[0]+","+t[1]+")"}),F.push(t));return t}(e))}):this.parentNode.removeChild(this)}),N.selectAll(".tile").style("left",function(e){return 256*(e[0]-tiles[0][0])+"px"}).style("top",function(e){return 256*(e[1]-tiles[0][1])+"px"}),d3.select("#"+a.container+"_map").selectAll("svg").sort(function(e,t){return e?-1:0}),d3.select("#"+a.container+"_map").selectAll("svg").sort(function(e,t){return e?0:1}),L.style("left",Z("",tiles.scale,tiles.translate)[0]+"px").style("top",Z("",tiles.scale,tiles.translate)[1]+"px").style("width",a.plot.width+"px").style("height",a.plot.height+"px"),a.series[0].tileIcon){case"circle":w.attr("cx",function(e){return e.position=Z([e[r],e[o]],tiles.scale,tiles.translate,!0),e.position[0]}).attr("cy",function(e){return e.position[1]}),A&&A.attr("cx",function(e){return e.position=Z([e[r],e[o]],tiles.scale,tiles.translate,!0),e.position[0]}).attr("cy",function(e){return e.position[1]});break;case"square":w.attr("x",function(e){return e.position=Z([e[r],e[o]],tiles.scale,tiles.translate,!0),e.position[0]-S(e[l])}).attr("y",function(e){return e.position[1]-S(e[l])}),A&&A.attr("x",function(e){return e.position=Z([e[r],e[o]],tiles.scale,tiles.translate,!0),e.position[0]-S(e[l])}).attr("y",function(e){return e.position[1]-S(e[l])});break;default:w.attr("cx",function(e){return e.position=Z([e[r],e[o]],tiles.scale,tiles.translate,!0),e.position[0]}).attr("cy",function(e){return e.position[1]}),A&&A.attr("cx",function(e){return e.position=Z([e[r],e[o]],tiles.scale,tiles.translate,!0),e.position[0]}).attr("cy",function(e){return e.position[1]})}F.length>0&&F.forEach(function(e){e.attr("transform",function(e){let t=Z([e.geometry.coordinates[0],e.geometry.coordinates[1]],tiles.scale,tiles.translate,!0);return"translate("+t[0]+","+t[1]+")"})}),null!==v&&(v.attr("transform",function(e){return e.position=Z([e[r],e[o]],tiles.scale,tiles.translate,!0),"translate("+e.position[0]+","+e.position[1]+")"}),k&&k.attr("transform",function(e){return e.position=Z([e[r],e[o]],tiles.scale,tiles.translate,!0),"translate("+e.position[0]+","+e.position[1]+")"}))}function Z(e,t,n,a){let l=y(e),i=t%1?Number:Math.round;return a?[l[0],l[1]]:[-i((n[0]+tiles[0][0])*t),-i((n[1]+tiles[0][1])*t)]}function P(e){""!==a.tooltip.format&&(tooltipContent=a.tooltip.format,groupValue=e[s],tooltipContent=c?tooltipContent.replaceAll("{group}",groupValue):tooltipContent.replaceAll("{group}",""),tooltipContent=a.getContent(e,a.series[0],tooltipContent),a.showTooltip(tooltipContent))}return null==a.currTransform&&G(),function(){let t,n="",i="";if(b=d3.zoom().scaleExtent([512,1<<22]).on("zoom",I),x=d3.tile().size([a.plot.width,a.plot.height]),!a.hideZoom){let e=V.append("div").attr("class","zoom-container").style("position","absolute").style("top","10px").style("left","10px").attr("id",a.container+"_zoom_container");e.append("a").attr("class","zoom").attr("id","zoom_in").text("+").on("click",function(){b.scaleBy(d3.select("#"+a.container+"_zoomApply"),2)}),e.append("a").attr("class","zoom").attr("id","zoom_out").text("-").on("click",function(){b.scaleBy(d3.select("#"+a.container+"_zoomApply"),.5)})}switch(V.append("div").attr("class","info").style("position","absolute").style("bottom","0px").style("right","0px").style("background","rgba(255, 255, 255, 0.8)").style("padding","0px 5px").style("font-family","Tahoma, Arial, Helvetica, Ubuntu").style("font-size","11px").attr("id",a.container+"_info").html('<a href="https://www.maptiler.com/license/maps/" target="_blank">&copy MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy OpenStreetMap contributors</a>'),l?(u=a.domains.minY===a.domains.maxY?a.series[0].maxBulletSize:a.series[0].minBulletSize,S=d3.scalePow().exponent(.5).domain([a.domains.minY,a.domains.maxY]).range([u,d]),p=a.data.filter(function(e){return!isNaN(parseFloat(e[l]))&&0!==parseFloat(e[l])&&(e[l]=parseFloat(e[l]),!0)})):(u=a.series[0].minBulletSize,S=function(e){return u},p=a.data),a.series[0].tileIcon){case"circle":w=B.selectAll(".overlay-shape").data(p).enter().append("circle");break;case"square":w=B.selectAll(".overlay-shape").data(p).enter().append("rect");break;default:w=B.selectAll(".overlay-shape").data(p).enter().append("circle")}w.attr("class","overlay-shape").style("stroke",function(t){return t.fillColor=c?e.matchGroup(t[s],a.legend.legendColors,"color"):f,t.fillColor}).style("opacity",.6).style("fill",function(e){return e.fillColor}).on("mousemove",P).on("mouseout",function(){a.hideTooltip()}),""!==a.series[0].labelFormat&&(v=B.selectAll("text").data(p).enter().append("text").style("text-anchor","middle").style("fill",function(e){return"auto"===a.series[0].labelFontColor?a.getAutoColor(e.fillColor):a.series[0].labelFontColor}).style("font-size","24px").style("font-family",a.series[0].labelFontFamily).style("font-style","bold"===a.series[0].labelFontStyle?"normal":a.series[0].labelFontStyle).style("font-weight","bold"===a.series[0].labelFontStyle?"bold":"normal").text(function(e){return n=a.series[0].labelFormat,i=e[s],n=c?n.replaceAll("{group}",i):n.replaceAll("{group}",""),n=a.getContent(e,a.series[0],n)}).style("font-size",function(e){return"auto"===a.series[0].labelFontSize?(z=(2*S(e[l])-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*24)<T&&d3.select(this).text(""):z=a.series[0].labelFontSize,z+"px"}).on("mousemove",P).on("mouseout",function(){a.hideTooltip()}).attr("dy",".35em")),null!=a.currTransform?(t="string"==typeof a.currTransform?JSON.parse(a.currTransform):a.currTransform,d3.select("#"+a.container+"_zoomApply").call(b).on("dblclick.zoom",null).call(b.transform,d3.zoomIdentity.translate(t.x,t.y).scale(t.k))):d3.select("#"+a.container+"_zoomApply").call(b).on("dblclick.zoom",null).call(b.transform,d3.zoomIdentity.translate(a.plot.width/2,a.plot.height/2).scale(m).translate(-M[0],-M[1])),a.onLoaded&&a.onLoaded(),D(),a.clear=function(){L.selectAll(".overlay-shape").remove(),L.selectAll("text").remove()},a.update=function(t,m){function g(){switch(a.series[0].tileIcon){case"circle":{let t=B.selectAll(".overlay-shape").data(p);t.attr("class","overlay-shape update"),t.exit().remove(),w=t.enter().append("circle").attr("class","overlay-shape").style("stroke",function(t){return t.fillColor=c?e.matchGroup(t[s],a.legend.legendColors,"color"):f,t.fillColor}).style("opacity",.6).on("mousemove",P).on("mouseout",function(){a.hideTooltip()}).merge(t).attr("cx",function(e){return e.position=Z([e[r],e[o]],tiles.scale,tiles.translate,!0),e.position[0]}).attr("cy",function(e){return e.position[1]}).attr("r",null).style("fill",function(t){return t.fillColor=c?e.matchGroup(t[s],a.legend.legendColors,"color"):f,t.fillColor})}break;case"square":{let t=B.selectAll(".overlay-shape").data(p);t.attr("class","overlay-shape update"),t.exit().remove(),w=t.enter().append("rect").attr("class","overlay-shape").style("stroke",function(t){return t.fillColor=c?e.matchGroup(t[s],a.legend.legendColors,"color"):f,t.fillColor}).style("opacity",.6).on("mousemove",P).on("mouseout",function(){a.hideTooltip()}).merge(t).attr("x",function(e){return e.position=Z([e[r],e[o]],tiles.scale,tiles.translate,!0),e.position[0]-S(e[l])}).attr("y",function(e){return e.position[1]-S(e[l])}).attr("width",null).attr("height",null).style("fill",function(t){return t.fillColor=c?e.matchGroup(t[s],a.legend.legendColors,"color"):f,t.fillColor})}break;default:{let t=B.selectAll(".overlay-shape").data(p);t.attr("class","overlay-shape update"),t.exit().remove(),w=t.enter().append("circle").attr("class","overlay-shape").style("stroke",function(t){return t.fillColor=c?e.matchGroup(t[s],a.legend.legendColors,"color"):f,t.fillColor}).style("opacity",.6).on("mousemove",P).on("mouseout",function(){a.hideTooltip()}).merge(t).attr("cx",function(e){return e.position=Z([e[r],e[o]],tiles.scale,tiles.translate,!0),e.position[0]}).attr("cy",function(e){return e.position[1]}).attr("r",null).style("fill",function(t){return t.fillColor=c?e.matchGroup(t[s],a.legend.legendColors,"color"):f,t.fillColor})}}if(null!==v){let e=B.selectAll("text").data(p);e.attr("class","update"),e.exit().remove(),v=e.enter().append("text").style("text-anchor","middle").style("fill",function(e){return"auto"===a.series[0].labelFontColor?a.getAutoColor(e.fillColor):a.series[0].labelFontColor}).style("font-family",a.series[0].labelFontFamily).style("font-style","bold"===a.series[0].labelFontStyle?"normal":a.series[0].labelFontStyle).style("font-weight","bold"===a.series[0].labelFontStyle?"bold":"normal").on("mousemove",P).on("mouseout",function(){a.hideTooltip()}).attr("dy",".35em").merge(e).style("font-size","24px").text(function(e){return n=a.series[0].labelFormat,i=e[s],n=c?n.replaceAll("{group}",i):n.replaceAll("{group}",""),n=a.getContent(e,a.series[0],n)}).style("font-size",function(e){return"auto"===a.series[0].labelFontSize?(z=(2*S(e[l])-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*24)<T&&d3.select(this).text(""):z=a.series[0].labelFontSize,z+"px"}).attr("transform",function(e){return e.position=Z([e[r],e[o]],tiles.scale,tiles.translate,!0),"translate("+e.position[0]+","+(e.position[1]-this.getBBox().height/4)+")"})}}function h(){switch(a.series[0].tileIcon){case"circle":w=L.append("g").selectAll(".overlay-shape").data(p).enter().append("circle").attr("class","overlay-shape").style("stroke",function(t){return t.fillColor=c?e.matchGroup(t[s],a.legend.legendColors,"color"):f,t.fillColor}).style("opacity",.6).on("mousemove",P).on("mouseout",function(){a.hideTooltip()}).attr("cx",function(e){return e.position=Z([e[r],e[o]],tiles.scale,tiles.translate,!0),e.position[0]}).attr("cy",function(e){return e.position[1]}).attr("r",null).style("fill",function(t){return t.fillColor=c?e.matchGroup(t[s],a.legend.legendColors,"color"):f,t.fillColor});break;case"square":w=L.append("g").selectAll(".overlay-shape").enter().append("rect").attr("class","overlay-shape").style("stroke",function(t){return t.fillColor=c?e.matchGroup(t[s],a.legend.legendColors,"color"):f,t.fillColor}).style("opacity",.6).on("mousemove",P).on("mouseout",function(){a.hideTooltip()}).attr("x",function(e){return e.position=Z([e[r],e[o]],tiles.scale,tiles.translate,!0),e.position[0]-S(e[l])}).attr("y",function(e){return e.position[1]-S(e[l])}).attr("width",null).attr("height",null).style("fill",function(t){return t.fillColor=c?e.matchGroup(t[s],a.legend.legendColors,"color"):f,t.fillColor});break;default:w=L.append("g").selectAll(".overlay-shape").enter().append("circle").attr("class","overlay-shape").style("stroke",function(t){return t.fillColor=c?e.matchGroup(t[s],a.legend.legendColors,"color"):f,t.fillColor}).style("opacity",.6).on("mousemove",P).on("mouseout",function(){a.hideTooltip()}).attr("cx",function(e){return e.position=Z([e[r],e[o]],tiles.scale,tiles.translate,!0),e.position[0]}).attr("cy",function(e){return e.position[1]}).attr("r",null).style("fill",function(t){return t.fillColor=c?e.matchGroup(t[s],a.legend.legendColors,"color"):f,t.fillColor})}null!==v&&(v=L.data(p).enter().append("text").style("text-anchor","middle").style("fill",function(e){return"auto"===a.series[0].labelFontColor?a.getAutoColor(e.fillColor):a.series[0].labelFontColor}).style("font-family",a.series[0].labelFontFamily).style("font-style","bold"===a.series[0].labelFontStyle?"normal":a.series[0].labelFontStyle).style("font-weight","bold"===a.series[0].labelFontStyle?"bold":"normal").on("mousemove",P).on("mouseout",function(){a.hideTooltip()}).attr("dy",".35em").style("font-size","24px").text(function(e){return n=a.series[0].labelFormat,i=e[s],n=c?n.replaceAll("{group}",i):n.replaceAll("{group}",""),n=a.getContent(e,a.series[0],n)}).style("font-size",function(e){return"auto"===a.series[0].labelFontSize?(z=(2*S(e[l])-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*24)<T&&d3.select(this).text(""):z=a.series[0].labelFontSize,z+"px"}).attr("transform",function(e){return e.position=Z([e[r],e[o]],tiles.scale,tiles.translate,!0),"translate("+e.position[0]+","+(e.position[1]-this.getBBox().height/4)+")"}))}a.data=t,a.calculateDomain(),a.updateLegend(),a.series[0].updateReZoom&&G(!0),l?(u=a.domains.minY===a.domains.maxY?a.series[0].maxBulletSize:a.series[0].minBulletSize,S=d3.scalePow().exponent(.5).domain([a.domains.minY,a.domains.maxY]).range([u,d]),p=a.data.filter(function(e){return!isNaN(parseFloat(e[l]))&&0!==parseFloat(e[l])&&(e[l]=parseFloat(e[l]),!0)})):(u=a.series[0].minBulletSize,S=function(e){return u},p=a.data),a.animation.effect?"fade"===a.animation.effect?(B.transition().duration(1e3).style("opacity",0).remove(),B=L.append("g"),g()):"dim"===a.animation.effect?(A=L.selectAll(".overlay-shape").style("opacity",.1).on("mousemove",null).on("mouseout",null),v&&(k=L.selectAll("text").style("opacity",.1).on("mousemove",null).on("mouseout",null)),h()):"add"===a.animation.effect?(A=L.selectAll(".overlay-shape"),v&&(k=L.selectAll("text")),h()):g():g(),D()}}(),a.toCanvas=function(t){let n,l,i,o,r=document.getElementById(a.container+"_map"),s=document.getElementById(a.container+"_legend_svg"),u=r.getElementsByClassName("tile"),d=document.getElementById(a.container+"_overlay"),c=parseFloat(d.style.top),p=parseFloat(d.style.left),f=document.createElement("canvas"),m=!1,g=document.createElement("canvas"),h=g.getContext("2d"),y=document.createElement("div"),x=document.createElement("defs");x.innerHTML=e.vectorTileStyle,y.style.position=r.style.position,y.style.overflow=r.style.overflow,y.style.width=r.style.width,y.style.height=r.style.height,g.style.top=0,g.style.left=0,g.style.position="absolute",g.width=a.plot.width,g.height=a.plot.height,h.fillStyle="rgb(221, 221, 221)";for(let t=0;t<u.length;t++)n=parseFloat(u[t].style.top)-c,l=parseFloat(u[t].style.left)-p,u[t].insertBefore(x,u[t].firstChild),o=(new XMLSerializer).serializeToString(u[t]),e.detectMS()&&(o=o.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(f,o,{ignoreMouse:!0,ignoreAnimation:!0}),h.fillRect(l,n,f.width,f.height),h.drawImage(f,l,n),u[t].removeChild(x);return o=(new XMLSerializer).serializeToString(d),e.detectMS()&&(o=o.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(f,o,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){m=!0,g.getContext("2d").drawImage(f,0,0),f.svg.stop()}}),y.appendChild(g),y.appendChild(document.getElementById(a.container+"_info").cloneNode(!0)),r.parentNode.insertBefore(y,r),r.parentNode.removeChild(r),s&&(i=document.createElement("canvas"),o=(new XMLSerializer).serializeToString(s),e.detectMS()&&(o=o.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(i,o,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){i.svg.stop()}}),s.parentNode.appendChild(i),s.parentNode.removeChild(s)),new Promise(function(e){let n=setInterval(function(){m&&(html2canvas(document.getElementById(a.container)).then(function(n){s&&(i.parentNode.appendChild(s),i.parentNode.removeChild(i)),y.parentNode.insertBefore(r,y),y.parentNode.removeChild(y),n.id=t+"-canvas",e(n)}),clearInterval(n))},50)})},a.toImage=function(){let t,n,l,i,o=document.getElementById(a.container+"_map"),r=document.getElementById(a.container+"_legend_svg"),s=o.getElementsByClassName("tile"),u=document.getElementById(a.container+"_overlay"),d=parseFloat(u.style.top),c=parseFloat(u.style.left),p=document.createElement("canvas"),f=!1,m=document.createElement("canvas"),g=m.getContext("2d"),h=document.createElement("div"),y=document.createElement("defs");y.innerHTML=e.vectorTileStyle,h.style.position=o.style.position,h.style.overflow=o.style.overflow,h.style.width=o.style.width,h.style.height=o.style.height,m.style.top=0,m.style.left=0,m.style.position="absolute",m.width=a.plot.width,m.height=a.plot.height,g.fillStyle="rgb(221, 221, 221)";for(let a=0;a<s.length;a++)t=parseFloat(s[a].style.top)-d,n=parseFloat(s[a].style.left)-c,s[a].insertBefore(y,s[a].firstChild),i=(new XMLSerializer).serializeToString(s[a]),e.detectMS()&&(i=i.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(p,i,{ignoreMouse:!0,ignoreAnimation:!0}),g.fillRect(n,t,p.width,p.height),g.drawImage(p,n,t),s[a].removeChild(y);return i=(new XMLSerializer).serializeToString(u),e.detectMS()&&(i=i.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(p,i,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){f=!0,m.getContext("2d").drawImage(p,0,0),p.svg.stop()}}),h.appendChild(m),h.appendChild(document.getElementById(a.container+"_info").cloneNode(!0)),o.parentNode.insertBefore(h,o),o.parentNode.removeChild(o),r&&(l=document.createElement("canvas"),i=(new XMLSerializer).serializeToString(r),e.detectMS()&&(i=i.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(l,i,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){l.svg.stop()}}),r.parentNode.appendChild(l),r.parentNode.removeChild(r)),new Promise(function(e){let t=setInterval(function(){f&&(html2canvas(document.getElementById(a.container)).then(function(t){r&&(l.parentNode.appendChild(r),l.parentNode.removeChild(l)),h.parentNode.insertBefore(o,h),h.parentNode.removeChild(h),e(t.toDataURL("image/png"))}),clearInterval(t))},1)})},a}e.locationMap=function(n){return n.type="locationMap",n.masterType="map",e.visualizations.push(n),new t(n)}}(eve),function(e){function t(t){let n=e.initVis(t),a=n.series[0].latField,l=n.series[0].longField,o=n.series[0].groupField,r=(n.series[0].orderField,""!==n.series[0].groupField),s=1<<22,u=[{minValue:90,maxValue:360,zoom:512},{minValue:45,maxValue:90,zoom:1024},{minValue:22.5,maxValue:45,zoom:2048},{minValue:11.25,maxValue:22.5,zoom:4096},{minValue:5.625,maxValue:11.25,zoom:8192},{minValue:2.813,maxValue:5.625,zoom:16384},{minValue:1.406,maxValue:2.813,zoom:32768},{minValue:.703,maxValue:1.406,zoom:65536},{minValue:.352,maxValue:.703,zoom:1<<17},{minValue:.176,maxValue:.352,zoom:1<<18},{minValue:.088,maxValue:.176,zoom:1<<19},{minValue:.044,maxValue:.088,zoom:1<<20},{minValue:.022,maxValue:.044,zoom:1<<21},{minValue:.011,maxValue:.022,zoom:1<<22}],d=2*Math.PI,c=d3.geoMercator().scale(1/d).translate([0,0]),p=null,f=null,m=null,g=[],h=[],y={},x={},b=!1,v=null,F=[],w=[],A="";A=window.app&&(n.index||0===n.index)?"vysda":window.report&&report.dashboard&&report.dashboard.tabs?"ssweb":"eve",n.plot.width=n.plot.width-2*n.plot.left-n.plot.right,n.plot.height=n.plot.height-n.plot.top-n.plot.bottom;let k=d3.select("#"+n.innerContainer).style("padding-left",n.plot.left+"px").append("div").attr("class","vectormap").style("position","relative").style("overflow","hidden").style("width",n.plot.width+"px").style("height",n.plot.height+"px").attr("id",n.container+"_map"),S=k.append("div").attr("id",n.container+"_zoomApply").append("div").attr("class","vectorlayer").style("position","absolute").style("will-change","transform").attr("id",n.container+"_vectorlayer");S.insert("defs",":first-child").html(e.vectorTileStyle);let C=S.append("svg").attr("class","overlay").style("position","absolute").attr("id",n.container+"_overlay"),z=d3.line().curve(d3.curveLinear).x(function(e){return(g=V([e[l],e[a]],f.scale,f.translate,!0))[0]}).y(function(e){return(g=V([e[l],e[a]],f.scale,f.translate,!0))[1]});function T(t){let a=[];if(1===n.data.length)w=[n.domains.minLong,n.domains.minLat],s=1<<22;else{n.domains.minLat>0&&n.domains.maxLat>0||n.domains.minLat<0&&n.domains.maxLat<0?(w[1]=n.domains.maxLat-Math.abs(n.domains.maxLat-n.domains.minLat)/2,a[0]=Math.abs(n.domains.maxLat-n.domains.minLat)):(w[1]=n.domains.maxLat-(Math.abs(n.domains.minLat)+Math.abs(n.domains.maxLat))/2,a[0]=Math.abs(n.domains.maxLat)+Math.abs(n.domains.minLat)),n.domains.minLong>0&&n.domains.maxLong>0||n.domains.minLong<0&&n.domains.maxLong<0?(w[0]=n.domains.maxLong-Math.abs(n.domains.maxLong-n.domains.minLong)/2,a[1]=Math.abs(n.domains.maxLong-n.domains.minLong)):(w[0]=n.domains.maxLong-(Math.abs(n.domains.minLong)+Math.abs(n.domains.maxLong))/2,a[1]=Math.abs(n.domains.maxLong)+Math.abs(n.domains.minLong)),n.yAxis.diffDegrees&&(a=e.clone(n.yAxis.diffDegrees));let t=n.plot.width/256,l=n.plot.height/256;a[0]=a[0]/l,a[1]=a[1]/t,512==(s=Math.min(e.findRange(a[0],u,"zoom"),e.findRange(a[1],u,"zoom")))&&n.plot.width>512&&(s=1024)}w=d3.geoMercator().scale(1/d).translate([0,0])(w),t&&(b=!0,d3.select("#"+n.container+"_zoomApply").call(m.transform,d3.zoomIdentity.translate(n.plot.width/2,n.plot.height/2).scale(s).translate(-w[0],-w[1])))}function M(){for(i=0;i<n.legend.legendColors.length;i++)h[i].length>0&&y[i].transition().duration(4*n.animation.duration).attrTween("stroke-dasharray",e(x[i],y[i]));function e(e,t){let n=!0,a=t.node().getTotalLength(),l=d3.interpolateString("0,"+a,a+","+a);return function(i){return function(i){n&&(t.attr("stroke-width",2),e.attr("fill-opacity",.75)),n=!1;let o=t.node().getPointAtLength(i*a);return e.attr("transform","translate("+o.x+","+o.y+")"),l(i)}}}n.renderComplete&&setTimeout(function(){n.renderComplete()},1e3)}function E(){let t,o=d3.event.transform,r=[n.plot.width/2,n.plot.height/2],s=[0,0];if(b)b=!1,t={x:o.x,y:o.y,k:o.k,center:r};else{if(!o.k)return;if("vysda"===A?t=app.maps[n.index].currTransform:"ssweb"===A?report.dashboard.tabs.forEach(function(e){e.id===n.tabID&&e.visualizations.forEach(function(e){e.visualizationID===n.visualizationID&&e.currTransform&&(t=JSON.parse(e.currTransform))})}):t=n.currTransform,null==t)t={x:o.x,y:o.y,k:o.k,center:r};else{if(t.center&&r[0]!=t.center[0]&&r[1]!=t.center[1]&&(s[0]=r[0]-t.center[0],s[1]=r[1]-t.center[1]),o===t)return;t.k<o.k?(o.x=2*t.x-r[0]+s[0],o.y=2*t.y-r[1]+s[1],o.k=2*t.k):t.k>o.k?(o.x=.5*t.x+r[0]/2,o.y=.5*t.y+r[1]/2,o.k=.5*t.k):t.k==o.k&&(o.x=o.x+s[0],o.y=o.y+s[1]),s=[0,0],t.x=o.x,t.y=o.y,t.k=o.k,t.center=r}}"vysda"===A?app.maps[n.index].currTransform=t:"ssweb"===A?report.dashboard.tabs.forEach(function(e){e.id===n.tabID&&e.visualizations.forEach(function(e){e.visualizationID===n.visualizationID&&(e.currTransform=JSON.stringify(t))})}):n.currTransform=t,f=p.scale(o.k).translate([o.x,o.y])(),c.scale(o.k/d).translate([o.x,o.y]);let u=S.style("transform",function(e,t,n){let a=e/256,l=e%1?Number:Math.round;return"matrix3d("+[a,0,0,0,0,a,0,0,0,0,a,0,l((t[0]+n[0])*e),l((t[1]+n[1])*e),0,1]+")"}(f.scale,f.translate,f[0])).selectAll(".tile").data(f,function(e){return e});for(u.exit().each(function(e){this.labels&&this.labels.remove(),this.labels=null}).remove(),u.enter().append("svg").attr("class",n.container+" tile").style("position","absolute").style("background-color","rgb(221,221,221)").style("width","256px").style("height","256px").each(function(t){let a=Math.pow(2,t[2])-1,l=this;this.labels&&this.labels.remove(),t[0]<=a&&t[1]<=a?function(t,a){let l=e.clone(n.series[0].mapLayers);-1===l.indexOf("landcover")&&l.push("landcover");-1===l.indexOf("water")&&l.push("water");for(let e=0;e<l.length;e++)"boundaries"===l[e]?l[e]="boundary":"buildings"===l[e]?(l[e]="building",l.push("housenumber")):"places"===l[e]?l[e]="place":"roads"===l[e]?l[e]="transportation":"lakesandrivers"===l[e]&&(l[e]="waterway");-1!==l.indexOf("aeroway")&&l.splice(l.indexOf("aeroway"),1);-1!==l.indexOf("landcover")&&l.push("landcover");-1!==l.indexOf("mountain_peak")&&l.splice(l.indexOf("mountain_peak"),1);-1!==l.indexOf("park")&&l.splice(l.indexOf("park"),1);-1!==l.indexOf("pois")&&l.splice(l.indexOf("pois"),1);-1!==l.indexOf("transit")&&l.splice(l.indexOf("transit"),1);-1!==l.indexOf("water_name")&&l.splice(l.indexOf("water_name"),1);-1!==l.indexOf("transportation_name")&&l.splice(l.indexOf("transportation_name"),1);if(!e.vectorSource||!e.vectorKey)return e.renderVectorError(a),new Promise(function(e,t){e(null)});let o={base:e.vectorSource,z:t[2],x:t[0],y:t[1],token:e.vectorKey};return vectorJSON.getVectorTilePromise(o).then(function(n){if(_.isEmpty(n))return e.renderVectorError(a),null;let o=[],r=[],s=256*Math.pow(2,t[2]),u=d3.geoMercator().scale(s/d).translate([s/2-256*t[0],s/2-256*t[1]]).precision(0);return l.forEach(function(e){if(n[e]&&n[e].features.length>0)for(i=0;i<n[e].features.length;i++){if("boundary"===e)if(2===n[e].features[i].properties.admin_level)n[e].features[i].properties.cssClass="outerBorder";else{if(4!==n[e].features[i].properties.admin_level)continue;t[2]<6?n[e].features[i].properties.cssClass="innerBorder":n[e].features[i].properties.cssClass="outerBorder"}else if("building"===e||"housenumber"===e){if(t[2]<=14&&n[e].features[i].properties.render_height>=100)continue;n[e].features[i].properties.cssClass="buildingAndHouseNo"}else if("landcover"===e)n[e].features[i].properties.cssClass="notVisible";else if("water"===e)n[e].features[i].properties.cssClass="water";else if("waterway"===e)n[e].features[i].properties.cssClass="waterway";else if("place"===e)if(t[2]<3)if("continent"===n[e].features[i].properties.class)n[e].features[i].properties.cssClass="noneStyle";else{if("country"!==n[e].features[i].properties.class||1!==n[e].features[i].properties.rank)continue;n[e].features[i].properties.cssClass="noneStyle"}else if(t[2]<5){if("continent"!==n[e].features[i].properties.class&&"country"!==n[e].features[i].properties.class&&"state"!==n[e].features[i].properties.class&&"province"!==n[e].features[i].properties.class)continue;n[e].features[i].properties.cssClass="noneStyle"}else if(t[2]<9)if("continent"===n[e].features[i].properties.class||"country"===n[e].features[i].properties.class||"state"===n[e].features[i].properties.class||"province"===n[e].features[i].properties.class)n[e].features[i].properties.cssClass="noneStyle";else{if("city"!==n[e].features[i].properties.class&&"town"!==n[e].features[i].properties.class)continue;n[e].features[i].properties.cssClass="noneStyle"}else n[e].features[i].properties.cssClass="noneStyle";else if("transportation"===e){let t=n[e].features[i].properties.class;n[e].features[i].properties.cssClass="motorway"===t?"roads-motorway":"trunk"===t||"primary"===t||"secondary"===t||"tertiary"===t||"trunk"===t?"roads-major_road":"raceway"===t||"service"===t||"minor"===t?"roads-minor_road":"rail"===t?"roads-rail":"notVisible"}else n[e].features[i].properties.cssClass="notVisible";n[e].features[i].layer_name=e,"place"===e?r.push(n[e].features[i]):o.push(n[e].features[i])}}),d3.select(a).selectAll("path").data(o).enter().append("path").attr("class",function(e){return e.properties.cssClass}).attr("d",d3.geoPath().projection(u)),r})}(t,this).then(function(e){e&&(l.labels=function(e){let t,a={style:"",weight:"",size:0};e.length>0&&(t=C.selectAll(".tile-label").data(e).enter().append("text").style("text-anchor","middle").style("font-family",n.series[0].labelFontFamily).style("font-style",function(e){return"continent"===e.properties.class?a.style="oblique":"region"===e.properties.class?a.style="italic":a.style="normal",a.style}).style("font-weight",function(e){return"country"===e.properties.class?a.weight="600":a.weight="normal",a.weight}).attr("dy",".35em").text(function(e){return e.properties["name:en"]?e.properties["name:en"]:e.properties.name}).style("fill","black").style("font-size",function(e){return"continent"===e.properties.class?a.size=12:"region"===e.properties.class?a.size=12:"country"===e.properties.class?a.size=11:a.size=10,a.size+"px"}).attr("transform",function(e){let t=V([e.geometry.coordinates[0],e.geometry.coordinates[1]],f.scale,f.translate,!0);return"translate("+t[0]+","+t[1]+")"}),F.push(t));return t}(e))}):this.parentNode.removeChild(this)}),S.selectAll(".tile").style("left",function(e){return 256*(e[0]-f[0][0])+"px"}).style("top",function(e){return 256*(e[1]-f[0][1])+"px"}),d3.select("#"+n.container+"_map").selectAll("svg").sort(function(e,t){return e?-1:0}),d3.select("#"+n.container+"_map").selectAll("svg").sort(function(e,t){return e?0:1}),C.style("left",V("",f.scale,f.translate)[0]+"px").style("top",V("",f.scale,f.translate)[1]+"px").style("width",n.plot.width+"px").style("height",n.plot.height+"px"),i=0;i<n.legend.legendColors.length;i++)h[i].length>0&&(y[i].attr("d",z).attr("stroke-dasharray",null),g=V([h[i][h[i].length-1][l],h[i][h[i].length-1][a]],f.scale,f.translate,!0),x[i].attr("transform","translate("+g[0]+","+g[1]+")"));F.length>0&&F.forEach(function(e){e.attr("transform",function(e){let t=V([e.geometry.coordinates[0],e.geometry.coordinates[1]],f.scale,f.translate,!0);return"translate("+t[0]+","+t[1]+")"})}),""!==n.series[0].labelFormat&&null!==v&&v.attr("transform",function(e){let t=V([e[l],e[a]],f.scale,f.translate,!0);return"translate("+t[0]+","+t[1]+")"})}function V(e,t,n,a){let l=c(e),i=t%1?Number:Math.round;return a?[l[0],l[1]]:[-i((n[0]+f[0][0])*t),-i((n[1]+f[0][1])*t)]}return null==n.currTransform&&T(),function(){let t,u="",d="",c="";if(m=d3.zoom().scaleExtent([512,1<<22]).on("zoom",E),p=d3.tile().size([n.plot.width,n.plot.height]),!n.hideZoom){let e=k.append("div").attr("class","zoom-container").style("position","absolute").style("top","10px").style("left","10px").attr("id",n.container+"_zoom_container");e.append("a").attr("class","zoom").attr("id","zoom_in").text("+").on("click",function(){m.scaleBy(d3.select("#"+n.container+"_zoomApply"),2)}),e.append("a").attr("class","zoom").attr("id","zoom_out").text("-").on("click",function(){m.scaleBy(d3.select("#"+n.container+"_zoomApply"),.5)})}k.append("div").attr("class","info").style("position","absolute").style("bottom","0px").style("right","0px").style("background","rgba(255, 255, 255, 0.8)").style("padding","0px 5px").style("font-family","Tahoma, Arial, Helvetica, Ubuntu").style("font-size","11px").attr("id",n.container+"_info").html('<a href="https://www.maptiler.com/license/maps/" target="_blank">&copy MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy OpenStreetMap contributors</a>'),n.legend.legendColors.forEach(function(t,a){let l=r?e.filter(n.data,o,t.value):n.data,i=null,s=null;h.push(l),l.length>0&&(i=C.selectAll(".lineConnect_"+n.container+"_"+a).data([l]).enter().append("path").attr("class","lineConnect_"+n.container+"_"+a).attr("fill","none").attr("stroke",t.color).attr("stroke-width",0).on("mousemove",function(){r&&""!==n.tooltip.format&&(u=n.tooltip.format.replaceAll("{group}",t.value),n.showTooltip(u))}).on("mouseout",function(){n.hideTooltip()}),s=C.append("circle").attr("r",10).attr("class","marker_"+n.container+"_"+a).attr("fill",t.color).attr("fill-opacity",0).on("mousemove",function(){r&&""!==n.tooltip.format&&(u=n.tooltip.format.replaceAll("{group}",t.value),n.showTooltip(u))}).on("mouseout",function(){n.hideTooltip()})),y[a]=i,x[a]=s}),""!==n.series[0].labelFormat&&(v=C.selectAll("text").data(n.data).enter().append("text").style("text-anchor","middle").style("fill",n.series[0].labelFontColor).style("font-size",n.series[0].labelFontSize+"px").style("font-family",n.series[0].labelFontFamily).style("font-style","bold"===n.series[0].labelFontStyle?"normal":n.series[0].labelFontStyle).style("font-weight","bold"===n.series[0].labelFontStyle?"bold":"normal").text(function(e){return d=n.series[0].labelFormat,c=e[o],d=r?d.replaceAll("{group}",c):d.replaceAll("{group}",""),d=n.getContent(e,n.series[0],d)}).attr("dy",".35em")),null!=n.currTransform?(t="string"==typeof n.currTransform?JSON.parse(n.currTransform):n.currTransform,d3.select("#"+n.container+"_zoomApply").call(m).on("dblclick.zoom",null).call(m.transform,d3.zoomIdentity.translate(t.x,t.y).scale(t.k))):d3.select("#"+n.container+"_zoomApply").call(m).on("dblclick.zoom",null).call(m.transform,d3.zoomIdentity.translate(n.plot.width/2,n.plot.height/2).scale(s).translate(-w[0],-w[1])),n.onLoaded&&n.onLoaded(),M(),n.clear=function(){},n.update=function(t,s){for(n.data=t,n.calculateDomain(),n.updateLegend(),n.series[0].updateReZoom&&T(!0),i=0;i<n.legend.legendColors.length;i++)h[i].length>0&&(y[i].remove(),x[i].remove());if(y={},x={},h=[],n.legend.legendColors.forEach(function(t,i){let s=r?e.filter(n.data,o,t.value):n.data,d=null,c=null;h.push(s),s.length>0&&(d=C.selectAll(".lineConnect_"+n.container+"_"+i).data([s]).enter().append("path").attr("class","lineConnect_"+n.container+"_"+i).attr("fill","none").attr("stroke",t.color).attr("stroke-width",0).on("mousemove",function(){r&&""!==n.tooltip.format&&(u=n.tooltip.format.replaceAll("{group}",t.value),n.showTooltip(u))}).on("mouseout",function(){n.hideTooltip()}).attr("d",z),g=V([h[i][h[i].length-1][l],h[i][h[i].length-1][a]],f.scale,f.translate,!0),c=C.append("circle").attr("r",10).attr("class","marker_"+n.container+"_"+i).attr("fill",t.color).attr("fill-opacity",0).on("mousemove",function(){r&&""!==n.tooltip.format&&(u=n.tooltip.format.replaceAll("{group}",t.value),n.showTooltip(u))}).on("mouseout",function(){n.hideTooltip()}).attr("transform","translate("+g[0]+","+g[1]+")")),y[i]=d,x[i]=c}),null!==v){let e=C.selectAll("text").data(n.data);e.attr("class","update"),e.exit().remove(),v=e.enter().append("text").style("text-anchor","middle").style("fill",n.series[0].labelFontColor).style("font-size",n.series[0].labelFontSize+"px").style("font-family",n.series[0].labelFontFamily).style("font-style","bold"===n.series[0].labelFontStyle?"normal":n.series[0].labelFontStyle).style("font-weight","bold"===n.series[0].labelFontStyle?"bold":"normal").attr("dy",".35em").merge(e).attr("transform",function(e){let t=V([e[l],e[a]],f.scale,f.translate,!0);return"translate("+t[0]+","+t[1]+")"}).text(function(e){return d=n.series[0].labelFormat,c=e[o],d=r?d.replaceAll("{group}",c):d.replaceAll("{group}",""),d=n.getContent(e,n.series[0],d)})}M()}}(),n.toCanvas=function(t){let a,l,i,o,r=document.getElementById(n.container+"_map"),s=document.getElementById(n.container+"_legend_svg"),u=r.getElementsByClassName("tile"),d=document.getElementById(n.container+"_overlay"),c=parseFloat(d.style.top),p=parseFloat(d.style.left),f=document.createElement("canvas"),m=!1,g=document.createElement("canvas"),h=g.getContext("2d"),y=document.createElement("div"),x=document.createElement("defs");x.innerHTML=e.vectorTileStyle,y.style.position=r.style.position,y.style.overflow=r.style.overflow,y.style.width=r.style.width,y.style.height=r.style.height,g.style.top=0,g.style.left=0,g.style.position="absolute",g.width=n.plot.width,g.height=n.plot.height,h.fillStyle="rgb(221, 221, 221)";for(let t=0;t<u.length;t++)a=parseFloat(u[t].style.top)-c,l=parseFloat(u[t].style.left)-p,u[t].insertBefore(x,u[t].firstChild),o=(new XMLSerializer).serializeToString(u[t]),e.detectMS()&&(o=o.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(f,o,{ignoreMouse:!0,ignoreAnimation:!0}),h.fillRect(l,a,f.width,f.height),h.drawImage(f,l,a),u[t].removeChild(x);return o=(new XMLSerializer).serializeToString(d),e.detectMS()&&(o=o.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(f,o,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){m=!0,g.getContext("2d").drawImage(f,0,0),f.svg.stop()}}),y.appendChild(g),y.appendChild(document.getElementById(n.container+"_info").cloneNode(!0)),r.parentNode.insertBefore(y,r),r.parentNode.removeChild(r),s&&(i=document.createElement("canvas"),o=(new XMLSerializer).serializeToString(s),e.detectMS()&&(o=o.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(i,o,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){i.svg.stop()}}),s.parentNode.appendChild(i),s.parentNode.removeChild(s)),new Promise(function(e){let a=setInterval(function(){m&&(html2canvas(document.getElementById(n.container)).then(function(n){s&&(i.parentNode.appendChild(s),i.parentNode.removeChild(i)),y.parentNode.insertBefore(r,y),y.parentNode.removeChild(y),n.id=t+"-canvas",e(n)}),clearInterval(a))},50)})},n.toImage=function(){let t,a,l,i,o=document.getElementById(n.container+"_map"),r=document.getElementById(n.container+"_legend_svg"),s=o.getElementsByClassName("tile"),u=document.getElementById(n.container+"_overlay"),d=parseInt(u.style.top),c=parseInt(u.style.left),p=document.createElement("canvas"),f=!1,m=document.createElement("canvas"),g=m.getContext("2d"),h=document.createElement("div"),y=document.createElement("defs");y.innerHTML=e.vectorTileStyle,h.style.position=o.style.position,h.style.overflow=o.style.overflow,h.style.width=o.style.width,h.style.height=o.style.height,m.style.top=0,m.style.left=0,m.style.position="absolute",m.width=n.plot.width,m.height=n.plot.height,g.fillStyle="rgb(221, 221, 221)";for(let n=0;n<s.length;n++)t=parseFloat(s[n].style.top)-d,a=parseFloat(s[n].style.left)-c,s[n].insertBefore(y,s[n].firstChild),i=(new XMLSerializer).serializeToString(s[n]),e.detectMS()&&(i=i.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(p,i,{ignoreMouse:!0,ignoreAnimation:!0}),g.fillRect(a,t,p.width,p.height),g.drawImage(p,a,t),s[n].removeChild(y);return i=(new XMLSerializer).serializeToString(u),e.detectMS()&&(i=i.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(p,i,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){f=!0,m.getContext("2d").drawImage(p,0,0),p.svg.stop()}}),h.appendChild(m),h.appendChild(document.getElementById(n.container+"_info").cloneNode(!0)),o.parentNode.insertBefore(h,o),o.parentNode.removeChild(o),r&&(l=document.createElement("canvas"),i=(new XMLSerializer).serializeToString(r),e.detectMS()&&(i=i.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,"")),canvg(l,i,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){l.svg.stop()}}),r.parentNode.appendChild(l),r.parentNode.removeChild(r)),new Promise(function(e){let t=setInterval(function(){f&&(html2canvas(document.getElementById(n.container)).then(function(t){r&&(l.parentNode.appendChild(r),l.parentNode.removeChild(l)),h.parentNode.insertBefore(o,h),h.parentNode.removeChild(h),e(t.toDataURL("image/png"))}),clearInterval(t))},50)})},n}e.routeMap=function(n){return n.type="routeMap",n.masterType="map",e.visualizations.push(n),new t(n)}}(eve),function(e){eve.standardMap=function(t){return t.type="standardMap",t.masterType="map",e.visualizations.push(t),new function(t){let n=e.initVis(t),a=n.series[0].labelField,l=n.series[0].valueField,i=n.series[0].parentField,o=e.mapDirectory+"stdmaps/",r=0,s="",u=null,d=null,c=null,p=null,f=null,m=null,g=n.domains.minY,h=n.domains.maxY,y="",x="",b=null,v=null,F=[],w="",A=[{name:"Alabama",code:"AL"},{name:"Alaska",code:"AK"},{name:"Arizona",code:"AZ"},{name:"Arkansas",code:"AR"},{name:"California",code:"CA"},{name:"Colorado",code:"CO"},{name:"Connecticut",code:"CT"},{name:"Delaware",code:"DE"},{name:"District of Columbia",code:"DC"},{name:"Florida",code:"FL"},{name:"Georgia",code:"GA"},{name:"Hawaii",code:"HI"},{name:"Idaho",code:"ID"},{name:"Illinois",code:"IL"},{name:"Indiana",code:"IN"},{name:"Iowa",code:"IA"},{name:"Kansa",code:"KS"},{name:"Kentucky",code:"KY"},{name:"Lousiana",code:"LA"},{name:"Maine",code:"ME"},{name:"Maryland",code:"MD"},{name:"Massachusetts",code:"MA"},{name:"Michigan",code:"MI"},{name:"Minnesota",code:"MN"},{name:"Mississippi",code:"MS"},{name:"Missouri",code:"MO"},{name:"Montana",code:"MT"},{name:"Nebraska",code:"NE"},{name:"Nevada",code:"NV"},{name:"New Hampshire",code:"NH"},{name:"New Jersey",code:"NJ"},{name:"New Mexico",code:"NM"},{name:"New York",code:"NY"},{name:"North Carolina",code:"NC"},{name:"North Dakota",code:"ND"},{name:"Ohio",code:"OH"},{name:"Oklahoma",code:"OK"},{name:"Oregon",code:"OR"},{name:"Pennsylvania",code:"PA"},{name:"Rhode Island",code:"RI"},{name:"South Carolina",code:"SC"},{name:"South Dakota",code:"SD"},{name:"Tennessee",code:"TN"},{name:"Texas",code:"TX"},{name:"Utah",code:"UT"},{name:"Vermont",code:"VT"},{name:"Virginia",code:"VA"},{name:"Washington",code:"WA"},{name:"West Virginia",code:"WV"},{name:"Wisconsin",code:"WI"},{name:"Wyoming",code:"WY"}],k="",S="",C="",z=[],T=0,M=0;n.plot.width=n.plot.width-n.plot.left-n.plot.right,n.plot.height=n.plot.height-n.plot.top-n.plot.bottom;let _=n.svg.append("g").attr("transform","translate("+n.plot.left+","+n.plot.top+")").append("svg").attr("width",n.plot.width-n.plot.left).attr("height",n.plot.height).attr("transform","translate(0,0)");function E(){g=n.domains.minY,h=n.domains.maxY,f.transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay/Math.max(1,Math.sqrt(t/8))}).attr("fill-opacity",function(t){if(t.currentData?(x=d3.select(this).attr("fill"),b=t.currentData):(x="",b=null),t.currentData=null,"code2"===S)switch(r){case 0:v=e.filterSingle(n.data,{key:a,values:t.properties.iso_a2});break;case 1:t.properties.postal&&(v=e.filterSingle(n.data,{key:a,values:t.properties.postal}));break;default:v=null}else if("code3"===S)switch(r){case 0:v=e.filterSingle(n.data,{key:a,values:t.properties.iso_a3});break;default:v=null}else if("name"===S){let l,o=[];switch(t.properties.name_alt?(o.push(t.properties.name),(l=t.properties.name_alt.split("|")).forEach(function(e){o.push(e)})):o=t.properties.name,r){case 2:if("SC_USACounties"===w){let l=[];switch(l.push({key:a,values:o}),C){case"code":l.push({key:i,values:t.properties.parent});break;case"name":l.push({key:i,values:t.properties.parentName});break}v=e.filterSingle(n.data,l)}else v=e.filterSingle(n.data,{key:a,values:o,replaceChar:!0});break;case 3:v=e.filterSingle(n.data,{key:a,values:o,isNumeric:!0});break;default:v=e.filterSingle(n.data,{key:a,values:o,replaceChar:!0})}}else if("fips"===S)switch(r){case 2:v=e.filterSingle(n.data,{key:a,values:t.properties.countyFIPS,isNumeric:!0});break;default:v=null}if(v&&0!=v[l]&&null!=v[l]){switch("default"!==n.legend.type&&(v[l]=parseFloat(v[l])),n.legend.type){case"default":y=e.matchGroup(v[l],n.legend.legendColors,"color")||"rgb(221,221,221)";break;case"ranged":{let a=e.matchRange(v[l],n.legend.rangeList,"color");a?(y=a.color,t.legendClass="ranged-"+a.index):y="rgb(221,221,221)"}break;default:M=g!==h?v[l]/(h-g)*100-g/(h-g)*100:1,y=e.gradient(n.legend.gradientColors,M)}T=1,t.currentData=v}return t.currentData||n.animation.effect&&("fade"===n.animation.effect?(y="rgb(221,221,221)",T=.9):"dim"===n.animation.effect?b?(y=x,T=.3,t.currentData=b):(y="rgb(221,221,221)",T=.9):"add"===n.animation.effect&&b?(y=x,T=1,t.currentData=b):(y="rgb(221,221,221)",T=.9)),t.fillColor=y,t.fillOpacity=T,t.fillOpacity}).attr("fill",function(e){return e.fillColor}),""!==n.series[0].labelFormat&&null!==d&&d.text(function(e){return labelFormat=n.series[0].labelFormat,labelValue=e.properties.name,codeValue=3===s.length?e.properties.postal:e.properties.iso_a2,null!==e.properties.iso_a3&&("STP"===e.properties.iso_a3?labelValue="Sao Tome and Principe":"CIV"===e.properties.iso_a3?labelValue="Cote dIvoire":"BLM"===e.properties.iso_a3?labelValue="St-Barthelemy":"CUW"===e.properties.iso_a3&&(labelValue="Curacao")),e.currentData?(labelFormat=labelFormat.replaceAll("{code}",codeValue).replaceAll("{label}",labelValue),labelFormat=n.getContent(e.currentData,n.series[0],labelFormat)):(z="",z+=-1!==labelFormat.search("{code}")?codeValue:"",z+=-1!==labelFormat.search("{label}")?z?" "+labelValue:labelValue:"",labelFormat=z),labelFormat}).style("fill",function(e){return"auto"===n.series[0].labelFontColor?n.getAutoColor(e.fillColor):n.series[0].labelFontColor}).style("font-size",n.series[0].labelFontSize+"px"),n.renderComplete&&setTimeout(function(){n.renderComplete()},1e3)}function V(){"SC_USACounties"===s&&n.series[0].filterStates&&"fips"!==S&&1===(F=e.getUniqueValues(n.data,i)).length?"code"===C?w="SC_"+F[0]:A.forEach(function(e){e.name===F[0]&&(w="SC_"+e.code)}):w=s,F=[]}function N(){if(V(),t(!0),!n.hideZoom){let e=d3.select("#"+n.innerContainer).append("div").attr("class","zoom-container").style("position","absolute").style("top",n.plot.top+n.plot.titleHeight+("top"===n.legend.position?n.legendSize.height:0)+"px").style("left",n.plot.left+("left"===n.legend.position?n.legendSize.width:0)+"px").attr("id",n.container+"_zoom_container");e.append("a").attr("class","zoom").attr("id","zoom_in").text("+").on("click",function(){p.scaleBy(_,2)}),e.append("a").attr("class","zoom").attr("id","zoom_out").text("-").on("click",function(){p.scaleBy(_,.5)})}function e(){let e=d3.event.transform;u.scale(e.k).translate([e.x,e.y]),_.select("g").selectAll("path").attr("d",m),""!==n.series[0].labelFormat&&null!==d&&d.attr("transform",function(e){return e.properties.coordinates?"translate("+u(e.properties.coordinates)+")":"translate("+m.centroid(e)+")"})}function t(t){let a="",l="",i="";d3.json(o+w+".json",function(o,g){k=w;let h=topojson.feature(g,g.objects[w+".geo"]).features;h=(3==r?topojson.feature(g,g.objects["SC_"+w.substring(6,8)+".geo"]).features:[]).concat(h);let y=topojson.feature(g,{type:"GeometryCollection",geometries:g.objects[w+".geo"].geometries});if(u.fitExtent([[0,0],[n.plot.width,n.plot.height]],y),m=d3.geoPath().projection(u),f=_.append("g").selectAll("path").data(h).enter().append("path").attr("stroke","rgb(255,255,255)").attr("stroke-width",.5).attr("width",n.plot.width).attr("height",n.plot.width/2).on("mousemove",function(e,t){""!==n.tooltip.format&&(a="no data available",e.currentData&&(i=3===s.length?e.properties.postal:e.properties.iso_a2,l=e.properties.name,null!==e.properties.iso_a3&&("STP"===e.properties.iso_a3?l="Sao Tome and Principe":"CIV"===e.properties.iso_a3?l="Cote dIvoire":"BLM"===e.properties.iso_a3?l="St-Barthelemy":"CUW"===e.properties.iso_a3&&(l="Curacao")),a=n.tooltip.format.replaceAll("{code}",i).replaceAll("{label}",l),a=n.getContent(e.currentData,n.series[0],a)),n.showTooltip(a))}).on("mouseout",function(e){n.hideTooltip()}),""!==n.series[0].labelFormat){if(c)for(let e=0;e<h.length;e++)for(let t=0;t<c.length;t++)if(h[e].properties.iso_a3===c[t].properties.iso_a3){h[e].properties.coordinates=c[t].geometry.coordinates;break}d=_.append("g").selectAll("text").data(h).enter().append("text").style("text-anchor","middle").style("font-family",n.series[0].labelFontFamily).style("font-style","bold"===n.series[0].labelFontStyle?"normal":n.series[0].labelFontStyle).style("font-weight","bold"===n.series[0].labelFontStyle?"bold":"normal").attr("dy",".35em").on("mousemove",function(e,t){""!==n.tooltip.format&&(a="no data available",e.currentData&&(i=3===s.length?e.properties.postal:e.properties.iso_a2,l=e.properties.name,null!==e.properties.iso_a3&&("STP"===e.properties.iso_a3?l="Sao Tome and Principe":"CIV"===e.properties.iso_a3?l="Cote dIvoire":"BLM"===e.properties.iso_a3?l="St-Barthelemy":"CUW"===e.properties.iso_a3&&(l="Curacao")),a=n.tooltip.format.replaceAll("{code}",i).replaceAll("{label}",l),a=n.getContent(e.currentData,n.series[0],a)),n.showTooltip(a))}).on("mouseout",function(e){n.hideTooltip()})}p=d3.zoom().scaleExtent([u.scale(),8*u.scale()]).on("zoom",e),_.call(p).call(p.transform,d3.zoomIdentity.translate(u.translate()[0],u.translate()[1]).scale(u.scale())),t&&n.onLoaded&&n.onLoaded(),E()})}n.clear=function(){f.each(function(e){e.currentData=null})},n.update=function(e,a){n.data=e,n.calculateDomain(),n.updateLegend(),V(),k!==w?(_.selectAll("g").remove(),t(!1)):E()},n.legendClick=function(e,t){"ranged"===n.legend.type&&(e.clicked?f.attr("fill-opacity",function(e){return e.legendClass==="ranged-"+t?.1:e.fillOpacity}):f.attr("fill-opacity",function(e){return e.legendClass==="ranged-"+t?1:e.fillOpacity}))},n.onLegendHover=function(e,t,a){"ranged"===n.legend.type&&(a?f.attr("fill-opacity",function(e){return e.legendClass!=="ranged-"+t?.1:e.fillOpacity}):f.attr("fill-opacity",function(e){return e.fillOpacity}))}}return function(){let t=[],l=[],d=0,p=0;s=n.series[0].map.replace("%20","").trim(),r=3===s.length?1:"SC_"===s.substring(0,3)?"SC_Zip"===s.substring(0,6)?3:2:0,u="USA"===s||"SC_USACounties"===s?d3.geoAlbersUsa():d3.geoEquirectangular(),d=n.data.length>10?10:n.data.length;let f=0;if("number"===n.dataProperties.columns[a].type&&2===r)S="fips";else{for(;t.length<d;)(isNaN(n.data[f][a])||3===r)&&n.data[f][a]&&t.push(n.data[f][a].length),f++;p=d3.max(t),S=p<3?"code2":p<4?"code3":"name"}if(i){for(f=0;l.length<d;)isNaN(n.data[f][i])&&n.data[f][i]&&l.push(n.data[f][i].length),f++;p=d3.max(l),C=p<3?"code":"name"}3===s.length?(o=e.mapDirectory+"stdmaps/countries/",N()):"SC_"===s.substring(0,3)?(o=e.mapDirectory+"stdmaps/SubCountries/",N()):""!==n.series[0].labelFormat?d3.json(o+"country_labels.json",function(e,t){c=topojson.feature(t,t.objects.places).features,N()}):N()}(),n}(t)}}(eve),function(e){function t(t){let n=e.initVis(t),a=n.series[0].labelField,l=n.series[0].valueField,i=e.mapDirectory+"/tilemaps/",o="",r=0,s=0,u=0,d=null,c=n.domains.minY,p=n.domains.maxY,f="",m="",g=null,h=null,y=null,x=null,b=0,v=0,F=0,w=null,A=[],k={x:0,y:0},S=0,C=0,z=8,T=0;n.plot.width=n.plot.width-n.plot.left-n.plot.right,n.plot.height=n.plot.height-n.plot.top-n.plot.bottom;let M=n.svg.append("g").attr("transform","translate("+n.plot.left+","+n.plot.top+")");function _(){c=n.domains.minY,p=n.domains.maxY,w.transition().duration(n.animation.duration).ease(n.animation.easing.toEasing()).delay(function(e,t){return t*n.animation.delay}).attr("fill-opacity",function(t){return t.currentData?(m=d3.select(this).attr("fill"),g=t.currentData):(m="",g=null),t.currentData=null,h=3===r?e.filterNumeric(n.data,a,t.name):e.filter(n.data,a,t.name),y=1===r?e.filter(n.data,a,t.code):[],x=null,h.length>0?h[0][a]&&(x=h):y.length>0&&y[0][a]&&(x=y),null!==x&&x.forEach(function(a){if(0!=a[l]&&null!=a[l]){switch("default"!==n.legend.type&&(a[l]=parseFloat(a[l])),n.legend.type){case"default":f=e.matchGroup(a[l],n.legend.legendColors,"color")||"rgb(221,221,221)";break;case"ranged":{let i=e.matchRange(a[l],n.legend.rangeList,"color");i?(f=i.color,t.legendClass="ranged-"+i.index):f="rgb(221,221,221)"}break;default:v=c!==p?a[l]/(p-c)*100-c/(p-c)*100:1,f=e.gradient(n.legend.gradientColors,v)}b=1,t.currentData=a}}),t.currentData||n.animation.effect&&("fade"===n.animation.effect?(f="rgb(221,221,221)",b=.9):"dim"===n.animation.effect?g?(f=m,b=.3,t.currentData=g):(f="rgb(221,221,221)",b=.9):"add"===n.animation.effect&&g?(f=m,b=1,t.currentData=g):(f="rgb(221,221,221)",b=.9)),t.fillColor=f,t.fillOpacity=b,t.fillOpacity}).attr("fill",function(e){return e.fillColor}).style("stroke",function(e){return e.fillColor}).style("stroke-opacity",function(e){return e.fillOpacity}),""!==n.series[0].labelFormat&&null!==d&&d.style("fill",function(e){return"auto"===n.series[0].labelFontColor?n.getAutoColor(e.fillColor):n.series[0].labelFontColor}).text(function(e){return labelFormat=n.series[0].labelFormat,labelValue=e.label,codeValue=e.code,e.currentData?(labelFormat=labelFormat.replaceAll("{code}",codeValue).replaceAll("{label}",labelValue),labelFormat=n.getContent(e.currentData,n.series[0],labelFormat)):(labelwoutMeasure="",labelwoutMeasure+=-1!==labelFormat.search("{code}")?codeValue:"",labelwoutMeasure+=-1!==labelFormat.search("{label}")?labelwoutMeasure?" "+labelValue:labelValue:"",labelFormat=labelwoutMeasure),labelFormat}).style("font-size","24px").style("font-size",function(e){return"auto"===n.series[0].labelFontSize?(C="hexagonal"===n.series[0].tileIcon?(2*T-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*24-1:(2*T-8)/Math.max(this.getComputedTextLength(),this.getBBox().height)*24)<z&&d3.select(this).text(""):C=n.series[0].labelFontSize,C+"px"}).attr("transform",function(e){return"hexagonal"===n.series[0].tileIcon?(s=e.x*S*2+k.x+T,u=e.y*S*Math.sqrt(3)+k.y+T/2,e.y%2!=0&&(s+=S),"translate("+s+","+u+")"):(s=e.x*F+F/2+k.x,u=e.y*F+F/2+k.y,"translate("+s+","+u+")")}),n.renderComplete&&setTimeout(function(){n.renderComplete()},1e3)}return 3===(o=n.series[0].map.replace("%20","").trim()).length?(i=e.mapDirectory+"/tilemaps/countries/",r=1):"SC_"===o.substring(0,3)&&(i=e.mapDirectory+"/tilemaps/SubCountries/",r=2),function(){let e="",t="",a="";d3.json(i+o+".json",function(l,i){let o=i.size;"hexagonal"===n.series[0].tileIcon?(F=Math.min(Math.floor(n.plot.width/(o.x-1)),Math.floor(n.plot.height/(o.y%2==0?.5+.75*o.y:.75*o.y))),k.x=(n.plot.width-F*o.x)/2,k.y=(n.plot.height-F*(.75*o.y))/2):(F=Math.min(Math.floor(n.plot.width/o.x),Math.floor(n.plot.height/o.y)),k.x=(n.plot.width-F*o.x)/2,k.y=(n.plot.height-F*o.y)/2),T=F/2-1,M.attr("transform","translate("+n.plot.left+","+n.plot.top+")"),A=i.objects,"circle"===n.series[0].tileIcon?w=M.selectAll(".circle").attr("class","circle").data(A).enter().append("circle").attr("r",T).attr("transform",function(e){return s=e.x*F+F/2+k.x,u=e.y*F+F/2+k.y,"translate("+s+","+u+")"}):"square"===n.series[0].tileIcon?w=M.selectAll(".rect").attr("class","rect").data(A).enter().append("rect").attr("width",F-2).attr("height",F-2).attr("rx",3).attr("ry",3).attr("transform",function(e){return s=e.x*F+k.x,u=e.y*F+k.y,"translate("+s+","+u+")"}):"hexagonal"===n.series[0].tileIcon&&(w=M.selectAll(".polygon").attr("class","polygon").data(A).enter().append("polygon").attr("points",function(e){return S=2+Math.sqrt(3)*T/2,s=e.x*S*2+k.x+T,u=e.y*S*Math.sqrt(3)+k.y+T/2,e.y%2!=0&&(s+=S),s+","+(u-T)+" "+(s+Math.cos(Math.PI/6)*T)+","+(u-Math.sin(Math.PI/6)*T)+" "+(s+Math.cos(Math.PI/6)*T)+","+(u+Math.sin(Math.PI/6)*T)+" "+s+","+(u+T)+" "+(s-Math.cos(Math.PI/6)*T)+","+(u+Math.sin(Math.PI/6)*T)+" "+(s-Math.cos(Math.PI/6)*T)+","+(u-Math.sin(Math.PI/6)*T)})),w.on("mousemove",function(l,i){""!==n.tooltip.format&&(e="no data available",l.currentData&&(a=l.code,t=l.name,e=n.tooltip.format.replaceAll("{code}",a).replaceAll("{label}",t),e=n.getContent(l.currentData,n.series[0],e)),n.showTooltip(e))}).on("mouseout",function(e){n.hideTooltip()}),""!==n.series[0].labelFormat&&(d=M.append("g").selectAll("text").data(A).enter().append("text").style("text-anchor","middle").style("font-family",n.series[0].labelFontFamily).style("font-style","bold"===n.series[0].labelFontStyle?"normal":n.series[0].labelFontStyle).style("font-weight","bold"===n.series[0].labelFontStyle?"bold":"normal").attr("dy",".35em").on("mousemove",function(l,i){""!==n.tooltip.format&&(e="no data available",l.currentData&&(a=l.code,t=l.name,e=n.tooltip.format.replaceAll("{code}",a).replaceAll("{label}",t),e=n.getContent(l.currentData,n.series[0],e)),n.showTooltip(e))}).on("mouseout",function(e){n.hideTooltip()})),n.onLoaded&&n.onLoaded(),_()}),n.clear=function(){w.each(function(e){e.currentData=null})},n.update=function(e,t){n.data=e,n.calculateDomain(),n.updateLegend(),_()},n.legendClick=function(e,t){"ranged"===n.legend.type&&(e.clicked?w.attr("fill-opacity",function(e){return e.legendClass==="ranged-"+t?.1:e.fillOpacity}):w.attr("fill-opacity",function(e){return e.legendClass==="ranged-"+t?1:e.fillOpacity}))},n.onLegendHover=function(e,t,a){"ranged"===n.legend.type&&(a?w.attr("fill-opacity",function(e){return e.legendClass!=="ranged-"+t?.1:e.fillOpacity}).style("stroke-opacity",function(e){return e.legendClass!=="ranged-"+t?.1:e.fillOpacity}):w.attr("fill-opacity",function(e){return e.fillOpacity}).style("stroke-opacity",function(e){return e.fillOpacity}))}}(),n}e.tileMap=function(n){return n.type="tileMap",n.masterType="map",e.visualizations.push(n),new t(n)}}(eve),Number.prototype.group=function(e,t,n){null===e&&(e="."),null===t&&(t=","),null===n&&(n=2),"number"!==eve.getType(n)&&(n=2),"string"!==eve.getType(e)&&(e="."),"string"!==eve.getType(t)&&(t=",");for(var a=(n<0?this:this.toFixed(n)).toString().split("."),l=a[0],i=a.length>1?e+a[1]:"",o=/(\d+)(\d{3})/;o.test(l);)l=l.replace(o,"$1"+t+"$2");return l+i},function(e){function t(t){this.behavior="tabular",this.container="",this.columns=[],this.data=null,this.width="auto",this.height="auto",this.pageIndex=1,this.pageSize=100,this.sortDirection="asc",this.sortField="",this.paginatorText="Records from {0} to {1} of total {2}",this.pivotMode="tree";var n=this,a=null;for(var l in t)n[l]=t[l];if(""===n.container)return null;n._totalPages=0,n._pager=null,n._firstCol=null,n._minMaxValues=null,n._classicalMinMax=null,n._rows=null,n._totalRecords=null,n._columnNames=[],n._rowTitles=[],n._rowNames=[],n._dataNames=[],n._totalColWidth=0,n._subBtns=null,n._btns=null,n._header=null,n._footer=null,n._rowsContainer=null,n._colElements=null,n._colResizers=null,n._selectedRow=null,n._rowElements=null,n._gauges=[],n.columns.forEach(function(e){switch(e.direction){case"column":n._columnNames.push(e.fieldName);break;case"row":n._rowNames.push(e.fieldName),n._rowTitles.push(e.columnName),1===n._rowNames.length&&(n._firstCol=e);break;case"data":n._dataNames.push(e.fieldName);break;default:n._columnNames.push(e.fieldName);break}});let i=function(){var e=n.paginatorText,t=(n.pageIndex-1)*n.pageSize+1,a=t+n.pageSize-1,l=$("#"+n.container+"_navText");a>n._totalRecords&&(a=n._totalRecords),n._totalPages=Math.ceil(n._totalRecords/n.pageSize),e=(e=(e=e.replace("{0}",t.group(".",",",0))).replace("{1}",a.group(".",",",0))).replace("{2}",n._totalRecords),null!=l&&l.html(e),null!=n._pager&&n._pager.val(n.pageIndex)},o=function(e,t){var a=$("#"+n.container+"_col_"+e),l=n.columns[t],i="desc"===n.sortDirection?"pagos-grid-sorter-desc":"pagos-grid-sorter-asc";if(null!=n._colElements&&(n._colElements.removeClass("pagos-grid-sorter-asc"),n._colElements.removeClass("pagos-grid-sorter-desc")),n.sortField!=l.fieldName&&(n.sortDirection="asc",i="pagos-grid-sorter-asc"),"undefined"!=typeof isSinglePostPage){var o=l.fieldName,r=l.columnType;n._rows=n._rows.sort(function(e,t){switch(r){case"numeric":var a=parseFloat(e[o]),l=parseFloat(t[o]);return isNaN(a)&&(a=0),isNaN(l)&&(l=0),"asc"===n.sortDirection?a-l:l-a;case"datetime":return"asc"===n.sortDirection?new Date(e[o])>new Date(t[o])?1:new Date(e[o])<new Date(t[o])?-1:0:new Date(t[o])>new Date(e[o])?1:new Date(t[o])<new Date(e[o])?-1:0;default:return"asc"===n.sortDirection?e[o]>t[o]?1:e[o]<t[o]?-1:0:t[o]>e[o]?1:t[o]<e[o]?-1:0}}),n.bind(n.data),n.sortDirection="asc"===n.sortDirection?"desc":"asc"}n.sortField=l.fieldName,n.sortFieldID=l.fieldID,null!=a&&(a.addClass(i),"right"===l.labelPosition?a.css("backgroundPosition","left"):a.css("backgroundPosition","right")),n.onSort&&(n.onSort(n.sortField,n.sortFieldID,"asc"===n.sortDirection?"desc":"asc"),n.sortDirection="asc"===n.sortDirection?"desc":"asc")},r=function(){switch(n.behavior){case"tabular":s(n.data);break;case"pivot":u(n.data);break}$("."+n.container+"_cols").each(function(e){$(this).resizable({handles:"e",resize:function(e,t){let a=$(this).attr("colid"),l=A(a);n.columns[l].width=t.size.width,$("."+n.container+"_rowCol_"+l).css("width",t.size.width+"px"),n.onColumnResize&&n.onColumnResize(a,l,t.size.width)},stop:function(e,t){}})})},s=function(e){let t="";n._rows=e.rows,n._totalRecords=e.totalRecords,n._minMaxValues=e.minMaxValues;let a=parseInt(n._rowsContainer.css("height")),l=Math.floor(a/20);n._rows.forEach(function(e,a){let i="";a>=l&&(i=" pagos-grid-last2"),t+='<tr id="'+n.container+"_row_"+a+'" class="pagos-grid-row pagos-grid-row-hlines '+n.container+"_rows "+i+'">',n.columns.forEach(function(n,l){t+=p(e,n,a,l,0)}),t+="</tr>"}),n._rowsContainer.html('<table cellpadding="0" cellspacing="0">'+t+"</table>"),n._rowElements=$("."+n.container+"_rows"),n._rowElements.length&&n._rowElements.on("click",function(e){var t=$(this);n._rowElements.removeClass("pagos-grid-row-selected"),t.addClass("pagos-grid-row-selected"),n._selectedRow=n._rows[e],n.onRowSelected&&n.onRowSelected(n._selectedRow)}),g(n._rows,0),1===n.pageIndex&&i()},u=function(e){var t="",a="",l=null,i=0,o=null,r="",s="";n._rows=e.rows,n._rows.forEach(function(e,l){t=n.container+"_row_"+l,a=t+"_sub",s+='<tr id="'+t+'" class="pagos-grid-row pagos-grid-row-hlines '+n.container+'_rows">',s+=p(e,n._firstCol,l,0,0),n.columns.forEach(function(t){if("data"===t.direction){var a=b(t.fieldName);s+=p(e,t,l,a,0),e[t.fieldName]<n._minMaxValues["min"+t.fieldName]&&(n._minMaxValues["min"+t.fieldName]=e[t.fieldName]),e[t.fieldName]>n._minMaxValues["max"+t.fieldName]&&(n._minMaxValues["max"+t.fieldName]=e[t.fieldName])}}),s+="</tr>",s+='<tr id="'+a+'" class="pagos-grid-sub-row-container"><td colspan="'+(n.columns.length-1)+'"></td></tr>'}),n._rowsContainer.html('<table cellpadding="0" cellspacing="0">'+s+"</table>"),n._rowElements=$("."+n.container+"_rows"),n._rowElements.length&&n._rowElements.on("click",function(e){var t=$(this);n._rowElements.removeClass("pagos-grid-row-selected"),t.addClass("pagos-grid-row-selected"),n._selectedRow=n._rows[e],n.onRowSelected&&n.onRowSelected(n._selectedRow)}),n._subBtns=$("."+n.container+"_subBtns_0"),n._subBtns.length&&n._subBtns.on("click",function(e){var t=$(this);i=parseInt(t.attr("rowindex"));var a="#"+n.container+"_row_"+i+"_sub";l=$(a),t.hasClass("pagos-grid-minus")?t.removeClass("pagos-grid-minus"):t.addClass("pagos-grid-minus"),$(".pagos-grid-sub-row-container").css("display","none"),t.hasClass("pagos-grid-minus")?(l.css("display","table-row"),d(l,a,n._rows[i],0)):l.css("display","none")}),n.showSubTotals&&n.columns.forEach(function(e){if("data"===e.direction){let t=b(e.fieldName);o=$("#"+n.container+"_subTotal_"+t),r=w(t),null!=o&&(o.html(r),o.attr("title",r))}}),"classical"===n.pivotMode&&(n._classicalMinMax=F(n._rows)),g(n._rows,0)},d=function(e,t,a,l){var i=l+1,o="",r=null,s=null,u=null,c="",p=null,m=0,h=a.sub;null!=h&&h.length>0&&((r=x(n._rowNames[i])).width=x(n._rowNames[0]).width,h.forEach(function(e,a){c=t+"_row_"+a+"_sub",o+='<tr id="'+n.container+"_subs_"+i+'" class="pagos-grid-sub-row '+n.container+"_subRows_"+i+'">',o+=f(e,r,a,0,l+1,t),n.columns.forEach(function(i){if("data"===i.direction){var r=A(i.fieldID);o+=f(e,i,a,r,l+0,t),e[i.fieldName]<n._minMaxValues["min"+i.fieldName]&&(n._minMaxValues["min"+i.fieldName]=e[i.fieldName]),e[i.fieldName]>n._minMaxValues["max"+i.fieldName]&&(n._minMaxValues["max"+i.fieldName]=e[i.fieldName])}}),o+="</tr>",o+='<tr id="'+c+'" class="pagos-grid-sub-row-container"><td colspan="'+(n.columns.length-1)+'"></td></tr>'})),e.children().first().html('<table border="0" cellpadding="0" cellspacing="0">'+o+"</table>"),(s=$("."+n.container+"_subRows_"+i)).length&&s.on("click",function(e){var t=$(this);s.removeClass("pagos-grid-row-selected"),t.addClass("pagos-grid-row-selected")}),(u=$("."+n.container+"_subBtns_"+i)).length&&u.on("click",function(e){var t=$(this);m=parseInt(t.attr("rowindex")),p=$("#"+n.container+"_row_"+m+"_sub"),t.hasClass("pagos-grid-minus")?t.removeClass("pagos-grid-minus"):t.addClass("pagos-grid-minus"),t.hasClass("pagos-grid-minus")?(p.css("display","table-row"),d(p,"#"+n.container+"_row_"+m+"_sub",h[m],i)):p.css("display","none")}),g(h,l,t)},c=function(e,t,n){let a=t[e.fieldName];if(t.sub&&t.sub.length){let n=d3.sum(t.sub,function(t){return t[e.fieldName]}),l=function(){let n=0;return t.sub.forEach(function(t){null!=t[e.fieldName]&&n++}),n}();switch(e.expression){case"count":a=l;case"sum":a=n;break;case"avg":a=n/l;break;case"min":a=d3.min(t.sub,function(t){return t[e.fieldName]});break;case"max":a=d3.max(t.sub,function(t){return t[e.fieldName]});break;default:a=n;break}}return a},p=function(e,t,l,i,o){let r="",s=n.container+"_row_"+l+"_col_"+i+"_depth_"+o,u=e.sub,d="",p=e[t.fieldName],f=m(e[t.fieldName],t),g="width: "+t.width+"px; text-align: "+t.labelPosition+"; ";"pivot"===n.type&&"data"===t.direction&&(p="avg"===t.expression?+e[t.fieldName]:c(t,e),f=m(p,t)),i===n.columns.length-1&&n._totalColWidth>a.width()&&(g="width: "+(t.width-2)+"px; text-align: "+t.labelPosition+"; "),0===i&&null!=u&&"tabular"!==n.behavior&&(d='<i class="pagos-grid-plus '+n.container+'_subBtns_0 fa fa-plus"  rowindex="'+l+'" colindex="'+i+'" depth="0"></i>&nbsp;'),r+='<td id="'+s+'" title="'+f+'" value="'+p+'" class="pagos-grid-cell pagos-grid-row-vlines '+n.container+"_rowCol_"+i+'"',0==l&&(r+=' style="'+g+'"');var h=n.container+"_rowCol_"+i;return"bars"!==t.conditionalFormat.type&&(h+=" pagos-grid-cell-padding"),r+='><div id="'+s+'_div" style="'+g+'" class="'+h+'">',t.hideValues?r+=d:r+=d+f,r+="</div></td>"},f=function(e,t,l,i,o,r){let s=r.startsWith("#")?r.replace("#",""):r,u=s+"_row_"+l+"_col_"+i+"_depth_"+o,d=e.sub,p=s+"_row_"+l+"_sub",f="",g="",h="width: "+t.width+"px; text-align: "+t.labelPosition+"; ",y=e[t.fieldName],x=m(e[t.fieldName],t),b="";"pivot"===n.type&&"data"===t.direction&&(y=c(t,e),x=m(y,t)),i===n.columns.length-1&&n._totalColWidth>a.width()&&(h="width: "+(t.width-2)+"px; text-align: "+t.labelPosition+"; "),0===l&&(g=" border-top: 1px solid #85b9f6; "),0===i&&null!=d&&(f='<i class="pagos-grid-plus '+n.container+"_subBtns_"+o+'" sid="'+p+'" rowindex="'+l+'" colindex="'+i+'" depth="'+o+'"></i>&nbsp;'),b+='<td id="'+u+'" title="'+x+'" value="'+y+'" class="pagos-grid-cell pagos-grid-row-vlines '+n.container+"_rowCol_"+i+'" style="'+h+g+'">',h+=0===i?"padding-left: "+(16*o+5)+"px; padding-right: 5px":"padding-right: 5px";var v=n.container+"_rowCol_"+i;return"bars"!==t.conditionalFormat.type&&(v+=" pagos-grid-cell-padding"),b+='<div id="'+u+'_div" style="'+h+'" class="'+v+'">',t.hideValues?b+=f:b+=f+x,b+="</div></td>"},m=function(t,n){if(null==t)return"";let a=t;if("datetime"===n.columnType){let l=""==n.labelFormat?"%x":n.labelFormat;n.includeTime&&(l+=" %X"),a=e.formatDate(t,l)}else"numeric"===n.columnType&&(a=e.formatNumber(t,n.labelFormat));return null!=a&&"null"!=a&&"nan"!=a&&"NaN"!=a&&"Nan"!=a&&NaN!=a&&a!=1/0&&"Infinity"!=a&&"infinity"!=a||(a=""),a},g=function(t,a,l){let i=null,o=null,r=0,s=0,u=0,d="",c=null,p=0,f=null,m={},g={},x={},b={};n._gauges.length=0,"tabular"===n.behavior?c=n.columns:(c=[],y().forEach(function(e){c.push(e)}),h().forEach(function(e){c.push(e)}));for(let h=0;h<t.length;h++){t[h];c.forEach(function(t,c){if((f=t.conditionalFormat)&&"none"!==f.type)switch(o=v(t.fieldName),r=o.min,s=o.max,null!=r&&void 0!=r||(r=0),null!=t.startFromZero&&!0===t.startFromZero&&(r=0),x[t.fieldName]=r<0?r:0,b[t.fieldName]=s>=0?0:s,m[t.fieldName]=r<0?0:r,g[t.fieldName]=s>=0?s:0,d=n.container+"_row_"+h+"_col_"+c+"_depth_"+a,null!=l&&(d=l+"_row_"+h+"_col_"+c+"_depth_"+a),i=d.startsWith("#")?$(d):$("#"+d),p=parseFloat(i.attr("value")),(u=r<0?100*Math.abs(p)/s:100*(Math.abs(p)-r)/(s-r))<0&&(u=0),u>100&&(u=100),isNaN(p)&&(u=0),f.type){case"bars":{let e=i.children().first(),n=s-r,a=Math.abs(p)/n*100-r/n*100,l=(t.width,""),o=null;i.css("padding","0px 0px 0px 0px !important"),e.css("padding","0px 0px 0px 0px !important"),e.css("height","20px"),e.css("position","relative"),e.html(""),a=Math.round(a),""!=t.labelFormat&&(p=0==p?"":eve.formatNumber(p,t.labelFormat)),-1!=(o=isNaN(p)&&""==t.labelFormat?"":p).toString().indexOf("NaN")&&(o=""),""===o?l+='<div style="width:100%; height:20px; text-align: '+t.labelPosition+'; position: absolute; top: 0; z-index:2; padding: 0;" class="pagos-grid-cell-padding">'+o+"</div>":(t.hideValues&&(o=""),l+='<div style="width:100%; height:20px; text-align: '+t.labelPosition+'; position: absolute; padding: 0; top: 0; z-index:2;" class="pagos-grid-cell-padding">'+o+"</div>",0!=a&&(l+='<div style="width:'+a+"%; height: 20px; text-align: "+t.labelPosition+"; position: absolute; top: 0; background: "+f.startColor+'; padding: 0;" class="pagos-grid-cell-padding"></div>'),e.html(l))}break;case"gradient":{let n=e.gridGradient(f.startColor,f.endColor,u);0==p&&(p="",i.html(p)),isNaN(p)||(0!=p||t.startFromZero)&&i.css("backgroundColor",n)}break}})}},h=function(){let t=[];return n.columns.forEach(function(n){"data"===n.direction&&t.push(e.clone(n))}),t},y=function(){let t=[];return n.columns.forEach(function(n){"row"===n.direction&&t.push(e.clone(n))}),t},x=function(e){let t=null;return n.columns.forEach(function(n){n.fieldName===e&&(t=n)}),t},b=function(e){let t=-1;return n.columns.forEach(function(n,a){n.fieldName===e&&(t=a)}),t},v=function(e){let t=0,a=0,l=n._rows;if("tabular"===n.behavior)return t=parseFloat(n._minMaxValues[0][e+"_min"]),a=parseFloat(n._minMaxValues[0][e+"_max"]),{min:t,max:a};if("classical"===n.pivotMode){let e=[];return y().forEach(function(t){e.push(t.fieldName)}),l.forEach(function(t,n){for(var l in t)-1==e.indexOf(l)&&t[l]>a&&(a=parseFloat(t[l]))}),t=a,l.forEach(function(n,a){for(var l in n)-1==e.indexOf(l)&&null!=n[l]&&n[l]<t&&(t=parseFloat(n[l]))}),{min:t,max:a}}return l.forEach(function(t,n){null==t[e]||void 0==t[e]||isNaN(t[e])||t[e]>a&&(a=parseFloat(t[e]))}),t=a,l.forEach(function(n,a){null==n[e]||void 0==n[e]||isNaN(n[e])||n[e]<t&&(t=parseFloat(n[e]))}),{min:t,max:a}},F=function(e){let t=0,a=0;return e.forEach(function(e,t){n.columns.forEach(function(t,n){"data"===t.direction&&(null==e[t.fieldName]||void 0==e[t.fieldName]||isNaN(e[t.fieldName])||e[t.fieldName]>a&&(a=e[t.fieldName]))})}),t=a,e.forEach(function(e,a){n.columns.forEach(function(n,a){"data"===n.direction&&(null==e[n.fieldName]||void 0==e[n.fieldName]||isNaN(e[n.fieldName])||e[n.fieldName]<t&&(t=e[n.fieldName]))})}),{min:t,max:a}},w=function(e){let t=n.columns[e],a=[],l=0,i=0,o=0;switch(n._rows.forEach(function(e){let n=parseFloat(e[t.fieldName]);isNaN(n)||(a.push(n),o+=n),null!=e[t.fieldName]&&l++}),a.sort(),t.expression){case"count":i=l;case"sum":i=o;break;case"avg":i=o/l;break;case"min":i=d3.min(a);break;case"max":i=d3.max(a);break;default:i=o;break}return m(i,t)},A=function(e){var t=-1;return n.columns.forEach(function(n,a){n.fieldID===e&&(t=a)}),t};this.update=function(e){if(null==e)return!1;var t=this;switch(t.behavior){case"tabular":s(e);break;case"pivot":u(e);break}$("."+t.container+"_cols").each(function(e){$(this).resizable({handles:"e",resize:function(e,n){var a=$(this).attr("colid"),l=A(a);t.columns[l].width=n.size.width,$("."+t.container+"_rowCol_"+l).css("width",n.size.width+"px")},stop:function(e,t){}})})},$(document).ready(function(){!function(){(a=$("#"+n.container)).hasClass("pagos-grid")||a.addClass("pagos-grid");let e=a.height()-56,t="",l="";if(a.css("width","auto"===n.width?"100%":n.width+"px"),a.css("height","auto"===n.height?a.height():n.height+"px"),"pivot"===n.behavior){let e=n._firstCol.width?n._firstCol.width:100,a="auto"===n._firstCol.labelPosition?"left":n._firstCol.labelPosition,l="width: "+e+"px;",i="width: "+e+"px; text-align: "+a+"; height: 27px; padding-top: 5px;",o="";i+="right"===a?"background-position: left":"background-position: right",t+='<td class="colContainer '+n.container+'_rowCol_0" style="'+l+'">',t+='<div id="'+n.container+'_col_0" columnindex="0" colname="'+n._firstCol.fieldName+'" colid="'+n._firstCol.fieldID+'" dataindex="0" class="column '+n.container+"_cols "+o+" "+n.container+'_rowCol_0" style="'+i+'">',t+=n._rowTitles.join("-"),t+="</div></td>",n._minMaxValues={}}if(n.columns.forEach(function(e,a){let l=e.width?e.width:100,i="auto"===e.labelPosition?"left":e.labelPosition,o="width: "+l+"px;",r="width: "+l+"px; text-align: "+i+"; height: 27px; padding-top: 5px;";r+="right"===i?"background-position: left":"background-position: right","tabular"===n.behavior?(t+='<td class="colContainer '+n.container+"_rowCol_"+a+'" style="'+o+'">',t+='<div id="'+n.container+"_col_"+a+'" columnindex="'+a+'" colname="'+e.fieldName+'" colid="'+e.fieldID+'" dataindex="'+a+'" class="column '+n.container+'_cols " style="'+r+'">',t+=e.columnName,t+="</div></td>"):"data"===e.direction&&(n._minMaxValues["min"+e.fieldName]=0,n._minMaxValues["max"+e.fieldName]=0,t+='<td class="colContainer '+n.container+"_rowCol_"+a+'" style="'+o+'">',t+='<div id="'+n.container+"_col_"+a+'" columnindex="'+a+'" colname="'+e.fieldName+'"  colid="'+e.fieldID+'"dataindex="'+a+'" class="column '+n.container+'_cols " style="'+r+'">',t+=e.columnName,t+="</div></td>"),t+="</td>","tabular"===n.behavior?n._totalColWidth+=e.width?e.width:100:"row"!==e.direction&&"data"!==e.direction||(n._totalColWidth+=e.width?e.width:100)}),l+='<div id="'+n.container+'_hct" style="width: 100%;" class="pagos-grid-rail-content">',l+='<table id="'+n.container+'_hdr" class="pagos-grid-header" style="" border="0" cellpadding="0" cellspacing="0"><tr>',l+=t,l+="</tr></table></div>",l+='<div id="'+n.container+'_rows" class="'+("tabular"==n.behavior?"pagos-grid-row-container":"pagos-pivot-row-container")+'" style="width: 100%; height: '+e+'px;">',l+="</div>","tabular"===n.behavior)l+='<table id="'+n.container+'_ft" class="pagos-grid-footer" style="min-width: 100%;"><tr><td>',l+='<div id="'+n.container+'_first" class="pagos-grid-button pagos-grid-button-first"><i class="fa fa-fast-backward"></i></div>',l+='<div id="'+n.container+'_prev" class="pagos-grid-button pagos-grid-button-prev"><i class="fa fa-backward"></i></div>',l+='<div id="'+n.container+'_navText" class="pagos-grid-footer-layer">'+n.paginatorText+"</div>",l+='<div id="'+n.container+'_next" class="pagos-grid-button pagos-grid-button-next"><i class="fa fa-forward"></i></div>',l+='<div id="'+n.container+'_last" class="pagos-grid-button pagos-grid-button-last"><i class="fa fa-fast-forward"></i></div>',l+='<div id="grid_footer_layer" class="pagos-grid-footer-layer">Jump to page: <input id="'+n.container+'_pager" type="text" style="text-align: center; padding-left: 0px; width: 50px;" /></div>',l+="</td></tr></table>";else if(n.showSubTotals){let e=n._firstCol.width?n._firstCol.width:100;l+='<div id="'+n.container+'_fct" class="pagos-grid-rail-content" style="width: 100%;">',l+='<table id="'+n.container+'_ft" class="pagos-grid-subtotal" border="0" cellpadding="0" cellspacing="0"><tr>',l+='<td class="pagos-grid-subtotal-cell-container '+n.container+'_rowCol_0" style="width: '+e+'px;">',l+='<div id="'+n.container+'_subTotal_0" class="pagos-grid-subtotal-cell '+n.container+'_rowCol_0" style="width: '+e+'px;">Grand Total</div></td>',n.columns.forEach(function(e,t){if("data"===e.direction){let a=e.width?e.width:100;l+='<td class="pagos-grid-subtotal-cell-container '+n.container+"_rowCol_"+t+'" style="width: '+a+'px;">',l+='<div id="'+n.container+"_subTotal_"+t+'" class="pagos-grid-subtotal-cell '+n.container+"_rowCol_"+t+'" style="width: '+a+'px;">0</div></td>'}}),l+="</td>",l+="</tr></table></div>"}a.html(l),"tabular"===n.behavior&&($("#"+n.container+"_first").on("click",function(){1!=n.pageIndex&&(n.pageIndex=1,i(),n.onPageChanged&&n.onPageChanged(n.pageIndex))}),$("#"+n.container+"_prev").on("click",function(){1!=n.pageIndex&&(n.pageIndex-=1,i(),n.onPageChanged&&n.onPageChanged(n.pageIndex))}),$("#"+n.container+"_next").on("click",function(){n.pageIndex!=n._totalPages&&(n.pageIndex+=1,i(),n.onPageChanged&&n.onPageChanged(n.pageIndex))}),$("#"+n.container+"_last").on("click",function(){n.pageIndex!=n._totalPages&&(n.pageIndex=n._totalPages,i(),n.onPageChanged&&n.onPageChanged(n.pageIndex))}),n._pager=$("#"+n.container+"_pager"),n._pager.on("change",function(){let e=parseInt(n._pager.val());if(isNaN(e))return!1;if(e<1){if(1===n.pageIndex)return void n._pager.val(1);e=1}if(e>n._totalPages){if(n.pageIndex===n._totalPages)return void n._pager.val(n._totalPages);e=n._totalPages}n.pageIndex=e,i(),n.onPageChanged&&n.onPageChanged(n.pageIndex)}),n._pager.val(n.pageIndex.toString())),n._header=$("#"+n.container+"_hdr"),n._footer=$("#"+n.container+"_ft"),n._colElements=$("."+n.container+"_cols"),n._rowsContainer=$("#"+n.container+"_rows"),null!=n._colElements&&n._colElements.length&&n._colElements.on("click",function(){let e=parseInt($(this).attr("columnindex")),t=parseInt($(this).attr("dataindex"));o(e,t)}),null!=n._rowsContainer&&n._rowsContainer.length&&n._rowsContainer.scroll(function(){let e=$(this),t=e.scrollLeft(),a=(e[0].scrollWidth,e[0].clientWidth,$("#"+n.container+"_subTotal_"+(n.columns.length-1)),$("#"+n.container+"_hct")),l=$("#"+n.container+"_fct");null!=a&&a.length&&a.scrollLeft(t),null!=l&&l.length&&l.scrollLeft(t)}),null!=n.data&&r(n.data)}()})}eve.grid=function(n){return n.behavior="tabular",e.visualizations.push(n),new t(n)},eve.pivot=function(n){return n.behavior="pivot",e.visualizations.push(n),new t(n)}}(eve);
//# sourceMappingURL=eve.min.js.map